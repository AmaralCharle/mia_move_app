(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();function rk(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ly={exports:{}},ae={};/**
* @license React
* react.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var $i=Symbol.for("react.element"),ak=Symbol.for("react.portal"),sk=Symbol.for("react.fragment"),ik=Symbol.for("react.strict_mode"),ok=Symbol.for("react.profiler"),lk=Symbol.for("react.provider"),uk=Symbol.for("react.context"),ck=Symbol.for("react.forward_ref"),dk=Symbol.for("react.suspense"),hk=Symbol.for("react.memo"),fk=Symbol.for("react.lazy"),Ym=Symbol.iterator;function mk(t){return t===null||typeof t!="object"?null:(t=Ym&&t[Ym]||t["@@iterator"],typeof t=="function"?t:null)}var My={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Fy=Object.assign,Uy={};function ds(t,e,n){this.props=t,this.context=e,this.refs=Uy,this.updater=n||My}ds.prototype.isReactComponent={};ds.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ds.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Vy(){}Vy.prototype=ds.prototype;function Lh(t,e,n){this.props=t,this.context=e,this.refs=Uy,this.updater=n||My}var Mh=Lh.prototype=new Vy;Mh.constructor=Lh;Fy(Mh,ds.prototype);Mh.isPureReactComponent=!0;var Xm=Array.isArray,zy=Object.prototype.hasOwnProperty,Fh={current:null},jy={key:!0,ref:!0,__self:!0,__source:!0};function qy(t,e,n){var r,a={},s=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(s=""+e.key),e)zy.call(e,r)&&!jy.hasOwnProperty(r)&&(a[r]=e[r]);var o=arguments.length-2;if(o===1)a.children=n;else if(1<o){for(var u=Array(o),c=0;c<o;c++)u[c]=arguments[c+2];a.children=u}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)a[r]===void 0&&(a[r]=o[r]);return{$$typeof:$i,type:t,key:s,ref:i,props:a,_owner:Fh.current}}function pk(t,e){return{$$typeof:$i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Uh(t){return typeof t=="object"&&t!==null&&t.$$typeof===$i}function gk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Jm=/\/+/g;function cc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gk(""+t.key):e.toString(36)}function Xo(t,e,n,r,a){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case $i:case ak:i=!0}}if(i)return i=t,a=a(i),t=r===""?"."+cc(i,0):r,Xm(a)?(n="",t!=null&&(n=t.replace(Jm,"$&/")+"/"),Xo(a,e,n,"",function(c){return c})):a!=null&&(Uh(a)&&(a=pk(a,n+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(Jm,"$&/")+"/")+t)),e.push(a)),1;if(i=0,r=r===""?".":r+":",Xm(t))for(var o=0;o<t.length;o++){s=t[o];var u=r+cc(s,o);i+=Xo(s,e,n,u,a)}else if(u=mk(t),typeof u=="function")for(t=u.call(t),o=0;!(s=t.next()).done;)s=s.value,u=r+cc(s,o++),i+=Xo(s,e,n,u,a);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function No(t,e,n){if(t==null)return t;var r=[],a=0;return Xo(t,r,"","",function(s){return e.call(n,s,a++)}),r}function yk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Nt={current:null},Jo={transition:null},vk={ReactCurrentDispatcher:Nt,ReactCurrentBatchConfig:Jo,ReactCurrentOwner:Fh};function By(){throw Error("act(...) is not supported in production builds of React.")}ae.Children={map:No,forEach:function(t,e,n){No(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return No(t,function(){e++}),e},toArray:function(t){return No(t,function(e){return e})||[]},only:function(t){if(!Uh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ae.Component=ds;ae.Fragment=sk;ae.Profiler=ok;ae.PureComponent=Lh;ae.StrictMode=ik;ae.Suspense=dk;ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vk;ae.act=By;ae.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Fy({},t.props),a=t.key,s=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,i=Fh.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(u in e)zy.call(e,u)&&!jy.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&o!==void 0?o[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){o=Array(u);for(var c=0;c<u;c++)o[c]=arguments[c+2];r.children=o}return{$$typeof:$i,type:t.type,key:a,ref:s,props:r,_owner:i}};ae.createContext=function(t){return t={$$typeof:uk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:lk,_context:t},t.Consumer=t};ae.createElement=qy;ae.createFactory=function(t){var e=qy.bind(null,t);return e.type=t,e};ae.createRef=function(){return{current:null}};ae.forwardRef=function(t){return{$$typeof:ck,render:t}};ae.isValidElement=Uh;ae.lazy=function(t){return{$$typeof:fk,_payload:{_status:-1,_result:t},_init:yk}};ae.memo=function(t,e){return{$$typeof:hk,type:t,compare:e===void 0?null:e}};ae.startTransition=function(t){var e=Jo.transition;Jo.transition={};try{t()}finally{Jo.transition=e}};ae.unstable_act=By;ae.useCallback=function(t,e){return Nt.current.useCallback(t,e)};ae.useContext=function(t){return Nt.current.useContext(t)};ae.useDebugValue=function(){};ae.useDeferredValue=function(t){return Nt.current.useDeferredValue(t)};ae.useEffect=function(t,e){return Nt.current.useEffect(t,e)};ae.useId=function(){return Nt.current.useId()};ae.useImperativeHandle=function(t,e,n){return Nt.current.useImperativeHandle(t,e,n)};ae.useInsertionEffect=function(t,e){return Nt.current.useInsertionEffect(t,e)};ae.useLayoutEffect=function(t,e){return Nt.current.useLayoutEffect(t,e)};ae.useMemo=function(t,e){return Nt.current.useMemo(t,e)};ae.useReducer=function(t,e,n){return Nt.current.useReducer(t,e,n)};ae.useRef=function(t){return Nt.current.useRef(t)};ae.useState=function(t){return Nt.current.useState(t)};ae.useSyncExternalStore=function(t,e,n){return Nt.current.useSyncExternalStore(t,e,n)};ae.useTransition=function(){return Nt.current.useTransition()};ae.version="18.3.1";Ly.exports=ae;var x=Ly.exports;const l=rk(x);var $y={exports:{}},Vt={},Hy={exports:{}},Ky={};/**
* @license React
* scheduler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/(function(t){function e(k,_){var j=k.length;k.push(_);e:for(;0<j;){var T=j-1>>>1,q=k[T];if(0<a(q,_))k[T]=_,k[j]=q,j=T;else break e}}function n(k){return k.length===0?null:k[0]}function r(k){if(k.length===0)return null;var _=k[0],j=k.pop();if(j!==_){k[0]=j;e:for(var T=0,q=k.length,X=q>>>1;T<X;){var Se=2*(T+1)-1,He=k[Se],Oe=Se+1,ln=k[Oe];if(0>a(He,j))Oe<q&&0>a(ln,He)?(k[T]=ln,k[Oe]=j,T=Oe):(k[T]=He,k[Se]=j,T=Se);else if(Oe<q&&0>a(ln,j))k[T]=ln,k[Oe]=j,T=Oe;else break e}}return _}function a(k,_){var j=k.sortIndex-_.sortIndex;return j!==0?j:k.id-_.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var u=[],c=[],d=1,h=null,f=3,g=!1,v=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(k){for(var _=n(c);_!==null;){if(_.callback===null)r(c);else if(_.startTime<=k)r(c),_.sortIndex=_.expirationTime,e(u,_);else break;_=n(c)}}function w(k){if(b=!1,y(k),!v)if(n(u)!==null)v=!0,A(C);else{var _=n(c);_!==null&&R(w,_.startTime-k)}}function C(k,_){v=!1,b&&(b=!1,m(O),O=-1),g=!0;var j=f;try{for(y(_),h=n(u);h!==null&&(!(h.expirationTime>_)||k&&!N());){var T=h.callback;if(typeof T=="function"){h.callback=null,f=h.priorityLevel;var q=T(h.expirationTime<=_);_=t.unstable_now(),typeof q=="function"?h.callback=q:h===n(u)&&r(u),y(_)}else r(u);h=n(u)}if(h!==null)var X=!0;else{var Se=n(c);Se!==null&&R(w,Se.startTime-_),X=!1}return X}finally{h=null,f=j,g=!1}}var M=!1,z=null,O=-1,Q=5,D=-1;function N(){return!(t.unstable_now()-D<Q)}function L(){if(z!==null){var k=t.unstable_now();D=k;var _=!0;try{_=z(!0,k)}finally{_?W():(M=!1,z=null)}}else M=!1}var W;if(typeof p=="function")W=function(){p(L)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,I=re.port2;re.port1.onmessage=L,W=function(){I.postMessage(null)}}else W=function(){E(L,0)};function A(k){z=k,M||(M=!0,W())}function R(k,_){O=E(function(){k(t.unstable_now())},_)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(k){k.callback=null},t.unstable_continueExecution=function(){v||g||(v=!0,A(C))},t.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<k?Math.floor(1e3/k):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(k){switch(f){case 1:case 2:case 3:var _=3;break;default:_=f}var j=f;f=_;try{return k()}finally{f=j}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(k,_){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var j=f;f=k;try{return _()}finally{f=j}},t.unstable_scheduleCallback=function(k,_,j){var T=t.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?T+j:T):j=T,k){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=j+q,k={id:d++,callback:_,priorityLevel:k,startTime:j,expirationTime:q,sortIndex:-1},j>T?(k.sortIndex=j,e(c,k),n(u)===null&&k===n(c)&&(b?(m(O),O=-1):b=!0,R(w,j-T))):(k.sortIndex=q,e(u,k),v||g||(v=!0,A(C))),k},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(k){var _=f;return function(){var j=f;f=_;try{return k.apply(this,arguments)}finally{f=j}}}})(Ky);Hy.exports=Ky;var bk=Hy.exports;/**
* @license React
* react-dom.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var wk=x,Ft=bk;function F(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Wy=new Set,oi={};function oa(t,e){Ka(t,e),Ka(t+"Capture",e)}function Ka(t,e){for(oi[t]=e,t=0;t<e.length;t++)Wy.add(e[t])}var Un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ld=Object.prototype.hasOwnProperty,Ek=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zm={},ep={};function kk(t){return ld.call(ep,t)?!0:ld.call(Zm,t)?!1:Ek.test(t)?ep[t]=!0:(Zm[t]=!0,!1)}function xk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Nk(t,e,n,r){if(e===null||typeof e>"u"||xk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function St(t,e,n,r,a,s,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=i}var nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){nt[t]=new St(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];nt[e]=new St(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){nt[t]=new St(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){nt[t]=new St(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){nt[t]=new St(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){nt[t]=new St(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){nt[t]=new St(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){nt[t]=new St(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){nt[t]=new St(t,5,!1,t.toLowerCase(),null,!1,!1)});var Vh=/[\-:]([a-z])/g;function zh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Vh,zh);nt[e]=new St(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Vh,zh);nt[e]=new St(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Vh,zh);nt[e]=new St(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){nt[t]=new St(t,1,!1,t.toLowerCase(),null,!1,!1)});nt.xlinkHref=new St("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){nt[t]=new St(t,1,!1,t.toLowerCase(),null,!0,!0)});function jh(t,e,n,r){var a=nt.hasOwnProperty(e)?nt[e]:null;(a!==null?a.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Nk(e,n,a,r)&&(n=null),r||a===null?kk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,r=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Wn=wk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,So=Symbol.for("react.element"),ba=Symbol.for("react.portal"),wa=Symbol.for("react.fragment"),qh=Symbol.for("react.strict_mode"),ud=Symbol.for("react.profiler"),Gy=Symbol.for("react.provider"),Qy=Symbol.for("react.context"),Bh=Symbol.for("react.forward_ref"),cd=Symbol.for("react.suspense"),dd=Symbol.for("react.suspense_list"),$h=Symbol.for("react.memo"),Jn=Symbol.for("react.lazy"),Yy=Symbol.for("react.offscreen"),tp=Symbol.iterator;function Cs(t){return t===null||typeof t!="object"?null:(t=tp&&t[tp]||t["@@iterator"],typeof t=="function"?t:null)}var De=Object.assign,dc;function Ms(t){if(dc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);dc=e&&e[1]||""}return`
`+dc+t}var hc=!1;function fc(t,e){if(!t||hc)return"";hc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=r.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var u=`
`+a[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=o);break}}}finally{hc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ms(t):""}function Sk(t){switch(t.tag){case 5:return Ms(t.type);case 16:return Ms("Lazy");case 13:return Ms("Suspense");case 19:return Ms("SuspenseList");case 0:case 2:case 15:return t=fc(t.type,!1),t;case 11:return t=fc(t.type.render,!1),t;case 1:return t=fc(t.type,!0),t;default:return""}}function hd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case wa:return"Fragment";case ba:return"Portal";case ud:return"Profiler";case qh:return"StrictMode";case cd:return"Suspense";case dd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Qy:return(t.displayName||"Context")+".Consumer";case Gy:return(t._context.displayName||"Context")+".Provider";case Bh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $h:return e=t.displayName||null,e!==null?e:hd(t.type)||"Memo";case Jn:e=t._payload,t=t._init;try{return hd(t(e))}catch{}}return null}function Ck(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return hd(e);case 8:return e===qh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function kr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Xy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ik(t){var e=Xy(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(i){r=""+i,s.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Co(t){t._valueTracker||(t._valueTracker=Ik(t))}function Jy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Xy(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function vl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function fd(t,e){var n=e.checked;return De({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function np(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=kr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Zy(t,e){e=e.checked,e!=null&&jh(t,"checked",e,!1)}function md(t,e){Zy(t,e);var n=kr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?pd(t,e.type,n):e.hasOwnProperty("defaultValue")&&pd(t,e.type,kr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rp(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function pd(t,e,n){(e!=="number"||vl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fs=Array.isArray;function Pa(t,e,n,r){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&r&&(t[n].defaultSelected=!0)}else{for(n=""+kr(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,r&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function gd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(F(91));return De({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ap(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(F(92));if(Fs(n)){if(1<n.length)throw Error(F(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:kr(n)}}function ev(t,e){var n=kr(e.value),r=kr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function sp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function tv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function yd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?tv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Io,nv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Io=Io||document.createElement("div"),Io.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Io.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function li(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ws={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_k=["Webkit","ms","Moz","O"];Object.keys(Ws).forEach(function(t){_k.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ws[e]=Ws[t]})});function rv(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ws.hasOwnProperty(t)&&Ws[t]?(""+e).trim():e+"px"}function av(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=rv(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,a):t[n]=a}}var Tk=De({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vd(t,e){if(e){if(Tk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(F(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(F(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(F(61))}if(e.style!=null&&typeof e.style!="object")throw Error(F(62))}}function bd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wd=null;function Hh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ed=null,Oa=null,La=null;function ip(t){if(t=Wi(t)){if(typeof Ed!="function")throw Error(F(280));var e=t.stateNode;e&&(e=pu(e),Ed(t.stateNode,t.type,e))}}function sv(t){Oa?La?La.push(t):La=[t]:Oa=t}function iv(){if(Oa){var t=Oa,e=La;if(La=Oa=null,ip(t),e)for(t=0;t<e.length;t++)ip(e[t])}}function ov(t,e){return t(e)}function lv(){}var mc=!1;function uv(t,e,n){if(mc)return t(e,n);mc=!0;try{return ov(t,e,n)}finally{mc=!1,(Oa!==null||La!==null)&&(lv(),iv())}}function ui(t,e){var n=t.stateNode;if(n===null)return null;var r=pu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(F(231,e,typeof n));return n}var kd=!1;if(Un)try{var Is={};Object.defineProperty(Is,"passive",{get:function(){kd=!0}}),window.addEventListener("test",Is,Is),window.removeEventListener("test",Is,Is)}catch{kd=!1}function Dk(t,e,n,r,a,s,i,o,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var Gs=!1,bl=null,wl=!1,xd=null,Ak={onError:function(t){Gs=!0,bl=t}};function Rk(t,e,n,r,a,s,i,o,u){Gs=!1,bl=null,Dk.apply(Ak,arguments)}function Pk(t,e,n,r,a,s,i,o,u){if(Rk.apply(this,arguments),Gs){if(Gs){var c=bl;Gs=!1,bl=null}else throw Error(F(198));wl||(wl=!0,xd=c)}}function la(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function cv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function op(t){if(la(t)!==t)throw Error(F(188))}function Ok(t){var e=t.alternate;if(!e){if(e=la(t),e===null)throw Error(F(188));return e!==t?null:t}for(var n=t,r=e;;){var a=n.return;if(a===null)break;var s=a.alternate;if(s===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return op(a),t;if(s===r)return op(a),e;s=s.sibling}throw Error(F(188))}if(n.return!==r.return)n=a,r=s;else{for(var i=!1,o=a.child;o;){if(o===n){i=!0,n=a,r=s;break}if(o===r){i=!0,r=a,n=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===n){i=!0,n=s,r=a;break}if(o===r){i=!0,r=s,n=a;break}o=o.sibling}if(!i)throw Error(F(189))}}if(n.alternate!==r)throw Error(F(190))}if(n.tag!==3)throw Error(F(188));return n.stateNode.current===n?t:e}function dv(t){return t=Ok(t),t!==null?hv(t):null}function hv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=hv(t);if(e!==null)return e;t=t.sibling}return null}var fv=Ft.unstable_scheduleCallback,lp=Ft.unstable_cancelCallback,Lk=Ft.unstable_shouldYield,Mk=Ft.unstable_requestPaint,Le=Ft.unstable_now,Fk=Ft.unstable_getCurrentPriorityLevel,Kh=Ft.unstable_ImmediatePriority,mv=Ft.unstable_UserBlockingPriority,El=Ft.unstable_NormalPriority,Uk=Ft.unstable_LowPriority,pv=Ft.unstable_IdlePriority,du=null,bn=null;function Vk(t){if(bn&&typeof bn.onCommitFiberRoot=="function")try{bn.onCommitFiberRoot(du,t,void 0,(t.current.flags&128)===128)}catch{}}var tn=Math.clz32?Math.clz32:qk,zk=Math.log,jk=Math.LN2;function qk(t){return t>>>=0,t===0?32:31-(zk(t)/jk|0)|0}var _o=64,To=4194304;function Us(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function kl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,a=t.suspendedLanes,s=t.pingedLanes,i=n&268435455;if(i!==0){var o=i&~a;o!==0?r=Us(o):(s&=i,s!==0&&(r=Us(s)))}else i=n&~a,i!==0?r=Us(i):s!==0&&(r=Us(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&a)&&(a=r&-r,s=e&-e,a>=s||a===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-tn(e),a=1<<n,r|=t[n],e&=~a;return r}function Bk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $k(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,s=t.pendingLanes;0<s;){var i=31-tn(s),o=1<<i,u=a[i];u===-1?(!(o&n)||o&r)&&(a[i]=Bk(o,e)):u<=e&&(t.expiredLanes|=o),s&=~o}}function Nd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function gv(){var t=_o;return _o<<=1,!(_o&4194240)&&(_o=64),t}function pc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Hi(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-tn(e),t[e]=n}function Hk(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-tn(n),s=1<<a;e[a]=0,r[a]=-1,t[a]=-1,n&=~s}}function Wh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-tn(n),a=1<<r;a&e|t[r]&e&&(t[r]|=e),n&=~a}}var me=0;function yv(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var vv,Gh,bv,wv,Ev,Sd=!1,Do=[],cr=null,dr=null,hr=null,ci=new Map,di=new Map,er=[],Kk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function up(t,e){switch(t){case"focusin":case"focusout":cr=null;break;case"dragenter":case"dragleave":dr=null;break;case"mouseover":case"mouseout":hr=null;break;case"pointerover":case"pointerout":ci.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":di.delete(e.pointerId)}}function _s(t,e,n,r,a,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[a]},e!==null&&(e=Wi(e),e!==null&&Gh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function Wk(t,e,n,r,a){switch(e){case"focusin":return cr=_s(cr,t,e,n,r,a),!0;case"dragenter":return dr=_s(dr,t,e,n,r,a),!0;case"mouseover":return hr=_s(hr,t,e,n,r,a),!0;case"pointerover":var s=a.pointerId;return ci.set(s,_s(ci.get(s)||null,t,e,n,r,a)),!0;case"gotpointercapture":return s=a.pointerId,di.set(s,_s(di.get(s)||null,t,e,n,r,a)),!0}return!1}function kv(t){var e=zr(t.target);if(e!==null){var n=la(e);if(n!==null){if(e=n.tag,e===13){if(e=cv(n),e!==null){t.blockedOn=e,Ev(t.priority,function(){bv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Zo(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Cd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);wd=r,n.target.dispatchEvent(r),wd=null}else return e=Wi(n),e!==null&&Gh(e),t.blockedOn=n,!1;e.shift()}return!0}function cp(t,e,n){Zo(t)&&n.delete(e)}function Gk(){Sd=!1,cr!==null&&Zo(cr)&&(cr=null),dr!==null&&Zo(dr)&&(dr=null),hr!==null&&Zo(hr)&&(hr=null),ci.forEach(cp),di.forEach(cp)}function Ts(t,e){t.blockedOn===e&&(t.blockedOn=null,Sd||(Sd=!0,Ft.unstable_scheduleCallback(Ft.unstable_NormalPriority,Gk)))}function hi(t){function e(a){return Ts(a,t)}if(0<Do.length){Ts(Do[0],t);for(var n=1;n<Do.length;n++){var r=Do[n];r.blockedOn===t&&(r.blockedOn=null)}}for(cr!==null&&Ts(cr,t),dr!==null&&Ts(dr,t),hr!==null&&Ts(hr,t),ci.forEach(e),di.forEach(e),n=0;n<er.length;n++)r=er[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<er.length&&(n=er[0],n.blockedOn===null);)kv(n),n.blockedOn===null&&er.shift()}var Ma=Wn.ReactCurrentBatchConfig,xl=!0;function Qk(t,e,n,r){var a=me,s=Ma.transition;Ma.transition=null;try{me=1,Qh(t,e,n,r)}finally{me=a,Ma.transition=s}}function Yk(t,e,n,r){var a=me,s=Ma.transition;Ma.transition=null;try{me=4,Qh(t,e,n,r)}finally{me=a,Ma.transition=s}}function Qh(t,e,n,r){if(xl){var a=Cd(t,e,n,r);if(a===null)Sc(t,e,r,Nl,n),up(t,r);else if(Wk(a,t,e,n,r))r.stopPropagation();else if(up(t,r),e&4&&-1<Kk.indexOf(t)){for(;a!==null;){var s=Wi(a);if(s!==null&&vv(s),s=Cd(t,e,n,r),s===null&&Sc(t,e,r,Nl,n),s===a)break;a=s}a!==null&&r.stopPropagation()}else Sc(t,e,r,null,n)}}var Nl=null;function Cd(t,e,n,r){if(Nl=null,t=Hh(r),t=zr(t),t!==null)if(e=la(t),e===null)t=null;else if(n=e.tag,n===13){if(t=cv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nl=t,null}function xv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Fk()){case Kh:return 1;case mv:return 4;case El:case Uk:return 16;case pv:return 536870912;default:return 16}default:return 16}}var or=null,Yh=null,el=null;function Nv(){if(el)return el;var t,e=Yh,n=e.length,r,a="value"in or?or.value:or.textContent,s=a.length;for(t=0;t<n&&e[t]===a[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===a[s-r];r++);return el=a.slice(t,1<r?1-r:void 0)}function tl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ao(){return!0}function dp(){return!1}function zt(t){function e(n,r,a,s,i){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ao:dp,this.isPropagationStopped=dp,this}return De(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ao)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ao)},persist:function(){},isPersistent:Ao}),e}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xh=zt(hs),Ki=De({},hs,{view:0,detail:0}),Xk=zt(Ki),gc,yc,Ds,hu=De({},Ki,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ds&&(Ds&&t.type==="mousemove"?(gc=t.screenX-Ds.screenX,yc=t.screenY-Ds.screenY):yc=gc=0,Ds=t),gc)},movementY:function(t){return"movementY"in t?t.movementY:yc}}),hp=zt(hu),Jk=De({},hu,{dataTransfer:0}),Zk=zt(Jk),ex=De({},Ki,{relatedTarget:0}),vc=zt(ex),tx=De({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),nx=zt(tx),rx=De({},hs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),ax=zt(rx),sx=De({},hs,{data:0}),fp=zt(sx),ix={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ox={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ux(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=lx[t])?!!e[t]:!1}function Jh(){return ux}var cx=De({},Ki,{key:function(t){if(t.key){var e=ix[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=tl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ox[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jh,charCode:function(t){return t.type==="keypress"?tl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?tl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),dx=zt(cx),hx=De({},hu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mp=zt(hx),fx=De({},Ki,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jh}),mx=zt(fx),px=De({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),gx=zt(px),yx=De({},hu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vx=zt(yx),bx=[9,13,27,32],Zh=Un&&"CompositionEvent"in window,Qs=null;Un&&"documentMode"in document&&(Qs=document.documentMode);var wx=Un&&"TextEvent"in window&&!Qs,Sv=Un&&(!Zh||Qs&&8<Qs&&11>=Qs),pp=" ",gp=!1;function Cv(t,e){switch(t){case"keyup":return bx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Iv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ea=!1;function Ex(t,e){switch(t){case"compositionend":return Iv(e);case"keypress":return e.which!==32?null:(gp=!0,pp);case"textInput":return t=e.data,t===pp&&gp?null:t;default:return null}}function kx(t,e){if(Ea)return t==="compositionend"||!Zh&&Cv(t,e)?(t=Nv(),el=Yh=or=null,Ea=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Sv&&e.locale!=="ko"?null:e.data;default:return null}}var xx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!xx[t.type]:e==="textarea"}function _v(t,e,n,r){sv(r),e=Sl(e,"onChange"),0<e.length&&(n=new Xh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Ys=null,fi=null;function Nx(t){Vv(t,0)}function fu(t){var e=Na(t);if(Jy(e))return t}function Sx(t,e){if(t==="change")return e}var Tv=!1;if(Un){var bc;if(Un){var wc="oninput"in document;if(!wc){var vp=document.createElement("div");vp.setAttribute("oninput","return;"),wc=typeof vp.oninput=="function"}bc=wc}else bc=!1;Tv=bc&&(!document.documentMode||9<document.documentMode)}function bp(){Ys&&(Ys.detachEvent("onpropertychange",Dv),fi=Ys=null)}function Dv(t){if(t.propertyName==="value"&&fu(fi)){var e=[];_v(e,fi,t,Hh(t)),uv(Nx,e)}}function Cx(t,e,n){t==="focusin"?(bp(),Ys=e,fi=n,Ys.attachEvent("onpropertychange",Dv)):t==="focusout"&&bp()}function Ix(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fu(fi)}function _x(t,e){if(t==="click")return fu(e)}function Tx(t,e){if(t==="input"||t==="change")return fu(e)}function Dx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var rn=typeof Object.is=="function"?Object.is:Dx;function mi(t,e){if(rn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!ld.call(e,a)||!rn(t[a],e[a]))return!1}return!0}function wp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ep(t,e){var n=wp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=wp(n)}}function Av(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Av(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Rv(){for(var t=window,e=vl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=vl(t.document)}return e}function ef(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Ax(t){var e=Rv(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Av(n.ownerDocument.documentElement,n)){if(r!==null&&ef(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,s=Math.min(r.start,a);r=r.end===void 0?s:Math.min(r.end,a),!t.extend&&s>r&&(a=r,r=s,s=a),a=Ep(n,s);var i=Ep(n,r);a&&i&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Rx=Un&&"documentMode"in document&&11>=document.documentMode,ka=null,Id=null,Xs=null,_d=!1;function kp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;_d||ka==null||ka!==vl(r)||(r=ka,"selectionStart"in r&&ef(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Xs&&mi(Xs,r)||(Xs=r,r=Sl(Id,"onSelect"),0<r.length&&(e=new Xh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ka)))}function Ro(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var xa={animationend:Ro("Animation","AnimationEnd"),animationiteration:Ro("Animation","AnimationIteration"),animationstart:Ro("Animation","AnimationStart"),transitionend:Ro("Transition","TransitionEnd")},Ec={},Pv={};Un&&(Pv=document.createElement("div").style,"AnimationEvent"in window||(delete xa.animationend.animation,delete xa.animationiteration.animation,delete xa.animationstart.animation),"TransitionEvent"in window||delete xa.transitionend.transition);function mu(t){if(Ec[t])return Ec[t];if(!xa[t])return t;var e=xa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Pv)return Ec[t]=e[n];return t}var Ov=mu("animationend"),Lv=mu("animationiteration"),Mv=mu("animationstart"),Fv=mu("transitionend"),Uv=new Map,xp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _r(t,e){Uv.set(t,e),oa(e,[t])}for(var kc=0;kc<xp.length;kc++){var xc=xp[kc],Px=xc.toLowerCase(),Ox=xc[0].toUpperCase()+xc.slice(1);_r(Px,"on"+Ox)}_r(Ov,"onAnimationEnd");_r(Lv,"onAnimationIteration");_r(Mv,"onAnimationStart");_r("dblclick","onDoubleClick");_r("focusin","onFocus");_r("focusout","onBlur");_r(Fv,"onTransitionEnd");Ka("onMouseEnter",["mouseout","mouseover"]);Ka("onMouseLeave",["mouseout","mouseover"]);Ka("onPointerEnter",["pointerout","pointerover"]);Ka("onPointerLeave",["pointerout","pointerover"]);oa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));oa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));oa("onBeforeInput",["compositionend","keypress","textInput","paste"]);oa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));oa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));oa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vs));function Np(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Pk(r,e,void 0,t),t.currentTarget=null}function Vv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],a=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var i=r.length-1;0<=i;i--){var o=r[i],u=o.instance,c=o.currentTarget;if(o=o.listener,u!==s&&a.isPropagationStopped())break e;Np(a,o,c),s=u}else for(i=0;i<r.length;i++){if(o=r[i],u=o.instance,c=o.currentTarget,o=o.listener,u!==s&&a.isPropagationStopped())break e;Np(a,o,c),s=u}}}if(wl)throw t=xd,wl=!1,xd=null,t}function we(t,e){var n=e[Pd];n===void 0&&(n=e[Pd]=new Set);var r=t+"__bubble";n.has(r)||(zv(e,t,2,!1),n.add(r))}function Nc(t,e,n){var r=0;e&&(r|=4),zv(n,t,r,e)}var Po="_reactListening"+Math.random().toString(36).slice(2);function pi(t){if(!t[Po]){t[Po]=!0,Wy.forEach(function(n){n!=="selectionchange"&&(Lx.has(n)||Nc(n,!1,t),Nc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Po]||(e[Po]=!0,Nc("selectionchange",!1,e))}}function zv(t,e,n,r){switch(xv(e)){case 1:var a=Qk;break;case 4:a=Yk;break;default:a=Qh}n=a.bind(null,e,n,t),a=void 0,!kd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),r?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function Sc(t,e,n,r,a){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var o=r.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;i=i.return}for(;o!==null;){if(i=zr(o),i===null)return;if(u=i.tag,u===5||u===6){r=s=i;continue e}o=o.parentNode}}r=r.return}uv(function(){var c=s,d=Hh(n),h=[];e:{var f=Uv.get(t);if(f!==void 0){var g=Xh,v=t;switch(t){case"keypress":if(tl(n)===0)break e;case"keydown":case"keyup":g=dx;break;case"focusin":v="focus",g=vc;break;case"focusout":v="blur",g=vc;break;case"beforeblur":case"afterblur":g=vc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=hp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Zk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=mx;break;case Ov:case Lv:case Mv:g=nx;break;case Fv:g=gx;break;case"scroll":g=Xk;break;case"wheel":g=vx;break;case"copy":case"cut":case"paste":g=ax;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=mp}var b=(e&4)!==0,E=!b&&t==="scroll",m=b?f!==null?f+"Capture":null:f;b=[];for(var p=c,y;p!==null;){y=p;var w=y.stateNode;if(y.tag===5&&w!==null&&(y=w,m!==null&&(w=ui(p,m),w!=null&&b.push(gi(p,w,y)))),E)break;p=p.return}0<b.length&&(f=new g(f,v,null,n,d),h.push({event:f,listeners:b}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",f&&n!==wd&&(v=n.relatedTarget||n.fromElement)&&(zr(v)||v[Vn]))break e;if((g||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,g?(v=n.relatedTarget||n.toElement,g=c,v=v?zr(v):null,v!==null&&(E=la(v),v!==E||v.tag!==5&&v.tag!==6)&&(v=null)):(g=null,v=c),g!==v)){if(b=hp,w="onMouseLeave",m="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(b=mp,w="onPointerLeave",m="onPointerEnter",p="pointer"),E=g==null?f:Na(g),y=v==null?f:Na(v),f=new b(w,p+"leave",g,n,d),f.target=E,f.relatedTarget=y,w=null,zr(d)===c&&(b=new b(m,p+"enter",v,n,d),b.target=y,b.relatedTarget=E,w=b),E=w,g&&v)t:{for(b=g,m=v,p=0,y=b;y;y=fa(y))p++;for(y=0,w=m;w;w=fa(w))y++;for(;0<p-y;)b=fa(b),p--;for(;0<y-p;)m=fa(m),y--;for(;p--;){if(b===m||m!==null&&b===m.alternate)break t;b=fa(b),m=fa(m)}b=null}else b=null;g!==null&&Sp(h,f,g,b,!1),v!==null&&E!==null&&Sp(h,E,v,b,!0)}}e:{if(f=c?Na(c):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var C=Sx;else if(yp(f))if(Tv)C=Tx;else{C=Ix;var M=Cx}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=_x);if(C&&(C=C(t,c))){_v(h,C,n,d);break e}M&&M(t,f,c),t==="focusout"&&(M=f._wrapperState)&&M.controlled&&f.type==="number"&&pd(f,"number",f.value)}switch(M=c?Na(c):window,t){case"focusin":(yp(M)||M.contentEditable==="true")&&(ka=M,Id=c,Xs=null);break;case"focusout":Xs=Id=ka=null;break;case"mousedown":_d=!0;break;case"contextmenu":case"mouseup":case"dragend":_d=!1,kp(h,n,d);break;case"selectionchange":if(Rx)break;case"keydown":case"keyup":kp(h,n,d)}var z;if(Zh)e:{switch(t){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Ea?Cv(t,n)&&(O="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(O="onCompositionStart");O&&(Sv&&n.locale!=="ko"&&(Ea||O!=="onCompositionStart"?O==="onCompositionEnd"&&Ea&&(z=Nv()):(or=d,Yh="value"in or?or.value:or.textContent,Ea=!0)),M=Sl(c,O),0<M.length&&(O=new fp(O,t,null,n,d),h.push({event:O,listeners:M}),z?O.data=z:(z=Iv(n),z!==null&&(O.data=z)))),(z=wx?Ex(t,n):kx(t,n))&&(c=Sl(c,"onBeforeInput"),0<c.length&&(d=new fp("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=z))}Vv(h,e)})}function gi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Sl(t,e){for(var n=e+"Capture",r=[];t!==null;){var a=t,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=ui(t,n),s!=null&&r.unshift(gi(t,s,a)),s=ui(t,e),s!=null&&r.push(gi(t,s,a))),t=t.return}return r}function fa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Sp(t,e,n,r,a){for(var s=e._reactName,i=[];n!==null&&n!==r;){var o=n,u=o.alternate,c=o.stateNode;if(u!==null&&u===r)break;o.tag===5&&c!==null&&(o=c,a?(u=ui(n,s),u!=null&&i.unshift(gi(n,u,o))):a||(u=ui(n,s),u!=null&&i.push(gi(n,u,o)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var Mx=/\r\n?/g,Fx=/\u0000|\uFFFD/g;function Cp(t){return(typeof t=="string"?t:""+t).replace(Mx,`
`).replace(Fx,"")}function Oo(t,e,n){if(e=Cp(e),Cp(t)!==e&&n)throw Error(F(425))}function Cl(){}var Td=null,Dd=null;function Ad(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Rd=typeof setTimeout=="function"?setTimeout:void 0,Ux=typeof clearTimeout=="function"?clearTimeout:void 0,Ip=typeof Promise=="function"?Promise:void 0,Vx=typeof queueMicrotask=="function"?queueMicrotask:typeof Ip<"u"?function(t){return Ip.resolve(null).then(t).catch(zx)}:Rd;function zx(t){setTimeout(function(){throw t})}function Cc(t,e){var n=e,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){t.removeChild(a),hi(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);hi(e)}function fr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function _p(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var fs=Math.random().toString(36).slice(2),pn="__reactFiber$"+fs,yi="__reactProps$"+fs,Vn="__reactContainer$"+fs,Pd="__reactEvents$"+fs,jx="__reactListeners$"+fs,qx="__reactHandles$"+fs;function zr(t){var e=t[pn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Vn]||n[pn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=_p(t);t!==null;){if(n=t[pn])return n;t=_p(t)}return e}t=n,n=t.parentNode}return null}function Wi(t){return t=t[pn]||t[Vn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Na(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(F(33))}function pu(t){return t[yi]||null}var Od=[],Sa=-1;function Tr(t){return{current:t}}function xe(t){0>Sa||(t.current=Od[Sa],Od[Sa]=null,Sa--)}function be(t,e){Sa++,Od[Sa]=t.current,t.current=e}var xr={},pt=Tr(xr),Tt=Tr(!1),Yr=xr;function Wa(t,e){var n=t.type.contextTypes;if(!n)return xr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in n)a[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Dt(t){return t=t.childContextTypes,t!=null}function Il(){xe(Tt),xe(pt)}function Tp(t,e,n){if(pt.current!==xr)throw Error(F(168));be(pt,e),be(Tt,n)}function jv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in e))throw Error(F(108,Ck(t)||"Unknown",a));return De({},n,r)}function _l(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||xr,Yr=pt.current,be(pt,t),be(Tt,Tt.current),!0}function Dp(t,e,n){var r=t.stateNode;if(!r)throw Error(F(169));n?(t=jv(t,e,Yr),r.__reactInternalMemoizedMergedChildContext=t,xe(Tt),xe(pt),be(pt,t)):xe(Tt),be(Tt,n)}var _n=null,gu=!1,Ic=!1;function qv(t){_n===null?_n=[t]:_n.push(t)}function Bx(t){gu=!0,qv(t)}function Dr(){if(!Ic&&_n!==null){Ic=!0;var t=0,e=me;try{var n=_n;for(me=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}_n=null,gu=!1}catch(a){throw _n!==null&&(_n=_n.slice(t+1)),fv(Kh,Dr),a}finally{me=e,Ic=!1}}return null}var Ca=[],Ia=0,Tl=null,Dl=0,$t=[],Ht=0,Xr=null,Dn=1,An="";function Fr(t,e){Ca[Ia++]=Dl,Ca[Ia++]=Tl,Tl=t,Dl=e}function Bv(t,e,n){$t[Ht++]=Dn,$t[Ht++]=An,$t[Ht++]=Xr,Xr=t;var r=Dn;t=An;var a=32-tn(r)-1;r&=~(1<<a),n+=1;var s=32-tn(e)+a;if(30<s){var i=a-a%5;s=(r&(1<<i)-1).toString(32),r>>=i,a-=i,Dn=1<<32-tn(e)+a|n<<a|r,An=s+t}else Dn=1<<s|n<<a|r,An=t}function tf(t){t.return!==null&&(Fr(t,1),Bv(t,1,0))}function nf(t){for(;t===Tl;)Tl=Ca[--Ia],Ca[Ia]=null,Dl=Ca[--Ia],Ca[Ia]=null;for(;t===Xr;)Xr=$t[--Ht],$t[Ht]=null,An=$t[--Ht],$t[Ht]=null,Dn=$t[--Ht],$t[Ht]=null}var Lt=null,Pt=null,Ce=!1,en=null;function $v(t,e){var n=Wt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ap(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Lt=t,Pt=fr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Lt=t,Pt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Xr!==null?{id:Dn,overflow:An}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Wt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Lt=t,Pt=null,!0):!1;default:return!1}}function Ld(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Md(t){if(Ce){var e=Pt;if(e){var n=e;if(!Ap(t,e)){if(Ld(t))throw Error(F(418));e=fr(n.nextSibling);var r=Lt;e&&Ap(t,e)?$v(r,n):(t.flags=t.flags&-4097|2,Ce=!1,Lt=t)}}else{if(Ld(t))throw Error(F(418));t.flags=t.flags&-4097|2,Ce=!1,Lt=t}}}function Rp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Lt=t}function Lo(t){if(t!==Lt)return!1;if(!Ce)return Rp(t),Ce=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ad(t.type,t.memoizedProps)),e&&(e=Pt)){if(Ld(t))throw Hv(),Error(F(418));for(;e;)$v(t,e),e=fr(e.nextSibling)}if(Rp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(F(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Pt=fr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Pt=null}}else Pt=Lt?fr(t.stateNode.nextSibling):null;return!0}function Hv(){for(var t=Pt;t;)t=fr(t.nextSibling)}function Ga(){Pt=Lt=null,Ce=!1}function rf(t){en===null?en=[t]:en.push(t)}var $x=Wn.ReactCurrentBatchConfig;function As(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(F(309));var r=n.stateNode}if(!r)throw Error(F(147,t));var a=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},e._stringRef=s,e)}if(typeof t!="string")throw Error(F(284));if(!n._owner)throw Error(F(290,t))}return t}function Mo(t,e){throw t=Object.prototype.toString.call(e),Error(F(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Pp(t){var e=t._init;return e(t._payload)}function Kv(t){function e(m,p){if(t){var y=m.deletions;y===null?(m.deletions=[p],m.flags|=16):y.push(p)}}function n(m,p){if(!t)return null;for(;p!==null;)e(m,p),p=p.sibling;return null}function r(m,p){for(m=new Map;p!==null;)p.key!==null?m.set(p.key,p):m.set(p.index,p),p=p.sibling;return m}function a(m,p){return m=yr(m,p),m.index=0,m.sibling=null,m}function s(m,p,y){return m.index=y,t?(y=m.alternate,y!==null?(y=y.index,y<p?(m.flags|=2,p):y):(m.flags|=2,p)):(m.flags|=1048576,p)}function i(m){return t&&m.alternate===null&&(m.flags|=2),m}function o(m,p,y,w){return p===null||p.tag!==6?(p=Oc(y,m.mode,w),p.return=m,p):(p=a(p,y),p.return=m,p)}function u(m,p,y,w){var C=y.type;return C===wa?d(m,p,y.props.children,w,y.key):p!==null&&(p.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Jn&&Pp(C)===p.type)?(w=a(p,y.props),w.ref=As(m,p,y),w.return=m,w):(w=ll(y.type,y.key,y.props,null,m.mode,w),w.ref=As(m,p,y),w.return=m,w)}function c(m,p,y,w){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=Lc(y,m.mode,w),p.return=m,p):(p=a(p,y.children||[]),p.return=m,p)}function d(m,p,y,w,C){return p===null||p.tag!==7?(p=Wr(y,m.mode,w,C),p.return=m,p):(p=a(p,y),p.return=m,p)}function h(m,p,y){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Oc(""+p,m.mode,y),p.return=m,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case So:return y=ll(p.type,p.key,p.props,null,m.mode,y),y.ref=As(m,null,p),y.return=m,y;case ba:return p=Lc(p,m.mode,y),p.return=m,p;case Jn:var w=p._init;return h(m,w(p._payload),y)}if(Fs(p)||Cs(p))return p=Wr(p,m.mode,y,null),p.return=m,p;Mo(m,p)}return null}function f(m,p,y,w){var C=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return C!==null?null:o(m,p,""+y,w);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case So:return y.key===C?u(m,p,y,w):null;case ba:return y.key===C?c(m,p,y,w):null;case Jn:return C=y._init,f(m,p,C(y._payload),w)}if(Fs(y)||Cs(y))return C!==null?null:d(m,p,y,w,null);Mo(m,y)}return null}function g(m,p,y,w,C){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(y)||null,o(p,m,""+w,C);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case So:return m=m.get(w.key===null?y:w.key)||null,u(p,m,w,C);case ba:return m=m.get(w.key===null?y:w.key)||null,c(p,m,w,C);case Jn:var M=w._init;return g(m,p,y,M(w._payload),C)}if(Fs(w)||Cs(w))return m=m.get(y)||null,d(p,m,w,C,null);Mo(p,w)}return null}function v(m,p,y,w){for(var C=null,M=null,z=p,O=p=0,Q=null;z!==null&&O<y.length;O++){z.index>O?(Q=z,z=null):Q=z.sibling;var D=f(m,z,y[O],w);if(D===null){z===null&&(z=Q);break}t&&z&&D.alternate===null&&e(m,z),p=s(D,p,O),M===null?C=D:M.sibling=D,M=D,z=Q}if(O===y.length)return n(m,z),Ce&&Fr(m,O),C;if(z===null){for(;O<y.length;O++)z=h(m,y[O],w),z!==null&&(p=s(z,p,O),M===null?C=z:M.sibling=z,M=z);return Ce&&Fr(m,O),C}for(z=r(m,z);O<y.length;O++)Q=g(z,m,O,y[O],w),Q!==null&&(t&&Q.alternate!==null&&z.delete(Q.key===null?O:Q.key),p=s(Q,p,O),M===null?C=Q:M.sibling=Q,M=Q);return t&&z.forEach(function(N){return e(m,N)}),Ce&&Fr(m,O),C}function b(m,p,y,w){var C=Cs(y);if(typeof C!="function")throw Error(F(150));if(y=C.call(y),y==null)throw Error(F(151));for(var M=C=null,z=p,O=p=0,Q=null,D=y.next();z!==null&&!D.done;O++,D=y.next()){z.index>O?(Q=z,z=null):Q=z.sibling;var N=f(m,z,D.value,w);if(N===null){z===null&&(z=Q);break}t&&z&&N.alternate===null&&e(m,z),p=s(N,p,O),M===null?C=N:M.sibling=N,M=N,z=Q}if(D.done)return n(m,z),Ce&&Fr(m,O),C;if(z===null){for(;!D.done;O++,D=y.next())D=h(m,D.value,w),D!==null&&(p=s(D,p,O),M===null?C=D:M.sibling=D,M=D);return Ce&&Fr(m,O),C}for(z=r(m,z);!D.done;O++,D=y.next())D=g(z,m,O,D.value,w),D!==null&&(t&&D.alternate!==null&&z.delete(D.key===null?O:D.key),p=s(D,p,O),M===null?C=D:M.sibling=D,M=D);return t&&z.forEach(function(L){return e(m,L)}),Ce&&Fr(m,O),C}function E(m,p,y,w){if(typeof y=="object"&&y!==null&&y.type===wa&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case So:e:{for(var C=y.key,M=p;M!==null;){if(M.key===C){if(C=y.type,C===wa){if(M.tag===7){n(m,M.sibling),p=a(M,y.props.children),p.return=m,m=p;break e}}else if(M.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Jn&&Pp(C)===M.type){n(m,M.sibling),p=a(M,y.props),p.ref=As(m,M,y),p.return=m,m=p;break e}n(m,M);break}else e(m,M);M=M.sibling}y.type===wa?(p=Wr(y.props.children,m.mode,w,y.key),p.return=m,m=p):(w=ll(y.type,y.key,y.props,null,m.mode,w),w.ref=As(m,p,y),w.return=m,m=w)}return i(m);case ba:e:{for(M=y.key;p!==null;){if(p.key===M)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){n(m,p.sibling),p=a(p,y.children||[]),p.return=m,m=p;break e}else{n(m,p);break}else e(m,p);p=p.sibling}p=Lc(y,m.mode,w),p.return=m,m=p}return i(m);case Jn:return M=y._init,E(m,p,M(y._payload),w)}if(Fs(y))return v(m,p,y,w);if(Cs(y))return b(m,p,y,w);Mo(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,p!==null&&p.tag===6?(n(m,p.sibling),p=a(p,y),p.return=m,m=p):(n(m,p),p=Oc(y,m.mode,w),p.return=m,m=p),i(m)):n(m,p)}return E}var Qa=Kv(!0),Wv=Kv(!1),Al=Tr(null),Rl=null,_a=null,af=null;function sf(){af=_a=Rl=null}function of(t){var e=Al.current;xe(Al),t._currentValue=e}function Fd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Fa(t,e){Rl=t,af=_a=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(_t=!0),t.firstContext=null)}function Qt(t){var e=t._currentValue;if(af!==t)if(t={context:t,memoizedValue:e,next:null},_a===null){if(Rl===null)throw Error(F(308));_a=t,Rl.dependencies={lanes:0,firstContext:t}}else _a=_a.next=t;return e}var jr=null;function lf(t){jr===null?jr=[t]:jr.push(t)}function Gv(t,e,n,r){var a=e.interleaved;return a===null?(n.next=n,lf(e)):(n.next=a.next,a.next=n),e.interleaved=n,zn(t,r)}function zn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zn=!1;function uf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Mn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function mr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ce&2){var a=r.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),r.pending=e,zn(t,n)}return a=r.interleaved,a===null?(e.next=e,lf(r)):(e.next=a.next,a.next=e),r.interleaved=e,zn(t,n)}function nl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Wh(t,n)}}function Op(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?a=s=i:s=s.next=i,n=n.next}while(n!==null);s===null?a=s=e:s=s.next=e}else a=s=e;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Pl(t,e,n,r){var a=t.updateQueue;Zn=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var u=o,c=u.next;u.next=null,i===null?s=c:i.next=c,i=u;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=u))}if(s!==null){var h=a.baseState;i=0,d=c=u=null,o=s;do{var f=o.lane,g=o.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=t,b=o;switch(f=e,g=n,b.tag){case 1:if(v=b.payload,typeof v=="function"){h=v.call(g,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=b.payload,f=typeof v=="function"?v.call(g,h,f):v,f==null)break e;h=De({},h,f);break e;case 2:Zn=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,f=a.effects,f===null?a.effects=[o]:f.push(o))}else g={eventTime:g,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=g,u=h):d=d.next=g,i|=f;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;f=o,o=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(d===null&&(u=h),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=d,e=a.shared.interleaved,e!==null){a=e;do i|=a.lane,a=a.next;while(a!==e)}else s===null&&(a.shared.lanes=0);Zr|=i,t.lanes=i,t.memoizedState=h}}function Lp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(F(191,a));a.call(r)}}}var Gi={},wn=Tr(Gi),vi=Tr(Gi),bi=Tr(Gi);function qr(t){if(t===Gi)throw Error(F(174));return t}function cf(t,e){switch(be(bi,e),be(vi,t),be(wn,Gi),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:yd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=yd(e,t)}xe(wn),be(wn,e)}function Ya(){xe(wn),xe(vi),xe(bi)}function Yv(t){qr(bi.current);var e=qr(wn.current),n=yd(e,t.type);e!==n&&(be(vi,t),be(wn,n))}function df(t){vi.current===t&&(xe(wn),xe(vi))}var Ie=Tr(0);function Ol(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var _c=[];function hf(){for(var t=0;t<_c.length;t++)_c[t]._workInProgressVersionPrimary=null;_c.length=0}var rl=Wn.ReactCurrentDispatcher,Tc=Wn.ReactCurrentBatchConfig,Jr=0,Te=null,Be=null,We=null,Ll=!1,Js=!1,wi=0,Hx=0;function at(){throw Error(F(321))}function ff(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!rn(t[n],e[n]))return!1;return!0}function mf(t,e,n,r,a,s){if(Jr=s,Te=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rl.current=t===null||t.memoizedState===null?Qx:Yx,t=n(r,a),Js){s=0;do{if(Js=!1,wi=0,25<=s)throw Error(F(301));s+=1,We=Be=null,e.updateQueue=null,rl.current=Xx,t=n(r,a)}while(Js)}if(rl.current=Ml,e=Be!==null&&Be.next!==null,Jr=0,We=Be=Te=null,Ll=!1,e)throw Error(F(300));return t}function pf(){var t=wi!==0;return wi=0,t}function mn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return We===null?Te.memoizedState=We=t:We=We.next=t,We}function Yt(){if(Be===null){var t=Te.alternate;t=t!==null?t.memoizedState:null}else t=Be.next;var e=We===null?Te.memoizedState:We.next;if(e!==null)We=e,Be=t;else{if(t===null)throw Error(F(310));Be=t,t={memoizedState:Be.memoizedState,baseState:Be.baseState,baseQueue:Be.baseQueue,queue:Be.queue,next:null},We===null?Te.memoizedState=We=t:We=We.next=t}return We}function Ei(t,e){return typeof e=="function"?e(t):e}function Dc(t){var e=Yt(),n=e.queue;if(n===null)throw Error(F(311));n.lastRenderedReducer=t;var r=Be,a=r.baseQueue,s=n.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}r.baseQueue=a=s,n.pending=null}if(a!==null){s=a.next,r=r.baseState;var o=i=null,u=null,c=s;do{var d=c.lane;if((Jr&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(o=u=h,i=r):u=u.next=h,Te.lanes|=d,Zr|=d}c=c.next}while(c!==null&&c!==s);u===null?i=r:u.next=o,rn(r,e.memoizedState)||(_t=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){a=t;do s=a.lane,Te.lanes|=s,Zr|=s,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ac(t){var e=Yt(),n=e.queue;if(n===null)throw Error(F(311));n.lastRenderedReducer=t;var r=n.dispatch,a=n.pending,s=e.memoizedState;if(a!==null){n.pending=null;var i=a=a.next;do s=t(s,i.action),i=i.next;while(i!==a);rn(s,e.memoizedState)||(_t=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function Xv(){}function Jv(t,e){var n=Te,r=Yt(),a=e(),s=!rn(r.memoizedState,a);if(s&&(r.memoizedState=a,_t=!0),r=r.queue,gf(t0.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||We!==null&&We.memoizedState.tag&1){if(n.flags|=2048,ki(9,e0.bind(null,n,r,a,e),void 0,null),Ge===null)throw Error(F(349));Jr&30||Zv(n,e,a)}return a}function Zv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Te.updateQueue,e===null?(e={lastEffect:null,stores:null},Te.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function e0(t,e,n,r){e.value=n,e.getSnapshot=r,n0(e)&&r0(t)}function t0(t,e,n){return n(function(){n0(e)&&r0(t)})}function n0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!rn(t,n)}catch{return!0}}function r0(t){var e=zn(t,1);e!==null&&nn(e,t,1,-1)}function Mp(t){var e=mn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:t},e.queue=t,t=t.dispatch=Gx.bind(null,Te,t),[e.memoizedState,t]}function ki(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Te.updateQueue,e===null?(e={lastEffect:null,stores:null},Te.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function a0(){return Yt().memoizedState}function al(t,e,n,r){var a=mn();Te.flags|=t,a.memoizedState=ki(1|e,n,void 0,r===void 0?null:r)}function yu(t,e,n,r){var a=Yt();r=r===void 0?null:r;var s=void 0;if(Be!==null){var i=Be.memoizedState;if(s=i.destroy,r!==null&&ff(r,i.deps)){a.memoizedState=ki(e,n,s,r);return}}Te.flags|=t,a.memoizedState=ki(1|e,n,s,r)}function Fp(t,e){return al(8390656,8,t,e)}function gf(t,e){return yu(2048,8,t,e)}function s0(t,e){return yu(4,2,t,e)}function i0(t,e){return yu(4,4,t,e)}function o0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function l0(t,e,n){return n=n!=null?n.concat([t]):null,yu(4,4,o0.bind(null,e,t),n)}function yf(){}function u0(t,e){var n=Yt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ff(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function c0(t,e){var n=Yt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ff(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function d0(t,e,n){return Jr&21?(rn(n,e)||(n=gv(),Te.lanes|=n,Zr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,_t=!0),t.memoizedState=n)}function Kx(t,e){var n=me;me=n!==0&&4>n?n:4,t(!0);var r=Tc.transition;Tc.transition={};try{t(!1),e()}finally{me=n,Tc.transition=r}}function h0(){return Yt().memoizedState}function Wx(t,e,n){var r=gr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},f0(t))m0(e,n);else if(n=Gv(t,e,n,r),n!==null){var a=Et();nn(n,t,r,a),p0(n,e,r)}}function Gx(t,e,n){var r=gr(t),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(f0(t))m0(e,a);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var i=e.lastRenderedState,o=s(i,n);if(a.hasEagerState=!0,a.eagerState=o,rn(o,i)){var u=e.interleaved;u===null?(a.next=a,lf(e)):(a.next=u.next,u.next=a),e.interleaved=a;return}}catch{}finally{}n=Gv(t,e,a,r),n!==null&&(a=Et(),nn(n,t,r,a),p0(n,e,r))}}function f0(t){var e=t.alternate;return t===Te||e!==null&&e===Te}function m0(t,e){Js=Ll=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function p0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Wh(t,n)}}var Ml={readContext:Qt,useCallback:at,useContext:at,useEffect:at,useImperativeHandle:at,useInsertionEffect:at,useLayoutEffect:at,useMemo:at,useReducer:at,useRef:at,useState:at,useDebugValue:at,useDeferredValue:at,useTransition:at,useMutableSource:at,useSyncExternalStore:at,useId:at,unstable_isNewReconciler:!1},Qx={readContext:Qt,useCallback:function(t,e){return mn().memoizedState=[t,e===void 0?null:e],t},useContext:Qt,useEffect:Fp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,al(4194308,4,o0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return al(4194308,4,t,e)},useInsertionEffect:function(t,e){return al(4,2,t,e)},useMemo:function(t,e){var n=mn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=mn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Wx.bind(null,Te,t),[r.memoizedState,t]},useRef:function(t){var e=mn();return t={current:t},e.memoizedState=t},useState:Mp,useDebugValue:yf,useDeferredValue:function(t){return mn().memoizedState=t},useTransition:function(){var t=Mp(!1),e=t[0];return t=Kx.bind(null,t[1]),mn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Te,a=mn();if(Ce){if(n===void 0)throw Error(F(407));n=n()}else{if(n=e(),Ge===null)throw Error(F(349));Jr&30||Zv(r,e,n)}a.memoizedState=n;var s={value:n,getSnapshot:e};return a.queue=s,Fp(t0.bind(null,r,s,t),[t]),r.flags|=2048,ki(9,e0.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=mn(),e=Ge.identifierPrefix;if(Ce){var n=An,r=Dn;n=(r&~(1<<32-tn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=wi++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Hx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Yx={readContext:Qt,useCallback:u0,useContext:Qt,useEffect:gf,useImperativeHandle:l0,useInsertionEffect:s0,useLayoutEffect:i0,useMemo:c0,useReducer:Dc,useRef:a0,useState:function(){return Dc(Ei)},useDebugValue:yf,useDeferredValue:function(t){var e=Yt();return d0(e,Be.memoizedState,t)},useTransition:function(){var t=Dc(Ei)[0],e=Yt().memoizedState;return[t,e]},useMutableSource:Xv,useSyncExternalStore:Jv,useId:h0,unstable_isNewReconciler:!1},Xx={readContext:Qt,useCallback:u0,useContext:Qt,useEffect:gf,useImperativeHandle:l0,useInsertionEffect:s0,useLayoutEffect:i0,useMemo:c0,useReducer:Ac,useRef:a0,useState:function(){return Ac(Ei)},useDebugValue:yf,useDeferredValue:function(t){var e=Yt();return Be===null?e.memoizedState=t:d0(e,Be.memoizedState,t)},useTransition:function(){var t=Ac(Ei)[0],e=Yt().memoizedState;return[t,e]},useMutableSource:Xv,useSyncExternalStore:Jv,useId:h0,unstable_isNewReconciler:!1};function Jt(t,e){if(t&&t.defaultProps){e=De({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ud(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:De({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var vu={isMounted:function(t){return(t=t._reactInternals)?la(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Et(),a=gr(t),s=Mn(r,a);s.payload=e,n!=null&&(s.callback=n),e=mr(t,s,a),e!==null&&(nn(e,t,a,r),nl(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Et(),a=gr(t),s=Mn(r,a);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=mr(t,s,a),e!==null&&(nn(e,t,a,r),nl(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Et(),r=gr(t),a=Mn(n,r);a.tag=2,e!=null&&(a.callback=e),e=mr(t,a,r),e!==null&&(nn(e,t,r,n),nl(e,t,r))}};function Up(t,e,n,r,a,s,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,i):e.prototype&&e.prototype.isPureReactComponent?!mi(n,r)||!mi(a,s):!0}function g0(t,e,n){var r=!1,a=xr,s=e.contextType;return typeof s=="object"&&s!==null?s=Qt(s):(a=Dt(e)?Yr:pt.current,r=e.contextTypes,s=(r=r!=null)?Wa(t,a):xr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=vu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=s),e}function Vp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&vu.enqueueReplaceState(e,e.state,null)}function Vd(t,e,n,r){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},uf(t);var s=e.contextType;typeof s=="object"&&s!==null?a.context=Qt(s):(s=Dt(e)?Yr:pt.current,a.context=Wa(t,s)),a.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Ud(t,e,s,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&vu.enqueueReplaceState(a,a.state,null),Pl(t,n,a,r),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Xa(t,e){try{var n="",r=e;do n+=Sk(r),r=r.return;while(r);var a=n}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:a,digest:null}}function Rc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function zd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Jx=typeof WeakMap=="function"?WeakMap:Map;function y0(t,e,n){n=Mn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ul||(Ul=!0,Qd=r),zd(t,e)},n}function v0(t,e,n){n=Mn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var a=e.value;n.payload=function(){return r(a)},n.callback=function(){zd(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){zd(t,e),typeof r!="function"&&(pr===null?pr=new Set([this]):pr.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function zp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Jx;var a=new Set;r.set(e,a)}else a=r.get(e),a===void 0&&(a=new Set,r.set(e,a));a.has(n)||(a.add(n),t=hN.bind(null,t,e,n),e.then(t,t))}function jp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function qp(t,e,n,r,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Mn(-1,1),e.tag=2,mr(n,e,1))),n.lanes|=1),t)}var Zx=Wn.ReactCurrentOwner,_t=!1;function vt(t,e,n,r){e.child=t===null?Wv(e,null,n,r):Qa(e,t.child,n,r)}function Bp(t,e,n,r,a){n=n.render;var s=e.ref;return Fa(e,a),r=mf(t,e,n,r,s,a),n=pf(),t!==null&&!_t?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,jn(t,e,a)):(Ce&&n&&tf(e),e.flags|=1,vt(t,e,r,a),e.child)}function $p(t,e,n,r,a){if(t===null){var s=n.type;return typeof s=="function"&&!Sf(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,b0(t,e,s,r,a)):(t=ll(n.type,null,r,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&a)){var i=s.memoizedProps;if(n=n.compare,n=n!==null?n:mi,n(i,r)&&t.ref===e.ref)return jn(t,e,a)}return e.flags|=1,t=yr(s,r),t.ref=e.ref,t.return=e,e.child=t}function b0(t,e,n,r,a){if(t!==null){var s=t.memoizedProps;if(mi(s,r)&&t.ref===e.ref)if(_t=!1,e.pendingProps=r=s,(t.lanes&a)!==0)t.flags&131072&&(_t=!0);else return e.lanes=t.lanes,jn(t,e,a)}return jd(t,e,n,r,a)}function w0(t,e,n){var r=e.pendingProps,a=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},be(Da,Rt),Rt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,be(Da,Rt),Rt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,be(Da,Rt),Rt|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,be(Da,Rt),Rt|=r;return vt(t,e,a,n),e.child}function E0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function jd(t,e,n,r,a){var s=Dt(n)?Yr:pt.current;return s=Wa(e,s),Fa(e,a),n=mf(t,e,n,r,s,a),r=pf(),t!==null&&!_t?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,jn(t,e,a)):(Ce&&r&&tf(e),e.flags|=1,vt(t,e,n,a),e.child)}function Hp(t,e,n,r,a){if(Dt(n)){var s=!0;_l(e)}else s=!1;if(Fa(e,a),e.stateNode===null)sl(t,e),g0(e,n,r),Vd(e,n,r,a),r=!0;else if(t===null){var i=e.stateNode,o=e.memoizedProps;i.props=o;var u=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=Qt(c):(c=Dt(n)?Yr:pt.current,c=Wa(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==r||u!==c)&&Vp(e,i,r,c),Zn=!1;var f=e.memoizedState;i.state=f,Pl(e,r,i,a),u=e.memoizedState,o!==r||f!==u||Tt.current||Zn?(typeof d=="function"&&(Ud(e,n,d,r),u=e.memoizedState),(o=Zn||Up(e,n,o,r,f,u,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),i.props=r,i.state=u,i.context=c,r=o):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,Qv(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Jt(e.type,o),i.props=c,h=e.pendingProps,f=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=Qt(u):(u=Dt(n)?Yr:pt.current,u=Wa(e,u));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||f!==u)&&Vp(e,i,r,u),Zn=!1,f=e.memoizedState,i.state=f,Pl(e,r,i,a);var v=e.memoizedState;o!==h||f!==v||Tt.current||Zn?(typeof g=="function"&&(Ud(e,n,g,r),v=e.memoizedState),(c=Zn||Up(e,n,c,r,f,v,u)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,v,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,v,u)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),i.props=r,i.state=v,i.context=u,r=c):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return qd(t,e,n,r,s,a)}function qd(t,e,n,r,a,s){E0(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return a&&Dp(e,n,!1),jn(t,e,s);r=e.stateNode,Zx.current=e;var o=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=Qa(e,t.child,null,s),e.child=Qa(e,null,o,s)):vt(t,e,o,s),e.memoizedState=r.state,a&&Dp(e,n,!0),e.child}function k0(t){var e=t.stateNode;e.pendingContext?Tp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Tp(t,e.context,!1),cf(t,e.containerInfo)}function Kp(t,e,n,r,a){return Ga(),rf(a),e.flags|=256,vt(t,e,n,r),e.child}var Bd={dehydrated:null,treeContext:null,retryLane:0};function $d(t){return{baseLanes:t,cachePool:null,transitions:null}}function x0(t,e,n){var r=e.pendingProps,a=Ie.current,s=!1,i=(e.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(a&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),be(Ie,a&1),t===null)return Md(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,s?(r=e.mode,s=e.child,i={mode:"hidden",children:i},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Eu(i,r,0,null),t=Wr(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=$d(n),e.memoizedState=Bd,t):vf(e,i));if(a=t.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return eN(t,e,i,r,o,a,n);if(s){s=r.fallback,i=e.mode,a=t.child,o=a.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&e.child!==a?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=yr(a,u),r.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=yr(o,s):(s=Wr(s,i,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,i=t.child.memoizedState,i=i===null?$d(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=t.childLanes&~n,e.memoizedState=Bd,r}return s=t.child,t=s.sibling,r=yr(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function vf(t,e){return e=Eu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fo(t,e,n,r){return r!==null&&rf(r),Qa(e,t.child,null,n),t=vf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function eN(t,e,n,r,a,s,i){if(n)return e.flags&256?(e.flags&=-257,r=Rc(Error(F(422))),Fo(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,a=e.mode,r=Eu({mode:"visible",children:r.children},a,0,null),s=Wr(s,a,i,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Qa(e,t.child,null,i),e.child.memoizedState=$d(i),e.memoizedState=Bd,s);if(!(e.mode&1))return Fo(t,e,i,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(F(419)),r=Rc(s,r,void 0),Fo(t,e,i,r)}if(o=(i&t.childLanes)!==0,_t||o){if(r=Ge,r!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,zn(t,a),nn(r,t,a,-1))}return Nf(),r=Rc(Error(F(421))),Fo(t,e,i,r)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=fN.bind(null,t),a._reactRetry=e,null):(t=s.treeContext,Pt=fr(a.nextSibling),Lt=e,Ce=!0,en=null,t!==null&&($t[Ht++]=Dn,$t[Ht++]=An,$t[Ht++]=Xr,Dn=t.id,An=t.overflow,Xr=e),e=vf(e,r.children),e.flags|=4096,e)}function Wp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Fd(t.return,e,n)}function Pc(t,e,n,r,a){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=a)}function N0(t,e,n){var r=e.pendingProps,a=r.revealOrder,s=r.tail;if(vt(t,e,r.children,n),r=Ie.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Wp(t,n,e);else if(t.tag===19)Wp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(be(Ie,r),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&Ol(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),Pc(e,!1,a,n,s);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&Ol(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}Pc(e,!0,n,null,s);break;case"together":Pc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function sl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function jn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Zr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(F(153));if(e.child!==null){for(t=e.child,n=yr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=yr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function tN(t,e,n){switch(e.tag){case 3:k0(e),Ga();break;case 5:Yv(e);break;case 1:Dt(e.type)&&_l(e);break;case 4:cf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,a=e.memoizedProps.value;be(Al,r._currentValue),r._currentValue=a;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(be(Ie,Ie.current&1),e.flags|=128,null):n&e.child.childLanes?x0(t,e,n):(be(Ie,Ie.current&1),t=jn(t,e,n),t!==null?t.sibling:null);be(Ie,Ie.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return N0(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),be(Ie,Ie.current),r)break;return null;case 22:case 23:return e.lanes=0,w0(t,e,n)}return jn(t,e,n)}var S0,Hd,C0,I0;S0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Hd=function(){};C0=function(t,e,n,r){var a=t.memoizedProps;if(a!==r){t=e.stateNode,qr(wn.current);var s=null;switch(n){case"input":a=fd(t,a),r=fd(t,r),s=[];break;case"select":a=De({},a,{value:void 0}),r=De({},r,{value:void 0}),s=[];break;case"textarea":a=gd(t,a),r=gd(t,r),s=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Cl)}vd(n,r);var i;n=null;for(c in a)if(!r.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(oi.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var u=r[c];if(o=a!=null?a[c]:void 0,r.hasOwnProperty(c)&&u!==o&&(u!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&o[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(s||(s=[]),s.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(s=s||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(oi.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&we("scroll",t),s||o===u||(s=[])):(s=s||[]).push(c,u))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};I0=function(t,e,n,r){n!==r&&(e.flags|=4)};function Rs(t,e){if(!Ce)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function st(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function nN(t,e,n){var r=e.pendingProps;switch(nf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return st(e),null;case 1:return Dt(e.type)&&Il(),st(e),null;case 3:return r=e.stateNode,Ya(),xe(Tt),xe(pt),hf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Lo(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,en!==null&&(Jd(en),en=null))),Hd(t,e),st(e),null;case 5:df(e);var a=qr(bi.current);if(n=e.type,t!==null&&e.stateNode!=null)C0(t,e,n,r,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(F(166));return st(e),null}if(t=qr(wn.current),Lo(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[pn]=e,r[yi]=s,t=(e.mode&1)!==0,n){case"dialog":we("cancel",r),we("close",r);break;case"iframe":case"object":case"embed":we("load",r);break;case"video":case"audio":for(a=0;a<Vs.length;a++)we(Vs[a],r);break;case"source":we("error",r);break;case"img":case"image":case"link":we("error",r),we("load",r);break;case"details":we("toggle",r);break;case"input":np(r,s),we("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},we("invalid",r);break;case"textarea":ap(r,s),we("invalid",r)}vd(n,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&Oo(r.textContent,o,t),a=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Oo(r.textContent,o,t),a=["children",""+o]):oi.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&we("scroll",r)}switch(n){case"input":Co(r),rp(r,s,!0);break;case"textarea":Co(r),sp(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Cl)}r=a,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=tv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[pn]=e,t[yi]=r,S0(t,e,!1,!1),e.stateNode=t;e:{switch(i=bd(n,r),n){case"dialog":we("cancel",t),we("close",t),a=r;break;case"iframe":case"object":case"embed":we("load",t),a=r;break;case"video":case"audio":for(a=0;a<Vs.length;a++)we(Vs[a],t);a=r;break;case"source":we("error",t),a=r;break;case"img":case"image":case"link":we("error",t),we("load",t),a=r;break;case"details":we("toggle",t),a=r;break;case"input":np(t,r),a=fd(t,r),we("invalid",t);break;case"option":a=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},a=De({},r,{value:void 0}),we("invalid",t);break;case"textarea":ap(t,r),a=gd(t,r),we("invalid",t);break;default:a=r}vd(n,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var u=o[s];s==="style"?av(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&nv(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&li(t,u):typeof u=="number"&&li(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(oi.hasOwnProperty(s)?u!=null&&s==="onScroll"&&we("scroll",t):u!=null&&jh(t,s,u,i))}switch(n){case"input":Co(t),rp(t,r,!1);break;case"textarea":Co(t),sp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+kr(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Pa(t,!!r.multiple,s,!1):r.defaultValue!=null&&Pa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Cl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return st(e),null;case 6:if(t&&e.stateNode!=null)I0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(F(166));if(n=qr(bi.current),qr(wn.current),Lo(e)){if(r=e.stateNode,n=e.memoizedProps,r[pn]=e,(s=r.nodeValue!==n)&&(t=Lt,t!==null))switch(t.tag){case 3:Oo(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Oo(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[pn]=e,e.stateNode=r}return st(e),null;case 13:if(xe(Ie),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ce&&Pt!==null&&e.mode&1&&!(e.flags&128))Hv(),Ga(),e.flags|=98560,s=!1;else if(s=Lo(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(F(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(F(317));s[pn]=e}else Ga(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;st(e),s=!1}else en!==null&&(Jd(en),en=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ie.current&1?$e===0&&($e=3):Nf())),e.updateQueue!==null&&(e.flags|=4),st(e),null);case 4:return Ya(),Hd(t,e),t===null&&pi(e.stateNode.containerInfo),st(e),null;case 10:return of(e.type._context),st(e),null;case 17:return Dt(e.type)&&Il(),st(e),null;case 19:if(xe(Ie),s=e.memoizedState,s===null)return st(e),null;if(r=(e.flags&128)!==0,i=s.rendering,i===null)if(r)Rs(s,!1);else{if($e!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=Ol(t),i!==null){for(e.flags|=128,Rs(s,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,t=i.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return be(Ie,Ie.current&1|2),e.child}t=t.sibling}s.tail!==null&&Le()>Ja&&(e.flags|=128,r=!0,Rs(s,!1),e.lanes=4194304)}else{if(!r)if(t=Ol(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Rs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!Ce)return st(e),null}else 2*Le()-s.renderingStartTime>Ja&&n!==1073741824&&(e.flags|=128,r=!0,Rs(s,!1),e.lanes=4194304);s.isBackwards?(i.sibling=e.child,e.child=i):(n=s.last,n!==null?n.sibling=i:e.child=i,s.last=i)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Le(),e.sibling=null,n=Ie.current,be(Ie,r?n&1|2:n&1),e):(st(e),null);case 22:case 23:return xf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Rt&1073741824&&(st(e),e.subtreeFlags&6&&(e.flags|=8192)):st(e),null;case 24:return null;case 25:return null}throw Error(F(156,e.tag))}function rN(t,e){switch(nf(e),e.tag){case 1:return Dt(e.type)&&Il(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ya(),xe(Tt),xe(pt),hf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return df(e),null;case 13:if(xe(Ie),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(F(340));Ga()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return xe(Ie),null;case 4:return Ya(),null;case 10:return of(e.type._context),null;case 22:case 23:return xf(),null;case 24:return null;default:return null}}var Uo=!1,lt=!1,aN=typeof WeakSet=="function"?WeakSet:Set,H=null;function Ta(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Re(t,e,r)}else n.current=null}function _0(t,e,n){try{n()}catch(r){Re(t,e,r)}}var Gp=!1;function sN(t,e){if(Td=xl,t=Rv(),ef(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var i=0,o=-1,u=-1,c=0,d=0,h=t,f=null;t:for(;;){for(var g;h!==n||a!==0&&h.nodeType!==3||(o=i+a),h!==s||r!==0&&h.nodeType!==3||(u=i+r),h.nodeType===3&&(i+=h.nodeValue.length),(g=h.firstChild)!==null;)f=h,h=g;for(;;){if(h===t)break t;if(f===n&&++c===a&&(o=i),f===s&&++d===r&&(u=i),(g=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=g}n=o===-1||u===-1?null:{start:o,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Dd={focusedElem:t,selectionRange:n},xl=!1,H=e;H!==null;)if(e=H,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,H=t;else for(;H!==null;){e=H;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var b=v.memoizedProps,E=v.memoizedState,m=e.stateNode,p=m.getSnapshotBeforeUpdate(e.elementType===e.type?b:Jt(e.type,b),E);m.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(F(163))}}catch(w){Re(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}return v=Gp,Gp=!1,v}function Zs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&t)===t){var s=a.destroy;a.destroy=void 0,s!==void 0&&_0(e,n,s)}a=a.next}while(a!==r)}}function bu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Kd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function T0(t){var e=t.alternate;e!==null&&(t.alternate=null,T0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[pn],delete e[yi],delete e[Pd],delete e[jx],delete e[qx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function D0(t){return t.tag===5||t.tag===3||t.tag===4}function Qp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||D0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Wd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Cl));else if(r!==4&&(t=t.child,t!==null))for(Wd(t,e,n),t=t.sibling;t!==null;)Wd(t,e,n),t=t.sibling}function Gd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Gd(t,e,n),t=t.sibling;t!==null;)Gd(t,e,n),t=t.sibling}var Xe=null,Zt=!1;function Qn(t,e,n){for(n=n.child;n!==null;)A0(t,e,n),n=n.sibling}function A0(t,e,n){if(bn&&typeof bn.onCommitFiberUnmount=="function")try{bn.onCommitFiberUnmount(du,n)}catch{}switch(n.tag){case 5:lt||Ta(n,e);case 6:var r=Xe,a=Zt;Xe=null,Qn(t,e,n),Xe=r,Zt=a,Xe!==null&&(Zt?(t=Xe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Xe.removeChild(n.stateNode));break;case 18:Xe!==null&&(Zt?(t=Xe,n=n.stateNode,t.nodeType===8?Cc(t.parentNode,n):t.nodeType===1&&Cc(t,n),hi(t)):Cc(Xe,n.stateNode));break;case 4:r=Xe,a=Zt,Xe=n.stateNode.containerInfo,Zt=!0,Qn(t,e,n),Xe=r,Zt=a;break;case 0:case 11:case 14:case 15:if(!lt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&_0(n,e,i),a=a.next}while(a!==r)}Qn(t,e,n);break;case 1:if(!lt&&(Ta(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Re(n,e,o)}Qn(t,e,n);break;case 21:Qn(t,e,n);break;case 22:n.mode&1?(lt=(r=lt)||n.memoizedState!==null,Qn(t,e,n),lt=r):Qn(t,e,n);break;default:Qn(t,e,n)}}function Yp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new aN),e.forEach(function(r){var a=mN.bind(null,t,r);n.has(r)||(n.add(r),r.then(a,a))})}}function Xt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var s=t,i=e,o=i;e:for(;o!==null;){switch(o.tag){case 5:Xe=o.stateNode,Zt=!1;break e;case 3:Xe=o.stateNode.containerInfo,Zt=!0;break e;case 4:Xe=o.stateNode.containerInfo,Zt=!0;break e}o=o.return}if(Xe===null)throw Error(F(160));A0(s,i,a),Xe=null,Zt=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(c){Re(a,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)R0(e,t),e=e.sibling}function R0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xt(e,t),hn(t),r&4){try{Zs(3,t,t.return),bu(3,t)}catch(b){Re(t,t.return,b)}try{Zs(5,t,t.return)}catch(b){Re(t,t.return,b)}}break;case 1:Xt(e,t),hn(t),r&512&&n!==null&&Ta(n,n.return);break;case 5:if(Xt(e,t),hn(t),r&512&&n!==null&&Ta(n,n.return),t.flags&32){var a=t.stateNode;try{li(a,"")}catch(b){Re(t,t.return,b)}}if(r&4&&(a=t.stateNode,a!=null)){var s=t.memoizedProps,i=n!==null?n.memoizedProps:s,o=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Zy(a,s),bd(o,i);var c=bd(o,s);for(i=0;i<u.length;i+=2){var d=u[i],h=u[i+1];d==="style"?av(a,h):d==="dangerouslySetInnerHTML"?nv(a,h):d==="children"?li(a,h):jh(a,d,h,c)}switch(o){case"input":md(a,s);break;case"textarea":ev(a,s);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Pa(a,!!s.multiple,g,!1):f!==!!s.multiple&&(s.defaultValue!=null?Pa(a,!!s.multiple,s.defaultValue,!0):Pa(a,!!s.multiple,s.multiple?[]:"",!1))}a[yi]=s}catch(b){Re(t,t.return,b)}}break;case 6:if(Xt(e,t),hn(t),r&4){if(t.stateNode===null)throw Error(F(162));a=t.stateNode,s=t.memoizedProps;try{a.nodeValue=s}catch(b){Re(t,t.return,b)}}break;case 3:if(Xt(e,t),hn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{hi(e.containerInfo)}catch(b){Re(t,t.return,b)}break;case 4:Xt(e,t),hn(t);break;case 13:Xt(e,t),hn(t),a=t.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(Ef=Le())),r&4&&Yp(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(lt=(c=lt)||d,Xt(e,t),lt=c):Xt(e,t),hn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(H=t,d=t.child;d!==null;){for(h=H=d;H!==null;){switch(f=H,g=f.child,f.tag){case 0:case 11:case 14:case 15:Zs(4,f,f.return);break;case 1:Ta(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(b){Re(r,n,b)}}break;case 5:Ta(f,f.return);break;case 22:if(f.memoizedState!==null){Jp(h);continue}}g!==null?(g.return=f,H=g):Jp(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{a=h.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,u=h.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,o.style.display=rv("display",i))}catch(b){Re(t,t.return,b)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(b){Re(t,t.return,b)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Xt(e,t),hn(t),r&4&&Yp(t);break;case 21:break;default:Xt(e,t),hn(t)}}function hn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(D0(n)){var r=n;break e}n=n.return}throw Error(F(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(li(a,""),r.flags&=-33);var s=Qp(t);Gd(t,s,a);break;case 3:case 4:var i=r.stateNode.containerInfo,o=Qp(t);Wd(t,o,i);break;default:throw Error(F(161))}}catch(u){Re(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function iN(t,e,n){H=t,P0(t)}function P0(t,e,n){for(var r=(t.mode&1)!==0;H!==null;){var a=H,s=a.child;if(a.tag===22&&r){var i=a.memoizedState!==null||Uo;if(!i){var o=a.alternate,u=o!==null&&o.memoizedState!==null||lt;o=Uo;var c=lt;if(Uo=i,(lt=u)&&!c)for(H=a;H!==null;)i=H,u=i.child,i.tag===22&&i.memoizedState!==null?Zp(a):u!==null?(u.return=i,H=u):Zp(a);for(;s!==null;)H=s,P0(s),s=s.sibling;H=a,Uo=o,lt=c}Xp(t)}else a.subtreeFlags&8772&&s!==null?(s.return=a,H=s):Xp(t)}}function Xp(t){for(;H!==null;){var e=H;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:lt||bu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!lt)if(n===null)r.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:Jt(e.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Lp(e,s,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Lp(e,i,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&hi(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(F(163))}lt||e.flags&512&&Kd(e)}catch(f){Re(e,e.return,f)}}if(e===t){H=null;break}if(n=e.sibling,n!==null){n.return=e.return,H=n;break}H=e.return}}function Jp(t){for(;H!==null;){var e=H;if(e===t){H=null;break}var n=e.sibling;if(n!==null){n.return=e.return,H=n;break}H=e.return}}function Zp(t){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{bu(4,e)}catch(u){Re(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var a=e.return;try{r.componentDidMount()}catch(u){Re(e,a,u)}}var s=e.return;try{Kd(e)}catch(u){Re(e,s,u)}break;case 5:var i=e.return;try{Kd(e)}catch(u){Re(e,i,u)}}}catch(u){Re(e,e.return,u)}if(e===t){H=null;break}var o=e.sibling;if(o!==null){o.return=e.return,H=o;break}H=e.return}}var oN=Math.ceil,Fl=Wn.ReactCurrentDispatcher,bf=Wn.ReactCurrentOwner,Gt=Wn.ReactCurrentBatchConfig,ce=0,Ge=null,ze=null,et=0,Rt=0,Da=Tr(0),$e=0,xi=null,Zr=0,wu=0,wf=0,ei=null,Ct=null,Ef=0,Ja=1/0,In=null,Ul=!1,Qd=null,pr=null,Vo=!1,lr=null,Vl=0,ti=0,Yd=null,il=-1,ol=0;function Et(){return ce&6?Le():il!==-1?il:il=Le()}function gr(t){return t.mode&1?ce&2&&et!==0?et&-et:$x.transition!==null?(ol===0&&(ol=gv()),ol):(t=me,t!==0||(t=window.event,t=t===void 0?16:xv(t.type)),t):1}function nn(t,e,n,r){if(50<ti)throw ti=0,Yd=null,Error(F(185));Hi(t,n,r),(!(ce&2)||t!==Ge)&&(t===Ge&&(!(ce&2)&&(wu|=n),$e===4&&tr(t,et)),At(t,r),n===1&&ce===0&&!(e.mode&1)&&(Ja=Le()+500,gu&&Dr()))}function At(t,e){var n=t.callbackNode;$k(t,e);var r=kl(t,t===Ge?et:0);if(r===0)n!==null&&lp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&lp(n),e===1)t.tag===0?Bx(eg.bind(null,t)):qv(eg.bind(null,t)),Vx(function(){!(ce&6)&&Dr()}),n=null;else{switch(yv(r)){case 1:n=Kh;break;case 4:n=mv;break;case 16:n=El;break;case 536870912:n=pv;break;default:n=El}n=j0(n,O0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function O0(t,e){if(il=-1,ol=0,ce&6)throw Error(F(327));var n=t.callbackNode;if(Ua()&&t.callbackNode!==n)return null;var r=kl(t,t===Ge?et:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=zl(t,r);else{e=r;var a=ce;ce|=2;var s=M0();(Ge!==t||et!==e)&&(In=null,Ja=Le()+500,Kr(t,e));do try{cN();break}catch(o){L0(t,o)}while(!0);sf(),Fl.current=s,ce=a,ze!==null?e=0:(Ge=null,et=0,e=$e)}if(e!==0){if(e===2&&(a=Nd(t),a!==0&&(r=a,e=Xd(t,a))),e===1)throw n=xi,Kr(t,0),tr(t,r),At(t,Le()),n;if(e===6)tr(t,r);else{if(a=t.current.alternate,!(r&30)&&!lN(a)&&(e=zl(t,r),e===2&&(s=Nd(t),s!==0&&(r=s,e=Xd(t,s))),e===1))throw n=xi,Kr(t,0),tr(t,r),At(t,Le()),n;switch(t.finishedWork=a,t.finishedLanes=r,e){case 0:case 1:throw Error(F(345));case 2:Ur(t,Ct,In);break;case 3:if(tr(t,r),(r&130023424)===r&&(e=Ef+500-Le(),10<e)){if(kl(t,0)!==0)break;if(a=t.suspendedLanes,(a&r)!==r){Et(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=Rd(Ur.bind(null,t,Ct,In),e);break}Ur(t,Ct,In);break;case 4:if(tr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,a=-1;0<r;){var i=31-tn(r);s=1<<i,i=e[i],i>a&&(a=i),r&=~s}if(r=a,r=Le()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*oN(r/1960))-r,10<r){t.timeoutHandle=Rd(Ur.bind(null,t,Ct,In),r);break}Ur(t,Ct,In);break;case 5:Ur(t,Ct,In);break;default:throw Error(F(329))}}}return At(t,Le()),t.callbackNode===n?O0.bind(null,t):null}function Xd(t,e){var n=ei;return t.current.memoizedState.isDehydrated&&(Kr(t,e).flags|=256),t=zl(t,e),t!==2&&(e=Ct,Ct=n,e!==null&&Jd(e)),t}function Jd(t){Ct===null?Ct=t:Ct.push.apply(Ct,t)}function lN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],s=a.getSnapshot;a=a.value;try{if(!rn(s(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function tr(t,e){for(e&=~wf,e&=~wu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-tn(e),r=1<<n;t[n]=-1,e&=~r}}function eg(t){if(ce&6)throw Error(F(327));Ua();var e=kl(t,0);if(!(e&1))return At(t,Le()),null;var n=zl(t,e);if(t.tag!==0&&n===2){var r=Nd(t);r!==0&&(e=r,n=Xd(t,r))}if(n===1)throw n=xi,Kr(t,0),tr(t,e),At(t,Le()),n;if(n===6)throw Error(F(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ur(t,Ct,In),At(t,Le()),null}function kf(t,e){var n=ce;ce|=1;try{return t(e)}finally{ce=n,ce===0&&(Ja=Le()+500,gu&&Dr())}}function ea(t){lr!==null&&lr.tag===0&&!(ce&6)&&Ua();var e=ce;ce|=1;var n=Gt.transition,r=me;try{if(Gt.transition=null,me=1,t)return t()}finally{me=r,Gt.transition=n,ce=e,!(ce&6)&&Dr()}}function xf(){Rt=Da.current,xe(Da)}function Kr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Ux(n)),ze!==null)for(n=ze.return;n!==null;){var r=n;switch(nf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Il();break;case 3:Ya(),xe(Tt),xe(pt),hf();break;case 5:df(r);break;case 4:Ya();break;case 13:xe(Ie);break;case 19:xe(Ie);break;case 10:of(r.type._context);break;case 22:case 23:xf()}n=n.return}if(Ge=t,ze=t=yr(t.current,null),et=Rt=e,$e=0,xi=null,wf=wu=Zr=0,Ct=ei=null,jr!==null){for(e=0;e<jr.length;e++)if(n=jr[e],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,s=n.pending;if(s!==null){var i=s.next;s.next=a,r.next=i}n.pending=r}jr=null}return t}function L0(t,e){do{var n=ze;try{if(sf(),rl.current=Ml,Ll){for(var r=Te.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Ll=!1}if(Jr=0,We=Be=Te=null,Js=!1,wi=0,bf.current=null,n===null||n.return===null){$e=1,xi=e,ze=null;break}e:{var s=t,i=n.return,o=n,u=e;if(e=et,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=jp(i);if(g!==null){g.flags&=-257,qp(g,i,o,s,e),g.mode&1&&zp(s,c,e),e=g,u=c;var v=e.updateQueue;if(v===null){var b=new Set;b.add(u),e.updateQueue=b}else v.add(u);break e}else{if(!(e&1)){zp(s,c,e),Nf();break e}u=Error(F(426))}}else if(Ce&&o.mode&1){var E=jp(i);if(E!==null){!(E.flags&65536)&&(E.flags|=256),qp(E,i,o,s,e),rf(Xa(u,o));break e}}s=u=Xa(u,o),$e!==4&&($e=2),ei===null?ei=[s]:ei.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=y0(s,u,e);Op(s,m);break e;case 1:o=u;var p=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof p.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(pr===null||!pr.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=v0(s,o,e);Op(s,w);break e}}s=s.return}while(s!==null)}U0(n)}catch(C){e=C,ze===n&&n!==null&&(ze=n=n.return);continue}break}while(!0)}function M0(){var t=Fl.current;return Fl.current=Ml,t===null?Ml:t}function Nf(){($e===0||$e===3||$e===2)&&($e=4),Ge===null||!(Zr&268435455)&&!(wu&268435455)||tr(Ge,et)}function zl(t,e){var n=ce;ce|=2;var r=M0();(Ge!==t||et!==e)&&(In=null,Kr(t,e));do try{uN();break}catch(a){L0(t,a)}while(!0);if(sf(),ce=n,Fl.current=r,ze!==null)throw Error(F(261));return Ge=null,et=0,$e}function uN(){for(;ze!==null;)F0(ze)}function cN(){for(;ze!==null&&!Lk();)F0(ze)}function F0(t){var e=z0(t.alternate,t,Rt);t.memoizedProps=t.pendingProps,e===null?U0(t):ze=e,bf.current=null}function U0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=rN(n,e),n!==null){n.flags&=32767,ze=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{$e=6,ze=null;return}}else if(n=nN(n,e,Rt),n!==null){ze=n;return}if(e=e.sibling,e!==null){ze=e;return}ze=e=t}while(e!==null);$e===0&&($e=5)}function Ur(t,e,n){var r=me,a=Gt.transition;try{Gt.transition=null,me=1,dN(t,e,n,r)}finally{Gt.transition=a,me=r}return null}function dN(t,e,n,r){do Ua();while(lr!==null);if(ce&6)throw Error(F(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(F(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Hk(t,s),t===Ge&&(ze=Ge=null,et=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Vo||(Vo=!0,j0(El,function(){return Ua(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Gt.transition,Gt.transition=null;var i=me;me=1;var o=ce;ce|=4,bf.current=null,sN(t,n),R0(n,t),Ax(Dd),xl=!!Td,Dd=Td=null,t.current=n,iN(n),Mk(),ce=o,me=i,Gt.transition=s}else t.current=n;if(Vo&&(Vo=!1,lr=t,Vl=a),s=t.pendingLanes,s===0&&(pr=null),Vk(n.stateNode),At(t,Le()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Ul)throw Ul=!1,t=Qd,Qd=null,t;return Vl&1&&t.tag!==0&&Ua(),s=t.pendingLanes,s&1?t===Yd?ti++:(ti=0,Yd=t):ti=0,Dr(),null}function Ua(){if(lr!==null){var t=yv(Vl),e=Gt.transition,n=me;try{if(Gt.transition=null,me=16>t?16:t,lr===null)var r=!1;else{if(t=lr,lr=null,Vl=0,ce&6)throw Error(F(331));var a=ce;for(ce|=4,H=t.current;H!==null;){var s=H,i=s.child;if(H.flags&16){var o=s.deletions;if(o!==null){for(var u=0;u<o.length;u++){var c=o[u];for(H=c;H!==null;){var d=H;switch(d.tag){case 0:case 11:case 15:Zs(8,d,s)}var h=d.child;if(h!==null)h.return=d,H=h;else for(;H!==null;){d=H;var f=d.sibling,g=d.return;if(T0(d),d===c){H=null;break}if(f!==null){f.return=g,H=f;break}H=g}}}var v=s.alternate;if(v!==null){var b=v.child;if(b!==null){v.child=null;do{var E=b.sibling;b.sibling=null,b=E}while(b!==null)}}H=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,H=i;else e:for(;H!==null;){if(s=H,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Zs(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,H=m;break e}H=s.return}}var p=t.current;for(H=p;H!==null;){i=H;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,H=y;else e:for(i=p;H!==null;){if(o=H,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:bu(9,o)}}catch(C){Re(o,o.return,C)}if(o===i){H=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,H=w;break e}H=o.return}}if(ce=a,Dr(),bn&&typeof bn.onPostCommitFiberRoot=="function")try{bn.onPostCommitFiberRoot(du,t)}catch{}r=!0}return r}finally{me=n,Gt.transition=e}}return!1}function tg(t,e,n){e=Xa(n,e),e=y0(t,e,1),t=mr(t,e,1),e=Et(),t!==null&&(Hi(t,1,e),At(t,e))}function Re(t,e,n){if(t.tag===3)tg(t,t,n);else for(;e!==null;){if(e.tag===3){tg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(pr===null||!pr.has(r))){t=Xa(n,t),t=v0(e,t,1),e=mr(e,t,1),t=Et(),e!==null&&(Hi(e,1,t),At(e,t));break}}e=e.return}}function hN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Et(),t.pingedLanes|=t.suspendedLanes&n,Ge===t&&(et&n)===n&&($e===4||$e===3&&(et&130023424)===et&&500>Le()-Ef?Kr(t,0):wf|=n),At(t,e)}function V0(t,e){e===0&&(t.mode&1?(e=To,To<<=1,!(To&130023424)&&(To=4194304)):e=1);var n=Et();t=zn(t,e),t!==null&&(Hi(t,e,n),At(t,n))}function fN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),V0(t,n)}function mN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(F(314))}r!==null&&r.delete(e),V0(t,n)}var z0;z0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Tt.current)_t=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return _t=!1,tN(t,e,n);_t=!!(t.flags&131072)}else _t=!1,Ce&&e.flags&1048576&&Bv(e,Dl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;sl(t,e),t=e.pendingProps;var a=Wa(e,pt.current);Fa(e,n),a=mf(null,e,r,t,a,n);var s=pf();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Dt(r)?(s=!0,_l(e)):s=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,uf(e),a.updater=vu,e.stateNode=a,a._reactInternals=e,Vd(e,r,t,n),e=qd(null,e,r,!0,s,n)):(e.tag=0,Ce&&s&&tf(e),vt(null,e,a,n),e=e.child),e;case 16:r=e.elementType;e:{switch(sl(t,e),t=e.pendingProps,a=r._init,r=a(r._payload),e.type=r,a=e.tag=gN(r),t=Jt(r,t),a){case 0:e=jd(null,e,r,t,n);break e;case 1:e=Hp(null,e,r,t,n);break e;case 11:e=Bp(null,e,r,t,n);break e;case 14:e=$p(null,e,r,Jt(r.type,t),n);break e}throw Error(F(306,r,""))}return e;case 0:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Jt(r,a),jd(t,e,r,a,n);case 1:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Jt(r,a),Hp(t,e,r,a,n);case 3:e:{if(k0(e),t===null)throw Error(F(387));r=e.pendingProps,s=e.memoizedState,a=s.element,Qv(t,e),Pl(e,r,null,n);var i=e.memoizedState;if(r=i.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){a=Xa(Error(F(423)),e),e=Kp(t,e,r,n,a);break e}else if(r!==a){a=Xa(Error(F(424)),e),e=Kp(t,e,r,n,a);break e}else for(Pt=fr(e.stateNode.containerInfo.firstChild),Lt=e,Ce=!0,en=null,n=Wv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ga(),r===a){e=jn(t,e,n);break e}vt(t,e,r,n)}e=e.child}return e;case 5:return Yv(e),t===null&&Md(e),r=e.type,a=e.pendingProps,s=t!==null?t.memoizedProps:null,i=a.children,Ad(r,a)?i=null:s!==null&&Ad(r,s)&&(e.flags|=32),E0(t,e),vt(t,e,i,n),e.child;case 6:return t===null&&Md(e),null;case 13:return x0(t,e,n);case 4:return cf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Qa(e,null,r,n):vt(t,e,r,n),e.child;case 11:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Jt(r,a),Bp(t,e,r,a,n);case 7:return vt(t,e,e.pendingProps,n),e.child;case 8:return vt(t,e,e.pendingProps.children,n),e.child;case 12:return vt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,a=e.pendingProps,s=e.memoizedProps,i=a.value,be(Al,r._currentValue),r._currentValue=i,s!==null)if(rn(s.value,i)){if(s.children===a.children&&!Tt.current){e=jn(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var u=o.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=Mn(-1,n&-n),u.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),Fd(s.return,n,e),o.lanes|=n;break}u=u.next}}else if(s.tag===10)i=s.type===e.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(F(341));i.lanes|=n,o=i.alternate,o!==null&&(o.lanes|=n),Fd(i,n,e),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===e){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}vt(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,r=e.pendingProps.children,Fa(e,n),a=Qt(a),r=r(a),e.flags|=1,vt(t,e,r,n),e.child;case 14:return r=e.type,a=Jt(r,e.pendingProps),a=Jt(r.type,a),$p(t,e,r,a,n);case 15:return b0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Jt(r,a),sl(t,e),e.tag=1,Dt(r)?(t=!0,_l(e)):t=!1,Fa(e,n),g0(e,r,a),Vd(e,r,a,n),qd(null,e,r,!0,t,n);case 19:return N0(t,e,n);case 22:return w0(t,e,n)}throw Error(F(156,e.tag))};function j0(t,e){return fv(t,e)}function pN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wt(t,e,n,r){return new pN(t,e,n,r)}function Sf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function gN(t){if(typeof t=="function")return Sf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Bh)return 11;if(t===$h)return 14}return 2}function yr(t,e){var n=t.alternate;return n===null?(n=Wt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ll(t,e,n,r,a,s){var i=2;if(r=t,typeof t=="function")Sf(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case wa:return Wr(n.children,a,s,e);case qh:i=8,a|=8;break;case ud:return t=Wt(12,n,e,a|2),t.elementType=ud,t.lanes=s,t;case cd:return t=Wt(13,n,e,a),t.elementType=cd,t.lanes=s,t;case dd:return t=Wt(19,n,e,a),t.elementType=dd,t.lanes=s,t;case Yy:return Eu(n,a,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Gy:i=10;break e;case Qy:i=9;break e;case Bh:i=11;break e;case $h:i=14;break e;case Jn:i=16,r=null;break e}throw Error(F(130,t==null?t:typeof t,""))}return e=Wt(i,n,e,a),e.elementType=t,e.type=r,e.lanes=s,e}function Wr(t,e,n,r){return t=Wt(7,t,r,e),t.lanes=n,t}function Eu(t,e,n,r){return t=Wt(22,t,r,e),t.elementType=Yy,t.lanes=n,t.stateNode={isHidden:!1},t}function Oc(t,e,n){return t=Wt(6,t,null,e),t.lanes=n,t}function Lc(t,e,n){return e=Wt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function yN(t,e,n,r,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pc(0),this.expirationTimes=pc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pc(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Cf(t,e,n,r,a,s,i,o,u){return t=new yN(t,e,n,o,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Wt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},uf(s),t}function vN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ba,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function q0(t){if(!t)return xr;t=t._reactInternals;e:{if(la(t)!==t||t.tag!==1)throw Error(F(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Dt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(F(171))}if(t.tag===1){var n=t.type;if(Dt(n))return jv(t,n,e)}return e}function B0(t,e,n,r,a,s,i,o,u){return t=Cf(n,r,!0,t,a,s,i,o,u),t.context=q0(null),n=t.current,r=Et(),a=gr(n),s=Mn(r,a),s.callback=e??null,mr(n,s,a),t.current.lanes=a,Hi(t,a,r),At(t,r),t}function ku(t,e,n,r){var a=e.current,s=Et(),i=gr(a);return n=q0(n),e.context===null?e.context=n:e.pendingContext=n,e=Mn(s,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=mr(a,e,i),t!==null&&(nn(t,a,i,s),nl(t,a,i)),i}function jl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ng(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function If(t,e){ng(t,e),(t=t.alternate)&&ng(t,e)}function bN(){return null}var $0=typeof reportError=="function"?reportError:function(t){console.error(t)};function _f(t){this._internalRoot=t}xu.prototype.render=_f.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(F(409));ku(t,e,null,null)};xu.prototype.unmount=_f.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ea(function(){ku(null,t,null,null)}),e[Vn]=null}};function xu(t){this._internalRoot=t}xu.prototype.unstable_scheduleHydration=function(t){if(t){var e=wv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<er.length&&e!==0&&e<er[n].priority;n++);er.splice(n,0,t),n===0&&kv(t)}};function Tf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Nu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function rg(){}function wN(t,e,n,r,a){if(a){if(typeof r=="function"){var s=r;r=function(){var c=jl(i);s.call(c)}}var i=B0(e,r,t,0,null,!1,!1,"",rg);return t._reactRootContainer=i,t[Vn]=i.current,pi(t.nodeType===8?t.parentNode:t),ea(),i}for(;a=t.lastChild;)t.removeChild(a);if(typeof r=="function"){var o=r;r=function(){var c=jl(u);o.call(c)}}var u=Cf(t,0,!1,null,null,!1,!1,"",rg);return t._reactRootContainer=u,t[Vn]=u.current,pi(t.nodeType===8?t.parentNode:t),ea(function(){ku(e,u,n,r)}),u}function Su(t,e,n,r,a){var s=n._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var u=jl(i);o.call(u)}}ku(e,i,t,a)}else i=wN(n,e,t,a,r);return jl(i)}vv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Us(e.pendingLanes);n!==0&&(Wh(e,n|1),At(e,Le()),!(ce&6)&&(Ja=Le()+500,Dr()))}break;case 13:ea(function(){var r=zn(t,1);if(r!==null){var a=Et();nn(r,t,1,a)}}),If(t,1)}};Gh=function(t){if(t.tag===13){var e=zn(t,134217728);if(e!==null){var n=Et();nn(e,t,134217728,n)}If(t,134217728)}};bv=function(t){if(t.tag===13){var e=gr(t),n=zn(t,e);if(n!==null){var r=Et();nn(n,t,e,r)}If(t,e)}};wv=function(){return me};Ev=function(t,e){var n=me;try{return me=t,e()}finally{me=n}};Ed=function(t,e,n){switch(e){case"input":if(md(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var a=pu(r);if(!a)throw Error(F(90));Jy(r),md(r,a)}}}break;case"textarea":ev(t,n);break;case"select":e=n.value,e!=null&&Pa(t,!!n.multiple,e,!1)}};ov=kf;lv=ea;var EN={usingClientEntryPoint:!1,Events:[Wi,Na,pu,sv,iv,kf]},Ps={findFiberByHostInstance:zr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kN={bundleType:Ps.bundleType,version:Ps.version,rendererPackageName:Ps.rendererPackageName,rendererConfig:Ps.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Wn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=dv(t),t===null?null:t.stateNode},findFiberByHostInstance:Ps.findFiberByHostInstance||bN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zo.isDisabled&&zo.supportsFiber)try{du=zo.inject(kN),bn=zo}catch{}}Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EN;Vt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tf(e))throw Error(F(200));return vN(t,e,null,n)};Vt.createRoot=function(t,e){if(!Tf(t))throw Error(F(299));var n=!1,r="",a=$0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Cf(t,1,!1,null,null,n,!1,r,a),t[Vn]=e.current,pi(t.nodeType===8?t.parentNode:t),new _f(e)};Vt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(F(188)):(t=Object.keys(t).join(","),Error(F(268,t)));return t=dv(e),t=t===null?null:t.stateNode,t};Vt.flushSync=function(t){return ea(t)};Vt.hydrate=function(t,e,n){if(!Nu(e))throw Error(F(200));return Su(null,t,e,!0,n)};Vt.hydrateRoot=function(t,e,n){if(!Tf(t))throw Error(F(405));var r=n!=null&&n.hydratedSources||null,a=!1,s="",i=$0;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=B0(e,null,t,1,n??null,a,!1,s,i),t[Vn]=e.current,pi(t),r)for(t=0;t<r.length;t++)n=r[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new xu(e)};Vt.render=function(t,e,n){if(!Nu(e))throw Error(F(200));return Su(null,t,e,!1,n)};Vt.unmountComponentAtNode=function(t){if(!Nu(t))throw Error(F(40));return t._reactRootContainer?(ea(function(){Su(null,null,t,!1,function(){t._reactRootContainer=null,t[Vn]=null})}),!0):!1};Vt.unstable_batchedUpdates=kf;Vt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Nu(n))throw Error(F(200));if(t==null||t._reactInternals===void 0)throw Error(F(38));return Su(t,e,n,!1,r)};Vt.version="18.3.1-next-f1338f8080-20240426";function H0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(H0)}catch(t){console.error(t)}}H0(),$y.exports=Vt;var xN=$y.exports,K0,ag=xN;K0=ag.createRoot,ag.hydrateRoot;var sg={};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const W0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let a=t.charCodeAt(r);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},NN=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const a=t[n++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const s=t[n++];e[r++]=String.fromCharCode((a&31)<<6|s&63)}else if(a>239&&a<365){const s=t[n++],i=t[n++],o=t[n++],u=((a&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=t[n++],i=t[n++];e[r++]=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63)}}return e.join("")},G0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<t.length;a+=3){const s=t[a],i=a+1<t.length,o=i?t[a+1]:0,u=a+2<t.length,c=u?t[a+2]:0,d=s>>2,h=(s&3)<<4|o>>4;let f=(o&15)<<2|c>>6,g=c&63;u||(g=64,i||(f=64)),r.push(n[d],n[h],n[f],n[g])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(W0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):NN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<t.length;){const s=n[t.charAt(a++)],i=a<t.length?n[t.charAt(a)]:0;++a;const o=a<t.length?n[t.charAt(a)]:64;++a;const u=a<t.length?n[t.charAt(a)]:64;if(++a,s==null||i==null||o==null||u==null)throw new SN;const c=s<<2|i>>4;if(r.push(c),o!==64){const d=i<<4&240|o>>2;if(r.push(d),u!==64){const h=o<<6&192|u;r.push(h)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class SN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const CN=function(t){const e=W0(t);return G0.encodeByteArray(e,!0)},ql=function(t){return CN(t).replace(/\./g,"")},Q0=function(t){try{return G0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function IN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const _N=()=>IN().__FIREBASE_DEFAULTS__,TN=()=>{if(typeof process>"u"||typeof sg>"u")return;const t=sg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},DN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Q0(t[1]);return e&&JSON.parse(e)},Df=()=>{try{return _N()||TN()||DN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Y0=t=>{var e,n;return(n=(e=Df())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},AN=t=>{const e=Y0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},X0=()=>{var t;return(t=Df())===null||t===void 0?void 0:t.config},J0=t=>{var e;return(e=Df())===null||e===void 0?void 0:e[`_${t}`]};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class RN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function PN(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",a=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ql(JSON.stringify(n)),ql(JSON.stringify(i)),""].join(".")}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function gt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ON(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gt())}function LN(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function MN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function FN(){const t=gt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function UN(){try{return typeof indexedDB=="object"}catch{return!1}}function VN(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var s;e(((s=a.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const zN="FirebaseError";class Gn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=zN,Object.setPrototypeOf(this,Gn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qi.prototype.create)}}class Qi{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},a=`${this.service}/${e}`,s=this.errors[e],i=s?jN(s,r):"Error",o=`${this.serviceName}: ${i} (${a}).`;return new Gn(a,o,r)}}function jN(t,e){return t.replace(qN,(n,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const qN=/\{\$([^}]+)}/g;function BN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Bl(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const a of n){if(!r.includes(a))return!1;const s=t[a],i=e[a];if(ig(s)&&ig(i)){if(!Bl(s,i))return!1}else if(s!==i)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function ig(t){return t!==null&&typeof t=="object"}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Yi(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function zs(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[r,a]=n.split("=");e[decodeURIComponent(r)]=decodeURIComponent(a)}}),e}function js(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function $N(t,e){const n=new HN(t,e);return n.subscribe.bind(n)}class HN{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let a;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");KN(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:r},a.next===void 0&&(a.next=Mc),a.error===void 0&&(a.error=Mc),a.complete===void 0&&(a.complete=Mc);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function KN(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Mc(){}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Me(t){return t&&t._delegate?t._delegate:t}class ta{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Vr="[DEFAULT]";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class WN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new RN;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(a)return null;throw s}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(QN(e))try{this.getOrInitializeService({instanceIdentifier:Vr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:a});r.resolve(s)}catch{}}}}clearInstance(e=Vr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vr){return this.instances.has(e)}getOptions(e=Vr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);r===o&&i.resolve(a)}return a}onInit(e,n){var r;const a=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(a))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(a,s);const i=this.instances.get(a);return i&&e(i,a),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const a of r)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:GN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Vr){return this.component?this.component.multipleInstances?e:Vr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function GN(t){return t===Vr?void 0:t}function QN(t){return t.instantiationMode==="EAGER"}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class YN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new WN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var de;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(de||(de={}));const XN={debug:de.DEBUG,verbose:de.VERBOSE,info:de.INFO,warn:de.WARN,error:de.ERROR,silent:de.SILENT},JN=de.INFO,ZN={[de.DEBUG]:"log",[de.VERBOSE]:"log",[de.INFO]:"info",[de.WARN]:"warn",[de.ERROR]:"error"},eS=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),a=ZN[e];if(a)console[a](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Af{constructor(e){this.name=e,this._logLevel=JN,this._logHandler=eS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in de))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?XN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,de.DEBUG,...e),this._logHandler(this,de.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,de.VERBOSE,...e),this._logHandler(this,de.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,de.INFO,...e),this._logHandler(this,de.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,de.WARN,...e),this._logHandler(this,de.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,de.ERROR,...e),this._logHandler(this,de.ERROR,...e)}}const tS=(t,e)=>e.some(n=>t instanceof n);let og,lg;function nS(){return og||(og=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function rS(){return lg||(lg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Z0=new WeakMap,Zd=new WeakMap,eb=new WeakMap,Fc=new WeakMap,Rf=new WeakMap;function aS(t){const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("success",s),t.removeEventListener("error",i)},s=()=>{n(vr(t.result)),a()},i=()=>{r(t.error),a()};t.addEventListener("success",s),t.addEventListener("error",i)});return e.then(n=>{n instanceof IDBCursor&&Z0.set(n,t)}).catch(()=>{}),Rf.set(e,t),e}function sS(t){if(Zd.has(t))return;const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",i),t.removeEventListener("abort",i)},s=()=>{n(),a()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",s),t.addEventListener("error",i),t.addEventListener("abort",i)});Zd.set(t,e)}let eh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Zd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||eb.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function iS(t){eh=t(eh)}function oS(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Uc(this),e,...n);return eb.set(r,e.sort?e.sort():[e]),vr(r)}:rS().includes(t)?function(...e){return t.apply(Uc(this),e),vr(Z0.get(this))}:function(...e){return vr(t.apply(Uc(this),e))}}function lS(t){return typeof t=="function"?oS(t):(t instanceof IDBTransaction&&sS(t),tS(t,nS())?new Proxy(t,eh):t)}function vr(t){if(t instanceof IDBRequest)return aS(t);if(Fc.has(t))return Fc.get(t);const e=lS(t);return e!==t&&(Fc.set(t,e),Rf.set(e,t)),e}const Uc=t=>Rf.get(t);function uS(t,e,{blocked:n,upgrade:r,blocking:a,terminated:s}={}){const i=indexedDB.open(t,e),o=vr(i);return r&&i.addEventListener("upgradeneeded",u=>{r(vr(i.result),u.oldVersion,u.newVersion,vr(i.transaction),u)}),n&&i.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),o.then(u=>{s&&u.addEventListener("close",()=>s()),a&&u.addEventListener("versionchange",c=>a(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const cS=["get","getKey","getAll","getAllKeys","count"],dS=["put","add","delete","clear"],Vc=new Map;function ug(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Vc.get(e))return Vc.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,a=dS.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(a||cS.includes(n)))return;const s=async function(i,...o){const u=this.transaction(i,a?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(o.shift())),(await Promise.all([c[n](...o),a&&u.done]))[0]};return Vc.set(e,s),s}iS(t=>({...t,get:(e,n,r)=>ug(e,n)||t.get(e,n,r),has:(e,n)=>!!ug(e,n)||t.has(e,n)}));/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class hS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(fS(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function fS(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const th="@firebase/app",cg="0.9.13";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const na=new Af("@firebase/app"),mS="@firebase/app-compat",pS="@firebase/analytics-compat",gS="@firebase/analytics",yS="@firebase/app-check-compat",vS="@firebase/app-check",bS="@firebase/auth",wS="@firebase/auth-compat",ES="@firebase/database",kS="@firebase/database-compat",xS="@firebase/functions",NS="@firebase/functions-compat",SS="@firebase/installations",CS="@firebase/installations-compat",IS="@firebase/messaging",_S="@firebase/messaging-compat",TS="@firebase/performance",DS="@firebase/performance-compat",AS="@firebase/remote-config",RS="@firebase/remote-config-compat",PS="@firebase/storage",OS="@firebase/storage-compat",LS="@firebase/firestore",MS="@firebase/firestore-compat",FS="firebase",US="9.23.0";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const nh="[DEFAULT]",VS={[th]:"fire-core",[mS]:"fire-core-compat",[gS]:"fire-analytics",[pS]:"fire-analytics-compat",[vS]:"fire-app-check",[yS]:"fire-app-check-compat",[bS]:"fire-auth",[wS]:"fire-auth-compat",[ES]:"fire-rtdb",[kS]:"fire-rtdb-compat",[xS]:"fire-fn",[NS]:"fire-fn-compat",[SS]:"fire-iid",[CS]:"fire-iid-compat",[IS]:"fire-fcm",[_S]:"fire-fcm-compat",[TS]:"fire-perf",[DS]:"fire-perf-compat",[AS]:"fire-rc",[RS]:"fire-rc-compat",[PS]:"fire-gcs",[OS]:"fire-gcs-compat",[LS]:"fire-fst",[MS]:"fire-fst-compat","fire-js":"fire-js",[FS]:"fire-js-all"};/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const $l=new Map,rh=new Map;function zS(t,e){try{t.container.addComponent(e)}catch(n){na.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Za(t){const e=t.name;if(rh.has(e))return na.debug(`There were multiple attempts to register component ${e}.`),!1;rh.set(e,t);for(const n of $l.values())zS(n,t);return!0}function Pf(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const jS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},br=new Qi("app","Firebase",jS);/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qS{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ta("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw br.create("app-deleted",{appName:this._name})}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ms=US;function tb(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:nh,automaticDataCollectionEnabled:!1},e),a=r.name;if(typeof a!="string"||!a)throw br.create("bad-app-name",{appName:String(a)});if(n||(n=X0()),!n)throw br.create("no-options");const s=$l.get(a);if(s){if(Bl(n,s.options)&&Bl(r,s.config))return s;throw br.create("duplicate-app",{appName:a})}const i=new YN(a);for(const u of rh.values())i.addComponent(u);const o=new qS(n,r,i);return $l.set(a,o),o}function nb(t=nh){const e=$l.get(t);if(!e&&t===nh&&X0())return tb();if(!e)throw br.create("no-app",{appName:t});return e}function wr(t,e,n){var r;let a=(r=VS[t])!==null&&r!==void 0?r:t;n&&(a+=`-${n}`);const s=a.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${a}" with version "${e}":`];s&&o.push(`library name "${a}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),na.warn(o.join(" "));return}Za(new ta(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const BS="firebase-heartbeat-database",$S=1,Ni="firebase-heartbeat-store";let zc=null;function rb(){return zc||(zc=uS(BS,$S,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ni)}}}).catch(t=>{throw br.create("idb-open",{originalErrorMessage:t.message})})),zc}async function HS(t){try{return await(await rb()).transaction(Ni).objectStore(Ni).get(ab(t))}catch(e){if(e instanceof Gn)na.warn(e.message);else{const n=br.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});na.warn(n.message)}}}async function dg(t,e){try{const n=(await rb()).transaction(Ni,"readwrite");await n.objectStore(Ni).put(e,ab(t)),await n.done}catch(n){if(n instanceof Gn)na.warn(n.message);else{const r=br.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});na.warn(r.message)}}}function ab(t){return`${t.name}!${t.options.appId}`}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const KS=1024,WS=30*24*60*60*1e3;class GS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new YS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=hg();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(r=>r.date===n)))return this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const a=new Date(r.date).valueOf();return Date.now()-a<=WS}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=hg(),{heartbeatsToSend:n,unsentEntries:r}=QS(this._heartbeatsCache.heartbeats),a=ql(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}}function hg(){return new Date().toISOString().substring(0,10)}function QS(t,e=KS){const n=[];let r=t.slice();for(const a of t){const s=n.find(i=>i.agent===a.agent);if(s){if(s.dates.push(a.date),fg(n)>e){s.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),fg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class YS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return UN()?VN().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await HS(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return dg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return dg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function fg(t){return ql(JSON.stringify({version:2,heartbeats:t})).length}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function XS(t){Za(new ta("platform-logger",e=>new hS(e),"PRIVATE")),Za(new ta("heartbeat",e=>new GS(e),"PRIVATE")),wr(th,cg,t),wr(th,cg,"esm2017"),wr("fire-js","")}XS("");var JS="firebase",ZS="9.23.0";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/wr(JS,ZS,"app");function Of(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}function sb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const e1=sb,ib=new Qi("auth","Firebase",sb());/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Hl=new Af("@firebase/auth");function t1(t,...e){Hl.logLevel<=de.WARN&&Hl.warn(`Auth (${ms}): ${t}`,...e)}function ul(t,...e){Hl.logLevel<=de.ERROR&&Hl.error(`Auth (${ms}): ${t}`,...e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function an(t,...e){throw Lf(t,...e)}function En(t,...e){return Lf(t,...e)}function n1(t,e,n){const r=Object.assign(Object.assign({},e1()),{[e]:n});return new Qi("auth","Firebase",r).create(e,{appName:t.name})}function Lf(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return ib.create(t,...e)}function J(t,e,...n){if(!t)throw Lf(e,...n)}function Rn(t){const e="INTERNAL ASSERTION FAILED: "+t;throw ul(e),new Error(e)}function qn(t,e){t||Rn(e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function ah(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function r1(){return mg()==="http:"||mg()==="https:"}function mg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function a1(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(r1()||LN()||"connection"in navigator)?navigator.onLine:!0}function s1(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Xi{constructor(e,n){this.shortDelay=e,this.longDelay=n,qn(n>e,"Short delay should be less than long delay!"),this.isMobile=ON()||MN()}get(){return a1()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Mf(t,e){qn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ob{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;Rn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;Rn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;Rn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const i1={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const o1=new Xi(3e4,6e4);function Ji(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function ps(t,e,n,r,a={}){return lb(t,a,async()=>{let s={},i={};r&&(e==="GET"?i=r:s={body:JSON.stringify(r)});const o=Yi(Object.assign({key:t.config.apiKey},i)).slice(1),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),ob.fetch()(ub(t,t.config.apiHost,n,o),Object.assign({method:e,headers:u,referrerPolicy:"no-referrer"},s))})}async function lb(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},i1),e);try{const a=new l1(t),s=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const i=await s.json();if("needConfirmation"in i)throw jo(t,"account-exists-with-different-credential",i);if(s.ok&&!("errorMessage"in i))return i;{const o=s.ok?i.errorMessage:i.error.message,[u,c]=o.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw jo(t,"credential-already-in-use",i);if(u==="EMAIL_EXISTS")throw jo(t,"email-already-in-use",i);if(u==="USER_DISABLED")throw jo(t,"user-disabled",i);const d=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw n1(t,d,c);an(t,d)}}catch(a){if(a instanceof Gn)throw a;an(t,"network-request-failed",{message:String(a)})}}async function Cu(t,e,n,r,a={}){const s=await ps(t,e,n,r,a);return"mfaPendingCredential"in s&&an(t,"multi-factor-auth-required",{_serverResponse:s}),s}function ub(t,e,n,r){const a=`${e}${n}?${r}`;return t.config.emulator?Mf(t.config,a):`${t.config.apiScheme}://${a}`}class l1{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(En(this.auth,"network-request-failed")),o1.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function jo(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const a=En(t,e,r);return a.customData._tokenResponse=n,a}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function u1(t,e){return ps(t,"POST","/v1/accounts:delete",e)}async function c1(t,e){return ps(t,"POST","/v1/accounts:lookup",e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function ni(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function d1(t,e=!1){const n=Me(t),r=await n.getIdToken(e),a=Ff(r);J(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const s=typeof a.firebase=="object"?a.firebase:void 0,i=s==null?void 0:s.sign_in_provider;return{claims:a,token:r,authTime:ni(jc(a.auth_time)),issuedAtTime:ni(jc(a.iat)),expirationTime:ni(jc(a.exp)),signInProvider:i||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function jc(t){return Number(t)*1e3}function Ff(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return ul("JWT malformed, contained fewer than 3 sections"),null;try{const a=Q0(n);return a?JSON.parse(a):(ul("Failed to decode base64 JWT payload"),null)}catch(a){return ul("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function h1(t){const e=Ff(t);return J(e,"internal-error"),J(typeof e.exp<"u","internal-error"),J(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function Si(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Gn&&f1(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function f1({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class m1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class cb{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ni(this.lastLoginAt),this.creationTime=ni(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function Kl(t){var e;const n=t.auth,r=await t.getIdToken(),a=await Si(t,c1(n,{idToken:r}));J(a==null?void 0:a.users.length,n,"internal-error");const s=a.users[0];t._notifyReloadListener(s);const i=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?y1(s.providerUserInfo):[],o=g1(t.providerData,i),u=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=u?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new cb(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function p1(t){const e=Me(t);await Kl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function g1(t,e){return[...t.filter(n=>!e.some(r=>r.providerId===n.providerId)),...e]}function y1(t){return t.map(e=>{var{providerId:n}=e,r=Of(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function v1(t,e){const n=await lb(t,{},async()=>{const r=Yi({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:s}=t.config,i=ub(t,a,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",ob.fetch()(i,{method:"POST",headers:o,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ci{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){J(e.idToken,"internal-error"),J(typeof e.idToken<"u","internal-error"),J(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):h1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return J(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:a,expiresIn:s}=await v1(e,n);this.updateTokensAndExpiration(r,a,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:a,expirationTime:s}=n,i=new Ci;return r&&(J(typeof r=="string","internal-error",{appName:e}),i.refreshToken=r),a&&(J(typeof a=="string","internal-error",{appName:e}),i.accessToken=a),s&&(J(typeof s=="number","internal-error",{appName:e}),i.expirationTime=s),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ci,this.toJSON())}_performRefresh(){return Rn("not implemented")}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Yn(t,e){J(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Gr{constructor(e){var{uid:n,auth:r,stsTokenManager:a}=e,s=Of(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new m1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new cb(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Si(this,this.stsTokenManager.getToken(this.auth,e));return J(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return d1(this,e)}reload(){return p1(this)}_assign(e){this!==e&&(J(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Gr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){J(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Kl(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Si(this,u1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,a,s,i,o,u,c,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(a=n.email)!==null&&a!==void 0?a:void 0,g=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,v=(i=n.photoURL)!==null&&i!==void 0?i:void 0,b=(o=n.tenantId)!==null&&o!==void 0?o:void 0,E=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,m=(c=n.createdAt)!==null&&c!==void 0?c:void 0,p=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:y,emailVerified:w,isAnonymous:C,providerData:M,stsTokenManager:z}=n;J(y&&z,e,"internal-error");const O=Ci.fromJSON(this.name,z);J(typeof y=="string",e,"internal-error"),Yn(h,e.name),Yn(f,e.name),J(typeof w=="boolean",e,"internal-error"),J(typeof C=="boolean",e,"internal-error"),Yn(g,e.name),Yn(v,e.name),Yn(b,e.name),Yn(E,e.name),Yn(m,e.name),Yn(p,e.name);const Q=new Gr({uid:y,auth:e,email:f,emailVerified:w,displayName:h,isAnonymous:C,photoURL:v,phoneNumber:g,tenantId:b,stsTokenManager:O,createdAt:m,lastLoginAt:p});return M&&Array.isArray(M)&&(Q.providerData=M.map(D=>Object.assign({},D))),E&&(Q._redirectEventId=E),Q}static async _fromIdTokenResponse(e,n,r=!1){const a=new Ci;a.updateFromServerResponse(n);const s=new Gr({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await Kl(s),s}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const pg=new Map;function Pn(t){qn(t instanceof Function,"Expected a class definition");let e=pg.get(t);return e?(qn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,pg.set(t,e),e)}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class db{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}db.type="NONE";const gg=db;/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function cl(t,e,n){return`firebase:${t}:${e}:${n}`}class Va{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:a,name:s}=this.auth;this.fullUserKey=cl(this.userKey,a.apiKey,s),this.fullPersistenceKey=cl("persistence",a.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Gr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Va(Pn(gg),e,r);const a=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=a[0]||Pn(gg);const i=cl(r,e.config.apiKey,e.name);let o=null;for(const c of n)try{const d=await c._get(i);if(d){const h=Gr._fromJSON(e,d);c!==s&&(o=h),s=c;break}}catch{}const u=a.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new Va(s,e,r):(s=u[0],o&&await s._set(i,o.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(i)}catch{}})),new Va(s,e,r))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function yg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(mb(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(hb(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gb(e))return"Blackberry";if(yb(e))return"Webos";if(Uf(e))return"Safari";if((e.includes("chrome/")||fb(e))&&!e.includes("edge/"))return"Chrome";if(pb(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function hb(t=gt()){return/firefox\//i.test(t)}function Uf(t=gt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fb(t=gt()){return/crios\//i.test(t)}function mb(t=gt()){return/iemobile/i.test(t)}function pb(t=gt()){return/android/i.test(t)}function gb(t=gt()){return/blackberry/i.test(t)}function yb(t=gt()){return/webos/i.test(t)}function Iu(t=gt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function b1(t=gt()){var e;return Iu(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function w1(){return FN()&&document.documentMode===10}function vb(t=gt()){return Iu(t)||pb(t)||yb(t)||gb(t)||/windows phone/i.test(t)||mb(t)}function E1(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function bb(t,e=[]){let n;switch(t){case"Browser":n=yg(gt());break;case"Worker":n=`${yg(gt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ms}/${r}`}async function wb(t,e){return ps(t,"GET","/v2/recaptchaConfig",Ji(t,e))}function vg(t){return t!==void 0&&t.enterprise!==void 0}class Eb{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(n=>n.provider==="EMAIL_PASSWORD_PROVIDER"&&n.enforcementState!=="OFF")}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function k1(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function kb(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=a=>{const s=En("internal-error");s.customData=a,n(s)},r.type="text/javascript",r.charset="UTF-8",k1().appendChild(r)})}function x1(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const N1="https://www.google.com/recaptcha/enterprise.js?render=",S1="recaptcha-enterprise",C1="NO_RECAPTCHA";class xb{constructor(e){this.type=S1,this.auth=Zi(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(i,o)=>{wb(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const c=new Eb(u);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,i(c.siteKey)}}).catch(u=>{o(u)})})}function a(s,i,o){const u=window.grecaptcha;vg(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(c=>{i(c)}).catch(()=>{i(C1)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,i)=>{r(this.auth).then(o=>{if(!n&&vg(window.grecaptcha))a(o,s,i);else{if(typeof window>"u"){i(new Error("RecaptchaVerifier is only supported in browser"));return}kb(N1+o).then(()=>{a(o,s,i)}).catch(u=>{i(u)})}}).catch(o=>{i(o)})})}}async function bg(t,e,n,r=!1){const a=new xb(t);let s;try{s=await a.verify(n)}catch{s=await a.verify(n,!0)}const i=Object.assign({},e);return r?Object.assign(i,{captchaResp:s}):Object.assign(i,{captchaResponse:s}),Object.assign(i,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(i,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),i}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class I1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((i,o)=>{try{const u=e(s);i(u)}catch(u){o(u)}});r.onAbort=n,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class _1{constructor(e,n,r,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new wg(this),this.idTokenSubscription=new wg(this),this.beforeStateQueue=new I1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ib,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Pn(n)),this._initializationPromise=this.queue(async()=>{var r,a;if(!this._deleted&&(this.persistenceManager=await Va.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let a=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,o=a==null?void 0:a._redirectEventId,u=await this.tryRedirectSignIn(e);(!i||i===o)&&u!=null&&u.user&&(a=u.user,s=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(a)}catch(i){a=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return J(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Kl(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=s1()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?Me(e):null;return n&&J(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&J(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Pn(e))})}async initializeRecaptchaConfig(){const e=await wb(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new Eb(e);this.tenantId==null?this._agentRecaptchaConfig=n:this._tenantRecaptchaConfigs[this.tenantId]=n,n.emailPasswordEnabled&&new xb(this).verify()}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Qi("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Pn(e)||this._popupRedirectResolver;J(n,this,"argument-error"),this.redirectPersistenceManager=await Va.create(this,[Pn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,a){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n),i=this._isInitialized?Promise.resolve():this._initializationPromise;return J(i,this,"internal-error"),i.then(()=>s(this.currentUser)),typeof n=="function"?e.addObserver(n,r,a):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return J(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bb(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const a=await this._getAppCheckToken();return a&&(n["X-Firebase-AppCheck"]=a),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&t1(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Zi(t){return Me(t)}class wg{constructor(e){this.auth=e,this.observer=null,this.addObserver=$N(n=>this.observer=n)}get next(){return J(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function T1(t,e){const n=Pf(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),a=n.getOptions();if(Bl(a,e??{}))return r;an(r,"already-initialized")}return n.initialize({options:e})}function D1(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Pn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function A1(t,e,n){const r=Zi(t);J(r._canInitEmulator,r,"emulator-config-failed"),J(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!1,s=Nb(e),{host:i,port:o}=R1(e),u=o===null?"":`:${o}`;r.config.emulator={url:`${s}//${i}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:i,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:a})}),P1()}function Nb(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function R1(t){const e=Nb(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const s=a[1];return{host:s,port:Eg(r.substr(s.length+1))}}else{const[s,i]=r.split(":");return{host:s,port:Eg(i)}}}function Eg(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function P1(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Vf{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Rn("not implemented")}_getIdTokenResponse(e){return Rn("not implemented")}_linkToIdToken(e,n){return Rn("not implemented")}_getReauthenticationResolver(e){return Rn("not implemented")}}async function O1(t,e){return ps(t,"POST","/v1/accounts:update",e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function qc(t,e){return Cu(t,"POST","/v1/accounts:signInWithPassword",Ji(t,e))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function L1(t,e){return Cu(t,"POST","/v1/accounts:signInWithEmailLink",Ji(t,e))}async function M1(t,e){return Cu(t,"POST","/v1/accounts:signInWithEmailLink",Ji(t,e))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ii extends Vf{constructor(e,n,r,a=null){super("password",r),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new Ii(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Ii(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&n!=null&&n.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){var n;switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(!((n=e._getRecaptchaConfig())===null||n===void 0)&&n.emailPasswordEnabled){const a=await bg(e,r,"signInWithPassword");return qc(e,a)}else return qc(e,r).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const s=await bg(e,r,"signInWithPassword");return qc(e,s)}else return Promise.reject(a)});case"emailLink":return L1(e,{email:this._email,oobCode:this._password});default:an(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return O1(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return M1(e,{idToken:n,email:this._email,oobCode:this._password});default:an(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function za(t,e){return Cu(t,"POST","/v1/accounts:signInWithIdp",Ji(t,e))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const F1="http://localhost";class ra extends Vf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ra(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):an("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a}=n,s=Of(n,["providerId","signInMethod"]);if(!r||!a)return null;const i=new ra(r,a);return i.idToken=s.idToken||void 0,i.accessToken=s.accessToken||void 0,i.secret=s.secret,i.nonce=s.nonce,i.pendingToken=s.pendingToken||null,i}_getIdTokenResponse(e){const n=this.buildRequest();return za(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,za(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,za(e,n)}buildRequest(){const e={requestUri:F1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Yi(n)}return e}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function U1(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function V1(t){const e=zs(js(t)).link,n=e?zs(js(e)).deep_link_id:null,r=zs(js(t)).deep_link_id;return(r?zs(js(r)).link:null)||r||n||e||t}class zf{constructor(e){var n,r,a,s,i,o;const u=zs(js(e)),c=(n=u.apiKey)!==null&&n!==void 0?n:null,d=(r=u.oobCode)!==null&&r!==void 0?r:null,h=U1((a=u.mode)!==null&&a!==void 0?a:null);J(c&&d&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=d,this.continueUrl=(s=u.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(i=u.languageCode)!==null&&i!==void 0?i:null,this.tenantId=(o=u.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const n=V1(e);try{return new zf(n)}catch{return null}}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class gs{constructor(){this.providerId=gs.PROVIDER_ID}static credential(e,n){return Ii._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=zf.parseLink(n);return J(r,"argument-error"),Ii._fromEmailAndCode(e,r.code,r.tenantId)}}gs.PROVIDER_ID="password";gs.EMAIL_PASSWORD_SIGN_IN_METHOD="password";gs.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Sb{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class eo extends Sb{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class nr extends eo{constructor(){super("facebook.com")}static credential(e){return ra._fromParams({providerId:nr.PROVIDER_ID,signInMethod:nr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nr.credentialFromTaggedObject(e)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return nr.credential(e.oauthAccessToken)}catch{return null}}}nr.FACEBOOK_SIGN_IN_METHOD="facebook.com";nr.PROVIDER_ID="facebook.com";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class rr extends eo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ra._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return rr.credential(n,r)}catch{return null}}}rr.GOOGLE_SIGN_IN_METHOD="google.com";rr.PROVIDER_ID="google.com";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ar extends eo{constructor(){super("github.com")}static credential(e){return ra._fromParams({providerId:ar.PROVIDER_ID,signInMethod:ar.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ar.credentialFromTaggedObject(e)}static credentialFromError(e){return ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ar.credential(e.oauthAccessToken)}catch{return null}}}ar.GITHUB_SIGN_IN_METHOD="github.com";ar.PROVIDER_ID="github.com";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class sr extends eo{constructor(){super("twitter.com")}static credential(e,n){return ra._fromParams({providerId:sr.PROVIDER_ID,signInMethod:sr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return sr.credentialFromTaggedObject(e)}static credentialFromError(e){return sr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return sr.credential(n,r)}catch{return null}}}sr.TWITTER_SIGN_IN_METHOD="twitter.com";sr.PROVIDER_ID="twitter.com";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class es{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,a=!1){const s=await Gr._fromIdTokenResponse(e,r,a),i=kg(r);return new es({user:s,providerId:i,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const a=kg(r);return new es({user:e,providerId:a,_tokenResponse:r,operationType:n})}}function kg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Wl extends Gn{constructor(e,n,r,a){var s;super(n.code,n.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,Wl.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,a){return new Wl(e,n,r,a)}}function Cb(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Wl._fromErrorAndOperation(t,a,e,r):a})}async function z1(t,e,n=!1){const r=await Si(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return es._forOperation(t,"link",r)}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function j1(t,e,n=!1){const{auth:r}=t,a="reauthenticate";try{const s=await Si(t,Cb(r,a,e,t),n);J(s.idToken,r,"internal-error");const i=Ff(s.idToken);J(i,r,"internal-error");const{sub:o}=i;return J(t.uid===o,r,"user-mismatch"),es._forOperation(t,a,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&an(r,"user-mismatch"),s}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function Ib(t,e,n=!1){const r="signIn",a=await Cb(t,r,e),s=await es._fromIdTokenResponse(t,r,a);return n||await t._updateCurrentUser(s.user),s}async function q1(t,e){return Ib(Zi(t),e)}function B1(t,e,n){return q1(Me(t),gs.credential(e,n))}function $1(t,e,n,r){return Me(t).onIdTokenChanged(e,n,r)}function H1(t,e,n){return Me(t).beforeAuthStateChanged(e,n)}function K1(t,e,n,r){return Me(t).onAuthStateChanged(e,n,r)}function dl(t){return Me(t).signOut()}const Gl="__sak";/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class _b{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Gl,"1"),this.storage.removeItem(Gl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function W1(){const t=gt();return Uf(t)||Iu(t)}const G1=1e3,Q1=10;class Tb extends _b{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=W1()&&E1(),this.fallbackToPolling=vb(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),a=this.localCache[n];r!==a&&e(n,a,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((i,o,u)=>{this.notifyListeners(i,u)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(r);if(e.newValue!==i)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const a=()=>{const i=this.storage.getItem(r);!n&&this.localCache[r]===i||this.notifyListeners(r,i)},s=this.storage.getItem(r);w1()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Q1):a()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},G1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Tb.type="LOCAL";const Y1=Tb;/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Db extends _b{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Db.type="SESSION";const Ab=Db;/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function X1(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class _u{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const r=new _u(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:a,data:s}=n.data,i=this.handlersMap[a];if(!(i!=null&&i.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const o=Array.from(i).map(async c=>c(n.origin,s)),u=await X1(o);n.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_u.receivers=[];/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function jf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class J1{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let s,i;return new Promise((o,u)=>{const c=jf("",20);a.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},r);i={messageChannel:a,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(f.data.response);break;default:clearTimeout(d),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(i),a.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[a.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function kn(){return window}function Z1(t){kn().location.href=t}/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Rb(){return typeof kn().WorkerGlobalScope<"u"&&typeof kn().importScripts=="function"}async function eC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function nC(){return Rb()?self:null}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Pb="firebaseLocalStorageDb",rC=1,Ql="firebaseLocalStorage",Ob="fbase_key";class to{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Tu(t,e){return t.transaction([Ql],e?"readwrite":"readonly").objectStore(Ql)}function aC(){const t=indexedDB.deleteDatabase(Pb);return new to(t).toPromise()}function sh(){const t=indexedDB.open(Pb,rC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ql,{keyPath:Ob})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ql)?e(r):(r.close(),await aC(),e(await sh()))})})}async function xg(t,e,n){const r=Tu(t,!0).put({[Ob]:e,value:n});return new to(r).toPromise()}async function sC(t,e){const n=Tu(t,!1).get(e),r=await new to(n).toPromise();return r===void 0?null:r.value}function Ng(t,e){const n=Tu(t,!0).delete(e);return new to(n).toPromise()}const iC=800,oC=3;class Lb{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await sh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>oC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Rb()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_u._getInstance(nC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await eC(),!this.activeServiceWorker)return;this.sender=new J1(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await sh();return await xg(e,Gl,"1"),await Ng(e,Gl),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>xg(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>sC(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ng(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const s=Tu(a,!1).getAll();return new to(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:a,value:s}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(s)&&(this.notifyListeners(a,s),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),iC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Lb.type="LOCAL";const lC=Lb;new Xi(3e4,6e4);/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function uC(t,e){return e?Pn(e):(J(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qf extends Vf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return za(e,this._buildIdpRequest())}_linkToIdToken(e,n){return za(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return za(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function cC(t){return Ib(t.auth,new qf(t),t.bypassAuthState)}function dC(t){const{auth:e,user:n}=t;return J(n,e,"internal-error"),j1(n,new qf(t),t.bypassAuthState)}async function hC(t){const{auth:e,user:n}=t;return J(n,e,"internal-error"),z1(n,new qf(t),t.bypassAuthState)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Mb{constructor(e,n,r,a,s=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:a,tenantId:s,error:i,type:o}=e;if(i){this.reject(i);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return cC;case"linkViaPopup":case"linkViaRedirect":return hC;case"reauthViaPopup":case"reauthViaRedirect":return dC;default:an(this.auth,"internal-error")}}resolve(e){qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){qn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const fC=new Xi(2e3,1e4);class Aa extends Mb{constructor(e,n,r,a,s){super(e,n,a,s),this.provider=r,this.authWindow=null,this.pollId=null,Aa.currentPopupAction&&Aa.currentPopupAction.cancel(),Aa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return J(e,this.auth,"internal-error"),e}async onExecution(){qn(this.filter.length===1,"Popup operations only handle one event");const e=jf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(En(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(En(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Aa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(En(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,fC.get())};e()}}Aa.currentPopupAction=null;/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const mC="pendingRedirect",hl=new Map;class pC extends Mb{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=hl.get(this.auth._key());if(!e){try{const n=await gC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(n){e=()=>Promise.reject(n)}hl.set(this.auth._key(),e)}return this.bypassAuthState||hl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function gC(t,e){const n=bC(e),r=vC(t);if(!await r._isAvailable())return!1;const a=await r._get(n)==="true";return await r._remove(n),a}function yC(t,e){hl.set(t._key(),e)}function vC(t){return Pn(t._redirectPersistence)}function bC(t){return cl(mC,t.config.apiKey,t.name)}async function wC(t,e,n=!1){const r=Zi(t),a=uC(r,e),s=await new pC(r,a,n).execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const EC=10*60*1e3;class kC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!xC(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Fb(e)){const a=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(En(this.auth,a))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EC&&this.cachedEventUids.clear(),this.cachedEventUids.has(Sg(e))}saveEventToCache(e){this.cachedEventUids.add(Sg(e)),this.lastProcessedEventTime=Date.now()}}function Sg(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Fb({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function xC(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Fb(t);default:return!1}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function NC(t,e={}){return ps(t,"GET","/v1/projects",e)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const SC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,CC=/^https?/;async function IC(t){if(t.config.emulator)return;const{authorizedDomains:e}=await NC(t);for(const n of e)try{if(_C(n))return}catch{}an(t,"unauthorized-domain")}function _C(t){const e=ah(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&s.hostname===r}if(!CC.test(n))return!1;if(SC.test(t))return r===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const TC=new Xi(3e4,6e4);function Cg(){const t=kn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function DC(t){return new Promise((e,n)=>{var r,a,s;function i(){Cg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Cg(),n(En(t,"network-request-failed"))},timeout:TC.get()})}if(!((a=(r=kn().gapi)===null||r===void 0?void 0:r.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((s=kn().gapi)===null||s===void 0)&&s.load)i();else{const o=x1("iframefcb");return kn()[o]=()=>{gapi.load?i():n(En(t,"network-request-failed"))},kb(`https://apis.google.com/js/api.js?onload=${o}`).catch(u=>n(u))}}).catch(e=>{throw fl=null,e})}let fl=null;function AC(t){return fl=fl||DC(t),fl}/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const RC=new Xi(5e3,15e3),PC="__/auth/iframe",OC="emulator/auth/iframe",LC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},MC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function FC(t){const e=t.config;J(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Mf(e,OC):`https://${t.config.authDomain}/${PC}`,r={apiKey:e.apiKey,appName:t.name,v:ms},a=MC.get(t.config.apiHost);a&&(r.eid=a);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Yi(r).slice(1)}`}async function UC(t){const e=await AC(t),n=kn().gapi;return J(n,t,"internal-error"),e.open({where:document.body,url:FC(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:LC,dontclear:!0},r=>new Promise(async(a,s)=>{await r.restyle({setHideOnLeave:!1});const i=En(t,"network-request-failed"),o=kn().setTimeout(()=>{s(i)},RC.get());function u(){kn().clearTimeout(o),a(r)}r.ping(u).then(u,()=>{s(i)})}))}/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const VC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},zC=500,jC=600,qC="_blank",BC="http://localhost";class Ig{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function $C(t,e,n,r=zC,a=jC){const s=Math.max((window.screen.availHeight-a)/2,0).toString(),i=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const u=Object.assign(Object.assign({},VC),{width:r.toString(),height:a.toString(),top:s,left:i}),c=gt().toLowerCase();n&&(o=fb(c)?qC:n),hb(c)&&(e=e||BC,u.scrollbars="yes");const d=Object.entries(u).reduce((f,[g,v])=>`${f}${g}=${v},`,"");if(b1(c)&&o!=="_self")return HC(e||"",o),new Ig(null);const h=window.open(e||"",o,d);J(h,t,"popup-blocked");try{h.focus()}catch{}return new Ig(h)}function HC(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const KC="__/auth/handler",WC="emulator/auth/handler",GC=encodeURIComponent("fac");async function _g(t,e,n,r,a,s){J(t.config.authDomain,t,"auth-domain-config-required"),J(t.config.apiKey,t,"invalid-api-key");const i={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ms,eventId:a};if(e instanceof Sb){e.setDefaultLanguage(t.languageCode),i.providerId=e.providerId||"",BN(e.getCustomParameters())||(i.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))i[d]=h}if(e instanceof eo){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(i.scopes=d.join(","))}t.tenantId&&(i.tid=t.tenantId);const o=i;for(const d of Object.keys(o))o[d]===void 0&&delete o[d];const u=await t._getAppCheckToken(),c=u?`#${GC}=${encodeURIComponent(u)}`:"";return`${QC(t)}?${Yi(o).slice(1)}${c}`}function QC({config:t}){return t.emulator?Mf(t,WC):`https://${t.authDomain}/${KC}`}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Bc="webStorageSupport";class YC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ab,this._completeRedirectFn=wC,this._overrideRedirectResult=yC}async _openPopup(e,n,r,a){var s;qn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const i=await _g(e,n,r,ah(),a);return $C(e,i,jf())}async _openRedirect(e,n,r,a){await this._originValidation(e);const s=await _g(e,n,r,ah(),a);return Z1(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:s}=this.eventManagers[n];return a?Promise.resolve(a):(qn(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await UC(e),r=new kC(e);return n.register("authEvent",a=>(J(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Bc,{type:Bc},r=>{var a;const s=(a=r==null?void 0:r[0])===null||a===void 0?void 0:a[Bc];s!==void 0&&n(!!s),an(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=IC(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return vb()||Uf()||Iu()}}const XC=YC;var Tg="@firebase/auth",Dg="0.23.2";/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class JC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){J(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function ZC(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function eI(t){Za(new ta("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=r.options;J(i&&!i.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bb(t)},c=new _1(r,a,s,u);return D1(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Za(new ta("auth-internal",e=>{const n=Zi(e.getProvider("auth").getImmediate());return(r=>new JC(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),wr(Tg,Dg,ZC(t)),wr(Tg,Dg,"esm2017")}/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const tI=5*60,nI=J0("authIdTokenMaxAge")||tI;let Ag=null;const rI=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>nI)return;const a=n==null?void 0:n.token;Ag!==a&&(Ag=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function aI(t=nb()){const e=Pf(t,"auth");if(e.isInitialized())return e.getImmediate();const n=T1(t,{popupRedirectResolver:XC,persistence:[lC,Y1,Ab]}),r=J0("authTokenSyncURL");if(r){const s=rI(r);H1(n,s,()=>s(n.currentUser)),$1(n,i=>s(i))}const a=Y0("auth");return a&&A1(n,`http://${a}`),n}eI("Browser");var sI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},B,Bf=Bf||{},Z=sI||self;function Du(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Au(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function iI(t,e,n){return t.call.apply(t.bind,arguments)}function oI(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var a=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(a,r),t.apply(e,a)}}return function(){return t.apply(e,arguments)}}function dt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?dt=iI:dt=oI,dt.apply(null,arguments)}function qo(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Ye(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,a,s){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[a].apply(r,i)}}function Ar(){this.s=this.s,this.o=this.o}var lI=0;Ar.prototype.s=!1;Ar.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),lI!=0)};Ar.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ub=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function $f(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Rg(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Du(r)){const a=t.length||0,s=r.length||0;t.length=a+s;for(let i=0;i<s;i++)t[a+i]=r[i]}else t.push(r)}}function ht(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}ht.prototype.h=function(){this.defaultPrevented=!0};var uI=function(){if(!Z.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Z.addEventListener("test",()=>{},e),Z.removeEventListener("test",()=>{},e)}catch{}return t}();function _i(t){return/^[\s\xa0]*$/.test(t)}function Ru(){var t=Z.navigator;return t&&(t=t.userAgent)?t:""}function gn(t){return Ru().indexOf(t)!=-1}function Hf(t){return Hf[" "](t),t}Hf[" "]=function(){};function cI(t,e){var n=a_;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var dI=gn("Opera"),ts=gn("Trident")||gn("MSIE"),Vb=gn("Edge"),ih=Vb||ts,zb=gn("Gecko")&&!(Ru().toLowerCase().indexOf("webkit")!=-1&&!gn("Edge"))&&!(gn("Trident")||gn("MSIE"))&&!gn("Edge"),hI=Ru().toLowerCase().indexOf("webkit")!=-1&&!gn("Edge");function jb(){var t=Z.document;return t?t.documentMode:void 0}var oh;e:{var $c="",Hc=function(){var t=Ru();if(zb)return/rv:([^\);]+)(\)|;)/.exec(t);if(Vb)return/Edge\/([\d\.]+)/.exec(t);if(ts)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(hI)return/WebKit\/(\S+)/.exec(t);if(dI)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Hc&&($c=Hc?Hc[1]:""),ts){var Kc=jb();if(Kc!=null&&Kc>parseFloat($c)){oh=String(Kc);break e}}oh=$c}var lh;if(Z.document&&ts){var fI=jb();lh=fI||parseInt(oh,10)||void 0}else lh=void 0;var mI=lh;function Ti(t,e){if(ht.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(zb){e:{try{Hf(e.nodeName);var a=!0;break e}catch{}a=!1}a||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:pI[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ti.$.h.call(this)}}Ye(Ti,ht);var pI={2:"touch",3:"pen",4:"mouse"};Ti.prototype.h=function(){Ti.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Pu="closure_listenable_"+(1e6*Math.random()|0),gI=0;function yI(t,e,n,r,a){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=a,this.key=++gI,this.fa=this.ia=!1}function Ou(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Kf(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function vI(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function qb(t){const e={};for(const n in t)e[n]=t[n];return e}const Pg="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Bb(t,e){let n,r;for(let a=1;a<arguments.length;a++){r=arguments[a];for(n in r)t[n]=r[n];for(let s=0;s<Pg.length;s++)n=Pg[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Lu(t){this.src=t,this.g={},this.h=0}Lu.prototype.add=function(t,e,n,r,a){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var i=ch(t,e,r,a);return-1<i?(e=t[i],n||(e.ia=!1)):(e=new yI(e,this.src,s,!!r,a),e.ia=n,t.push(e)),e};function uh(t,e){var n=e.type;if(n in t.g){var r=t.g[n],a=Ub(r,e),s;(s=0<=a)&&Array.prototype.splice.call(r,a,1),s&&(Ou(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function ch(t,e,n,r){for(var a=0;a<t.length;++a){var s=t[a];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return a}return-1}var Wf="closure_lm_"+(1e6*Math.random()|0),Wc={};function $b(t,e,n,r,a){if(Array.isArray(e)){for(var s=0;s<e.length;s++)$b(t,e[s],n,r,a);return null}return n=Wb(n),t&&t[Pu]?t.O(e,n,Au(r)?!!r.capture:!1,a):bI(t,e,n,!1,r,a)}function bI(t,e,n,r,a,s){if(!e)throw Error("Invalid event type");var i=Au(a)?!!a.capture:!!a,o=Qf(t);if(o||(t[Wf]=o=new Lu(t)),n=o.add(e,n,r,i,s),n.proxy)return n;if(r=wI(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)uI||(a=i),a===void 0&&(a=!1),t.addEventListener(e.toString(),r,a);else if(t.attachEvent)t.attachEvent(Kb(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function wI(){function t(n){return e.call(t.src,t.listener,n)}const e=EI;return t}function Hb(t,e,n,r,a){if(Array.isArray(e))for(var s=0;s<e.length;s++)Hb(t,e[s],n,r,a);else r=Au(r)?!!r.capture:!!r,n=Wb(n),t&&t[Pu]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=ch(s,n,r,a),-1<n&&(Ou(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Qf(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ch(e,n,r,a)),(n=-1<t?e[t]:null)&&Gf(n))}function Gf(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Pu])uh(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Kb(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Qf(e))?(uh(n,t),n.h==0&&(n.src=null,e[Wf]=null)):Ou(t)}}}function Kb(t){return t in Wc?Wc[t]:Wc[t]="on"+t}function EI(t,e){if(t.fa)t=!0;else{e=new Ti(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Gf(t),t=n.call(r,e)}return t}function Qf(t){return t=t[Wf],t instanceof Lu?t:null}var Gc="__closure_events_fn_"+(1e9*Math.random()>>>0);function Wb(t){return typeof t=="function"?t:(t[Gc]||(t[Gc]=function(e){return t.handleEvent(e)}),t[Gc])}function Qe(){Ar.call(this),this.i=new Lu(this),this.S=this,this.J=null}Ye(Qe,Ar);Qe.prototype[Pu]=!0;Qe.prototype.removeEventListener=function(t,e,n,r){Hb(this,t,e,n,r)};function tt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new ht(e,t);else if(e instanceof ht)e.target=e.target||t;else{var a=e;e=new ht(r,t),Bb(e,a)}if(a=!0,n)for(var s=n.length-1;0<=s;s--){var i=e.g=n[s];a=Bo(i,r,!0,e)&&a}if(i=e.g=t,a=Bo(i,r,!0,e)&&a,a=Bo(i,r,!1,e)&&a,n)for(s=0;s<n.length;s++)i=e.g=n[s],a=Bo(i,r,!1,e)&&a}Qe.prototype.N=function(){if(Qe.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Ou(n[r]);delete t.g[e],t.h--}}this.J=null};Qe.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Qe.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Bo(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var a=!0,s=0;s<e.length;++s){var i=e[s];if(i&&!i.fa&&i.capture==n){var o=i.listener,u=i.la||i.src;i.ia&&uh(t.i,i),a=o.call(u,r)!==!1&&a}}return a&&!r.defaultPrevented}var Yf=Z.JSON.stringify;class kI{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function xI(){var t=Xf;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class NI{constructor(){this.h=this.g=null}add(e,n){const r=Gb.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var Gb=new kI(()=>new SI,t=>t.reset());class SI{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function CI(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function II(t){Z.setTimeout(()=>{throw t},0)}let Di,Ai=!1,Xf=new NI,Qb=()=>{const t=Z.Promise.resolve(void 0);Di=()=>{t.then(_I)}};var _I=()=>{for(var t;t=xI();){try{t.h.call(t.g)}catch(n){II(n)}var e=Gb;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Ai=!1};function Mu(t,e){Qe.call(this),this.h=t||1,this.g=e||Z,this.j=dt(this.qb,this),this.l=Date.now()}Ye(Mu,Qe);B=Mu.prototype;B.ga=!1;B.T=null;B.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),tt(this,"tick"),this.ga&&(Jf(this),this.start()))}};B.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Jf(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}B.N=function(){Mu.$.N.call(this),Jf(this),delete this.g};function Zf(t,e,n){if(typeof t=="function")n&&(t=dt(t,n));else if(t&&typeof t.handleEvent=="function")t=dt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Z.setTimeout(t,e||0)}function Yb(t){t.g=Zf(()=>{t.g=null,t.i&&(t.i=!1,Yb(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class TI extends Ar{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Yb(this)}N(){super.N(),this.g&&(Z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ri(t){Ar.call(this),this.h=t,this.g={}}Ye(Ri,Ar);var Og=[];function Xb(t,e,n,r){Array.isArray(n)||(n&&(Og[0]=n.toString()),n=Og);for(var a=0;a<n.length;a++){var s=$b(e,n[a],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Jb(t){Kf(t.g,function(e,n){this.g.hasOwnProperty(n)&&Gf(e)},t),t.g={}}Ri.prototype.N=function(){Ri.$.N.call(this),Jb(this)};Ri.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Fu(){this.g=!0}Fu.prototype.Ea=function(){this.g=!1};function DI(t,e,n,r,a,s){t.info(function(){if(t.g)if(s)for(var i="",o=s.split("&"),u=0;u<o.length;u++){var c=o[u].split("=");if(1<c.length){var d=c[0];c=c[1];var h=d.split("_");i=2<=h.length&&h[1]=="type"?i+(d+"="+c+"&"):i+(d+"=redacted&")}}else i=null;else i=s;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+e+`
`+n+`
`+i})}function AI(t,e,n,r,a,s,i){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+e+`
`+n+`
`+s+" "+i})}function Ra(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+PI(t,n)+(r?" "+r:"")})}function RI(t,e){t.info(function(){return"TIMEOUT: "+e})}Fu.prototype.info=function(){};function PI(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var a=r[1];if(Array.isArray(a)&&!(1>a.length)){var s=a[0];if(s!="noop"&&s!="stop"&&s!="close")for(var i=1;i<a.length;i++)a[i]=""}}}}return Yf(n)}catch{return e}}var ua={},Lg=null;function Uu(){return Lg=Lg||new Qe}ua.Ta="serverreachability";function Zb(t){ht.call(this,ua.Ta,t)}Ye(Zb,ht);function Pi(t){const e=Uu();tt(e,new Zb(e))}ua.STAT_EVENT="statevent";function ew(t,e){ht.call(this,ua.STAT_EVENT,t),this.stat=e}Ye(ew,ht);function bt(t){const e=Uu();tt(e,new ew(e,t))}ua.Ua="timingevent";function tw(t,e){ht.call(this,ua.Ua,t),this.size=e}Ye(tw,ht);function no(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Z.setTimeout(function(){t()},e)}var Vu={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},nw={};function em(){}em.prototype.h=null;function Mg(t){return t.h||(t.h=t.i())}function rw(){}var ro={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function tm(){ht.call(this,"d")}Ye(tm,ht);function nm(){ht.call(this,"c")}Ye(nm,ht);var dh;function zu(){}Ye(zu,em);zu.prototype.g=function(){return new XMLHttpRequest};zu.prototype.i=function(){return{}};dh=new zu;function ao(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Ri(this),this.P=OI,t=ih?125:void 0,this.V=new Mu(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new aw}function aw(){this.i=null,this.g="",this.h=!1}var OI=45e3,hh={},Yl={};B=ao.prototype;B.setTimeout=function(t){this.P=t};function fh(t,e,n){t.L=1,t.v=qu(Bn(e)),t.s=n,t.S=!0,sw(t,null)}function sw(t,e){t.G=Date.now(),so(t),t.A=Bn(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),fw(n.i,"t",r),t.C=0,n=t.l.J,t.h=new aw,t.g=Ow(t.l,n?e:null,!t.s),0<t.O&&(t.M=new TI(dt(t.Pa,t,t.g),t.O)),Xb(t.U,t.g,"readystatechange",t.nb),e=t.I?qb(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),Pi(),DI(t.j,t.u,t.A,t.m,t.W,t.s)}B.nb=function(t){t=t.target;const e=this.M;e&&yn(t)==3?e.l():this.Pa(t)};B.Pa=function(t){try{if(t==this.g)e:{const d=yn(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>d)&&(d!=3||ih||this.g&&(this.h.h||this.g.ja()||zg(this.g)))){this.J||d!=4||e==7||(e==8||0>=h?Pi(3):Pi(2)),ju(this);var n=this.g.da();this.ca=n;t:if(iw(this)){var r=zg(this.g);t="";var a=r.length,s=yn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Br(this),ri(this);var i="";break t}this.h.i=new Z.TextDecoder}for(e=0;e<a;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==a-1});r.splice(0,a),this.h.g+=t,this.C=0,i=this.h.g}else i=this.g.ja();if(this.i=n==200,AI(this.j,this.u,this.A,this.m,this.W,d,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var o,u=this.g;if((o=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_i(o)){var c=o;break t}}c=null}if(n=c)Ra(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,mh(this,n);else{this.i=!1,this.o=3,bt(12),Br(this),ri(this);break e}}this.S?(ow(this,d,i),ih&&this.i&&d==3&&(Xb(this.U,this.V,"tick",this.mb),this.V.start())):(Ra(this.j,this.m,i,null),mh(this,i)),d==4&&Br(this),this.i&&!this.J&&(d==4?Dw(this.l,this):(this.i=!1,so(this)))}else t_(this.g),n==400&&0<i.indexOf("Unknown SID")?(this.o=3,bt(12)):(this.o=0,bt(13)),Br(this),ri(this)}}}catch{}finally{}};function iw(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function ow(t,e,n){let r=!0,a;for(;!t.J&&t.C<n.length;)if(a=LI(t,n),a==Yl){e==4&&(t.o=4,bt(14),r=!1),Ra(t.j,t.m,null,"[Incomplete Response]");break}else if(a==hh){t.o=4,bt(15),Ra(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else Ra(t.j,t.m,a,null),mh(t,a);iw(t)&&a!=Yl&&a!=hh&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,bt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),lm(e),e.M=!0,bt(11))):(Ra(t.j,t.m,n,"[Invalid Chunked Response]"),Br(t),ri(t))}B.mb=function(){if(this.g){var t=yn(this.g),e=this.g.ja();this.C<e.length&&(ju(this),ow(this,t,e),this.i&&t!=4&&so(this))}};function LI(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Yl:(n=Number(e.substring(n,r)),isNaN(n)?hh:(r+=1,r+n>e.length?Yl:(e=e.slice(r,r+n),t.C=r+n,e)))}B.cancel=function(){this.J=!0,Br(this)};function so(t){t.Y=Date.now()+t.P,lw(t,t.P)}function lw(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=no(dt(t.lb,t),e)}function ju(t){t.B&&(Z.clearTimeout(t.B),t.B=null)}B.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(RI(this.j,this.A),this.L!=2&&(Pi(),bt(17)),Br(this),this.o=2,ri(this)):lw(this,this.Y-t)};function ri(t){t.l.H==0||t.J||Dw(t.l,t)}function Br(t){ju(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Jf(t.V),Jb(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function mh(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||ph(n.i,t))){if(!t.K&&ph(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var a=r;if(a[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Zl(n),Hu(n);else break e;om(n),bt(18)}}else n.Fa=a[1],0<n.Fa-n.V&&37500>a[2]&&n.G&&n.A==0&&!n.v&&(n.v=no(dt(n.ib,n),6e3));if(1>=gw(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else $r(n,11)}else if((t.K||n.g==t)&&Zl(n),!_i(e))for(a=n.Ja.g.parse(e),e=0;e<a.length;e++){let c=a[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];const d=c[3];d!=null&&(n.ra=d,n.l.info("VER="+n.ra));const h=c[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const f=c[5];f!=null&&typeof f=="number"&&0<f&&(r=1.5*f,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const g=t.g;if(g){const v=g.g?g.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(v){var s=r.i;s.g||v.indexOf("spdy")==-1&&v.indexOf("quic")==-1&&v.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(rm(s,s.h),s.h=null))}if(r.F){const b=g.g?g.g.getResponseHeader("X-HTTP-Session-Id"):null;b&&(r.Da=b,Ee(r.I,r.F,b))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var i=t;if(r.wa=Pw(r,r.J?r.pa:null,r.Y),i.K){yw(r.i,i);var o=i,u=r.L;u&&o.setTimeout(u),o.B&&(ju(o),so(o)),r.g=i}else _w(r);0<n.j.length&&Ku(n)}else c[0]!="stop"&&c[0]!="close"||$r(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?$r(n,7):im(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Pi(4)}catch{}}function MI(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Du(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function FI(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Du(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function uw(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Du(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=FI(t),r=MI(t),a=r.length,s=0;s<a;s++)e.call(void 0,r[s],n&&n[s],t)}var cw=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function UI(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),a=null;if(0<=r){var s=t[n].substring(0,r);a=t[n].substring(r+1)}else s=t[n];e(s,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}function Qr(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Qr){this.h=t.h,Xl(this,t.j),this.s=t.s,this.g=t.g,Jl(this,t.m),this.l=t.l;var e=t.i,n=new Oi;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Fg(this,n),this.o=t.o}else t&&(e=String(t).match(cw))?(this.h=!1,Xl(this,e[1]||"",!0),this.s=qs(e[2]||""),this.g=qs(e[3]||"",!0),Jl(this,e[4]),this.l=qs(e[5]||"",!0),Fg(this,e[6]||"",!0),this.o=qs(e[7]||"")):(this.h=!1,this.i=new Oi(null,this.h))}Qr.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Bs(e,Ug,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Bs(e,Ug,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Bs(n,n.charAt(0)=="/"?jI:zI,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Bs(n,BI)),t.join("")};function Bn(t){return new Qr(t)}function Xl(t,e,n){t.j=n?qs(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Jl(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Fg(t,e,n){e instanceof Oi?(t.i=e,$I(t.i,t.h)):(n||(e=Bs(e,qI)),t.i=new Oi(e,t.h))}function Ee(t,e,n){t.i.set(e,n)}function qu(t){return Ee(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function qs(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Bs(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,VI),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function VI(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Ug=/[#\/\?@]/g,zI=/[#\?:]/g,jI=/[#\?]/g,qI=/[#\?@]/g,BI=/#/g;function Oi(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Rr(t){t.g||(t.g=new Map,t.h=0,t.i&&UI(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}B=Oi.prototype;B.add=function(t,e){Rr(this),this.i=null,t=ys(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function dw(t,e){Rr(t),e=ys(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function hw(t,e){return Rr(t),e=ys(t,e),t.g.has(e)}B.forEach=function(t,e){Rr(this),this.g.forEach(function(n,r){n.forEach(function(a){t.call(e,a,r,this)},this)},this)};B.ta=function(){Rr(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const a=t[r];for(let s=0;s<a.length;s++)n.push(e[r])}return n};B.Z=function(t){Rr(this);let e=[];if(typeof t=="string")hw(this,t)&&(e=e.concat(this.g.get(ys(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};B.set=function(t,e){return Rr(this),this.i=null,t=ys(this,t),hw(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};B.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function fw(t,e,n){dw(t,e),0<n.length&&(t.i=null,t.g.set(ys(t,e),$f(n)),t.h+=n.length)}B.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),i=this.Z(r);for(r=0;r<i.length;r++){var a=s;i[r]!==""&&(a+="="+encodeURIComponent(String(i[r]))),t.push(a)}}return this.i=t.join("&")};function ys(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function $I(t,e){e&&!t.j&&(Rr(t),t.i=null,t.g.forEach(function(n,r){var a=r.toLowerCase();r!=a&&(dw(this,r),fw(this,a,n))},t)),t.j=e}var HI=class{constructor(t,e){this.g=t,this.map=e}};function mw(t){this.l=t||KI,Z.PerformanceNavigationTiming?(t=Z.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Z.g&&Z.g.Ka&&Z.g.Ka()&&Z.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var KI=10;function pw(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function gw(t){return t.h?1:t.g?t.g.size:0}function ph(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function rm(t,e){t.g?t.g.add(e):t.h=e}function yw(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}mw.prototype.cancel=function(){if(this.i=vw(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function vw(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return $f(t.i)}var WI=class{stringify(t){return Z.JSON.stringify(t,void 0)}parse(t){return Z.JSON.parse(t,void 0)}};function GI(){this.g=new WI}function QI(t,e,n){const r=n||"";try{uw(t,function(a,s){let i=a;Au(a)&&(i=Yf(a)),e.push(r+s+"="+encodeURIComponent(i))})}catch(a){throw e.push(r+"type="+encodeURIComponent("_badmap")),a}}function YI(t,e){const n=new Fu;if(Z.Image){const r=new Image;r.onload=qo($o,n,r,"TestLoadImage: loaded",!0,e),r.onerror=qo($o,n,r,"TestLoadImage: error",!1,e),r.onabort=qo($o,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=qo($o,n,r,"TestLoadImage: timeout",!1,e),Z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function $o(t,e,n,r,a){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,a(r)}catch{}}function io(t){this.l=t.fc||null,this.j=t.ob||!1}Ye(io,em);io.prototype.g=function(){return new Bu(this.l,this.j)};io.prototype.i=function(t){return function(){return t}}({});function Bu(t,e){Qe.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=am,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ye(Bu,Qe);var am=0;B=Bu.prototype;B.open=function(t,e){if(this.readyState!=am)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Li(this)};B.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};B.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,oo(this)),this.readyState=am};B.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Li(this)),this.g&&(this.readyState=3,Li(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Z.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;bw(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function bw(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}B.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?oo(this):Li(this),this.readyState==3&&bw(this)}};B.Za=function(t){this.g&&(this.response=this.responseText=t,oo(this))};B.Ya=function(t){this.g&&(this.response=t,oo(this))};B.ka=function(){this.g&&oo(this)};function oo(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Li(t)}B.setRequestHeader=function(t,e){this.v.append(t,e)};B.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};B.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Li(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Bu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var XI=Z.JSON.parse;function Pe(t){Qe.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=ww,this.L=this.M=!1}Ye(Pe,Qe);var ww="",JI=/^https?$/i,ZI=["POST","PUT"];B=Pe.prototype;B.Oa=function(t){this.M=t};B.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():dh.g(),this.C=this.u?Mg(this.u):Mg(dh),this.g.onreadystatechange=dt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){Vg(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var a in r)n.set(a,r[a]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),a=Z.FormData&&t instanceof Z.FormData,!(0<=Ub(ZI,e))||r||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,i]of n)this.g.setRequestHeader(s,i);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{xw(this),0<this.B&&((this.L=e_(this.g))?(this.g.timeout=this.B,this.g.ontimeout=dt(this.ua,this)):this.A=Zf(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Vg(this,s)}};function e_(t){return ts&&typeof t.timeout=="number"&&t.ontimeout!==void 0}B.ua=function(){typeof Bf<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,tt(this,"timeout"),this.abort(8))};function Vg(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ew(t),$u(t)}function Ew(t){t.F||(t.F=!0,tt(t,"complete"),tt(t,"error"))}B.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,tt(this,"complete"),tt(this,"abort"),$u(this))};B.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),$u(this,!0)),Pe.$.N.call(this)};B.La=function(){this.s||(this.G||this.v||this.l?kw(this):this.kb())};B.kb=function(){kw(this)};function kw(t){if(t.h&&typeof Bf<"u"&&(!t.C[1]||yn(t)!=4||t.da()!=2)){if(t.v&&yn(t)==4)Zf(t.La,0,t);else if(tt(t,"readystatechange"),yn(t)==4){t.h=!1;try{const i=t.da();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=i===0){var a=String(t.I).match(cw)[1]||null;!a&&Z.self&&Z.self.location&&(a=Z.self.location.protocol.slice(0,-1)),r=!JI.test(a?a.toLowerCase():"")}n=r}if(n)tt(t,"complete"),tt(t,"success");else{t.m=6;try{var s=2<yn(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",Ew(t)}}finally{$u(t)}}}}function $u(t,e){if(t.g){xw(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||tt(t,"ready");try{n.onreadystatechange=r}catch{}}}function xw(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Z.clearTimeout(t.A),t.A=null)}B.isActive=function(){return!!this.g};function yn(t){return t.g?t.g.readyState:0}B.da=function(){try{return 2<yn(this)?this.g.status:-1}catch{return-1}};B.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};B.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),XI(e)}};function zg(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case ww:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function t_(t){const e={};t=(t.g&&2<=yn(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(_i(t[r]))continue;var n=CI(t[r]);const a=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const s=e[a]||[];e[a]=s,s.push(n)}vI(e,function(r){return r.join(", ")})}B.Ia=function(){return this.m};B.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Nw(t){let e="";return Kf(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function sm(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Nw(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ee(t,e,n))}function Os(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Sw(t){this.Ga=0,this.j=[],this.l=new Fu,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Os("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Os("baseRetryDelayMs",5e3,t),this.hb=Os("retryDelaySeedMs",1e4,t),this.eb=Os("forwardChannelMaxRetries",2,t),this.xa=Os("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new mw(t&&t.concurrentRequestLimit),this.Ja=new GI,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}B=Sw.prototype;B.ra=8;B.H=1;function im(t){if(Cw(t),t.H==3){var e=t.W++,n=Bn(t.I);if(Ee(n,"SID",t.K),Ee(n,"RID",e),Ee(n,"TYPE","terminate"),lo(t,n),e=new ao(t,t.l,e),e.L=2,e.v=qu(Bn(n)),n=!1,Z.navigator&&Z.navigator.sendBeacon)try{n=Z.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&Z.Image&&(new Image().src=e.v,n=!0),n||(e.g=Ow(e.l,null),e.g.ha(e.v)),e.G=Date.now(),so(e)}Rw(t)}function Hu(t){t.g&&(lm(t),t.g.cancel(),t.g=null)}function Cw(t){Hu(t),t.u&&(Z.clearTimeout(t.u),t.u=null),Zl(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Z.clearTimeout(t.m),t.m=null)}function Ku(t){if(!pw(t.i)&&!t.m){t.m=!0;var e=t.Na;Di||Qb(),Ai||(Di(),Ai=!0),Xf.add(e,t),t.C=0}}function n_(t,e){return gw(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=no(dt(t.Na,t,e),Aw(t,t.C)),t.C++,!0)}B.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const a=new ao(this,this.l,t);let s=this.s;if(this.U&&(s?(s=qb(s),Bb(s,this.U)):s=this.U),this.o!==null||this.O||(a.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=Iw(this,a,e),n=Bn(this.I),Ee(n,"RID",t),Ee(n,"CVER",22),this.F&&Ee(n,"X-HTTP-Session-Id",this.F),lo(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Nw(s)))+"&"+e:this.o&&sm(n,this.o,s)),rm(this.i,a),this.bb&&Ee(n,"TYPE","init"),this.P?(Ee(n,"$req",e),Ee(n,"SID","null"),a.aa=!0,fh(a,n,null)):fh(a,n,e),this.H=2}}else this.H==3&&(t?jg(this,t):this.j.length==0||pw(this.i)||jg(this))};function jg(t,e){var n;e?n=e.m:n=t.W++;const r=Bn(t.I);Ee(r,"SID",t.K),Ee(r,"RID",n),Ee(r,"AID",t.V),lo(t,r),t.o&&t.s&&sm(r,t.o,t.s),n=new ao(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Iw(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),rm(t.i,n),fh(n,r,e)}function lo(t,e){t.na&&Kf(t.na,function(n,r){Ee(e,r,n)}),t.h&&uw({},function(n,r){Ee(e,r,n)})}function Iw(t,e,n){n=Math.min(t.j.length,n);var r=t.h?dt(t.h.Va,t.h,t):null;e:{var a=t.j;let s=-1;for(;;){const i=["count="+n];s==-1?0<n?(s=a[0].g,i.push("ofs="+s)):s=0:i.push("ofs="+s);let o=!0;for(let u=0;u<n;u++){let c=a[u].g;const d=a[u].map;if(c-=s,0>c)s=Math.max(0,a[u].g-100),o=!1;else try{QI(d,i,"req"+c+"_")}catch{r&&r(d)}}if(o){r=i.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function _w(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Di||Qb(),Ai||(Di(),Ai=!0),Xf.add(e,t),t.A=0}}function om(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=no(dt(t.Ma,t),Aw(t,t.A)),t.A++,!0)}B.Ma=function(){if(this.u=null,Tw(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=no(dt(this.jb,this),t)}};B.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,bt(10),Hu(this),Tw(this))};function lm(t){t.B!=null&&(Z.clearTimeout(t.B),t.B=null)}function Tw(t){t.g=new ao(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Bn(t.wa);Ee(e,"RID","rpc"),Ee(e,"SID",t.K),Ee(e,"AID",t.V),Ee(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Ee(e,"TO",t.qa),Ee(e,"TYPE","xmlhttp"),lo(t,e),t.o&&t.s&&sm(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=qu(Bn(e)),n.s=null,n.S=!0,sw(n,t)}B.ib=function(){this.v!=null&&(this.v=null,Hu(this),om(this),bt(19))};function Zl(t){t.v!=null&&(Z.clearTimeout(t.v),t.v=null)}function Dw(t,e){var n=null;if(t.g==e){Zl(t),lm(t),t.g=null;var r=2}else if(ph(t.i,e))n=e.F,yw(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var a=t.C;r=Uu(),tt(r,new tw(r,n)),Ku(t)}else _w(t);else if(a=e.o,a==3||a==0&&0<e.ca||!(r==1&&n_(t,e)||r==2&&om(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),a){case 1:$r(t,5);break;case 4:$r(t,10);break;case 3:$r(t,6);break;default:$r(t,2)}}}function Aw(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function $r(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=dt(t.pb,t);n||(n=new Qr("//www.google.com/images/cleardot.gif"),Z.location&&Z.location.protocol=="http"||Xl(n,"https"),qu(n)),YI(n.toString(),r)}else bt(2);t.H=0,t.h&&t.h.za(e),Rw(t),Cw(t)}B.pb=function(t){t?(this.l.info("Successfully pinged google.com"),bt(2)):(this.l.info("Failed to ping google.com"),bt(1))};function Rw(t){if(t.H=0,t.ma=[],t.h){const e=vw(t.i);(e.length!=0||t.j.length!=0)&&(Rg(t.ma,e),Rg(t.ma,t.j),t.i.i.length=0,$f(t.j),t.j.length=0),t.h.ya()}}function Pw(t,e,n){var r=n instanceof Qr?Bn(n):new Qr(n);if(r.g!="")e&&(r.g=e+"."+r.g),Jl(r,r.m);else{var a=Z.location;r=a.protocol,e=e?e+"."+a.hostname:a.hostname,a=+a.port;var s=new Qr(null);r&&Xl(s,r),e&&(s.g=e),a&&Jl(s,a),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Ee(r,n,e),Ee(r,"VER",t.ra),lo(t,r),r}function Ow(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new Pe(new io({ob:!0})):new Pe(t.va),e.Oa(t.J),e}B.isActive=function(){return!!this.h&&this.h.isActive(this)};function Lw(){}B=Lw.prototype;B.Ba=function(){};B.Aa=function(){};B.za=function(){};B.ya=function(){};B.isActive=function(){return!0};B.Va=function(){};function eu(){if(ts&&!(10<=Number(mI)))throw Error("Environmental error: no available transport.")}eu.prototype.g=function(t,e){return new Ut(t,e)};function Ut(t,e){Qe.call(this),this.g=new Sw(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!_i(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!_i(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new vs(this)}Ye(Ut,Qe);Ut.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;bt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Pw(t,null,t.Y),Ku(t)};Ut.prototype.close=function(){im(this.g)};Ut.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Yf(t),t=n);e.j.push(new HI(e.fb++,t)),e.H==3&&Ku(e)};Ut.prototype.N=function(){this.g.h=null,delete this.j,im(this.g),delete this.g,Ut.$.N.call(this)};function Mw(t){tm.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ye(Mw,tm);function Fw(){nm.call(this),this.status=1}Ye(Fw,nm);function vs(t){this.g=t}Ye(vs,Lw);vs.prototype.Ba=function(){tt(this.g,"a")};vs.prototype.Aa=function(t){tt(this.g,new Mw(t))};vs.prototype.za=function(t){tt(this.g,new Fw)};vs.prototype.ya=function(){tt(this.g,"b")};function r_(){this.blockSize=-1}function sn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}Ye(sn,r_);sn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Qc(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var a=0;16>a;++a)r[a]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(a=0;16>a;++a)r[a]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],a=t.g[2];var s=t.g[3],i=e+(s^n&(a^s))+r[0]+3614090360&4294967295;e=n+(i<<7&4294967295|i>>>25),i=s+(a^e&(n^a))+r[1]+3905402710&4294967295,s=e+(i<<12&4294967295|i>>>20),i=a+(n^s&(e^n))+r[2]+606105819&4294967295,a=s+(i<<17&4294967295|i>>>15),i=n+(e^a&(s^e))+r[3]+3250441966&4294967295,n=a+(i<<22&4294967295|i>>>10),i=e+(s^n&(a^s))+r[4]+4118548399&4294967295,e=n+(i<<7&4294967295|i>>>25),i=s+(a^e&(n^a))+r[5]+1200080426&4294967295,s=e+(i<<12&4294967295|i>>>20),i=a+(n^s&(e^n))+r[6]+2821735955&4294967295,a=s+(i<<17&4294967295|i>>>15),i=n+(e^a&(s^e))+r[7]+4249261313&4294967295,n=a+(i<<22&4294967295|i>>>10),i=e+(s^n&(a^s))+r[8]+1770035416&4294967295,e=n+(i<<7&4294967295|i>>>25),i=s+(a^e&(n^a))+r[9]+2336552879&4294967295,s=e+(i<<12&4294967295|i>>>20),i=a+(n^s&(e^n))+r[10]+4294925233&4294967295,a=s+(i<<17&4294967295|i>>>15),i=n+(e^a&(s^e))+r[11]+2304563134&4294967295,n=a+(i<<22&4294967295|i>>>10),i=e+(s^n&(a^s))+r[12]+1804603682&4294967295,e=n+(i<<7&4294967295|i>>>25),i=s+(a^e&(n^a))+r[13]+4254626195&4294967295,s=e+(i<<12&4294967295|i>>>20),i=a+(n^s&(e^n))+r[14]+2792965006&4294967295,a=s+(i<<17&4294967295|i>>>15),i=n+(e^a&(s^e))+r[15]+1236535329&4294967295,n=a+(i<<22&4294967295|i>>>10),i=e+(a^s&(n^a))+r[1]+4129170786&4294967295,e=n+(i<<5&4294967295|i>>>27),i=s+(n^a&(e^n))+r[6]+3225465664&4294967295,s=e+(i<<9&4294967295|i>>>23),i=a+(e^n&(s^e))+r[11]+643717713&4294967295,a=s+(i<<14&4294967295|i>>>18),i=n+(s^e&(a^s))+r[0]+3921069994&4294967295,n=a+(i<<20&4294967295|i>>>12),i=e+(a^s&(n^a))+r[5]+3593408605&4294967295,e=n+(i<<5&4294967295|i>>>27),i=s+(n^a&(e^n))+r[10]+38016083&4294967295,s=e+(i<<9&4294967295|i>>>23),i=a+(e^n&(s^e))+r[15]+3634488961&4294967295,a=s+(i<<14&4294967295|i>>>18),i=n+(s^e&(a^s))+r[4]+3889429448&4294967295,n=a+(i<<20&4294967295|i>>>12),i=e+(a^s&(n^a))+r[9]+568446438&4294967295,e=n+(i<<5&4294967295|i>>>27),i=s+(n^a&(e^n))+r[14]+3275163606&4294967295,s=e+(i<<9&4294967295|i>>>23),i=a+(e^n&(s^e))+r[3]+4107603335&4294967295,a=s+(i<<14&4294967295|i>>>18),i=n+(s^e&(a^s))+r[8]+1163531501&4294967295,n=a+(i<<20&4294967295|i>>>12),i=e+(a^s&(n^a))+r[13]+2850285829&4294967295,e=n+(i<<5&4294967295|i>>>27),i=s+(n^a&(e^n))+r[2]+4243563512&4294967295,s=e+(i<<9&4294967295|i>>>23),i=a+(e^n&(s^e))+r[7]+1735328473&4294967295,a=s+(i<<14&4294967295|i>>>18),i=n+(s^e&(a^s))+r[12]+2368359562&4294967295,n=a+(i<<20&4294967295|i>>>12),i=e+(n^a^s)+r[5]+4294588738&4294967295,e=n+(i<<4&4294967295|i>>>28),i=s+(e^n^a)+r[8]+2272392833&4294967295,s=e+(i<<11&4294967295|i>>>21),i=a+(s^e^n)+r[11]+1839030562&4294967295,a=s+(i<<16&4294967295|i>>>16),i=n+(a^s^e)+r[14]+4259657740&4294967295,n=a+(i<<23&4294967295|i>>>9),i=e+(n^a^s)+r[1]+2763975236&4294967295,e=n+(i<<4&4294967295|i>>>28),i=s+(e^n^a)+r[4]+1272893353&4294967295,s=e+(i<<11&4294967295|i>>>21),i=a+(s^e^n)+r[7]+4139469664&4294967295,a=s+(i<<16&4294967295|i>>>16),i=n+(a^s^e)+r[10]+3200236656&4294967295,n=a+(i<<23&4294967295|i>>>9),i=e+(n^a^s)+r[13]+681279174&4294967295,e=n+(i<<4&4294967295|i>>>28),i=s+(e^n^a)+r[0]+3936430074&4294967295,s=e+(i<<11&4294967295|i>>>21),i=a+(s^e^n)+r[3]+3572445317&4294967295,a=s+(i<<16&4294967295|i>>>16),i=n+(a^s^e)+r[6]+76029189&4294967295,n=a+(i<<23&4294967295|i>>>9),i=e+(n^a^s)+r[9]+3654602809&4294967295,e=n+(i<<4&4294967295|i>>>28),i=s+(e^n^a)+r[12]+3873151461&4294967295,s=e+(i<<11&4294967295|i>>>21),i=a+(s^e^n)+r[15]+530742520&4294967295,a=s+(i<<16&4294967295|i>>>16),i=n+(a^s^e)+r[2]+3299628645&4294967295,n=a+(i<<23&4294967295|i>>>9),i=e+(a^(n|~s))+r[0]+4096336452&4294967295,e=n+(i<<6&4294967295|i>>>26),i=s+(n^(e|~a))+r[7]+1126891415&4294967295,s=e+(i<<10&4294967295|i>>>22),i=a+(e^(s|~n))+r[14]+2878612391&4294967295,a=s+(i<<15&4294967295|i>>>17),i=n+(s^(a|~e))+r[5]+4237533241&4294967295,n=a+(i<<21&4294967295|i>>>11),i=e+(a^(n|~s))+r[12]+1700485571&4294967295,e=n+(i<<6&4294967295|i>>>26),i=s+(n^(e|~a))+r[3]+2399980690&4294967295,s=e+(i<<10&4294967295|i>>>22),i=a+(e^(s|~n))+r[10]+4293915773&4294967295,a=s+(i<<15&4294967295|i>>>17),i=n+(s^(a|~e))+r[1]+2240044497&4294967295,n=a+(i<<21&4294967295|i>>>11),i=e+(a^(n|~s))+r[8]+1873313359&4294967295,e=n+(i<<6&4294967295|i>>>26),i=s+(n^(e|~a))+r[15]+4264355552&4294967295,s=e+(i<<10&4294967295|i>>>22),i=a+(e^(s|~n))+r[6]+2734768916&4294967295,a=s+(i<<15&4294967295|i>>>17),i=n+(s^(a|~e))+r[13]+1309151649&4294967295,n=a+(i<<21&4294967295|i>>>11),i=e+(a^(n|~s))+r[4]+4149444226&4294967295,e=n+(i<<6&4294967295|i>>>26),i=s+(n^(e|~a))+r[11]+3174756917&4294967295,s=e+(i<<10&4294967295|i>>>22),i=a+(e^(s|~n))+r[2]+718787259&4294967295,a=s+(i<<15&4294967295|i>>>17),i=n+(s^(a|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(a+(i<<21&4294967295|i>>>11))&4294967295,t.g[2]=t.g[2]+a&4294967295,t.g[3]=t.g[3]+s&4294967295}sn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,a=this.h,s=0;s<e;){if(a==0)for(;s<=n;)Qc(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[a++]=t.charCodeAt(s++),a==this.blockSize){Qc(this,r),a=0;break}}else for(;s<e;)if(r[a++]=t[s++],a==this.blockSize){Qc(this,r),a=0;break}}this.h=a,this.i+=e};sn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function pe(t,e){this.h=e;for(var n=[],r=!0,a=t.length-1;0<=a;a--){var s=t[a]|0;r&&s==e||(n[a]=s,r=!1)}this.g=n}var a_={};function um(t){return-128<=t&&128>t?cI(t,function(e){return new pe([e|0],0>e?-1:0)}):new pe([t|0],0>t?-1:0)}function vn(t){if(isNaN(t)||!isFinite(t))return ja;if(0>t)return Ze(vn(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=gh;return new pe(e,0)}function Uw(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Ze(Uw(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=vn(Math.pow(e,8)),r=ja,a=0;a<t.length;a+=8){var s=Math.min(8,t.length-a),i=parseInt(t.substring(a,a+s),e);8>s?(s=vn(Math.pow(e,s)),r=r.R(s).add(vn(i))):(r=r.R(n),r=r.add(vn(i)))}return r}var gh=4294967296,ja=um(0),yh=um(1),qg=um(16777216);B=pe.prototype;B.ea=function(){if(Kt(this))return-Ze(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:gh+r)*e,e*=gh}return t};B.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(On(this))return"0";if(Kt(this))return"-"+Ze(this).toString(t);for(var e=vn(Math.pow(t,6)),n=this,r="";;){var a=nu(n,e).g;n=tu(n,a.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=a,On(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};B.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function On(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Kt(t){return t.h==-1}B.X=function(t){return t=tu(this,t),Kt(t)?-1:On(t)?0:1};function Ze(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new pe(n,~t.h).add(yh)}B.abs=function(){return Kt(this)?Ze(this):this};B.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,a=0;a<=e;a++){var s=r+(this.D(a)&65535)+(t.D(a)&65535),i=(s>>>16)+(this.D(a)>>>16)+(t.D(a)>>>16);r=i>>>16,s&=65535,i&=65535,n[a]=i<<16|s}return new pe(n,n[n.length-1]&-2147483648?-1:0)};function tu(t,e){return t.add(Ze(e))}B.R=function(t){if(On(this)||On(t))return ja;if(Kt(this))return Kt(t)?Ze(this).R(Ze(t)):Ze(Ze(this).R(t));if(Kt(t))return Ze(this.R(Ze(t)));if(0>this.X(qg)&&0>t.X(qg))return vn(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var a=0;a<t.g.length;a++){var s=this.D(r)>>>16,i=this.D(r)&65535,o=t.D(a)>>>16,u=t.D(a)&65535;n[2*r+2*a]+=i*u,Ho(n,2*r+2*a),n[2*r+2*a+1]+=s*u,Ho(n,2*r+2*a+1),n[2*r+2*a+1]+=i*o,Ho(n,2*r+2*a+1),n[2*r+2*a+2]+=s*o,Ho(n,2*r+2*a+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new pe(n,0)};function Ho(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ls(t,e){this.g=t,this.h=e}function nu(t,e){if(On(e))throw Error("division by zero");if(On(t))return new Ls(ja,ja);if(Kt(t))return e=nu(Ze(t),e),new Ls(Ze(e.g),Ze(e.h));if(Kt(e))return e=nu(t,Ze(e)),new Ls(Ze(e.g),e.h);if(30<t.g.length){if(Kt(t)||Kt(e))throw Error("slowDivide_ only works with positive integers.");for(var n=yh,r=e;0>=r.X(t);)n=Bg(n),r=Bg(r);var a=ma(n,1),s=ma(r,1);for(r=ma(r,2),n=ma(n,2);!On(r);){var i=s.add(r);0>=i.X(t)&&(a=a.add(n),s=i),r=ma(r,1),n=ma(n,1)}return e=tu(t,a.R(e)),new Ls(a,e)}for(a=ja;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=vn(n),i=s.R(e);Kt(i)||0<i.X(t);)n-=r,s=vn(n),i=s.R(e);On(s)&&(s=yh),a=a.add(s),t=tu(t,i)}return new Ls(a,t)}B.gb=function(t){return nu(this,t).h};B.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new pe(n,this.h&t.h)};B.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new pe(n,this.h|t.h)};B.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new pe(n,this.h^t.h)};function Bg(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new pe(n,t.h)}function ma(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,a=[],s=0;s<r;s++)a[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new pe(a,t.h)}eu.prototype.createWebChannel=eu.prototype.g;Ut.prototype.send=Ut.prototype.u;Ut.prototype.open=Ut.prototype.m;Ut.prototype.close=Ut.prototype.close;Vu.NO_ERROR=0;Vu.TIMEOUT=8;Vu.HTTP_ERROR=6;nw.COMPLETE="complete";rw.EventType=ro;ro.OPEN="a";ro.CLOSE="b";ro.ERROR="c";ro.MESSAGE="d";Qe.prototype.listen=Qe.prototype.O;Pe.prototype.listenOnce=Pe.prototype.P;Pe.prototype.getLastError=Pe.prototype.Sa;Pe.prototype.getLastErrorCode=Pe.prototype.Ia;Pe.prototype.getStatus=Pe.prototype.da;Pe.prototype.getResponseJson=Pe.prototype.Wa;Pe.prototype.getResponseText=Pe.prototype.ja;Pe.prototype.send=Pe.prototype.ha;Pe.prototype.setWithCredentials=Pe.prototype.Oa;sn.prototype.digest=sn.prototype.l;sn.prototype.reset=sn.prototype.reset;sn.prototype.update=sn.prototype.j;pe.prototype.add=pe.prototype.add;pe.prototype.multiply=pe.prototype.R;pe.prototype.modulo=pe.prototype.gb;pe.prototype.compare=pe.prototype.X;pe.prototype.toNumber=pe.prototype.ea;pe.prototype.toString=pe.prototype.toString;pe.prototype.getBits=pe.prototype.D;pe.fromNumber=vn;pe.fromString=Uw;var s_=function(){return new eu},i_=function(){return Uu()},Yc=Vu,o_=nw,l_=ua,$g={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},u_=io,Ko=rw,c_=Pe,d_=sn,qa=pe;const Hg="@firebase/firestore";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ot{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ot.UNAUTHENTICATED=new ot(null),ot.GOOGLE_CREDENTIALS=new ot("google-credentials-uid"),ot.FIRST_PARTY=new ot("first-party-uid"),ot.MOCK_USER=new ot("mock-user");/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let bs="9.23.0";/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Nr=new Af("@firebase/firestore");function Kg(){return Nr.logLevel}function Wg(t){Nr.setLogLevel(t)}function K(t,...e){if(Nr.logLevel<=de.DEBUG){const n=e.map(cm);Nr.debug(`Firestore (${bs}): ${t}`,...n)}}function $n(t,...e){if(Nr.logLevel<=de.ERROR){const n=e.map(cm);Nr.error(`Firestore (${bs}): ${t}`,...n)}}function ns(t,...e){if(Nr.logLevel<=de.WARN){const n=e.map(cm);Nr.warn(`Firestore (${bs}): ${t}`,...n)}}function cm(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function ee(t="Unexpected state"){const e=`FIRESTORE (${bs}) INTERNAL ASSERTION FAILED: `+t;throw $n(e),new Error(e)}function Ne(t,e){t||ee()}function ne(t,e){return t}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const S={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $ extends Gn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Fn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Vw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class h_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ot.UNAUTHENTICATED))}shutdown(){}}class f_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class m_{constructor(e){this.t=e,this.currentUser=ot.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const a=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let s=new Fn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Fn,e.enqueueRetryable(()=>a(this.currentUser))};const i=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await a(this.currentUser)})},o=u=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),i()};this.t.onInit(u=>o(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?o(u):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Fn)}},0),i()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ne(typeof r.accessToken=="string"),new Vw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Ne(e===null||typeof e=="string"),new ot(e)}}class p_{constructor(e,n,r){this.h=e,this.l=n,this.m=r,this.type="FirstParty",this.user=ot.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class g_{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new p_(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(ot.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class y_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class v_{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,n){const r=s=>{s.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const i=s.token!==this.T;return this.T=s.token,K("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const a=s=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>a(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?a(s):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ne(typeof n.token=="string"),this.T=n.token,new y_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function b_(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class zw{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const a=b_(40);for(let s=0;s<a.length;++s)r.length<20&&a[s]<n&&(r+=e.charAt(a[s]%e.length))}return r}}function he(t,e){return t<e?-1:t>e?1:0}function rs(t,e,n){return t.length===e.length&&t.every((r,a)=>n(r,e[a]))}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class le{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new $(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new $(S.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new $(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $(S.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return le.fromMillis(Date.now())}static fromDate(e){return le.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new le(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?he(this.nanoseconds,e.nanoseconds):he(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class te{constructor(e){this.timestamp=e}static fromTimestamp(e){return new te(e)}static min(){return new te(new le(0,0))}static max(){return new te(new le(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Mi{constructor(e,n,r){n===void 0?n=0:n>e.length&&ee(),r===void 0?r=e.length-n:r>e.length-n&&ee(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Mi.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Mi?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let a=0;a<r;a++){const s=e.get(a),i=n.get(a);if(s<i)return-1;if(s>i)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ke extends Mi{construct(e,n,r){return new ke(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new $(S.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(a=>a.length>0))}return new ke(n)}static emptyPath(){return new ke([])}}const w_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends Mi{construct(e,n,r){return new ct(e,n,r)}static isValidIdentifier(e){return w_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ct(["__name__"])}static fromServerFormat(e){const n=[];let r="",a=0;const s=()=>{if(r.length===0)throw new $(S.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let i=!1;for(;a<e.length;){const o=e[a];if(o==="\\"){if(a+1===e.length)throw new $(S.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[a+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new $(S.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,a+=2}else o==="`"?(i=!i,a++):o!=="."||i?(r+=o,a++):(s(),a++)}if(s(),i)throw new $(S.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(n)}static emptyPath(){return new ct([])}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class G{constructor(e){this.path=e}static fromPath(e){return new G(ke.fromString(e))}static fromName(e){return new G(ke.fromString(e).popFirst(5))}static empty(){return new G(ke.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ke.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ke.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new G(new ke(e.slice()))}}function E_(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,a=te.fromTimestamp(r===1e9?new le(n+1,0):new le(n,r));return new Sr(a,G.empty(),e)}function k_(t){return new Sr(t.readTime,t.key,-1)}class Sr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Sr(te.min(),G.empty(),-1)}static max(){return new Sr(te.max(),G.empty(),-1)}}function x_(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=G.comparator(t.documentKey,e.documentKey),n!==0?n:he(t.largestBatchId,e.largestBatchId))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const N_="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class S_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/async function uo(t){if(t.code!==S.FAILED_PRECONDITION||t.message!==N_)throw t;K("LocalStore","Unexpectedly lost primary lease")}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ee(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new V((r,a)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,a)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,a)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof V?n:V.resolve(n)}catch(n){return V.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):V.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):V.reject(n)}static resolve(e){return new V((n,r)=>{n(e)})}static reject(e){return new V((n,r)=>{r(e)})}static waitFor(e){return new V((n,r)=>{let a=0,s=0,i=!1;e.forEach(o=>{++a,o.next(()=>{++s,i&&s===a&&n()},u=>r(u))}),i=!0,s===a&&n()})}static or(e){let n=V.resolve(!1);for(const r of e)n=n.next(a=>a?V.resolve(a):r());return n}static forEach(e,n){const r=[];return e.forEach((a,s)=>{r.push(n.call(this,a,s))}),this.waitFor(r)}static mapArray(e,n){return new V((r,a)=>{const s=e.length,i=new Array(s);let o=0;for(let u=0;u<s;u++){const c=u;n(e[c]).next(d=>{i[c]=d,++o,o===s&&r(i)},d=>a(d))}})}static doWhile(e,n){return new V((r,a)=>{const s=()=>{e()===!0?n().next(()=>{s()},a):r()};s()})}}function co(t){return t.name==="IndexedDbTransactionError"}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class dm{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>n.writeSequenceNumber(r))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}dm.ct=-1;function Wu(t){return t==null}function ru(t){return t===0&&1/t==-1/0}function C_(t){return typeof t=="number"&&Number.isInteger(t)&&!ru(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Gg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ca(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function jw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ae{constructor(e,n){this.comparator=e,this.root=n||Je.EMPTY}insert(e,n){return new Ae(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Je.BLACK,null,null))}remove(e){return new Ae(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Je.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return n+r.left.size;a<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wo(this.root,e,this.comparator,!0)}}class Wo{constructor(e,n,r,a){this.isReverse=a,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&a&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Je{constructor(e,n,r,a,s){this.key=e,this.value=n,this.color=r??Je.RED,this.left=a??Je.EMPTY,this.right=s??Je.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,a,s){return new Je(e??this.key,n??this.value,r??this.color,a??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let a=this;const s=r(e,a.key);return a=s<0?a.copy(null,null,null,a.left.insert(e,n,r),null):s===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Je.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return Je.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Je.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Je.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ee();const e=this.left.check();if(e!==this.right.check())throw ee();return e+(this.isRed()?0:1)}}Je.EMPTY=null,Je.RED=!0,Je.BLACK=!1;Je.EMPTY=new class{constructor(){this.size=0}get key(){throw ee()}get value(){throw ee()}get color(){throw ee()}get left(){throw ee()}get right(){throw ee()}copy(t,e,n,r,a){return this}insert(t,e,n){return new Je(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ft{constructor(e){this.comparator=e,this.data=new Ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Qg(this.data.getIterator())}getIteratorFrom(e){return new Qg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ft)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,s=r.getNext().key;if(this.comparator(a,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ft(this.comparator);return n.data=e,n}}class Qg{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ot{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new Ot([])}unionWith(e){let n=new ft(ct.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ot(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return rs(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class yt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new qw("Invalid base64 string: "+a):a}}(e);return new yt(n)}static fromUint8Array(e){const n=function(r){let a="";for(let s=0;s<r.length;++s)a+=String.fromCharCode(r[s]);return a}(e);return new yt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return he(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yt.EMPTY_BYTE_STRING=new yt("");const I_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Cr(t){if(Ne(!!t),typeof t=="string"){let e=0;const n=I_.exec(t);if(Ne(!!n),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ve(t.seconds),nanos:Ve(t.nanos)}}function Ve(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function aa(t){return typeof t=="string"?yt.fromBase64String(t):yt.fromUint8Array(t)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function hm(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function fm(t){const e=t.mapValue.fields.__previous_value__;return hm(e)?fm(e):e}function Fi(t){const e=Cr(t.mapValue.fields.__local_write_time__.timestampValue);return new le(e.seconds,e.nanos)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class __{constructor(e,n,r,a,s,i,o,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=a,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=u,this.useFetchStreams=c}}class Ui{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Ui("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ui&&e.projectId===this.projectId&&e.database===this.database}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const Go={mapValue:{}};function sa(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?hm(t)?4:T_(t)?9007199254740991:10:ee()}function Nn(t,e){if(t===e)return!0;const n=sa(t);if(n!==sa(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Fi(t).isEqual(Fi(e));case 3:return function(r,a){if(typeof r.timestampValue=="string"&&typeof a.timestampValue=="string"&&r.timestampValue.length===a.timestampValue.length)return r.timestampValue===a.timestampValue;const s=Cr(r.timestampValue),i=Cr(a.timestampValue);return s.seconds===i.seconds&&s.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,a){return aa(r.bytesValue).isEqual(aa(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,a){return Ve(r.geoPointValue.latitude)===Ve(a.geoPointValue.latitude)&&Ve(r.geoPointValue.longitude)===Ve(a.geoPointValue.longitude)}(t,e);case 2:return function(r,a){if("integerValue"in r&&"integerValue"in a)return Ve(r.integerValue)===Ve(a.integerValue);if("doubleValue"in r&&"doubleValue"in a){const s=Ve(r.doubleValue),i=Ve(a.doubleValue);return s===i?ru(s)===ru(i):isNaN(s)&&isNaN(i)}return!1}(t,e);case 9:return rs(t.arrayValue.values||[],e.arrayValue.values||[],Nn);case 10:return function(r,a){const s=r.mapValue.fields||{},i=a.mapValue.fields||{};if(Gg(s)!==Gg(i))return!1;for(const o in s)if(s.hasOwnProperty(o)&&(i[o]===void 0||!Nn(s[o],i[o])))return!1;return!0}(t,e);default:return ee()}}function Vi(t,e){return(t.values||[]).find(n=>Nn(n,e))!==void 0}function as(t,e){if(t===e)return 0;const n=sa(t),r=sa(e);if(n!==r)return he(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return he(t.booleanValue,e.booleanValue);case 2:return function(a,s){const i=Ve(a.integerValue||a.doubleValue),o=Ve(s.integerValue||s.doubleValue);return i<o?-1:i>o?1:i===o?0:isNaN(i)?isNaN(o)?0:-1:1}(t,e);case 3:return Yg(t.timestampValue,e.timestampValue);case 4:return Yg(Fi(t),Fi(e));case 5:return he(t.stringValue,e.stringValue);case 6:return function(a,s){const i=aa(a),o=aa(s);return i.compareTo(o)}(t.bytesValue,e.bytesValue);case 7:return function(a,s){const i=a.split("/"),o=s.split("/");for(let u=0;u<i.length&&u<o.length;u++){const c=he(i[u],o[u]);if(c!==0)return c}return he(i.length,o.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,s){const i=he(Ve(a.latitude),Ve(s.latitude));return i!==0?i:he(Ve(a.longitude),Ve(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(a,s){const i=a.values||[],o=s.values||[];for(let u=0;u<i.length&&u<o.length;++u){const c=as(i[u],o[u]);if(c)return c}return he(i.length,o.length)}(t.arrayValue,e.arrayValue);case 10:return function(a,s){if(a===Go.mapValue&&s===Go.mapValue)return 0;if(a===Go.mapValue)return 1;if(s===Go.mapValue)return-1;const i=a.fields||{},o=Object.keys(i),u=s.fields||{},c=Object.keys(u);o.sort(),c.sort();for(let d=0;d<o.length&&d<c.length;++d){const h=he(o[d],c[d]);if(h!==0)return h;const f=as(i[o[d]],u[c[d]]);if(f!==0)return f}return he(o.length,c.length)}(t.mapValue,e.mapValue);default:throw ee()}}function Yg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return he(t,e);const n=Cr(t),r=Cr(e),a=he(n.seconds,r.seconds);return a!==0?a:he(n.nanos,r.nanos)}function ss(t){return vh(t)}function vh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const a=Cr(r);return`time(${a.seconds},${a.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?aa(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,G.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let a="[",s=!0;for(const i of r.values||[])s?s=!1:a+=",",a+=vh(i);return a+"]"}(t.arrayValue):"mapValue"in t?function(r){const a=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const o of a)i?i=!1:s+=",",s+=`${o}:${vh(r.fields[o])}`;return s+"}"}(t.mapValue):ee();var e,n}function Xg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function bh(t){return!!t&&"integerValue"in t}function mm(t){return!!t&&"arrayValue"in t}function Jg(t){return!!t&&"nullValue"in t}function Zg(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ml(t){return!!t&&"mapValue"in t}function ai(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ca(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ai(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ai(t.arrayValue.values[n]);return e}return Object.assign({},t)}function T_(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class It{constructor(e){this.value=e}static empty(){return new It({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!ml(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ai(n)}setAll(e){let n=ct.emptyPath(),r={},a=[];e.forEach((i,o)=>{if(!n.isImmediateParentOf(o)){const u=this.getFieldsMap(n);this.applyChanges(u,r,a),r={},a=[],n=o.popLast()}i?r[o.lastSegment()]=ai(i):a.push(o.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,a)}delete(e){const n=this.field(e.popLast());ml(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Nn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=n.mapValue.fields[e.get(r)];ml(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,r){ca(n,(a,s)=>e[a]=s);for(const a of r)delete e[a]}clone(){return new It(ai(this.value))}}function Bw(t){const e=[];return ca(t.fields,(n,r)=>{const a=new ct([n]);if(ml(r)){const s=Bw(r.mapValue).fields;if(s.length===0)e.push(a);else for(const i of s)e.push(a.child(i))}else e.push(a)}),new Ot(e)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ut{constructor(e,n,r,a,s,i,o){this.key=e,this.documentType=n,this.version=r,this.readTime=a,this.createTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new ut(e,0,te.min(),te.min(),te.min(),It.empty(),0)}static newFoundDocument(e,n,r,a){return new ut(e,1,n,te.min(),r,a,0)}static newNoDocument(e,n){return new ut(e,2,n,te.min(),te.min(),It.empty(),0)}static newUnknownDocument(e,n){return new ut(e,3,n,te.min(),te.min(),It.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=It.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=It.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ut&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ut(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class au{constructor(e,n){this.position=e,this.inclusive=n}}function ey(t,e,n){let r=0;for(let a=0;a<t.position.length;a++){const s=e[a],i=t.position[a];if(s.field.isKeyField()?r=G.comparator(G.fromName(i.referenceValue),n.key):r=as(i,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function ty(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Nn(t.position[n],e.position[n]))return!1;return!0}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ba{constructor(e,n="asc"){this.field=e,this.dir=n}}function D_(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class $w{}class je extends $w{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new R_(e,n,r):n==="array-contains"?new L_(e,r):n==="in"?new M_(e,r):n==="not-in"?new F_(e,r):n==="array-contains-any"?new U_(e,r):new je(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new P_(e,r):new O_(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(as(n,this.value)):n!==null&&sa(this.value)===sa(n)&&this.matchesComparison(as(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ee()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class on extends $w{constructor(e,n){super(),this.filters=e,this.op=n,this.lt=null}static create(e,n){return new on(e,n)}matches(e){return Hw(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.lt!==null||(this.lt=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(n=>n.isInequality());return e!==null?e.field:null}ft(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function Hw(t){return t.op==="and"}function Kw(t){return A_(t)&&Hw(t)}function A_(t){for(const e of t.filters)if(e instanceof on)return!1;return!0}function wh(t){if(t instanceof je)return t.field.canonicalString()+t.op.toString()+ss(t.value);if(Kw(t))return t.filters.map(e=>wh(e)).join(",");{const e=t.filters.map(n=>wh(n)).join(",");return`${t.op}(${e})`}}function Ww(t,e){return t instanceof je?function(n,r){return r instanceof je&&n.op===r.op&&n.field.isEqual(r.field)&&Nn(n.value,r.value)}(t,e):t instanceof on?function(n,r){return r instanceof on&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((a,s,i)=>a&&Ww(s,r.filters[i]),!0):!1}(t,e):void ee()}function Gw(t){return t instanceof je?function(e){return`${e.field.canonicalString()} ${e.op} ${ss(e.value)}`}(t):t instanceof on?function(e){return e.op.toString()+" {"+e.getFilters().map(Gw).join(" ,")+"}"}(t):"Filter"}class R_ extends je{constructor(e,n,r){super(e,n,r),this.key=G.fromName(r.referenceValue)}matches(e){const n=G.comparator(e.key,this.key);return this.matchesComparison(n)}}class P_ extends je{constructor(e,n){super(e,"in",n),this.keys=Qw("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class O_ extends je{constructor(e,n){super(e,"not-in",n),this.keys=Qw("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Qw(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>G.fromName(r.referenceValue))}class L_ extends je{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return mm(n)&&Vi(n.arrayValue,this.value)}}class M_ extends je{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Vi(this.value.arrayValue,n)}}class F_ extends je{constructor(e,n){super(e,"not-in",n)}matches(e){if(Vi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Vi(this.value.arrayValue,n)}}class U_ extends je{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!mm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Vi(this.value.arrayValue,r))}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class V_{constructor(e,n=null,r=[],a=[],s=null,i=null,o=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=a,this.limit=s,this.startAt=i,this.endAt=o,this.dt=null}}function ny(t,e=null,n=[],r=[],a=null,s=null,i=null){return new V_(t,e,n,r,a,s,i)}function pm(t){const e=ne(t);if(e.dt===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>wh(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(a){return a.field.canonicalString()+a.dir}(r)).join(","),Wu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ss(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ss(r)).join(",")),e.dt=n}return e.dt}function gm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!D_(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Ww(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ty(t.startAt,e.startAt)&&ty(t.endAt,e.endAt)}function Eh(t){return G.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ws{constructor(e,n=null,r=[],a=[],s=null,i="F",o=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=a,this.limit=s,this.limitType=i,this.startAt=o,this.endAt=u,this.wt=null,this._t=null,this.startAt,this.endAt}}function z_(t,e,n,r,a,s,i,o){return new ws(t,e,n,r,a,s,i,o)}function Gu(t){return new ws(t)}function ry(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ym(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Qu(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function Yw(t){return t.collectionGroup!==null}function $a(t){const e=ne(t);if(e.wt===null){e.wt=[];const n=Qu(e),r=ym(e);if(n!==null&&r===null)n.isKeyField()||e.wt.push(new Ba(n)),e.wt.push(new Ba(ct.keyField(),"asc"));else{let a=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(a=!0);if(!a){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new Ba(ct.keyField(),s))}}}return e.wt}function Hn(t){const e=ne(t);if(!e._t)if(e.limitType==="F")e._t=ny(e.path,e.collectionGroup,$a(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const s of $a(e)){const i=s.dir==="desc"?"asc":"desc";n.push(new Ba(s.field,i))}const r=e.endAt?new au(e.endAt.position,e.endAt.inclusive):null,a=e.startAt?new au(e.startAt.position,e.startAt.inclusive):null;e._t=ny(e.path,e.collectionGroup,n,e.filters,e.limit,r,a)}return e._t}function kh(t,e){e.getFirstInequalityField(),Qu(t);const n=t.filters.concat([e]);return new ws(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function xh(t,e,n){return new ws(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Yu(t,e){return gm(Hn(t),Hn(e))&&t.limitType===e.limitType}function Xw(t){return`${pm(Hn(t))}|lt:${t.limitType}`}function Nh(t){return`Query(target=${function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(r=>Gw(r)).join(", ")}]`),Wu(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(r=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(r)).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ss(r)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ss(r)).join(",")),`Target(${n})`}(Hn(t))}; limitType=${t.limitType})`}function Xu(t,e){return e.isFoundDocument()&&function(n,r){const a=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):G.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,r){for(const a of $a(n))if(!a.field.isKeyField()&&r.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const a of n.filters)if(!a.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(a,s,i){const o=ey(a,s,i);return a.inclusive?o<=0:o<0}(n.startAt,$a(n),r)||n.endAt&&!function(a,s,i){const o=ey(a,s,i);return a.inclusive?o>=0:o>0}(n.endAt,$a(n),r))}(t,e)}function j_(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Jw(t){return(e,n)=>{let r=!1;for(const a of $a(t)){const s=q_(a,e,n);if(s!==0)return s;r=r||a.field.isKeyField()}return 0}}function q_(t,e,n){const r=t.field.isKeyField()?G.comparator(e.key,n.key):function(a,s,i){const o=s.data.field(a),u=i.data.field(a);return o!==null&&u!==null?as(o,u):ee()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ee()}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Es{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[a,s]of r)if(this.equalsFn(a,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<a.length;s++)if(this.equalsFn(a[s][0],e))return void(a[s]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[n]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){ca(this.inner,(n,r)=>{for(const[a,s]of r)e(a,s)})}isEmpty(){return jw(this.inner)}size(){return this.innerSize}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const B_=new Ae(G.comparator);function Kn(){return B_}const Zw=new Ae(G.comparator);function $s(...t){let e=Zw;for(const n of t)e=e.insert(n.key,n);return e}function eE(t){let e=Zw;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Hr(){return si()}function tE(){return si()}function si(){return new Es(t=>t.toString(),(t,e)=>t.isEqual(e))}const $_=new Ae(G.comparator),H_=new ft(G.comparator);function oe(...t){let e=H_;for(const n of t)e=e.add(n);return e}const K_=new ft(he);function W_(){return K_}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function nE(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ru(e)?"-0":e}}function rE(t){return{integerValue:""+t}}function G_(t,e){return C_(e)?rE(e):nE(t,e)}/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ju{constructor(){this._=void 0}}function Q_(t,e,n){return t instanceof zi?function(r,a){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return a&&hm(a)&&(a=fm(a)),a&&(s.fields.__previous_value__=a),{mapValue:s}}(n,e):t instanceof ji?sE(t,e):t instanceof qi?iE(t,e):function(r,a){const s=aE(r,a),i=ay(s)+ay(r.gt);return bh(s)&&bh(r.gt)?rE(i):nE(r.serializer,i)}(t,e)}function Y_(t,e,n){return t instanceof ji?sE(t,e):t instanceof qi?iE(t,e):n}function aE(t,e){return t instanceof su?bh(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class zi extends Ju{}class ji extends Ju{constructor(e){super(),this.elements=e}}function sE(t,e){const n=oE(e);for(const r of t.elements)n.some(a=>Nn(a,r))||n.push(r);return{arrayValue:{values:n}}}class qi extends Ju{constructor(e){super(),this.elements=e}}function iE(t,e){let n=oE(e);for(const r of t.elements)n=n.filter(a=>!Nn(a,r));return{arrayValue:{values:n}}}class su extends Ju{constructor(e,n){super(),this.serializer=e,this.gt=n}}function ay(t){return Ve(t.integerValue||t.doubleValue)}function oE(t){return mm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class X_{constructor(e,n){this.field=e,this.transform=n}}function J_(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof ji&&r instanceof ji||n instanceof qi&&r instanceof qi?rs(n.elements,r.elements,Nn):n instanceof su&&r instanceof su?Nn(n.gt,r.gt):n instanceof zi&&r instanceof zi}(t.transform,e.transform)}class Z_{constructor(e,n){this.version=e,this.transformResults=n}}class kt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new kt}static exists(e){return new kt(void 0,e)}static updateTime(e){return new kt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Zu{}function lE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ec(t.key,kt.none()):new ho(t.key,t.data,kt.none());{const n=t.data,r=It.empty();let a=new ft(ct.comparator);for(let s of e.fields)if(!a.has(s)){let i=n.field(s);i===null&&s.length>1&&(s=s.popLast(),i=n.field(s)),i===null?r.delete(s):r.set(s,i),a=a.add(s)}return new Pr(t.key,r,new Ot(a.toArray()),kt.none())}}function eT(t,e,n){t instanceof ho?function(r,a,s){const i=r.value.clone(),o=iy(r.fieldTransforms,a,s.transformResults);i.setAll(o),a.convertToFoundDocument(s.version,i).setHasCommittedMutations()}(t,e,n):t instanceof Pr?function(r,a,s){if(!pl(r.precondition,a))return void a.convertToUnknownDocument(s.version);const i=iy(r.fieldTransforms,a,s.transformResults),o=a.data;o.setAll(uE(r)),o.setAll(i),a.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,n):function(r,a,s){a.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,n)}function ii(t,e,n,r){return t instanceof ho?function(a,s,i,o){if(!pl(a.precondition,s))return i;const u=a.value.clone(),c=oy(a.fieldTransforms,o,s);return u.setAll(c),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Pr?function(a,s,i,o){if(!pl(a.precondition,s))return i;const u=oy(a.fieldTransforms,o,s),c=s.data;return c.setAll(uE(a)),c.setAll(u),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),i===null?null:i.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(a,s,i){return pl(a.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):i}(t,e,n)}function tT(t,e){let n=null;for(const r of t.fieldTransforms){const a=e.data.field(r.field),s=aE(r.transform,a||null);s!=null&&(n===null&&(n=It.empty()),n.set(r.field,s))}return n||null}function sy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&rs(n,r,(a,s)=>J_(a,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ho extends Zu{constructor(e,n,r,a=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Pr extends Zu{constructor(e,n,r,a,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=a,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function uE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function iy(t,e,n){const r=new Map;Ne(t.length===n.length);for(let a=0;a<n.length;a++){const s=t[a],i=s.transform,o=e.data.field(s.field);r.set(s.field,Y_(i,o,n[a]))}return r}function oy(t,e,n){const r=new Map;for(const a of t){const s=a.transform,i=n.data.field(a.field);r.set(a.field,Q_(s,i,e))}return r}class ec extends Zu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nT extends Zu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class rT{constructor(e,n,r,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const s=this.mutations[a];s.key.isEqual(e.key)&&eT(s,e,r[a])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ii(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ii(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=tE();return this.mutations.forEach(a=>{const s=e.get(a.key),i=s.overlayedDocument;let o=this.applyToLocalView(i,s.mutatedFields);o=n.has(a.key)?null:o;const u=lE(i,o);u!==null&&r.set(a.key,u),i.isValidDocument()||i.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),oe())}isEqual(e){return this.batchId===e.batchId&&rs(this.mutations,e.mutations,(n,r)=>sy(n,r))&&rs(this.baseMutations,e.baseMutations,(n,r)=>sy(n,r))}}class vm{constructor(e,n,r,a){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=a}static from(e,n,r){Ne(e.mutations.length===r.length);let a=$_;const s=e.mutations;for(let i=0;i<s.length;i++)a=a.insert(s[i].key,r[i].version);return new vm(e,n,r,a)}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class aT{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class sT{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var Ue,ue;function iT(t){switch(t){default:return ee();case S.CANCELLED:case S.UNKNOWN:case S.DEADLINE_EXCEEDED:case S.RESOURCE_EXHAUSTED:case S.INTERNAL:case S.UNAVAILABLE:case S.UNAUTHENTICATED:return!1;case S.INVALID_ARGUMENT:case S.NOT_FOUND:case S.ALREADY_EXISTS:case S.PERMISSION_DENIED:case S.FAILED_PRECONDITION:case S.ABORTED:case S.OUT_OF_RANGE:case S.UNIMPLEMENTED:case S.DATA_LOSS:return!0}}function cE(t){if(t===void 0)return $n("GRPC error has no .code"),S.UNKNOWN;switch(t){case Ue.OK:return S.OK;case Ue.CANCELLED:return S.CANCELLED;case Ue.UNKNOWN:return S.UNKNOWN;case Ue.DEADLINE_EXCEEDED:return S.DEADLINE_EXCEEDED;case Ue.RESOURCE_EXHAUSTED:return S.RESOURCE_EXHAUSTED;case Ue.INTERNAL:return S.INTERNAL;case Ue.UNAVAILABLE:return S.UNAVAILABLE;case Ue.UNAUTHENTICATED:return S.UNAUTHENTICATED;case Ue.INVALID_ARGUMENT:return S.INVALID_ARGUMENT;case Ue.NOT_FOUND:return S.NOT_FOUND;case Ue.ALREADY_EXISTS:return S.ALREADY_EXISTS;case Ue.PERMISSION_DENIED:return S.PERMISSION_DENIED;case Ue.FAILED_PRECONDITION:return S.FAILED_PRECONDITION;case Ue.ABORTED:return S.ABORTED;case Ue.OUT_OF_RANGE:return S.OUT_OF_RANGE;case Ue.UNIMPLEMENTED:return S.UNIMPLEMENTED;case Ue.DATA_LOSS:return S.DATA_LOSS;default:return ee()}}(ue=Ue||(Ue={}))[ue.OK=0]="OK",ue[ue.CANCELLED=1]="CANCELLED",ue[ue.UNKNOWN=2]="UNKNOWN",ue[ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ue[ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ue[ue.NOT_FOUND=5]="NOT_FOUND",ue[ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",ue[ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",ue[ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",ue[ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ue[ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ue[ue.ABORTED=10]="ABORTED",ue[ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",ue[ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",ue[ue.INTERNAL=13]="INTERNAL",ue[ue.UNAVAILABLE=14]="UNAVAILABLE",ue[ue.DATA_LOSS=15]="DATA_LOSS";/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class bm{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Qo}static getOrCreateInstance(){return Qo===null&&(Qo=new bm),Qo}onExistenceFilterMismatch(e){const n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),()=>this.onExistenceFilterMismatchCallbacks.delete(n)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(n=>n(e))}}let Qo=null;/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function oT(){return new TextEncoder}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const lT=new qa([4294967295,4294967295],0);function ly(t){const e=oT().encode(t),n=new d_;return n.update(e),new Uint8Array(n.digest())}function uy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new qa([n,r],0),new qa([a,s],0)]}class wm{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Hs(`Invalid padding: ${n}`);if(r<0)throw new Hs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Hs(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Hs(`Invalid padding when bitmap length is 0: ${n}`);this.It=8*e.length-n,this.Tt=qa.fromNumber(this.It)}Et(e,n,r){let a=e.add(n.multiply(qa.fromNumber(r)));return a.compare(lT)===1&&(a=new qa([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Tt).toNumber()}At(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}vt(e){if(this.It===0)return!1;const n=ly(e),[r,a]=uy(n);for(let s=0;s<this.hashCount;s++){const i=this.Et(r,a,s);if(!this.At(i))return!1}return!0}static create(e,n,r){const a=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),i=new wm(s,a,n);return r.forEach(o=>i.insert(o)),i}insert(e){if(this.It===0)return;const n=ly(e),[r,a]=uy(n);for(let s=0;s<this.hashCount;s++){const i=this.Et(r,a,s);this.Rt(i)}}Rt(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Hs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class tc{constructor(e,n,r,a,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const a=new Map;return a.set(e,fo.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new tc(te.min(),a,new Ae(he),Kn(),oe())}}class fo{constructor(e,n,r,a,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new fo(r,n,oe(),oe(),oe())}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class gl{constructor(e,n,r,a){this.Pt=e,this.removedTargetIds=n,this.key=r,this.bt=a}}class dE{constructor(e,n){this.targetId=e,this.Vt=n}}class hE{constructor(e,n,r=yt.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=a}}class cy{constructor(){this.St=0,this.Dt=hy(),this.Ct=yt.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return this.St!==0}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=oe(),n=oe(),r=oe();return this.Dt.forEach((a,s)=>{switch(s){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:r=r.add(a);break;default:ee()}}),new fo(this.Ct,this.xt,e,n,r)}Ft(){this.Nt=!1,this.Dt=hy()}Bt(e,n){this.Nt=!0,this.Dt=this.Dt.insert(e,n)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class uT{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Kn(),this.zt=dy(),this.Wt=new Ae(he)}Ht(e){for(const n of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(n,e.bt):this.Yt(n,e.key,e.bt);for(const n of e.removedTargetIds)this.Yt(n,e.key,e.bt)}Xt(e){this.forEachTarget(e,n=>{const r=this.Zt(n);switch(e.state){case 0:this.te(n)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(n);break;case 3:this.te(n)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:this.te(n)&&(this.ee(n),r.$t(e.resumeToken));break;default:ee()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Qt.forEach((r,a)=>{this.te(a)&&n(a)})}ne(e){var n;const r=e.targetId,a=e.Vt.count,s=this.se(r);if(s){const i=s.target;if(Eh(i))if(a===0){const o=new G(i.path);this.Yt(r,o,ut.newNoDocument(o,te.min()))}else Ne(a===1);else{const o=this.ie(r);if(o!==a){const u=this.re(e,o);if(u!==0){this.ee(r);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(r,c)}(n=bm.instance)===null||n===void 0||n.notifyOnExistenceFilterMismatch(function(c,d,h){var f,g,v,b,E,m;const p={localCacheCount:d,existenceFilterCount:h.count},y=h.unchangedNames;return y&&(p.bloomFilter={applied:c===0,hashCount:(f=y==null?void 0:y.hashCount)!==null&&f!==void 0?f:0,bitmapLength:(b=(v=(g=y==null?void 0:y.bits)===null||g===void 0?void 0:g.bitmap)===null||v===void 0?void 0:v.length)!==null&&b!==void 0?b:0,padding:(m=(E=y==null?void 0:y.bits)===null||E===void 0?void 0:E.padding)!==null&&m!==void 0?m:0}),p}(u,o,e.Vt))}}}}re(e,n){const{unchangedNames:r,count:a}=e.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:s="",padding:i=0},hashCount:o=0}=r;let u,c;try{u=aa(s).toUint8Array()}catch(d){if(d instanceof qw)return ns("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw d}try{c=new wm(u,i,o)}catch(d){return ns(d instanceof Hs?"BloomFilter error: ":"Applying bloom filter failed: ",d),1}return c.It===0?1:a!==n-this.oe(e.targetId,c)?2:0}oe(e,n){const r=this.Gt.getRemoteKeysForTarget(e);let a=0;return r.forEach(s=>{const i=this.Gt.ue(),o=`projects/${i.projectId}/databases/${i.database}/documents/${s.path.canonicalString()}`;n.vt(o)||(this.Yt(e,s,null),a++)}),a}ce(e){const n=new Map;this.Qt.forEach((s,i)=>{const o=this.se(i);if(o){if(s.current&&Eh(o.target)){const u=new G(o.target.path);this.jt.get(u)!==null||this.ae(i,u)||this.Yt(i,u,ut.newNoDocument(u,e))}s.Mt&&(n.set(i,s.Ot()),s.Ft())}});let r=oe();this.zt.forEach((s,i)=>{let o=!0;i.forEachWhile(u=>{const c=this.se(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(r=r.add(s))}),this.jt.forEach((s,i)=>i.setReadTime(e));const a=new tc(e,n,this.Wt,this.jt,r);return this.jt=Kn(),this.zt=dy(),this.Wt=new Ae(he),a}Jt(e,n){if(!this.te(e))return;const r=this.ae(e,n.key)?2:0;this.Zt(e).Bt(n.key,r),this.jt=this.jt.insert(n.key,n),this.zt=this.zt.insert(n.key,this.he(n.key).add(e))}Yt(e,n,r){if(!this.te(e))return;const a=this.Zt(e);this.ae(e,n)?a.Bt(n,1):a.Lt(n),this.zt=this.zt.insert(n,this.he(n).delete(e)),r&&(this.jt=this.jt.insert(n,r))}removeTarget(e){this.Qt.delete(e)}ie(e){const n=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let n=this.Qt.get(e);return n||(n=new cy,this.Qt.set(e,n)),n}he(e){let n=this.zt.get(e);return n||(n=new ft(he),this.zt=this.zt.insert(e,n)),n}te(e){const n=this.se(e)!==null;return n||K("WatchChangeAggregator","Detected inactive target",e),n}se(e){const n=this.Qt.get(e);return n&&n.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new cy),this.Gt.getRemoteKeysForTarget(e).forEach(n=>{this.Yt(e,n,null)})}ae(e,n){return this.Gt.getRemoteKeysForTarget(e).has(n)}}function dy(){return new Ae(G.comparator)}function hy(){return new Ae(G.comparator)}const cT={asc:"ASCENDING",desc:"DESCENDING"},dT={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},hT={and:"AND",or:"OR"};class fT{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Sh(t,e){return t.useProto3Json||Wu(e)?e:{value:e}}function iu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function mT(t,e){return iu(t,e.toTimestamp())}function xn(t){return Ne(!!t),te.fromTimestamp(function(e){const n=Cr(e);return new le(n.seconds,n.nanos)}(t))}function Em(t,e){return function(n){return new ke(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function mE(t){const e=ke.fromString(t);return Ne(vE(e)),e}function Ch(t,e){return Em(t.databaseId,e.path)}function Xc(t,e){const n=mE(e);if(n.get(1)!==t.databaseId.projectId)throw new $(S.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new $(S.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new G(pE(n))}function Ih(t,e){return Em(t.databaseId,e)}function pT(t){const e=mE(t);return e.length===4?ke.emptyPath():pE(e)}function _h(t){return new ke(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function pE(t){return Ne(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function fy(t,e,n){return{name:Ch(t,e),fields:n.value.mapValue.fields}}function gT(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ee()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],s=function(u,c){return u.useProto3Json?(Ne(c===void 0||typeof c=="string"),yt.fromBase64String(c||"")):(Ne(c===void 0||c instanceof Uint8Array),yt.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),i=e.targetChange.cause,o=i&&function(u){const c=u.code===void 0?S.UNKNOWN:cE(u.code);return new $(c,u.message||"")}(i);n=new hE(r,a,s,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=Xc(t,r.document.name),s=xn(r.document.updateTime),i=r.document.createTime?xn(r.document.createTime):te.min(),o=new It({mapValue:{fields:r.document.fields}}),u=ut.newFoundDocument(a,s,i,o),c=r.targetIds||[],d=r.removedTargetIds||[];n=new gl(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=Xc(t,r.document),s=r.readTime?xn(r.readTime):te.min(),i=ut.newNoDocument(a,s),o=r.removedTargetIds||[];n=new gl([],o,i.key,i)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=Xc(t,r.document),s=r.removedTargetIds||[];n=new gl([],s,a,null)}else{if(!("filter"in e))return ee();{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:s}=r,i=new sT(a,s),o=r.targetId;n=new dE(o,i)}}return n}function yT(t,e){let n;if(e instanceof ho)n={update:fy(t,e.key,e.value)};else if(e instanceof ec)n={delete:Ch(t,e.key)};else if(e instanceof Pr)n={update:fy(t,e.key,e.data),updateMask:CT(e.fieldMask)};else{if(!(e instanceof nT))return ee();n={verify:Ch(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(a,s){const i=s.transform;if(i instanceof zi)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(i instanceof ji)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:i.elements}};if(i instanceof qi)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:i.elements}};if(i instanceof su)return{fieldPath:s.field.canonicalString(),increment:i.gt};throw ee()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,a){return a.updateTime!==void 0?{updateTime:mT(r,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ee()}(t,e.precondition)),n}function vT(t,e){return t&&t.length>0?(Ne(e!==void 0),t.map(n=>function(r,a){let s=r.updateTime?xn(r.updateTime):xn(a);return s.isEqual(te.min())&&(s=xn(a)),new Z_(s,r.transformResults||[])}(n,e))):[]}function bT(t,e){return{documents:[Ih(t,e.path)]}}function wT(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Ih(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ih(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const a=function(u){if(u.length!==0)return yE(on.create(u,"and"))}(e.filters);a&&(n.structuredQuery.where=a);const s=function(u){if(u.length!==0)return u.map(c=>function(d){return{field:ya(d.field),direction:xT(d.dir)}}(c))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const i=Sh(t,e.limit);var o;return i!==null&&(n.structuredQuery.limit=i),e.startAt&&(n.structuredQuery.startAt={before:(o=e.startAt).inclusive,values:o.position}),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),n}function ET(t){let e=pT(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){Ne(r===1);const d=n.from[0];d.allDescendants?a=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(d){const h=gE(d);return h instanceof on&&Kw(h)?h.getFilters():[h]}(n.where));let i=[];n.orderBy&&(i=n.orderBy.map(d=>function(h){return new Ba(va(h.field),function(f){switch(f){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(d)));let o=null;n.limit&&(o=function(d){let h;return h=typeof d=="object"?d.value:d,Wu(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(d){const h=!!d.before,f=d.values||[];return new au(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){const h=!d.before,f=d.values||[];return new au(f,h)}(n.endAt)),z_(e,a,i,s,o,"F",u,c)}function kT(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ee()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function gE(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=va(e.unaryFilter.field);return je.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=va(e.unaryFilter.field);return je.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=va(e.unaryFilter.field);return je.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=va(e.unaryFilter.field);return je.create(s,"!=",{nullValue:"NULL_VALUE"});default:return ee()}}(t):t.fieldFilter!==void 0?function(e){return je.create(va(e.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ee()}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return on.create(e.compositeFilter.filters.map(n=>gE(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return ee()}}(e.compositeFilter.op))}(t):ee()}function xT(t){return cT[t]}function NT(t){return dT[t]}function ST(t){return hT[t]}function ya(t){return{fieldPath:t.canonicalString()}}function va(t){return ct.fromServerFormat(t.fieldPath)}function yE(t){return t instanceof je?function(e){if(e.op==="=="){if(Zg(e.value))return{unaryFilter:{field:ya(e.field),op:"IS_NAN"}};if(Jg(e.value))return{unaryFilter:{field:ya(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Zg(e.value))return{unaryFilter:{field:ya(e.field),op:"IS_NOT_NAN"}};if(Jg(e.value))return{unaryFilter:{field:ya(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ya(e.field),op:NT(e.op),value:e.value}}}(t):t instanceof on?function(e){const n=e.getFilters().map(r=>yE(r));return n.length===1?n[0]:{compositeFilter:{op:ST(e.op),filters:n}}}(t):ee()}function CT(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function vE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ur{constructor(e,n,r,a,s=te.min(),i=te.min(),o=yt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=u}withSequenceNumber(e){return new ur(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ur(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ur(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ur(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class IT{constructor(e){this.fe=e}}function _T(t){const e=ET({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?xh(e,e.limit,"L"):e}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class TT{constructor(){this.rn=new DT}addToCollectionParentIndex(e,n){return this.rn.add(n),V.resolve()}getCollectionParents(e,n){return V.resolve(this.rn.getEntries(n))}addFieldIndex(e,n){return V.resolve()}deleteFieldIndex(e,n){return V.resolve()}getDocumentsMatchingTarget(e,n){return V.resolve(null)}getIndexType(e,n){return V.resolve(0)}getFieldIndexes(e,n){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,n){return V.resolve(Sr.min())}getMinOffsetFromCollectionGroup(e,n){return V.resolve(Sr.min())}updateCollectionGroup(e,n,r){return V.resolve()}updateIndexEntries(e,n){return V.resolve()}}class DT{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),a=this.index[n]||new ft(ke.comparator),s=!a.has(r);return this.index[n]=a.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),a=this.index[n];return a&&a.has(r)}getEntries(e){return(this.index[e]||new ft(ke.comparator)).toArray()}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class is{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new is(0)}static Mn(){return new is(-1)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class AT{constructor(){this.changes=new Es(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ut.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?V.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*//**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class RT{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class PT{constructor(e,n,r,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(a=>(r=a,this.remoteDocumentCache.getEntry(e,n))).next(a=>(r!==null&&ii(r.mutation,a,Ot.empty(),le.now()),a))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,oe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=oe()){const a=Hr();return this.populateOverlays(e,a,n).next(()=>this.computeViews(e,n,a,r).next(s=>{let i=$s();return s.forEach((o,u)=>{i=i.insert(o,u.overlayedDocument)}),i}))}getOverlayedDocuments(e,n){const r=Hr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,oe()))}populateOverlays(e,n,r){const a=[];return r.forEach(s=>{n.has(s)||a.push(s)}),this.documentOverlayCache.getOverlays(e,a).next(s=>{s.forEach((i,o)=>{n.set(i,o)})})}computeViews(e,n,r,a){let s=Kn();const i=si(),o=si();return n.forEach((u,c)=>{const d=r.get(c.key);a.has(c.key)&&(d===void 0||d.mutation instanceof Pr)?s=s.insert(c.key,c):d!==void 0?(i.set(c.key,d.mutation.getFieldMask()),ii(d.mutation,c,d.mutation.getFieldMask(),le.now())):i.set(c.key,Ot.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,d)=>i.set(c,d)),n.forEach((c,d)=>{var h;return o.set(c,new RT(d,(h=i.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,n){const r=si();let a=new Ae((i,o)=>i-o),s=oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(i=>{for(const o of i)o.keys().forEach(u=>{const c=n.get(u);if(c===null)return;let d=r.get(u)||Ot.empty();d=o.applyToLocalView(c,d),r.set(u,d);const h=(a.get(o.batchId)||oe()).add(u);a=a.insert(o.batchId,h)})}).next(()=>{const i=[],o=a.getReverseIterator();for(;o.hasNext();){const u=o.getNext(),c=u.key,d=u.value,h=tE();d.forEach(f=>{if(!s.has(f)){const g=lE(n.get(f),r.get(f));g!==null&&h.set(f,g),s=s.add(f)}}),i.push(this.documentOverlayCache.saveOverlays(e,c,h))}return V.waitFor(i)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(a){return G.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Yw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,a).next(s=>{const i=a-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,a-s.size):V.resolve(Hr());let o=-1,u=s;return i.next(c=>V.forEach(c,(d,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),s.get(d)?V.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{u=u.insert(d,f)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,oe())).next(d=>({batchId:o,changes:eE(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new G(n)).next(r=>{let a=$s();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const a=n.collectionGroup;let s=$s();return this.indexManager.getCollectionParents(e,a).next(i=>V.forEach(i,o=>{const u=function(c,d){return new ws(d,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,o.child(a));return this.getDocumentsMatchingCollectionQuery(e,u,r).next(c=>{c.forEach((d,h)=>{s=s.insert(d,h)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,r){let a;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(s=>(a=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,a))).next(s=>{a.forEach((o,u)=>{const c=u.getKey();s.get(c)===null&&(s=s.insert(c,ut.newInvalidDocument(c)))});let i=$s();return s.forEach((o,u)=>{const c=a.get(o);c!==void 0&&ii(c.mutation,u,Ot.empty(),le.now()),Xu(n,u)&&(i=i.insert(o,u))}),i})}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class OT{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,n){return V.resolve(this.cs.get(n))}saveBundleMetadata(e,n){var r;return this.cs.set(n.id,{id:(r=n).id,version:r.version,createTime:xn(r.createTime)}),V.resolve()}getNamedQuery(e,n){return V.resolve(this.hs.get(n))}saveNamedQuery(e,n){return this.hs.set(n.name,function(r){return{name:r.name,query:_T(r.bundledQuery),readTime:xn(r.readTime)}}(n)),V.resolve()}}/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class LT{constructor(){this.overlays=new Ae(G.comparator),this.ls=new Map}getOverlay(e,n){return V.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Hr();return V.forEach(n,a=>this.getOverlay(e,a).next(s=>{s!==null&&r.set(a,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((a,s)=>{this.we(e,n,s)}),V.resolve()}removeOverlaysForBatchId(e,n,r){const a=this.ls.get(r);return a!==void 0&&(a.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(r)),V.resolve()}getOverlaysForCollection(e,n,r){const a=Hr(),s=n.length+1,i=new G(n.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const u=o.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&a.set(u.getKey(),u)}return V.resolve(a)}getOverlaysForCollectionGroup(e,n,r,a){let s=new Ae((c,d)=>c-d);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=s.get(c.largestBatchId);d===null&&(d=Hr(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const o=Hr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>o.set(c,d)),!(o.size()>=a)););return V.resolve(o)}we(e,n,r){const a=this.overlays.get(r.key);if(a!==null){const i=this.ls.get(a.largestBatchId).delete(r.key);this.ls.set(a.largestBatchId,i)}this.overlays=this.overlays.insert(r.key,new aT(n,r));let s=this.ls.get(n);s===void 0&&(s=oe(),this.ls.set(n,s)),this.ls.set(n,s.add(r.key))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class km{constructor(){this.fs=new ft(Ke.ds),this.ws=new ft(Ke._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,n){const r=new Ke(e,n);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.ys(new Ke(e,n))}ps(e,n){e.forEach(r=>this.removeReference(r,n))}Is(e){const n=new G(new ke([])),r=new Ke(n,e),a=new Ke(n,e+1),s=[];return this.ws.forEachInRange([r,a],i=>{this.ys(i),s.push(i.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const n=new G(new ke([])),r=new Ke(n,e),a=new Ke(n,e+1);let s=oe();return this.ws.forEachInRange([r,a],i=>{s=s.add(i.key)}),s}containsKey(e){const n=new Ke(e,0),r=this.fs.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ke{constructor(e,n){this.key=e,this.As=n}static ds(e,n){return G.comparator(e.key,n.key)||he(e.As,n.As)}static _s(e,n){return he(e.As,n.As)||G.comparator(e.key,n.key)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class MT{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.vs=1,this.Rs=new ft(Ke.ds)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,a){const s=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new rT(s,n,r,a);this.mutationQueue.push(i);for(const o of a)this.Rs=this.Rs.add(new Ke(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return V.resolve(i)}lookupMutationBatch(e,n){return V.resolve(this.Ps(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,a=this.bs(r),s=a<0?0:a;return V.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.vs-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ke(n,0),a=new Ke(n,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([r,a],i=>{const o=this.Ps(i.As);s.push(o)}),V.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ft(he);return n.forEach(a=>{const s=new Ke(a,0),i=new Ke(a,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,i],o=>{r=r.add(o.As)})}),V.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,a=r.length+1;let s=r;G.isDocumentKey(s)||(s=s.child(""));const i=new Ke(new G(s),0);let o=new ft(he);return this.Rs.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===a&&(o=o.add(u.As)),!0)},i),V.resolve(this.Vs(o))}Vs(e){const n=[];return e.forEach(r=>{const a=this.Ps(r);a!==null&&n.push(a)}),n}removeMutationBatch(e,n){Ne(this.Ss(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.Rs;return V.forEach(n.mutations,a=>{const s=new Ke(a.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Rs=r})}Cn(e){}containsKey(e,n){const r=new Ke(n,0),a=this.Rs.firstAfterOrEqual(r);return V.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Ss(e,n){return this.bs(e)}bs(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Ps(e){const n=this.bs(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class FT{constructor(e){this.Ds=e,this.docs=new Ae(G.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,a=this.docs.get(r),s=a?a.size:0,i=this.Ds(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return V.resolve(r?r.document.mutableCopy():ut.newInvalidDocument(n))}getEntries(e,n){let r=Kn();return n.forEach(a=>{const s=this.docs.get(a);r=r.insert(a,s?s.document.mutableCopy():ut.newInvalidDocument(a))}),V.resolve(r)}getDocumentsMatchingQuery(e,n,r,a){let s=Kn();const i=n.path,o=new G(i.child("")),u=this.docs.getIteratorFrom(o);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||x_(k_(d),r)<=0||(a.has(d.key)||Xu(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return V.resolve(s)}getAllFromCollectionGroup(e,n,r,a){ee()}Cs(e,n){return V.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new UT(this)}getSize(e){return V.resolve(this.size)}}class UT extends AT{constructor(e){super(),this.os=e}applyChanges(e){const n=[];return this.changes.forEach((r,a)=>{a.isValidDocument()?n.push(this.os.addEntry(e,a)):this.os.removeEntry(r)}),V.waitFor(n)}getFromCache(e,n){return this.os.getEntry(e,n)}getAllFromCache(e,n){return this.os.getEntries(e,n)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class VT{constructor(e){this.persistence=e,this.xs=new Es(n=>pm(n),gm),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.Ns=0,this.ks=new km,this.targetCount=0,this.Ms=is.kn()}forEachTarget(e,n){return this.xs.forEach((r,a)=>n(a)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Ns&&(this.Ns=n),V.resolve()}Fn(e){this.xs.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Ms=new is(n),this.highestTargetId=n),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,n){return this.Fn(n),this.targetCount+=1,V.resolve()}updateTargetData(e,n){return this.Fn(n),V.resolve()}removeTargetData(e,n){return this.xs.delete(n.target),this.ks.Is(n.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,n,r){let a=0;const s=[];return this.xs.forEach((i,o)=>{o.sequenceNumber<=n&&r.get(o.targetId)===null&&(this.xs.delete(i),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),a++)}),V.waitFor(s).next(()=>a)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,n){const r=this.xs.get(n)||null;return V.resolve(r)}addMatchingKeys(e,n,r){return this.ks.gs(n,r),V.resolve()}removeMatchingKeys(e,n,r){this.ks.ps(n,r);const a=this.persistence.referenceDelegate,s=[];return a&&n.forEach(i=>{s.push(a.markPotentiallyOrphaned(e,i))}),V.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.ks.Is(n),V.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ks.Es(n);return V.resolve(r)}containsKey(e,n){return V.resolve(this.ks.containsKey(n))}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class zT{constructor(e,n){this.$s={},this.overlays={},this.Os=new dm(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new VT(this),this.indexManager=new TT,this.remoteDocumentCache=function(r){return new FT(r)}(r=>this.referenceDelegate.Ls(r)),this.serializer=new IT(n),this.qs=new OT(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new LT,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.$s[e.toKey()];return r||(r=new MT(n,this.referenceDelegate),this.$s[e.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,n,r){K("MemoryPersistence","Starting transaction:",e);const a=new jT(this.Os.next());return this.referenceDelegate.Us(),r(a).next(s=>this.referenceDelegate.Ks(a).next(()=>s)).toPromise().then(s=>(a.raiseOnCommittedEvent(),s))}Gs(e,n){return V.or(Object.values(this.$s).map(r=>()=>r.containsKey(e,n)))}}class jT extends S_{constructor(e){super(),this.currentSequenceNumber=e}}class xm{constructor(e){this.persistence=e,this.Qs=new km,this.js=null}static zs(e){return new xm(e)}get Ws(){if(this.js)return this.js;throw ee()}addReference(e,n,r){return this.Qs.addReference(r,n),this.Ws.delete(r.toString()),V.resolve()}removeReference(e,n,r){return this.Qs.removeReference(r,n),this.Ws.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,n){return this.Ws.add(n.toString()),V.resolve()}removeTarget(e,n){this.Qs.Is(n.targetId).forEach(a=>this.Ws.add(a.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(a=>{a.forEach(s=>this.Ws.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Us(){this.js=new Set}Ks(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Ws,r=>{const a=G.fromPath(r);return this.Hs(e,a).next(s=>{s||n.removeEntry(a,te.min())})}).next(()=>(this.js=null,n.apply(e)))}updateLimboDocument(e,n){return this.Hs(e,n).next(r=>{r?this.Ws.delete(n.toString()):this.Ws.add(n.toString())})}Ls(e){return 0}Hs(e,n){return V.or([()=>V.resolve(this.Qs.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gs(e,n)])}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Nm{constructor(e,n,r,a){this.targetId=e,this.fromCache=n,this.Fi=r,this.Bi=a}static Li(e,n){let r=oe(),a=oe();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}return new Nm(e,n.fromCache,r,a)}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class qT{constructor(){this.qi=!1}initialize(e,n){this.Ui=e,this.indexManager=n,this.qi=!0}getDocumentsMatchingQuery(e,n,r,a){return this.Ki(e,n).next(s=>s||this.Gi(e,n,a,r)).next(s=>s||this.Qi(e,n))}Ki(e,n){if(ry(n))return V.resolve(null);let r=Hn(n);return this.indexManager.getIndexType(e,r).next(a=>a===0?null:(n.limit!==null&&a===1&&(n=xh(n,null,"F"),r=Hn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const i=oe(...s);return this.Ui.getDocuments(e,i).next(o=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.ji(n,o);return this.zi(n,c,i,u.readTime)?this.Ki(e,xh(n,null,"F")):this.Wi(e,c,n,u)}))})))}Gi(e,n,r,a){return ry(n)||a.isEqual(te.min())?this.Qi(e,n):this.Ui.getDocuments(e,r).next(s=>{const i=this.ji(n,s);return this.zi(n,i,r,a)?this.Qi(e,n):(Kg()<=de.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Nh(n)),this.Wi(e,i,n,E_(a,-1)))})}ji(e,n){let r=new ft(Jw(e));return n.forEach((a,s)=>{Xu(e,s)&&(r=r.add(s))}),r}zi(e,n,r,a){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(a)>0)}Qi(e,n){return Kg()<=de.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Nh(n)),this.Ui.getDocumentsMatchingQuery(e,n,Sr.min())}Wi(e,n,r,a){return this.Ui.getDocumentsMatchingQuery(e,r,a).next(s=>(n.forEach(i=>{s=s.insert(i.key,i)}),s))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class BT{constructor(e,n,r,a){this.persistence=e,this.Hi=n,this.serializer=a,this.Ji=new Ae(he),this.Yi=new Es(s=>pm(s),gm),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(r)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new PT(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ji))}}function $T(t,e,n,r){return new BT(t,e,n,r)}async function bE(t,e){const n=ne(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let a;return n.mutationQueue.getAllMutationBatches(r).next(s=>(a=s,n.tr(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const i=[],o=[];let u=oe();for(const c of a){i.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of s){o.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return n.localDocuments.getDocuments(r,u).next(c=>({er:c,removedBatchIds:i,addedBatchIds:o}))})})}function HT(t,e){const n=ne(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const a=e.batch.keys(),s=n.Zi.newChangeBuffer({trackRemovals:!0});return function(i,o,u,c){const d=u.batch,h=d.keys();let f=V.resolve();return h.forEach(g=>{f=f.next(()=>c.getEntry(o,g)).next(v=>{const b=u.docVersions.get(g);Ne(b!==null),v.version.compareTo(b)<0&&(d.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),c.addEntry(v)))})}),f.next(()=>i.mutationQueue.removeMutationBatch(o,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(i){let o=oe();for(let u=0;u<i.mutationResults.length;++u)i.mutationResults[u].transformResults.length>0&&(o=o.add(i.batch.mutations[u].key));return o}(e))).next(()=>n.localDocuments.getDocuments(r,a))})}function wE(t){const e=ne(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Bs.getLastRemoteSnapshotVersion(n))}function KT(t,e){const n=ne(t),r=e.snapshotVersion;let a=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const i=n.Zi.newChangeBuffer({trackRemovals:!0});a=n.Ji;const o=[];e.targetChanges.forEach((d,h)=>{const f=a.get(h);if(!f)return;o.push(n.Bs.removeMatchingKeys(s,d.removedDocuments,h).next(()=>n.Bs.addMatchingKeys(s,d.addedDocuments,h)));let g=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?g=g.withResumeToken(yt.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):d.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(d.resumeToken,r)),a=a.insert(h,g),function(v,b,E){return v.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(f,g,d)&&o.push(n.Bs.updateTargetData(s,g))});let u=Kn(),c=oe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),o.push(WT(s,i,e.documentUpdates).next(d=>{u=d.nr,c=d.sr})),!r.isEqual(te.min())){const d=n.Bs.getLastRemoteSnapshotVersion(s).next(h=>n.Bs.setTargetsMetadata(s,s.currentSequenceNumber,r));o.push(d)}return V.waitFor(o).next(()=>i.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.Ji=a,s))}function WT(t,e,n){let r=oe(),a=oe();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let i=Kn();return n.forEach((o,u)=>{const c=s.get(o);u.isFoundDocument()!==c.isFoundDocument()&&(a=a.add(o)),u.isNoDocument()&&u.version.isEqual(te.min())?(e.removeEntry(o,u.readTime),i=i.insert(o,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),i=i.insert(o,u)):K("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",u.version)}),{nr:i,sr:a}})}function GT(t,e){const n=ne(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function QT(t,e){const n=ne(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let a;return n.Bs.getTargetData(r,e).next(s=>s?(a=s,V.resolve(a)):n.Bs.allocateTargetId(r).next(i=>(a=new ur(e,i,"TargetPurposeListen",r.currentSequenceNumber),n.Bs.addTargetData(r,a).next(()=>a))))}).then(r=>{const a=n.Ji.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(r.targetId,r),n.Yi.set(e,r.targetId)),r})}async function Th(t,e,n){const r=ne(t),a=r.Ji.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,i=>r.persistence.referenceDelegate.removeTarget(i,a))}catch(i){if(!co(i))throw i;K("LocalStore",`Failed to update sequence numbers for target ${e}: ${i}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(a.target)}function my(t,e,n){const r=ne(t);let a=te.min(),s=oe();return r.persistence.runTransaction("Execute query","readonly",i=>function(o,u,c){const d=ne(o),h=d.Yi.get(c);return h!==void 0?V.resolve(d.Ji.get(h)):d.Bs.getTargetData(u,c)}(r,i,Hn(e)).next(o=>{if(o)return a=o.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(i,o.targetId).next(u=>{s=u})}).next(()=>r.Hi.getDocumentsMatchingQuery(i,e,n?a:te.min(),n?s:oe())).next(o=>(YT(r,j_(e),o),{documents:o,ir:s})))}function YT(t,e,n){let r=t.Xi.get(e)||te.min();n.forEach((a,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Xi.set(e,r)}class py{constructor(){this.activeTargetIds=W_()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class XT{constructor(){this.Hr=new py,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,n,r){this.Jr[e]=n}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new py,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class JT{Yr(e){}shutdown(){}}/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class gy{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){K("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){K("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/let Yo=null;function Jc(){return Yo===null?Yo=268435456+Math.round(2147483648*Math.random()):Yo++,"0x"+Yo.toString(16)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const ZT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class e2{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const it="WebChannelConnection";class t2 extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.mo=n+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,n,r,a,s){const i=Jc(),o=this.To(e,n);K("RestConnection",`Sending RPC '${e}' ${i}:`,o,r);const u={};return this.Eo(u,a,s),this.Ao(e,o,u,r).then(c=>(K("RestConnection",`Received RPC '${e}' ${i}: `,c),c),c=>{throw ns("RestConnection",`RPC '${e}' ${i} failed with error: `,c,"url: ",o,"request:",r),c})}vo(e,n,r,a,s,i){return this.Io(e,n,r,a,s)}Eo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+bs,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,s)=>e[s]=a),r&&r.headers.forEach((a,s)=>e[s]=a)}To(e,n){const r=ZT[e];return`${this.mo}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,n,r,a){const s=Jc();return new Promise((i,o)=>{const u=new c_;u.setWithCredentials(!0),u.listenOnce(o_.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Yc.NO_ERROR:const d=u.getResponseJson();K(it,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),i(d);break;case Yc.TIMEOUT:K(it,`RPC '${e}' ${s} timed out`),o(new $(S.DEADLINE_EXCEEDED,"Request time out"));break;case Yc.HTTP_ERROR:const h=u.getStatus();if(K(it,`RPC '${e}' ${s} failed with status:`,h,"response text:",u.getResponseText()),h>0){let f=u.getResponseJson();Array.isArray(f)&&(f=f[0]);const g=f==null?void 0:f.error;if(g&&g.status&&g.message){const v=function(b){const E=b.toLowerCase().replace(/_/g,"-");return Object.values(S).indexOf(E)>=0?E:S.UNKNOWN}(g.status);o(new $(v,g.message))}else o(new $(S.UNKNOWN,"Server responded with status "+u.getStatus()))}else o(new $(S.UNAVAILABLE,"Connection failed."));break;default:ee()}}finally{K(it,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(a);K(it,`RPC '${e}' ${s} sending request:`,a),u.send(n,"POST",c,r,15)})}Ro(e,n,r){const a=Jc(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=s_(),o=i_(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.xmlHttpFactory=new u_({})),this.Eo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const d=s.join("");K(it,`Creating RPC '${e}' stream ${a}: ${d}`,u);const h=i.createWebChannel(d,u);let f=!1,g=!1;const v=new e2({ro:E=>{g?K(it,`Not sending because RPC '${e}' stream ${a} is closed:`,E):(f||(K(it,`Opening RPC '${e}' stream ${a} transport.`),h.open(),f=!0),K(it,`RPC '${e}' stream ${a} sending:`,E),h.send(E))},oo:()=>h.close()}),b=(E,m,p)=>{E.listen(m,y=>{try{p(y)}catch(w){setTimeout(()=>{throw w},0)}})};return b(h,Ko.EventType.OPEN,()=>{g||K(it,`RPC '${e}' stream ${a} transport opened.`)}),b(h,Ko.EventType.CLOSE,()=>{g||(g=!0,K(it,`RPC '${e}' stream ${a} transport closed`),v.wo())}),b(h,Ko.EventType.ERROR,E=>{g||(g=!0,ns(it,`RPC '${e}' stream ${a} transport errored:`,E),v.wo(new $(S.UNAVAILABLE,"The operation could not be completed")))}),b(h,Ko.EventType.MESSAGE,E=>{var m;if(!g){const p=E.data[0];Ne(!!p);const y=p,w=y.error||((m=y[0])===null||m===void 0?void 0:m.error);if(w){K(it,`RPC '${e}' stream ${a} received error:`,w);const C=w.status;let M=function(O){const Q=Ue[O];if(Q!==void 0)return cE(Q)}(C),z=w.message;M===void 0&&(M=S.INTERNAL,z="Unknown error status: "+C+" with message "+w.message),g=!0,v.wo(new $(M,z)),h.close()}else K(it,`RPC '${e}' stream ${a} received:`,p),v._o(p)}}),b(o,l_.STAT_EVENT,E=>{E.stat===$g.PROXY?K(it,`RPC '${e}' stream ${a} detected buffering proxy`):E.stat===$g.NOPROXY&&K(it,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{v.fo()},0),v}}function Zc(){return typeof document<"u"?document:null}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function nc(t){return new fT(t,!0)}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class EE{constructor(e,n,r=1e3,a=1.5,s=6e4){this.ii=e,this.timerId=n,this.Po=r,this.bo=a,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const n=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),a=Math.max(0,n-r);a>0&&K("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.So} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,a,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){this.Do!==null&&(this.Do.skipDelay(),this.Do=null)}cancel(){this.Do!==null&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class kE{constructor(e,n,r,a,s,i,o,u){this.ii=e,this.$o=r,this.Oo=a,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=u,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new EE(e,n)}Uo(){return this.state===1||this.state===5||this.Ko()}Ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&this.Bo===null&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,n){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,e!==4?this.qo.reset():n&&n.code===S.RESOURCE_EXHAUSTED?($n(n.toString()),$n("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):n&&n.code===S.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(n)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),n=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,a])=>{this.Fo===n&&this.Zo(r,a)},r=>{e(()=>{const a=new $(S.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(a)})})}Zo(e,n){const r=this.Xo(this.Fo);this.stream=this.eu(e,n),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(a=>{r(()=>this.tu(a))}),this.stream.onMessage(a=>{r(()=>this.onMessage(a))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return K("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return n=>{this.ii.enqueueAndForget(()=>this.Fo===e?n():(K("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class n2 extends kE{constructor(e,n,r,a,s,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,a,i),this.serializer=s}eu(e,n){return this.connection.Ro("Listen",e,n)}onMessage(e){this.qo.reset();const n=gT(this.serializer,e),r=function(a){if(!("targetChange"in a))return te.min();const s=a.targetChange;return s.targetIds&&s.targetIds.length?te.min():s.readTime?xn(s.readTime):te.min()}(e);return this.listener.nu(n,r)}su(e){const n={};n.database=_h(this.serializer),n.addTarget=function(a,s){let i;const o=s.target;if(i=Eh(o)?{documents:bT(a,o)}:{query:wT(a,o)},i.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){i.resumeToken=fE(a,s.resumeToken);const u=Sh(a,s.expectedCount);u!==null&&(i.expectedCount=u)}else if(s.snapshotVersion.compareTo(te.min())>0){i.readTime=iu(a,s.snapshotVersion.toTimestamp());const u=Sh(a,s.expectedCount);u!==null&&(i.expectedCount=u)}return i}(this.serializer,e);const r=kT(this.serializer,e);r&&(n.labels=r),this.Wo(n)}iu(e){const n={};n.database=_h(this.serializer),n.removeTarget=e,this.Wo(n)}}class r2 extends kE{constructor(e,n,r,a,s,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,a,i),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,n){return this.connection.Ro("Write",e,n)}onMessage(e){if(Ne(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const n=vT(e.writeResults,e.commitTime),r=xn(e.commitTime);return this.listener.cu(r,n)}return Ne(!e.writeResults||e.writeResults.length===0),this.ru=!0,this.listener.au()}hu(){const e={};e.database=_h(this.serializer),this.Wo(e)}uu(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>yT(this.serializer,r))};this.Wo(n)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class a2 extends class{}{constructor(e,n,r,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=a,this.lu=!1}fu(){if(this.lu)throw new $(S.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,s])=>this.connection.Io(e,n,r,a,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new $(S.UNKNOWN,a.toString())})}vo(e,n,r,a){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.vo(e,n,r,s,i,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===S.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new $(S.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class s2{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){this.wu===0&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){this.state==="Online"?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,e==="Online"&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?($n(n),this.mu=!1):K("OnlineStateTracker",n)}Tu(){this._u!==null&&(this._u.cancel(),this._u=null)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class i2{constructor(e,n,r,a,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(i=>{r.enqueueAndForget(async()=>{da(this)&&(K("RemoteStore","Restarting streams for network reachability change."),await async function(o){const u=ne(o);u.vu.add(4),await mo(u),u.bu.set("Unknown"),u.vu.delete(4),await rc(u)}(this))})}),this.bu=new s2(r,a)}}async function rc(t){if(da(t))for(const e of t.Ru)await e(!0)}async function mo(t){for(const e of t.Ru)await e(!1)}function xE(t,e){const n=ne(t);n.Au.has(e.targetId)||(n.Au.set(e.targetId,e),Im(n)?Cm(n):ks(n).Ko()&&Sm(n,e))}function NE(t,e){const n=ne(t),r=ks(n);n.Au.delete(e),r.Ko()&&SE(n,e),n.Au.size===0&&(r.Ko()?r.jo():da(n)&&n.bu.set("Unknown"))}function Sm(t,e){if(t.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ks(t).su(e)}function SE(t,e){t.Vu.qt(e),ks(t).iu(e)}function Cm(t){t.Vu=new uT({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),le:e=>t.Au.get(e)||null,ue:()=>t.datastore.serializer.databaseId}),ks(t).start(),t.bu.gu()}function Im(t){return da(t)&&!ks(t).Uo()&&t.Au.size>0}function da(t){return ne(t).vu.size===0}function CE(t){t.Vu=void 0}async function o2(t){t.Au.forEach((e,n)=>{Sm(t,e)})}async function l2(t,e){CE(t),Im(t)?(t.bu.Iu(e),Cm(t)):t.bu.set("Unknown")}async function u2(t,e,n){if(t.bu.set("Online"),e instanceof hE&&e.state===2&&e.cause)try{await async function(r,a){const s=a.cause;for(const i of a.targetIds)r.Au.has(i)&&(await r.remoteSyncer.rejectListen(i,s),r.Au.delete(i),r.Vu.removeTarget(i))}(t,e)}catch(r){K("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ou(t,r)}else if(e instanceof gl?t.Vu.Ht(e):e instanceof dE?t.Vu.ne(e):t.Vu.Xt(e),!n.isEqual(te.min()))try{const r=await wE(t.localStore);n.compareTo(r)>=0&&await function(a,s){const i=a.Vu.ce(s);return i.targetChanges.forEach((o,u)=>{if(o.resumeToken.approximateByteSize()>0){const c=a.Au.get(u);c&&a.Au.set(u,c.withResumeToken(o.resumeToken,s))}}),i.targetMismatches.forEach((o,u)=>{const c=a.Au.get(o);if(!c)return;a.Au.set(o,c.withResumeToken(yt.EMPTY_BYTE_STRING,c.snapshotVersion)),SE(a,o);const d=new ur(c.target,o,u,c.sequenceNumber);Sm(a,d)}),a.remoteSyncer.applyRemoteEvent(i)}(t,n)}catch(r){K("RemoteStore","Failed to raise snapshot:",r),await ou(t,r)}}async function ou(t,e,n){if(!co(e))throw e;t.vu.add(1),await mo(t),t.bu.set("Offline"),n||(n=()=>wE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K("RemoteStore","Retrying IndexedDB access"),await n(),t.vu.delete(1),await rc(t)})}function IE(t,e){return e().catch(n=>ou(t,n,e))}async function ac(t){const e=ne(t),n=Ir(e);let r=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;c2(e);)try{const a=await GT(e.localStore,r);if(a===null){e.Eu.length===0&&n.jo();break}r=a.batchId,d2(e,a)}catch(a){await ou(e,a)}_E(e)&&TE(e)}function c2(t){return da(t)&&t.Eu.length<10}function d2(t,e){t.Eu.push(e);const n=Ir(t);n.Ko()&&n.ou&&n.uu(e.mutations)}function _E(t){return da(t)&&!Ir(t).Uo()&&t.Eu.length>0}function TE(t){Ir(t).start()}async function h2(t){Ir(t).hu()}async function f2(t){const e=Ir(t);for(const n of t.Eu)e.uu(n.mutations)}async function m2(t,e,n){const r=t.Eu.shift(),a=vm.from(r,e,n);await IE(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await ac(t)}async function p2(t,e){e&&Ir(t).ou&&await async function(n,r){if(a=r.code,iT(a)&&a!==S.ABORTED){const s=n.Eu.shift();Ir(n).Qo(),await IE(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,r)),await ac(n)}var a}(t,e),_E(t)&&TE(t)}async function yy(t,e){const n=ne(t);n.asyncQueue.verifyOperationInProgress(),K("RemoteStore","RemoteStore received new credentials");const r=da(n);n.vu.add(3),await mo(n),r&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.vu.delete(3),await rc(n)}async function g2(t,e){const n=ne(t);e?(n.vu.delete(2),await rc(n)):e||(n.vu.add(2),await mo(n),n.bu.set("Unknown"))}function ks(t){return t.Su||(t.Su=function(e,n,r){const a=ne(e);return a.fu(),new n2(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)}(t.datastore,t.asyncQueue,{uo:o2.bind(null,t),ao:l2.bind(null,t),nu:u2.bind(null,t)}),t.Ru.push(async e=>{e?(t.Su.Qo(),Im(t)?Cm(t):t.bu.set("Unknown")):(await t.Su.stop(),CE(t))})),t.Su}function Ir(t){return t.Du||(t.Du=function(e,n,r){const a=ne(e);return a.fu(),new r2(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)}(t.datastore,t.asyncQueue,{uo:h2.bind(null,t),ao:p2.bind(null,t),au:f2.bind(null,t),cu:m2.bind(null,t)}),t.Ru.push(async e=>{e?(t.Du.Qo(),await ac(t)):(await t.Du.stop(),t.Eu.length>0&&(K("RemoteStore",`Stopping write stream with ${t.Eu.length} pending writes`),t.Eu=[]))})),t.Du}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class _m{constructor(e,n,r,a,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=a,this.removalCallback=s,this.deferred=new Fn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}static createAndSchedule(e,n,r,a,s){const i=Date.now()+r,o=new _m(e,n,i,a,s);return o.start(r),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $(S.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Tm(t,e){if($n("AsyncQueue",`${e}: ${t}`),co(t))return new $(S.UNAVAILABLE,`${e}: ${t}`);throw t}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ha{constructor(e){this.comparator=e?(n,r)=>e(n,r)||G.comparator(n.key,r.key):(n,r)=>G.comparator(n.key,r.key),this.keyedMap=$s(),this.sortedSet=new Ae(this.comparator)}static emptySet(e){return new Ha(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ha)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,s=r.getNext().key;if(!a.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ha;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class vy{constructor(){this.Cu=new Ae(G.comparator)}track(e){const n=e.doc.key,r=this.Cu.get(n);r?e.type!==0&&r.type===3?this.Cu=this.Cu.insert(n,e):e.type===3&&r.type!==1?this.Cu=this.Cu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Cu=this.Cu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Cu=this.Cu.remove(n):e.type===1&&r.type===2?this.Cu=this.Cu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):ee():this.Cu=this.Cu.insert(n,e)}xu(){const e=[];return this.Cu.inorderTraversal((n,r)=>{e.push(r)}),e}}class os{constructor(e,n,r,a,s,i,o,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,a,s){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new os(e,n,Ha.emptySet(n),i,r,a,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==r[a].type||!n[a].doc.isEqual(r[a].doc))return!1;return!0}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class y2{constructor(){this.Nu=void 0,this.listeners=[]}}class v2{constructor(){this.queries=new Es(e=>Xw(e),Yu),this.onlineState="Unknown",this.ku=new Set}}async function Dm(t,e){const n=ne(t),r=e.query;let a=!1,s=n.queries.get(r);if(s||(a=!0,s=new y2),a)try{s.Nu=await n.onListen(r)}catch(i){const o=Tm(i,`Initialization of query '${Nh(e.query)}' failed`);return void e.onError(o)}n.queries.set(r,s),s.listeners.push(e),e.Mu(n.onlineState),s.Nu&&e.$u(s.Nu)&&Rm(n)}async function Am(t,e){const n=ne(t),r=e.query;let a=!1;const s=n.queries.get(r);if(s){const i=s.listeners.indexOf(e);i>=0&&(s.listeners.splice(i,1),a=s.listeners.length===0)}if(a)return n.queries.delete(r),n.onUnlisten(r)}function b2(t,e){const n=ne(t);let r=!1;for(const a of e){const s=a.query,i=n.queries.get(s);if(i){for(const o of i.listeners)o.$u(a)&&(r=!0);i.Nu=a}}r&&Rm(n)}function w2(t,e,n){const r=ne(t),a=r.queries.get(e);if(a)for(const s of a.listeners)s.onError(n);r.queries.delete(e)}function Rm(t){t.ku.forEach(e=>{e.next()})}class Pm{constructor(e,n,r){this.query=e,this.Ou=n,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new os(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),n=!0):this.qu(e,this.onlineState)&&(this.Uu(e),n=!0),this.Bu=e,n}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let n=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),n=!0),n}qu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Ku||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Lu(e){if(e.docChanges.length>0)return!0;const n=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Uu(e){e=os.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class DE{constructor(e){this.key=e}}class AE{constructor(e){this.key=e}}class E2{constructor(e,n){this.query=e,this.Yu=n,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=oe(),this.mutatedKeys=oe(),this.tc=Jw(e),this.ec=new Ha(this.tc)}get nc(){return this.Yu}sc(e,n){const r=n?n.ic:new vy,a=n?n.ec:this.ec;let s=n?n.mutatedKeys:this.mutatedKeys,i=a,o=!1;const u=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,c=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((d,h)=>{const f=a.get(d),g=Xu(this.query,h)?h:null,v=!!f&&this.mutatedKeys.has(f.key),b=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let E=!1;f&&g?f.data.isEqual(g.data)?v!==b&&(r.track({type:3,doc:g}),E=!0):this.rc(f,g)||(r.track({type:2,doc:g}),E=!0,(u&&this.tc(g,u)>0||c&&this.tc(g,c)<0)&&(o=!0)):!f&&g?(r.track({type:0,doc:g}),E=!0):f&&!g&&(r.track({type:1,doc:f}),E=!0,(u||c)&&(o=!0)),E&&(g?(i=i.add(g),s=b?s.add(d):s.delete(d)):(i=i.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;i.size>this.query.limit;){const d=this.query.limitType==="F"?i.last():i.first();i=i.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{ec:i,ic:r,zi:o,mutatedKeys:s}}rc(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const a=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((c,d)=>function(h,f){const g=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ee()}};return g(h)-g(f)}(c.type,d.type)||this.tc(c.doc,d.doc)),this.oc(r);const i=n?this.uc():[],o=this.Zu.size===0&&this.current?1:0,u=o!==this.Xu;return this.Xu=o,s.length!==0||u?{snapshot:new os(this.query,e.ec,a,s,e.mutatedKeys,o===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:i}:{cc:i}}Mu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ec:this.ec,ic:new vy,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(n=>this.Yu=this.Yu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Yu=this.Yu.delete(n)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=oe(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});const n=[];return e.forEach(r=>{this.Zu.has(r)||n.push(new AE(r))}),this.Zu.forEach(r=>{e.has(r)||n.push(new DE(r))}),n}hc(e){this.Yu=e.ir,this.Zu=oe();const n=this.sc(e.documents);return this.applyChanges(n,!0)}lc(){return os.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,this.Xu===0,this.hasCachedResults)}}class k2{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class x2{constructor(e){this.key=e,this.fc=!1}}class N2{constructor(e,n,r,a,s,i){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.dc={},this.wc=new Es(o=>Xw(o),Yu),this._c=new Map,this.mc=new Set,this.gc=new Ae(G.comparator),this.yc=new Map,this.Ic=new km,this.Tc={},this.Ec=new Map,this.Ac=is.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return this.vc===!0}}async function S2(t,e){const n=L2(t);let r,a;const s=n.wc.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),a=s.view.lc();else{const i=await QT(n.localStore,Hn(e)),o=n.sharedClientState.addLocalQueryTarget(i.targetId);r=i.targetId,a=await C2(n,e,r,o==="current",i.resumeToken),n.isPrimaryClient&&xE(n.remoteStore,i)}return a}async function C2(t,e,n,r,a){t.Rc=(h,f,g)=>async function(v,b,E,m){let p=b.view.sc(E);p.zi&&(p=await my(v.localStore,b.query,!1).then(({documents:C})=>b.view.sc(C,p)));const y=m&&m.targetChanges.get(b.targetId),w=b.view.applyChanges(p,v.isPrimaryClient,y);return wy(v,b.targetId,w.cc),w.snapshot}(t,h,f,g);const s=await my(t.localStore,e,!0),i=new E2(e,s.ir),o=i.sc(s.documents),u=fo.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",a),c=i.applyChanges(o,t.isPrimaryClient,u);wy(t,n,c.cc);const d=new k2(e,n,i);return t.wc.set(e,d),t._c.has(n)?t._c.get(n).push(e):t._c.set(n,[e]),c.snapshot}async function I2(t,e){const n=ne(t),r=n.wc.get(e),a=n._c.get(r.targetId);if(a.length>1)return n._c.set(r.targetId,a.filter(s=>!Yu(s,e))),void n.wc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Th(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),NE(n.remoteStore,r.targetId),Dh(n,r.targetId)}).catch(uo)):(Dh(n,r.targetId),await Th(n.localStore,r.targetId,!0))}async function _2(t,e,n){const r=M2(t);try{const a=await function(s,i){const o=ne(s),u=le.now(),c=i.reduce((f,g)=>f.add(g.key),oe());let d,h;return o.persistence.runTransaction("Locally write mutations","readwrite",f=>{let g=Kn(),v=oe();return o.Zi.getEntries(f,c).next(b=>{g=b,g.forEach((E,m)=>{m.isValidDocument()||(v=v.add(E))})}).next(()=>o.localDocuments.getOverlayedDocuments(f,g)).next(b=>{d=b;const E=[];for(const m of i){const p=tT(m,d.get(m.key).overlayedDocument);p!=null&&E.push(new Pr(m.key,p,Bw(p.value.mapValue),kt.exists(!0)))}return o.mutationQueue.addMutationBatch(f,u,E,i)}).next(b=>{h=b;const E=b.applyToLocalDocumentSet(d,v);return o.documentOverlayCache.saveOverlays(f,b.batchId,E)})}).then(()=>({batchId:h.batchId,changes:eE(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),function(s,i,o){let u=s.Tc[s.currentUser.toKey()];u||(u=new Ae(he)),u=u.insert(i,o),s.Tc[s.currentUser.toKey()]=u}(r,a.batchId,n),await po(r,a.changes),await ac(r.remoteStore)}catch(a){const s=Tm(a,"Failed to persist write");n.reject(s)}}async function RE(t,e){const n=ne(t);try{const r=await KT(n.localStore,e);e.targetChanges.forEach((a,s)=>{const i=n.yc.get(s);i&&(Ne(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?i.fc=!0:a.modifiedDocuments.size>0?Ne(i.fc):a.removedDocuments.size>0&&(Ne(i.fc),i.fc=!1))}),await po(n,r,e)}catch(r){await uo(r)}}function by(t,e,n){const r=ne(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const a=[];r.wc.forEach((s,i)=>{const o=i.view.Mu(e);o.snapshot&&a.push(o.snapshot)}),function(s,i){const o=ne(s);o.onlineState=i;let u=!1;o.queries.forEach((c,d)=>{for(const h of d.listeners)h.Mu(i)&&(u=!0)}),u&&Rm(o)}(r.eventManager,e),a.length&&r.dc.nu(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function T2(t,e,n){const r=ne(t);r.sharedClientState.updateQueryState(e,"rejected",n);const a=r.yc.get(e),s=a&&a.key;if(s){let i=new Ae(G.comparator);i=i.insert(s,ut.newNoDocument(s,te.min()));const o=oe().add(s),u=new tc(te.min(),new Map,new Ae(he),i,o);await RE(r,u),r.gc=r.gc.remove(s),r.yc.delete(e),Om(r)}else await Th(r.localStore,e,!1).then(()=>Dh(r,e,n)).catch(uo)}async function D2(t,e){const n=ne(t),r=e.batch.batchId;try{const a=await HT(n.localStore,e);OE(n,r,null),PE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await po(n,a)}catch(a){await uo(a)}}async function A2(t,e,n){const r=ne(t);try{const a=await function(s,i){const o=ne(s);return o.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return o.mutationQueue.lookupMutationBatch(u,i).next(d=>(Ne(d!==null),c=d.keys(),o.mutationQueue.removeMutationBatch(u,d))).next(()=>o.mutationQueue.performConsistencyCheck(u)).next(()=>o.documentOverlayCache.removeOverlaysForBatchId(u,c,i)).next(()=>o.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,c)).next(()=>o.localDocuments.getDocuments(u,c))})}(r.localStore,e);OE(r,e,n),PE(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await po(r,a)}catch(a){await uo(a)}}function PE(t,e){(t.Ec.get(e)||[]).forEach(n=>{n.resolve()}),t.Ec.delete(e)}function OE(t,e,n){const r=ne(t);let a=r.Tc[r.currentUser.toKey()];if(a){const s=a.get(e);s&&(n?s.reject(n):s.resolve(),a=a.remove(e)),r.Tc[r.currentUser.toKey()]=a}}function Dh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t._c.get(e))t.wc.delete(r),n&&t.dc.Pc(r,n);t._c.delete(e),t.isPrimaryClient&&t.Ic.Is(e).forEach(r=>{t.Ic.containsKey(r)||LE(t,r)})}function LE(t,e){t.mc.delete(e.path.canonicalString());const n=t.gc.get(e);n!==null&&(NE(t.remoteStore,n),t.gc=t.gc.remove(e),t.yc.delete(n),Om(t))}function wy(t,e,n){for(const r of n)r instanceof DE?(t.Ic.addReference(r.key,e),R2(t,r)):r instanceof AE?(K("SyncEngine","Document no longer in limbo: "+r.key),t.Ic.removeReference(r.key,e),t.Ic.containsKey(r.key)||LE(t,r.key)):ee()}function R2(t,e){const n=e.key,r=n.path.canonicalString();t.gc.get(n)||t.mc.has(r)||(K("SyncEngine","New document in limbo: "+n),t.mc.add(r),Om(t))}function Om(t){for(;t.mc.size>0&&t.gc.size<t.maxConcurrentLimboResolutions;){const e=t.mc.values().next().value;t.mc.delete(e);const n=new G(ke.fromString(e)),r=t.Ac.next();t.yc.set(r,new x2(n)),t.gc=t.gc.insert(n,r),xE(t.remoteStore,new ur(Hn(Gu(n.path)),r,"TargetPurposeLimboResolution",dm.ct))}}async function po(t,e,n){const r=ne(t),a=[],s=[],i=[];r.wc.isEmpty()||(r.wc.forEach((o,u)=>{i.push(r.Rc(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c!=null&&c.fromCache?"not-current":"current"),c){a.push(c);const d=Nm.Li(u.targetId,c);s.push(d)}}))}),await Promise.all(i),r.dc.nu(a),await async function(o,u){const c=ne(o);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>V.forEach(u,h=>V.forEach(h.Fi,f=>c.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>V.forEach(h.Bi,f=>c.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!co(d))throw d;K("LocalStore","Failed to update sequence numbers: "+d)}for(const d of u){const h=d.targetId;if(!d.fromCache){const f=c.Ji.get(h),g=f.snapshotVersion,v=f.withLastLimboFreeSnapshotVersion(g);c.Ji=c.Ji.insert(h,v)}}}(r.localStore,s))}async function P2(t,e){const n=ne(t);if(!n.currentUser.isEqual(e)){K("SyncEngine","User change. New user:",e.toKey());const r=await bE(n.localStore,e);n.currentUser=e,function(a,s){a.Ec.forEach(i=>{i.forEach(o=>{o.reject(new $(S.CANCELLED,s))})}),a.Ec.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await po(n,r.er)}}function O2(t,e){const n=ne(t),r=n.yc.get(e);if(r&&r.fc)return oe().add(r.key);{let a=oe();const s=n._c.get(e);if(!s)return a;for(const i of s){const o=n.wc.get(i);a=a.unionWith(o.view.nc)}return a}}function L2(t){const e=ne(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=RE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=O2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=T2.bind(null,e),e.dc.nu=b2.bind(null,e.eventManager),e.dc.Pc=w2.bind(null,e.eventManager),e}function M2(t){const e=ne(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=D2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=A2.bind(null,e),e}class Ey{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=nc(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return $T(this.persistence,new qT,e.initialUser,this.serializer)}createPersistence(e){return new zT(xm.zs,this.serializer)}createSharedClientState(e){return new XT}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class F2{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>by(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=P2.bind(null,this.syncEngine),await g2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new v2}createDatastore(e){const n=nc(e.databaseInfo.databaseId),r=(a=e.databaseInfo,new t2(a));var a;return function(s,i,o,u){return new a2(s,i,o,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,a=e.asyncQueue,s=o=>by(this.syncEngine,o,0),i=gy.D()?new gy:new JT,new i2(n,r,a,s,i);var n,r,a,s,i}createSyncEngine(e,n){return function(r,a,s,i,o,u,c){const d=new N2(r,a,s,i,o,u);return c&&(d.vc=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=ne(e);K("RemoteStore","RemoteStore shutting down."),n.vu.add(5),await mo(n),n.Pu.shutdown(),n.bu.set("Unknown")}(this.remoteStore)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*//**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Lm{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):$n("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class U2{constructor(e,n,r,a){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=a,this.user=ot.UNAUTHENTICATED,this.clientId=zw.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{K("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(K("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new $(S.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Fn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Tm(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ed(t,e){t.asyncQueue.verifyOperationInProgress(),K("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async a=>{r.isEqual(a)||(await bE(e.localStore,a),r=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ky(t,e){t.asyncQueue.verifyOperationInProgress();const n=await z2(t);K("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(a=>yy(e.remoteStore,a)),t.setAppCheckTokenChangeListener((a,s)=>yy(e.remoteStore,s)),t._onlineComponents=e}function V2(t){return t.name==="FirebaseError"?t.code===S.FAILED_PRECONDITION||t.code===S.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function z2(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){K("FirestoreClient","Using user provided OfflineComponentProvider");try{await ed(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!V2(n))throw n;ns("Error using user provided cache. Falling back to memory cache: "+n),await ed(t,new Ey)}}else K("FirestoreClient","Using default OfflineComponentProvider"),await ed(t,new Ey);return t._offlineComponents}async function ME(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(K("FirestoreClient","Using user provided OnlineComponentProvider"),await ky(t,t._uninitializedComponentsProvider._online)):(K("FirestoreClient","Using default OnlineComponentProvider"),await ky(t,new F2))),t._onlineComponents}function j2(t){return ME(t).then(e=>e.syncEngine)}async function lu(t){const e=await ME(t),n=e.eventManager;return n.onListen=S2.bind(null,e.syncEngine),n.onUnlisten=I2.bind(null,e.syncEngine),n}function q2(t,e,n={}){const r=new Fn;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,i,o,u){const c=new Lm({next:h=>{s.enqueueAndForget(()=>Am(a,d));const f=h.docs.has(i);!f&&h.fromCache?u.reject(new $(S.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&o&&o.source==="server"?u.reject(new $(S.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new Pm(Gu(i.path),c,{includeMetadataChanges:!0,Ku:!0});return Dm(a,d)}(await lu(t),t.asyncQueue,e,n,r)),r.promise}function B2(t,e,n={}){const r=new Fn;return t.asyncQueue.enqueueAndForget(async()=>function(a,s,i,o,u){const c=new Lm({next:h=>{s.enqueueAndForget(()=>Am(a,d)),h.fromCache&&o.source==="server"?u.reject(new $(S.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new Pm(i,c,{includeMetadataChanges:!0,Ku:!0});return Dm(a,d)}(await lu(t),t.asyncQueue,e,n,r)),r.promise}/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function FE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const xy=new Map;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function UE(t,e,n){if(!n)throw new $(S.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $2(t,e,n,r){if(e===!0&&r===!0)throw new $(S.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Ny(t){if(!G.isDocumentKey(t))throw new $(S.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Sy(t){if(G.isDocumentKey(t))throw new $(S.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function sc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ee()}function xt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $(S.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=sc(t);throw new $(S.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Cy{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new $(S.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new $(S.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=FE((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new $(S.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new $(S.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new $(S.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(n=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,n.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var n,r}}class ic{constructor(e,n,r,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Cy({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new $(S.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new $(S.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Cy(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new h_;switch(n.type){case"firstParty":return new g_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new $(S.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=xy.get(e);n&&(K("ComponentProvider","Removing Datastore"),xy.delete(e),n.terminate())}(this),Promise.resolve()}}function H2(t,e,n,r={}){var a;const s=(t=xt(t,ic))._getSettings(),i=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==i&&ns("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:i,ssl:!1})),r.mockUserToken){let o,u;if(typeof r.mockUserToken=="string")o=r.mockUserToken,u=ot.MOCK_USER;else{o=PN(r.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new $(S.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new ot(c)}t._authCredentials=new f_(new Vw(o,u))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class mt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Er(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mt(this.firestore,e,this._key)}}class Or{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Or(this.firestore,e,this._query)}}class Er extends Or{constructor(e,n,r){super(e,n,Gu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new mt(this.firestore,null,new G(e))}withConverter(e){return new Er(this.firestore,e,this._path)}}function wt(t,e,...n){if(t=Me(t),UE("collection","path",e),t instanceof ic){const r=ke.fromString(e,...n);return Sy(r),new Er(t,null,r)}{if(!(t instanceof mt||t instanceof Er))throw new $(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ke.fromString(e,...n));return Sy(r),new Er(t.firestore,null,r)}}function _e(t,e,...n){if(t=Me(t),arguments.length===1&&(e=zw.A()),UE("doc","path",e),t instanceof ic){const r=ke.fromString(e,...n);return Ny(r),new mt(t,null,new G(r))}{if(!(t instanceof mt||t instanceof Er))throw new $(S.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ke.fromString(e,...n));return Ny(r),new mt(t.firestore,t instanceof Er?t.converter:null,new G(r))}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class K2{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new EE(this,"async_queue_retry"),this.Xc=()=>{const n=Zc();n&&K("AsyncQueue","Visibility state changed to "+n.visibilityState),this.qo.Mo()};const e=Zc();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const n=Zc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const n=new Fn;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(this.Qc.length!==0){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!co(e))throw e;K("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const n=this.Gc.then(()=>(this.Hc=!0,e().catch(r=>{this.Wc=r,this.Hc=!1;const a=function(s){let i=s.message||"";return s.stack&&(i=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),i}(r);throw $n("INTERNAL UNHANDLED ERROR: ",a),r}).then(r=>(this.Hc=!1,r))));return this.Gc=n,n}enqueueAfterDelay(e,n,r){this.Zc(),this.Yc.indexOf(e)>-1&&(n=0);const a=_m.createAndSchedule(this,e,n,r,s=>this.na(s));return this.zc.push(a),a}Zc(){this.Wc&&ee()}verifyOperationInProgress(){}async sa(){let e;do e=this.Gc,await e;while(e!==this.Gc)}ia(e){for(const n of this.zc)if(n.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.zc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const n=this.zc.indexOf(e);this.zc.splice(n,1)}}function Iy(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const a of n)if(a in r&&typeof r[a]=="function")return!0;return!1}(t,["next","error","complete"])}class Sn extends ic{constructor(e,n,r,a){super(e,n,r,a),this.type="firestore",this._queue=new K2,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||VE(this),this._firestoreClient.terminate()}}function W2(t,e){const n=typeof t=="object"?t:nb(),r=typeof t=="string"?t:"(default)",a=Pf(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const s=AN("firestore");s&&H2(a,...s)}return a}function go(t){return t._firestoreClient||VE(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function VE(t){var e,n,r;const a=t._freezeSettings(),s=function(i,o,u,c){return new __(i,o,u,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,FE(c.experimentalLongPollingOptions),c.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._firestoreClient=new U2(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=a.cache)===null||n===void 0)&&n._offlineComponentProvider&&!((r=a.cache)===null||r===void 0)&&r._onlineComponentProvider&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:a.cache.kind,_offline:a.cache._offlineComponentProvider,_online:a.cache._onlineComponentProvider})}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class ls{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ls(yt.fromBase64String(e))}catch(n){throw new $(S.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ls(yt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class yo{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new $(S.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class oc{constructor(e){this._methodName=e}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Mm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new $(S.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new $(S.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return he(this._lat,e._lat)||he(this._long,e._long)}}/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const G2=/^__.*__$/;class Q2{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Pr(e,this.data,this.fieldMask,n,this.fieldTransforms):new ho(e,this.data,n,this.fieldTransforms)}}class zE{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Pr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function jE(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ee()}}class Fm{constructor(e,n,r,a,s,i){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=a,s===void 0&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new Fm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),a=this.aa({path:r,la:!1});return a.fa(e),a}da(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),a=this.aa({path:r,la:!1});return a.ua(),a}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return uu(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(e.length===0)throw this._a("Document fields must not be empty");if(jE(this.ca)&&G2.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class Y2{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||nc(e)}ya(e,n,r,a=!1){return new Fm({ca:e,methodName:n,ga:r,path:ct.emptyPath(),la:!1,ma:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function vo(t){const e=t._freezeSettings(),n=nc(t._databaseId);return new Y2(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Um(t,e,n,r,a,s={}){const i=t.ya(s.merge||s.mergeFields?2:0,e,n,a);zm("Data must be an object, but it was:",i,r);const o=$E(r,i);let u,c;if(s.merge)u=new Ot(i.fieldMask),c=i.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const f=Ah(e,h,n);if(!i.contains(f))throw new $(S.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);KE(d,f)||d.push(f)}u=new Ot(d),c=i.fieldTransforms.filter(h=>u.covers(h.field))}else u=null,c=i.fieldTransforms;return new Q2(new It(o),u,c)}class lc extends oc{_toFieldTransform(e){if(e.ca!==2)throw e.ca===1?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lc}}class Vm extends oc{_toFieldTransform(e){return new X_(e.path,new zi)}isEqual(e){return e instanceof Vm}}function qE(t,e,n,r){const a=t.ya(1,e,n);zm("Data must be an object, but it was:",a,r);const s=[],i=It.empty();ca(r,(u,c)=>{const d=jm(e,u,n);c=Me(c);const h=a.da(d);if(c instanceof lc)s.push(d);else{const f=bo(c,h);f!=null&&(s.push(d),i.set(d,f))}});const o=new Ot(s);return new zE(i,o,a.fieldTransforms)}function BE(t,e,n,r,a,s){const i=t.ya(1,e,n),o=[Ah(e,r,n)],u=[a];if(s.length%2!=0)throw new $(S.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<s.length;f+=2)o.push(Ah(e,s[f])),u.push(s[f+1]);const c=[],d=It.empty();for(let f=o.length-1;f>=0;--f)if(!KE(c,o[f])){const g=o[f];let v=u[f];v=Me(v);const b=i.da(g);if(v instanceof lc)c.push(g);else{const E=bo(v,b);E!=null&&(c.push(g),d.set(g,E))}}const h=new Ot(c);return new zE(d,h,i.fieldTransforms)}function X2(t,e,n,r=!1){return bo(n,t.ya(r?4:3,e))}function bo(t,e){if(HE(t=Me(t)))return zm("Unsupported field value:",e,t),$E(t,e);if(t instanceof oc)return function(n,r){if(!jE(r.ca))throw r._a(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(r);a&&r.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.la&&e.ca!==4)throw e._a("Nested arrays are not supported");return function(n,r){const a=[];let s=0;for(const i of n){let o=bo(i,r.wa(s));o==null&&(o={nullValue:"NULL_VALUE"}),a.push(o),s++}return{arrayValue:{values:a}}}(t,e)}return function(n,r){if((n=Me(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return G_(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=le.fromDate(n);return{timestampValue:iu(r.serializer,a)}}if(n instanceof le){const a=new le(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:iu(r.serializer,a)}}if(n instanceof Mm)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ls)return{bytesValue:fE(r.serializer,n._byteString)};if(n instanceof mt){const a=r.databaseId,s=n.firestore._databaseId;if(!s.isEqual(a))throw r._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Em(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r._a(`Unsupported field value: ${sc(n)}`)}(t,e)}function $E(t,e){const n={};return jw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ca(t,(r,a)=>{const s=bo(a,e.ha(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function HE(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof le||t instanceof Mm||t instanceof ls||t instanceof mt||t instanceof oc)}function zm(t,e,n){if(!HE(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=sc(n);throw r==="an object"?e._a(t+" a custom object"):e._a(t+" "+r)}}function Ah(t,e,n){if((e=Me(e))instanceof yo)return e._internalPath;if(typeof e=="string")return jm(t,e);throw uu("Field path arguments must be of type string or ",t,!1,void 0,n)}const J2=new RegExp("[~\\*/\\[\\]]");function jm(t,e,n){if(e.search(J2)>=0)throw uu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new yo(...e.split("."))._internalPath}catch{throw uu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function uu(t,e,n,r,a){const s=r&&!r.isEmpty(),i=a!==void 0;let o=`Function ${e}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let u="";return(s||i)&&(u+=" (found",s&&(u+=` in field ${r}`),i&&(u+=` in document ${a}`),u+=")"),new $(S.INVALID_ARGUMENT,o+t+u)}function KE(t,e){return t.some(n=>n.isEqual(e))}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class WE{constructor(e,n,r,a,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=a,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new mt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Z2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(qm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Z2 extends WE{data(){return super.data()}}function qm(t,e){return typeof e=="string"?jm(t,e):e instanceof yo?e._internalPath:e._delegate._internalPath}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function GE(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $(S.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Bm{}class QE extends Bm{}function Rh(t,e,...n){let r=[];e instanceof Bm&&r.push(e),r=r.concat(n),function(a){const s=a.filter(o=>o instanceof Hm).length,i=a.filter(o=>o instanceof $m).length;if(s>1||s>0&&i>0)throw new $(S.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const a of r)t=a._apply(t);return t}class $m extends QE{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new $m(e,n,r)}_apply(e){const n=this._parse(e);return YE(e._query,n),new Or(e.firestore,e.converter,kh(e._query,n))}_parse(e){const n=vo(e.firestore);return function(r,a,s,i,o,u,c){let d;if(o.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new $(S.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Ty(c,u);const h=[];for(const f of c)h.push(_y(i,r,f));d={arrayValue:{values:h}}}else d=_y(i,r,c)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Ty(c,u),d=X2(s,a,c,u==="in"||u==="not-in");return je.create(o,u,d)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Hm extends Bm{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Hm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:on.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,a){let s=r;const i=a.getFlattenedFilters();for(const o of i)YE(s,o),s=kh(s,o)}(e._query,n),new Or(e.firestore,e.converter,kh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Km extends QE{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Km(e,n)}_apply(e){const n=function(r,a,s){if(r.startAt!==null)throw new $(S.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new $(S.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const i=new Ba(a,s);return function(o,u){if(ym(o)===null){const c=Qu(o);c!==null&&XE(o,c,u.field)}}(r,i),i}(e._query,this._field,this._direction);return new Or(e.firestore,e.converter,function(r,a){const s=r.explicitOrderBy.concat([a]);return new ws(r.path,r.collectionGroup,s,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function eD(t,e="asc"){const n=e,r=qm("orderBy",t);return Km._create(r,n)}function _y(t,e,n){if(typeof(n=Me(n))=="string"){if(n==="")throw new $(S.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Yw(e)&&n.indexOf("/")!==-1)throw new $(S.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ke.fromString(n));if(!G.isDocumentKey(r))throw new $(S.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Xg(t,new G(r))}if(n instanceof mt)return Xg(t,n._key);throw new $(S.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${sc(n)}.`)}function Ty(t,e){if(!Array.isArray(t)||t.length===0)throw new $(S.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function YE(t,e){if(e.isInequality()){const r=Qu(t),a=e.field;if(r!==null&&!r.isEqual(a))throw new $(S.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${a.toString()}'`);const s=ym(t);s!==null&&XE(t,a,s)}const n=function(r,a){for(const s of r)for(const i of s.getFlattenedFilters())if(a.indexOf(i.op)>=0)return i.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new $(S.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $(S.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function XE(t,e,n){if(!n.isEqual(e))throw new $(S.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class tD{convertValue(e,n="none"){switch(sa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ve(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(aa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw ee()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ca(e,(a,s)=>{r[a]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Mm(Ve(e.latitude),Ve(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=fm(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Fi(e));default:return null}}convertTimestamp(e){const n=Cr(e);return new le(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ke.fromString(e);Ne(vE(r));const a=new Ui(r.get(1),r.get(3)),s=new G(r.popFirst(5));return a.isEqual(n)||$n(`Document ${s} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Wm(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class Ks{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class JE extends WE{constructor(e,n,r,a,s,i){super(e,n,r,a,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new yl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(qm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class yl extends JE{data(e={}){return super.data(e)}}class ZE{constructor(e,n,r,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new Ks(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new yl(this._firestore,this._userDataWriter,r.key,r,new Ks(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new $(S.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,a){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(i=>{const o=new yl(r._firestore,r._userDataWriter,i.doc.key,i.doc,new Ks(r._snapshot.mutatedKeys.has(i.doc.key),r._snapshot.fromCache),r.query.converter);return i.doc,{type:"added",doc:o,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(i=>a||i.type!==3).map(i=>{const o=new yl(r._firestore,r._userDataWriter,i.doc.key,i.doc,new Ks(r._snapshot.mutatedKeys.has(i.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,c=-1;return i.type!==0&&(u=s.indexOf(i.doc.key),s=s.delete(i.doc.key)),i.type!==1&&(s=s.add(i.doc),c=s.indexOf(i.doc.key)),{type:nD(i.type),doc:o,oldIndex:u,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function nD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ee()}}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function cu(t){t=xt(t,mt);const e=xt(t.firestore,Sn);return q2(go(e),t._key).then(n=>tk(e,t,n))}class Gm extends tD{constructor(e){super(),this.firestore=e}convertBytes(e){return new ls(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new mt(this.firestore,null,n)}}function Ph(t){t=xt(t,Or);const e=xt(t.firestore,Sn),n=go(e),r=new Gm(e);return GE(t._query),B2(n,t._query).then(a=>new ZE(e,r,t,a))}function ek(t,e,n){t=xt(t,mt);const r=xt(t.firestore,Sn),a=Wm(t.converter,e,n);return wo(r,[Um(vo(r),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,kt.none())])}function us(t,e,n,...r){t=xt(t,mt);const a=xt(t.firestore,Sn),s=vo(a);let i;return i=typeof(e=Me(e))=="string"||e instanceof yo?BE(s,"updateDoc",t._key,e,n,r):qE(s,"updateDoc",t._key,e),wo(a,[i.toMutation(t._key,kt.exists(!0))])}function cs(t){return wo(xt(t.firestore,Sn),[new ec(t._key,kt.none())])}function ia(t,e){const n=xt(t.firestore,Sn),r=_e(t),a=Wm(t.converter,e);return wo(n,[Um(vo(t.firestore),"addDoc",r._key,a,t.converter!==null,{}).toMutation(r._key,kt.exists(!1))]).then(()=>r)}function rD(t,...e){var n,r,a;t=Me(t);let s={includeMetadataChanges:!1},i=0;typeof e[i]!="object"||Iy(e[i])||(s=e[i],i++);const o={includeMetadataChanges:s.includeMetadataChanges};if(Iy(e[i])){const h=e[i];e[i]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[i+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[i+2]=(a=h.complete)===null||a===void 0?void 0:a.bind(h)}let u,c,d;if(t instanceof mt)c=xt(t.firestore,Sn),d=Gu(t._key.path),u={next:h=>{e[i]&&e[i](tk(c,t,h))},error:e[i+1],complete:e[i+2]};else{const h=xt(t,Or);c=xt(h.firestore,Sn),d=h._query;const f=new Gm(c);u={next:g=>{e[i]&&e[i](new ZE(c,f,h,g))},error:e[i+1],complete:e[i+2]},GE(t._query)}return function(h,f,g,v){const b=new Lm(v),E=new Pm(f,b,g);return h.asyncQueue.enqueueAndForget(async()=>Dm(await lu(h),E)),()=>{b.Dc(),h.asyncQueue.enqueueAndForget(async()=>Am(await lu(h),E))}}(go(c),d,o,u)}function wo(t,e){return function(n,r){const a=new Fn;return n.asyncQueue.enqueueAndForget(async()=>_2(await j2(n),r,a)),a.promise}(go(t),e)}function tk(t,e,n){const r=n.docs.get(e._key),a=new Gm(t);return new JE(t,a,e._key,r,new Ks(n.hasPendingWrites,n.fromCache),e.converter)}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/class aD{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=vo(e)}set(e,n,r){this._verifyNotCommitted();const a=td(e,this._firestore),s=Wm(a.converter,n,r),i=Um(this._dataReader,"WriteBatch.set",a._key,s,a.converter!==null,r);return this._mutations.push(i.toMutation(a._key,kt.none())),this}update(e,n,r,...a){this._verifyNotCommitted();const s=td(e,this._firestore);let i;return i=typeof(n=Me(n))=="string"||n instanceof yo?BE(this._dataReader,"WriteBatch.update",s._key,n,r,a):qE(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(i.toMutation(s._key,kt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=td(e,this._firestore);return this._mutations=this._mutations.concat(new ec(n._key,kt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new $(S.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function td(t,e){if((t=Me(t)).firestore!==e)throw new $(S.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function sD(){return new Vm("serverTimestamp")}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Qm(t){return go(t=xt(t,Sn)),new aD(t,e=>wo(t,e))}(function(t,e=!0){(function(n){bs=n})(ms),Za(new ta("firestore",(n,{instanceIdentifier:r,options:a})=>{const s=n.getProvider("app").getImmediate(),i=new Sn(new m_(n.getProvider("auth-internal")),new v_(n.getProvider("app-check-internal")),function(o,u){if(!Object.prototype.hasOwnProperty.apply(o.options,["projectId"]))throw new $(S.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ui(o.options.projectId,u)}(s,r),s);return a=Object.assign({useFetchStreams:e},a),i._setSettings(a),i},"PUBLIC").setMultipleInstances(!0)),wr(Hg,"3.13.0",t),wr(Hg,"3.13.0","esm2017")})();let nd=null,Bt=null,Ln=null,Bi=typeof __firebase_config<"u"?JSON.parse(__firebase_config):null;Bi||(Bi={apiKey:"AIzaSyDkiLiR8QI7XDLkQ3S4R7psfSiAhL8Ds7U",authDomain:"mia-move-dev.firebaseapp.com",projectId:"mia-move-dev",storageBucket:"mia-move-dev.firebasestorage.app",messagingSenderId:"539510852507",appId:"1:539510852507:web:0d2293397af8756a2f6f3e",measurementId:"G-JRW1F0E3K8"});if(Bi){try{Wg&&Wg("debug")}catch{}nd=tb(Bi),Bt=W2(nd),Ln=aI(nd)}const ve=(t,e,n=typeof __app_id<"u"?__app_id:"mia-move-app")=>`/artifacts/${n}/users/${t}/${e}`,Mt=({title:t,children:e,isOpen:n,onClose:r,actions:a,size:s="max-w-lg",compact:i=!1})=>{if(!n)return null;const o=i?"p-4":"p-6",u=i?"rounded-md":"rounded-xl";return l.createElement("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4",onClick:r},l.createElement("div",{className:`bg-white dark:bg-gray-800 ${u} w-full ${s} ${o} shadow-2xl max-h-[90vh] flex flex-col`,onClick:c=>c.stopPropagation()},l.createElement("div",{className:"flex justify-between items-center mb-4 border-b pb-2 border-gray-200 dark:border-gray-700"},l.createElement("h3",{className:"text-xl font-bold text-pink-600"},t),l.createElement("button",{onClick:r,"aria-label":"Fechar modal",className:"text-gray-600 hover:text-gray-800 dark:text-gray-200 dark:hover:text-gray-100 text-2xl"},"")),l.createElement("div",{className:"mb-6 overflow-y-auto flex-1 min-h-0"},e),a&&l.createElement("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"},a)))},iD=async t=>{if(navigator.clipboard&&navigator.clipboard.writeText)return navigator.clipboard.writeText(t);const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select();try{document.execCommand("copy")}finally{document.body.removeChild(e)}},oD=({isOpen:t,onClose:e,showToast:n,onSync:r,onUnsync:a,currentUid:s,isSynced:i})=>{const[o,u]=x.useState(""),c=async()=>{try{await iD(s||""),n("ID da Sesso copiado!","success")}catch{n("Falha ao copiar o ID.","error")}},d=()=>{if(!o.trim())return n("Por favor, cole um ID para sincronizar.","error");r(o.trim()),e()};return l.createElement(Mt,{isOpen:t,onClose:e,title:"Sincronizar Dispositivos",size:"max-w-xl"},l.createElement("div",{className:"space-y-6"},l.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Use esta funo para acessar os mesmos dados em diferentes aparelhos."),l.createElement("div",{className:"p-4 border dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700/50"},l.createElement("h4",{className:"font-semibold text-lg mb-2"},"1. Copie o ID do Dispositivo Principal"),l.createElement("div",{className:"mt-4 text-center bg-pink-100 dark:bg-pink-900/40 p-3 rounded-lg flex items-center justify-between"},l.createElement("span",{className:"text-sm font-mono break-all text-pink-800 dark:text-pink-200"},s),l.createElement("button",{onClick:c,className:"ml-4 px-3 py-2 text-sm font-semibold bg-pink-500 text-white rounded-lg hover:bg-pink-600"},"Copiar"))),l.createElement("div",{className:"p-4 border dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700/50"},l.createElement("h4",{className:"font-semibold text-lg mb-2"},"2. Cole o ID no Novo Dispositivo"),l.createElement("div",{className:"flex space-x-2"},l.createElement("input",{type:"text",value:o,onChange:h=>u(h.target.value),placeholder:"Cole o ID da Sesso aqui",className:"w-full p-3 border border-gray-300 rounded-lg"}),l.createElement("button",{onClick:d,className:"px-6 py-2 font-semibold text-white rounded-lg bg-teal-500 hover:bg-teal-600"},"Sincronizar"))),i&&l.createElement("div",{className:"text-center pt-4 border-t"},l.createElement("button",{onClick:a,className:"px-4 py-2 text-sm font-semibold rounded-full bg-red-500 text-white"},"Desfazer Sincronizao neste Dispositivo"))))},lD=({message:t,type:e,onClose:n})=>{const r="fixed bottom-5 right-5 p-4 rounded-lg shadow-xl text-white font-semibold flex items-center space-x-3 transition-opacity duration-300 z-50";let a="";switch(e){case"success":a="bg-teal-500";break;case"error":a="bg-red-500";break;default:a="bg-gray-700"}return l.createElement("div",{className:`${r} ${a}`},l.createElement("span",null,t),l.createElement("button",{onClick:n,className:"ml-4 opacity-75 hover:opacity-100"},""))},uD=({onLogin:t})=>{const[e,n]=x.useState(""),[r,a]=x.useState(""),[s,i]=x.useState(!1),o="usemiamove@gmail.com",u=async c=>{if(c.preventDefault(),!e.trim()||!r.trim())return alert("Preencha email e senha");i(!0);try{const d=(await B1(Ln,e.trim(),r)).user,h=_e(Bt,"users",d.uid),f=await cu(h);if(!f.exists())if(d.email===o)try{await ek(h,{email:d.email,role:"master",createdAt:sD()})}catch(b){return console.error("Failed to create master user doc",b),await dl(Ln),i(!1),alert("Falha ao criar o perfil do usurio. Contate o administrador.")}else return await dl(Ln),i(!1),alert("Usurio autenticado, mas documento de perfil no encontrado. Contate o administrador.");const g=await cu(h),v=g.exists()?g.data():f.exists()?f.data():null;if(!v||v.role!=="master")return await dl(Ln),i(!1),alert("Acesso negado: usurio no tem permisso de master.");t&&t({uid:d.uid,email:d.email,displayName:d.displayName})}catch(d){console.error("Login error",d),alert("Falha no login: "+(d.message||d.code||"erro desconhecido"))}finally{i(!1)}};return l.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900"},l.createElement("div",{className:"absolute inset-0 overflow-hidden"},l.createElement("img",{src:"login-cat.svg",alt:"background",className:"w-full h-full object-cover opacity-30 dark:opacity-20"}),l.createElement("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-white/60 to-white/80 dark:from-transparent dark:via-gray-900/60 dark:to-gray-900/80"})),l.createElement("div",{className:"relative z-10 w-full max-w-md p-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg"},l.createElement("h1",{className:"text-2xl font-extrabold text-pink-600 mb-2"},"Mia Move"),l.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-300 mb-6"},"Entre com sua conta para continuar"),l.createElement("form",{onSubmit:u,className:"space-y-4"},l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Email"),l.createElement("input",{type:"email",value:e,onChange:c=>n(c.target.value),className:"mt-1 w-full p-3 border rounded bg-white dark:bg-gray-700 dark:text-gray-50",placeholder:"vc@exemplo.com"})),l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Senha"),l.createElement("input",{type:"password",value:r,onChange:c=>a(c.target.value),className:"mt-1 w-full p-3 border rounded bg-white dark:bg-gray-700 dark:text-gray-50",placeholder:""})),l.createElement("div",{className:"flex items-center justify-between"},l.createElement("label",{className:"flex items-center text-sm"},l.createElement("input",{type:"checkbox",className:"mr-2"})," Lembrar"),l.createElement("a",{className:"text-sm text-pink-600 hover:underline",href:"#"},"Esqueci a senha")),l.createElement("button",{disabled:s,type:"submit",className:"w-full py-3 bg-pink-500 text-white font-bold rounded-lg"},s?"Entrando...":"Entrar")),l.createElement("p",{className:"text-sm text-center text-gray-500 mt-4"},"Ou cole a sesso principal no modal de Sincronizao para puxar os dados.")))},cD=({variants:t})=>{const e=x.useMemo(()=>{if(!t||t.length===0)return{full:{count:0,percentage:0},medium:{count:0,percentage:0},low:{count:0,percentage:0},outOfStock:{count:0,percentage:0},total:0};let r=0,a=0,s=0,i=0;t.forEach(u=>{u.quantity===0?i++:u.quantity<5?s++:u.quantity<10?a++:r++});const o=t.length;return{full:{count:r,percentage:r/o*100},medium:{count:a,percentage:a/o*100},low:{count:s,percentage:s/o*100},outOfStock:{count:i,percentage:i/o*100},total:o}},[t]),n=({percentage:r,color:a,radius:s,strokeWidth:i,label:o,count:u})=>{const c=2*Math.PI*s,d=c-r/100*c;return l.createElement("div",{className:"relative flex flex-col items-center justify-center"},l.createElement("svg",{className:"transform -rotate-90",width:s*2+i*2,height:s*2+i*2},l.createElement("circle",{className:"text-gray-200 dark:text-gray-700",stroke:"currentColor",strokeWidth:i,fill:"transparent",r:s,cx:s+i,cy:s+i}),l.createElement("circle",{className:a,stroke:"currentColor",strokeWidth:i,strokeLinecap:"round",fill:"transparent",r:s,cx:s+i,cy:s+i,style:{strokeDasharray:c,strokeDashoffset:d,transition:"stroke-dashoffset 0.5s ease-out"}})),l.createElement("div",{className:"absolute flex flex-col items-center"},l.createElement("span",{className:"text-xl font-bold"},u),l.createElement("span",{className:"text-xs text-gray-500 dark:text-gray-400"},o)))};return l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700"},l.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Viso Geral do Estoque"),e.total===0?l.createElement("p",{className:"text-center text-gray-500 dark:text-gray-400 py-8"},"Nenhum item em estoque para exibir."):l.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 justify-items-center text-center"},l.createElement(n,{percentage:e.full.percentage,color:"text-green-500",radius:40,strokeWidth:8,label:"Estoque Cheio",count:e.full.count}),l.createElement(n,{percentage:e.medium.percentage,color:"text-blue-500",radius:40,strokeWidth:8,label:"Estoque Mdio",count:e.medium.count}),l.createElement(n,{percentage:e.low.percentage,color:"text-orange-500",radius:40,strokeWidth:8,label:"Estoque Baixo",count:e.low.count}),l.createElement(n,{percentage:e.outOfStock.percentage,color:"text-red-500",radius:40,strokeWidth:8,label:"Esgotado",count:e.outOfStock.count})))},pa="w-full p-2 border border-gray-300 rounded-lg bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50 text-sm",dD=({variant:t,index:e,onChange:n,onRemove:r,showRemove:a,applyToAll:s})=>{const i=o=>n(e,o);return l.createElement("div",{className:"p-3 border dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700/50 relative"},l.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 items-end"},l.createElement("div",null,l.createElement("label",{className:"block text-xs font-medium"},"SKU*:"),l.createElement("input",{type:"text",name:"sku",value:t.sku,onChange:i,required:!0,className:pa})),l.createElement("div",null,l.createElement("label",{className:"block text-xs font-medium"},"Tamanho:"),l.createElement("input",{type:"text",name:"size",value:t.size,onChange:i,className:pa})),l.createElement("div",null,l.createElement("label",{className:"block text-xs font-medium"},"Cor:"),l.createElement("input",{type:"text",name:"color",value:t.color,onChange:i,className:pa})),l.createElement("div",null,l.createElement("label",{className:"block text-xs font-medium"},"Qtd*:"),l.createElement("input",{type:"number",name:"quantity",value:t.quantity,onChange:i,required:!0,min:"0",className:pa})),l.createElement("div",{className:"flex items-center"},l.createElement("div",{className:"flex-grow"},l.createElement("label",{className:"block text-xs font-medium"},"Custo (R$):"),l.createElement("input",{type:"number",name:"costPrice",value:t.costPrice,onChange:i,step:"0.01",min:"0",className:pa}))),l.createElement("div",{className:"flex items-center"},l.createElement("div",{className:"flex-grow"},l.createElement("label",{className:"block text-xs font-medium"},"Venda (R$)*:"),l.createElement("input",{type:"number",name:"salePrice",value:t.salePrice,onChange:i,required:!0,step:"0.01",min:"0.01",className:pa})))),a&&l.createElement("button",{type:"button",onClick:()=>r(e),className:"absolute top-2 right-2 text-red-500 hover:text-red-700 text-lg font-bold"},""),s&&s.show&&l.createElement("div",{className:"absolute top-2 left-2 flex space-x-1"},s.fields.map(o=>l.createElement("button",{key:o.key,type:"button",title:`Aplicar ${o.label} para todos`,onClick:()=>s.onApply(o.key,t[o.key]),className:"p-1 text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400"},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"}))))))},Dy="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",hD=({isOpen:t,onClose:e,variant:n,onAdjust:r})=>{const[a,s]=x.useState((n==null?void 0:n.quantity)||0),[i,o]=x.useState(""),u=["Avaria","Perda","Acerto de contagem","Devoluo","Outro"];return x.useEffect(()=>{s((n==null?void 0:n.quantity)||0),o("")},[n,t]),l.createElement(Mt,{isOpen:t,onClose:e,title:`Ajustar Estoque: ${(n==null?void 0:n.productName)||""}`,size:"max-w-md",actions:l.createElement(l.Fragment,null,l.createElement("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),l.createElement("button",{onClick:()=>r(parseInt(a,10),i),className:"px-4 py-2 text-white rounded-full bg-pink-500"},"Confirmar Ajuste"))},l.createElement("div",{className:"space-y-4"},l.createElement("p",null,"Variao: ",l.createElement("strong",null,n==null?void 0:n.size," - ",n==null?void 0:n.color)," (SKU: ",n==null?void 0:n.sku,")"),l.createElement("p",null,"Quantidade Atual: ",l.createElement("strong",null,n==null?void 0:n.quantity)),l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"Nova Quantidade:"),l.createElement("input",{type:"number",value:a,onChange:c=>s(c.target.value),className:Dy,min:"0"})),l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"Motivo do Ajuste:"),l.createElement("select",{value:i,onChange:c=>o(c.target.value),className:Dy},l.createElement("option",{value:""},"Selecione um motivo"),u.map(c=>l.createElement("option",{key:c,value:c},c))))))},fD=({isOpen:t,onClose:e,variant:n,movements:r=[]})=>{const a=s=>{switch(s){case"venda":return l.createElement("span",{className:"text-red-600 font-semibold"},"Venda");case"estorno":return l.createElement("span",{className:"text-blue-600 font-semibold"},"Estorno");case"ajuste_entrada":return l.createElement("span",{className:"text-green-600 font-semibold"},"Ajuste (Entrada)");case"ajuste_saida":return l.createElement("span",{className:"text-orange-600 font-semibold"},"Ajuste (Sada)");case"saida_defeito":return l.createElement("span",{className:"text-yellow-600 font-semibold"},"Sada (Defeito)");default:return s}};return l.createElement(Mt,{isOpen:t,onClose:e,title:`Histrico: ${(n==null?void 0:n.productName)||""} (${(n==null?void 0:n.size)||""} - ${(n==null?void 0:n.color)||""})`,size:"max-w-2xl"},l.createElement("div",{className:"max-h-[60vh] overflow-y-auto"},l.createElement("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},l.createElement("thead",{className:"bg-gray-50 dark:bg-gray-700"},l.createElement("tr",null,l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Data"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Tipo"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Alterao"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Saldo Final"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Motivo / Venda ID"))),l.createElement("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},r.map((s,i)=>l.createElement("tr",{key:i},l.createElement("td",{className:"px-3 py-4 text-sm"},s.date.toDate().toLocaleString("pt-BR")),l.createElement("td",{className:"px-3 py-4 text-sm"},a(s.type)),l.createElement("td",{className:`px-3 py-4 text-sm font-bold ${s.type==="ajuste_entrada"||s.type==="estorno"?"text-green-600":"text-red-600"}`},s.type==="ajuste_entrada"||s.type==="estorno"?`+${s.quantityChange}`:`-${s.quantityChange}`),l.createElement("td",{className:"px-3 py-4 text-sm font-bold"},s.newQuantity),l.createElement("td",{className:"px-3 py-4 text-sm"},s.reason||s.saleId)))))))},rd="bg-pink-500 hover:bg-pink-600",mD="bg-teal-500 hover:bg-teal-600",pD="bg-red-500 hover:bg-red-600",gD="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",Mr="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50 dark:placeholder-gray-400",ga={sku:"",size:"",color:"",quantity:0,costPrice:0,salePrice:0},yD=({db:t,userId:e,products:n=[],showToast:r=()=>{},categories:a=[]})=>{const s=!!t&&!!e,[i,o]=x.useState(!1),[u,c]=x.useState(null),[d,h]=x.useState(!1),[f,g]=x.useState(null),[v,b]=x.useState(!1),[E,m]=x.useState(null),[p,y]=x.useState(!1),[w,C]=x.useState(null),[M,z]=x.useState([]),[O,Q]=x.useState("all"),[D,N]=x.useState(!1),[L,W]=x.useState(a||[]),[re,I]=x.useState(""),[A,R]=x.useState({name:"",categoryId:"",variants:[ga]}),[k,_]=x.useState(""),[j,T]=x.useState(""),[q,X]=x.useState("");x.useEffect(()=>{R(u?{name:u.name||"",categoryId:u.categoryId||"",variants:u.variants&&u.variants.length>0?u.variants:[ga]}:{name:"",categoryId:"",variants:[ga]})},[u]),x.useEffect(()=>{W(a||[])},[a]);const Se=P=>R(Y=>({...Y,[P.target.name]:P.target.value})),He=(P,Y)=>{const{name:se,value:ye}=Y.target,ie=[...A.variants];ie[P]={...ie[P],[se]:ye},R(dn=>({...dn,variants:ie}))},Oe=()=>R(P=>({...P,variants:[...P.variants,ga]})),ln=P=>R(Y=>({...Y,variants:Y.variants.filter((se,ye)=>ye!==P)})),ha=(P,Y)=>{R(se=>({...se,variants:se.variants.map(ye=>({...ye,[P]:Y}))}))},uc=()=>{const P=k.split(",").map(ie=>ie.trim()).filter(Boolean),Y=j.split(",").map(ie=>ie.trim()).filter(Boolean);if(P.length===0&&Y.length===0)return r("Informe cores e/ou tamanhos para gerar variaes.","error");const se=[];P.length>0&&Y.length>0?P.forEach(ie=>Y.forEach(dn=>se.push({color:ie,size:dn}))):P.length>0?P.forEach(ie=>se.push({color:ie,size:""})):Y.length>0&&Y.forEach(ie=>se.push({color:"",size:ie}));const ye=se.map((ie,dn)=>{const ko=String(dn+1).padStart(3,"0"),Ns=ie.color?ie.color.replace(/\s+/g,"").toUpperCase().slice(0,6):"",xo=ie.size?ie.size.replace(/\s+/g,"").toUpperCase().slice(0,6):"",Cn=[];q&&Cn.push(q.replace(/\s+/g,"").toUpperCase()),Ns&&Cn.push(Ns),xo&&Cn.push(xo),Cn.push(ko);const Ss=Cn.join("-");return{...ga,sku:Ss,color:ie.color,size:ie.size}});R(ie=>({...ie,variants:ye.length>0?ye:[ga]})),r("Variaes geradas.","success")},U=async P=>{if(P.preventDefault(),!A.name.trim())return r("O nome do produto  obrigatrio.","error");if(A.variants.some(se=>!se.sku.trim()||parseFloat(se.salePrice)<=0))return r("Todas as variaes devem ter SKU e Preo de Venda vlidos.","error");if(!s){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}const Y=wt(t,ve(e,"products"));try{const se={...A,variants:A.variants.map(ye=>({...ye,quantity:parseInt(ye.quantity,10)||0,costPrice:parseFloat(ye.costPrice)||0,salePrice:parseFloat(ye.salePrice)||0})),updatedAt:le.now()};u?(await us(_e(Y,u.id),se),r("Produto atualizado!","success")):(await ia(Y,{...se,createdAt:le.now()}),r("Novo produto adicionado!","success")),o(!1),c(null)}catch(se){console.error("Erro ao salvar o produto:",se),r("Erro ao salvar produto.","error")}},ge=P=>{g(P),h(!0)},qe=async()=>{if(f){if(!s){r("Firestore no configurado. Faa login com uma conta vlida.","error"),h(!1),g(null);return}try{await cs(_e(t,ve(e,"products"),f.id)),r(`Produto ${f.name} excludo.`,"success")}catch(P){console.error("Erro ao deletar produto:",P),r("Erro ao deletar produto.","error")}finally{h(!1),g(null)}}},Fe=(P=null)=>{c(P),o(!0)},un=P=>{m(P),b(!0)},rt=async P=>{if(C(P),!s){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{const Y=wt(t,ve(e,"stockMovements")),se=Rh(Y),ye=(await Ph(se)).docs.map(ie=>ie.data()).filter(ie=>ie.variantSku===P.sku).sort((ie,dn)=>dn.date.seconds-ie.date.seconds);z(ye),y(!0)}catch(Y){console.error("Erro ao buscar histrico:",Y),r("Erro ao buscar histrico.","error")}},cn=async(P,Y)=>{if(!E||Y.trim()==="")return r("Nova quantidade e motivo so obrigatrios.","error");if(!s){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{const se=_e(t,ve(e,"products"),E.productId),ye=n.find(Ss=>Ss.id===E.productId),ie=ye.variants.findIndex(Ss=>Ss.sku===E.sku);if(ie===-1)return;const dn=ye.variants[ie].quantity,ko=P-dn,Ns=[...ye.variants];Ns[ie].quantity=P;const xo={date:le.now(),productId:E.productId,productName:E.productName,variantSku:E.sku,type:ko>0?"ajuste_entrada":"ajuste_saida",quantityChange:Math.abs(ko),reason:Y,oldQuantity:dn,newQuantity:P},Cn=Qm(t);Cn.update(se,{variants:Ns}),Cn.set(_e(wt(t,ve(e,"stockMovements"))),xo),await Cn.commit(),r("Estoque ajustado com sucesso!","success"),b(!1),m(null)}catch(se){console.error("Erro ao ajustar estoque:",se),r("Erro ao ajustar estoque.","error")}},Eo=async()=>{if(!re.trim())return r("Preencha o nome da categoria.","error");const P=re.trim();if(!s){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{const Y=wt(t,ve(e,"categories")),se={id:(await ia(Y,{name:P,createdAt:le.now()})).id,name:P};W(ye=>[...ye,se]),I(""),r("Categoria adicionada!","success")}catch(Y){console.error("Erro ao adicionar categoria",Y),r("Erro ao adicionar categoria.","error")}},xs=async P=>{if(P){if(!s){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{await cs(_e(t,ve(e,"categories"),P.id)),W(Y=>Y.filter(se=>se.id!==P.id)),r("Categoria removida!","success")}catch(Y){console.error("Erro ao deletar categoria",Y),r("Erro ao excluir categoria.","error")}}},Lr=x.useMemo(()=>(n||[]).filter(P=>O==="all"||P.categoryId===O).flatMap(P=>(P.variants||[]).map(Y=>{var se;return{...Y,productId:P.id,productName:P.name,category:((se=L.find(ye=>ye.id===P.categoryId))==null?void 0:se.name)||"Sem Categoria"}})),[n,L,O]),jt=x.useMemo(()=>Lr.filter(P=>P.quantity<5),[Lr]);return l.createElement("div",{className:"space-y-6"},l.createElement("div",{className:"flex flex-col md:flex-row justify-between md:items-center"},l.createElement("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100"},"Estoque Mia Move"),l.createElement("div",{className:"flex items-center space-x-2 mt-4 md:mt-0"},l.createElement("select",{value:O,onChange:P=>Q(P.target.value),className:Mr+" max-w-xs"},l.createElement("option",{value:"all"},"Todas as Categorias"),L.map(P=>l.createElement("option",{key:P.id,value:P.id},P.name))),l.createElement("button",{onClick:()=>N(!0),className:"px-4 py-3 text-pink-600 dark:text-pink-300 font-semibold bg-pink-100 dark:bg-pink-900/40 rounded-lg hover:bg-pink-200 dark:hover:bg-pink-900/60 whitespace-nowrap"},"Gerenciar Categorias"),l.createElement("button",{onClick:()=>Fe(),className:`px-4 py-3 text-white font-semibold rounded-lg ${rd} shadow-md whitespace-nowrap`},"+ Novo Produto"))),l.createElement(cD,{variants:Lr}),jt.length>0&&l.createElement("div",{className:"bg-orange-100 dark:bg-orange-900/40 border-l-4 border-orange-500 p-4 rounded-xl shadow-md"},l.createElement("p",{className:"font-bold text-orange-800 dark:text-orange-200"}," ",jt.length," Variae(s) com Estoque Baixo!")),l.createElement("div",{className:`${gD}`},l.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Variaes em Estoque (",Lr.length,")"),l.createElement("div",{className:"overflow-x-auto"},l.createElement("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},l.createElement("thead",{className:"bg-gray-50 dark:bg-gray-700"},l.createElement("tr",null,l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Produto / Categoria"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"SKU"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Variao"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Qtd"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Venda"),l.createElement("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Aes"))),l.createElement("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Lr.map((P,Y)=>{var se;const ye=n.find(ie=>ie.id===P.productId);return l.createElement("tr",{key:`${P.productId}-${P.sku}-${Y}`,className:P.quantity<5?"bg-red-50 dark:bg-red-900/30 hover:bg-red-100 dark:hover:bg-red-900/50":"hover:bg-gray-50 dark:hover:bg-gray-700"},l.createElement("td",{className:"px-3 py-4 text-sm font-medium"},P.productName," ",l.createElement("span",{className:"block text-xs text-gray-500 dark:text-gray-400"},P.category)),l.createElement("td",{className:"px-3 py-4 text-sm"},P.sku),l.createElement("td",{className:"px-3 py-4 text-sm text-gray-600 dark:text-gray-300"},P.size," - ",P.color),l.createElement("td",{className:"px-3 py-4 text-sm font-bold"},P.quantity),l.createElement("td",{className:"px-3 py-4 text-sm font-semibold text-teal-600 dark:text-teal-400"},(se=P.salePrice)!=null&&se.toLocaleString?P.salePrice.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}):`R$ ${P.salePrice}`),l.createElement("td",{className:"px-3 py-4 text-right text-sm font-medium space-x-2"},l.createElement("button",{onClick:()=>rt(P),className:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-100"},"Histrico"),l.createElement("button",{onClick:()=>un(P),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300"},"Ajustar"),l.createElement("button",{onClick:()=>Fe(ye),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300"},"Editar"),l.createElement("button",{onClick:()=>ge(ye),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},"Excluir")))}))))),l.createElement(Mt,{isOpen:i,onClose:()=>o(!1),title:u?"Editar Produto":"Adicionar Novo Produto",size:"max-w-3xl",actions:l.createElement(l.Fragment,null,l.createElement("button",{onClick:()=>o(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),l.createElement("button",{onClick:U,className:`px-5 py-2 text-white rounded-full ${rd}`},u?"Salvar Alteraes":"Adicionar Produto"))},l.createElement("form",{className:"space-y-6"},l.createElement("div",{className:"p-4 border dark:border-gray-700 rounded-lg grid grid-cols-1 md:grid-cols-2 gap-4"},l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"Nome do Produto:"),l.createElement("input",{type:"text",name:"name",value:A.name,onChange:Se,required:!0,className:Mr})),l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"Categoria:"),l.createElement("select",{name:"categoryId",value:A.categoryId,onChange:Se,className:Mr},l.createElement("option",{value:""},"Selecione uma categoria"),L.map(P=>l.createElement("option",{key:P.id,value:P.id},P.name))))),!u&&l.createElement("div",{className:"p-4 border dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-700/50"},l.createElement("h4",{className:"font-semibold text-lg mb-3 text-gray-700 dark:text-gray-200"},"Gerador de Variaes em Massa"),l.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3 items-start"},l.createElement("div",{className:"flex flex-col"},l.createElement("label",{className:"block text-sm font-medium mb-2 min-h-[2.1rem] leading-tight"},"Cores (separadas por vrgula):"),l.createElement("input",{type:"text",value:k,onChange:P=>_(P.target.value),placeholder:"Preto, Azul, Rosa",className:Mr+" h-10 text-sm"})),l.createElement("div",{className:"flex flex-col"},l.createElement("label",{className:"block text-sm font-medium mb-2 min-h-[2.1rem] leading-tight"},"Tamanhos (separadas por vrgula):"),l.createElement("input",{type:"text",value:j,onChange:P=>T(P.target.value),placeholder:"P, M, G",className:Mr+" h-10 text-sm"})),l.createElement("div",{className:"flex flex-col"},l.createElement("label",{className:"block text-sm font-medium mb-2 min-h-[2.1rem] leading-tight"},"Prefixo do SKU (Opcional):"),l.createElement("input",{type:"text",value:q,onChange:P=>X(P.target.value),placeholder:"LEG-FLARE",className:Mr+" h-10 text-sm"}))),l.createElement("button",{type:"button",onClick:uc,className:`w-full text-center py-3 text-sm font-semibold text-white rounded-full ${mD} transition`},"Gerar Variaes")),l.createElement("div",{className:"space-y-4"},l.createElement("h4",{className:"font-semibold text-lg text-gray-700 dark:text-gray-200"},"Variaes do Produto"),l.createElement("div",{className:"max-h-[40vh] overflow-y-auto space-y-4 pr-2 border-t border-b py-4 dark:border-gray-700"},A.variants.map((P,Y)=>l.createElement(dD,{key:Y,variant:P,index:Y,onChange:He,onRemove:ln,showRemove:A.variants.length>1,applyToAll:Y===0&&A.variants.length>1?{show:!0,fields:[{key:"costPrice",label:"Custo"},{key:"salePrice",label:"Venda"}],onApply:ha}:null}))),l.createElement("button",{type:"button",onClick:Oe,className:"w-full text-center py-2 text-sm font-semibold text-pink-600 dark:text-pink-400 border-2 border-dashed border-pink-300 dark:border-pink-500 rounded-lg hover:bg-pink-50 dark:hover:bg-pink-900/30 transition"},"+ Adicionar Variao Manualmente")))),l.createElement(Mt,{isOpen:d,onClose:()=>h(!1),title:"Confirmar Excluso",size:"max-w-md",actions:l.createElement(l.Fragment,null,l.createElement("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),l.createElement("button",{onClick:qe,className:`px-4 py-2 text-white rounded-full ${pD}`},"Excluir"))},l.createElement("p",null,"Voc tem certeza que deseja deletar o produto ",l.createElement("strong",null,f==null?void 0:f.name)," e todas as suas variaes?")),E&&l.createElement(hD,{isOpen:v,onClose:()=>b(!1),variant:E,onAdjust:cn}),w&&l.createElement(fD,{isOpen:p,onClose:()=>y(!1),variant:w,movements:M}),l.createElement(Mt,{isOpen:D,onClose:()=>N(!1),title:"Gerenciar Categorias",size:"max-w-md",actions:l.createElement(l.Fragment,null,l.createElement("button",{onClick:()=>N(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Fechar"),l.createElement("button",{onClick:()=>{Eo()},className:`px-4 py-2 text-white rounded-full ${rd}`},"Adicionar"))},l.createElement("div",{className:"space-y-4"},l.createElement("input",{type:"text",placeholder:"Nome da nova categoria",value:re,onChange:P=>I(P.target.value),className:Mr}),l.createElement("div",{className:"space-y-2"},L.length===0&&l.createElement("p",{className:"text-gray-500"},"Nenhuma categoria cadastrada."),L.map(P=>l.createElement("div",{key:P.id,className:"flex justify-between items-center p-2 bg-gray-50 dark:bg-gray-700/50 rounded"},l.createElement("div",{className:"text-sm"},P.name),l.createElement("div",{className:"space-x-2"},l.createElement("button",{onClick:()=>{Q(P.id),N(!1)},className:"text-sm text-teal-600"},"Selecionar"),l.createElement("button",{onClick:()=>xs(P),className:"text-sm text-red-600"},"Excluir"))))))))},fe=t=>{const e=typeof t=="number"?t:0;return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)},ad=t=>new Intl.NumberFormat("pt-BR").format(t),Tn=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},fn="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",vD="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",bD=({db:t,userId:e,products:n=[],sales:r=[],customers:a=[],showToast:s=()=>{}})=>{const[i,o]=x.useState("new"),[u,c]=x.useState(""),[d,h]=x.useState([]),[f,g]=x.useState(""),[v,b]=x.useState(!1),[E,m]=x.useState("Carto de Crdito"),[p,y]=x.useState(0),[w,C]=x.useState(0),[M,z]=x.useState(1),[O,Q]=x.useState("recebido"),[D,N]=x.useState(""),[L,W]=x.useState(""),[re,I]=x.useState(""),[A,R]=x.useState(""),k=x.useMemo(()=>(n||[]).flatMap(U=>(U.variants||[]).map(ge=>({...ge,productId:U.id,productName:U.name}))).filter(U=>U.productName.toLowerCase().includes(f.toLowerCase())||U.color.toLowerCase().includes(f.toLowerCase())||U.size.toLowerCase().includes(f.toLowerCase())||U.sku.toLowerCase().includes(f.toLowerCase())),[n,f]),{subtotal:_,costOfGoodsSold:j,totalAfterDiscount:T,feeAmount:q,finalTotal:X}=x.useMemo(()=>{const U=d.reduce((rt,cn)=>rt+cn.salePrice*cn.quantity,0),ge=d.reduce((rt,cn)=>rt+cn.costPrice*cn.quantity,0),qe=U*(1-p/100);let Fe=0;E==="Carto de Crdito"&&w>0&&(Fe=qe*(w/100));const un=qe+Fe;return{subtotal:U,costOfGoodsSold:ge,totalAfterDiscount:qe,feeAmount:Fe,finalTotal:un}},[d,p,w,E]),Se=_-T,He=x.useMemo(()=>{const U=u.trim().toLowerCase();return(r||[]).filter(ge=>!!(!U||(ge.id||"").toLowerCase().includes(U)||(ge.customerName||"").toLowerCase().includes(U)||ge.items&&ge.items.some(qe=>(qe.productName||"").toLowerCase().includes(U)||(qe.sku||"").toLowerCase().includes(U))))},[r,u]),Oe=U=>{const ge=d.find(qe=>qe.sku===U.sku);ge?ge.quantity<U.quantity?h(qe=>qe.map(Fe=>Fe.sku===U.sku?{...Fe,quantity:Fe.quantity+1}:Fe)):s("Estoque insuficiente.","error"):h(qe=>[...qe,{productId:U.productId,productName:U.productName,sku:U.sku,size:U.size,color:U.color,quantity:1,salePrice:U.salePrice,costPrice:U.costPrice,stockQuantity:U.quantity}]),g("")},ln=(U,ge)=>h(qe=>qe.map(Fe=>Fe.sku===U?{...Fe,quantity:Math.min(Math.max(1,ge),Fe.stockQuantity)}:Fe)),ha=U=>h(ge=>ge.filter(qe=>qe.sku!==U)),uc=async()=>{if(d.length===0)return s("O carrinho est vazio.","error");if(O==="a_receber"&&!L.trim())return s("Digite um nome de cliente para vendas a receber.","error");if(O==="a_receber"&&!D)return s("Preencha a data de vencimento.","error");b(!0);try{if(console.log("processSale start",{selectedItems:d,subtotal:_,finalTotal:X,paymentStatus:O}),s("Iniciando processamento da venda...","info"),!t||!e){s("Firestore no configurado. Faa login com uma conta vlida.","error"),b(!1);return}else try{const U=wt(t,ve(e,"sales")),ge={items:d,subtotal:_,discountPercentage:p,totalDiscount:Se,feeAmount:q,finalTotal:X,paymentMethod:E,paymentStatus:O,dueDate:O==="a_receber"&&D?le.fromDate(new Date(D)):null,customerName:L,customerWhatsapp:A,saleNotes:re,installments:M,createdAt:le.now(),updatedAt:le.now()},qe=await ia(U,ge),Fe=Qm(t),un={};d.forEach(rt=>{un[rt.productId]||(un[rt.productId]=[]),un[rt.productId].push({sku:rt.sku,qty:rt.quantity})});for(const rt of Object.keys(un)){const cn=_e(t,ve(e,"products"),rt),Eo=await cu(cn);if(!Eo.exists())continue;const xs=Eo.data(),Lr=(xs.variants||[]).map(jt=>{const P=un[rt].find(Y=>Y.sku===jt.sku);if(P){const Y=parseInt(jt.quantity||0,10);return{...jt,quantity:Math.max(0,Y-P.qty)}}return jt});Fe.update(cn,{variants:Lr,updatedAt:le.now()}),un[rt].forEach(jt=>{const P=(xs.variants||[]).find(ie=>ie.sku===jt.sku),Y=P?parseInt(P.quantity||0,10):0,se=Math.max(0,Y-jt.qty),ye=_e(wt(t,ve(e,"stockMovements")));Fe.set(ye,{date:le.now(),productId:rt,productName:xs.name,variantSku:jt.sku,type:"venda",quantityChange:jt.qty,oldQuantity:Y,newQuantity:se})})}await Fe.commit(),s(`Venda registrada: ${fe(X)}`,"success"),h([]),y(0),m("Carto de Crdito"),Q("recebido"),N(""),W(""),I(""),C(0),z(1),R("")}catch(U){console.error("Erro ao processar venda com Firebase:",U),s("Erro ao processar a venda (Firebase).","error")}}catch(U){console.error("Erro ao processar a venda:",U),s("Erro ao processar a venda.","error")}finally{b(!1)}};return l.createElement("div",{className:"space-y-6"},l.createElement("div",{className:"flex flex-col md:flex-row justify-between md:items-center"},l.createElement("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100"},"Vendas"),l.createElement("div",{className:"flex rounded-lg shadow-sm border border-gray-300 dark:border-gray-600 mt-4 md:mt-0"},l.createElement("button",{onClick:()=>o("new"),className:`px-4 py-2 font-semibold rounded-l-lg transition ${i==="new"?"bg-pink-500 text-white":"bg-white dark:bg-gray-700 hover:bg-gray-50"}`},"Nova Venda"),l.createElement("button",{onClick:()=>o("history"),className:`px-4 py-2 font-semibold rounded-r-lg transition ${i==="history"?"bg-pink-500 text-white":"bg-white dark:bg-gray-700 hover:bg-gray-50"}`},"Histrico de Vendas"))),i==="new"&&l.createElement("div",{className:"grid lg:grid-cols-3 gap-6"},l.createElement("div",{className:"lg:col-span-1 space-y-4"},l.createElement("h3",{className:"text-xl font-bold"},"1. Adicionar Produtos"),l.createElement("input",{type:"text",placeholder:"Buscar produto...",value:f,onChange:U=>g(U.target.value),className:fn}),l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow max-h-[500px] overflow-y-auto"},(k||[]).map(U=>l.createElement("div",{key:U.sku,className:"flex justify-between items-center p-3 border rounded-xl mb-2"},l.createElement("div",null,l.createElement("p",{className:"font-medium"},U.productName," (",U.size," - ",U.color,")"),l.createElement("p",{className:"text-sm text-gray-500"},"Qtd: ",U.quantity," | ",fe(U.salePrice))),l.createElement("button",{onClick:()=>Oe(U),className:"p-2 bg-teal-500 text-white rounded-full"},"+"))))),l.createElement("div",{className:"lg:col-span-2 space-y-4"},l.createElement("h3",{className:"text-xl font-bold"},"2. Finalizar Venda"),l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow"},l.createElement("h3",{className:"font-semibold text-xl mb-4"},"Resumo da Venda"),d.length===0?l.createElement("p",{className:"text-gray-500 text-center py-8"},"O carrinho est vazio."):l.createElement("div",{className:"space-y-3 max-h-80 overflow-y-auto pr-2 mb-4 border-b pb-4"},d.map(U=>l.createElement("div",{key:U.sku,className:"flex items-center justify-between border-b pb-2"},l.createElement("div",null,l.createElement("p",{className:"font-medium"},U.productName," (",U.size," - ",U.color,")"),l.createElement("p",{className:"text-sm text-gray-500"},fe(U.salePrice)," x ",U.quantity)),l.createElement("div",{className:"flex items-center space-x-2"},l.createElement("input",{type:"number",min:"1",max:U.stockQuantity,value:U.quantity,onChange:ge=>ln(U.sku,parseInt(ge.target.value,10)),className:"w-16 p-1 text-center border rounded-lg text-sm"}),l.createElement("button",{onClick:()=>ha(U.sku),className:"text-red-500"},"Remover"))))),l.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"Nome da Cliente"),l.createElement("input",{type:"text",value:L,onChange:U=>W(U.target.value),className:fn,placeholder:"Para venda annima, deixe em branco"})),l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"Contato WhatsApp (Opcional)"),l.createElement("input",{type:"tel",value:A,onChange:U=>R(U.target.value),className:fn,placeholder:"Ser salvo no cadastro"}))),l.createElement("div",{className:"grid grid-cols-2 gap-4 mt-4"},l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"Pagamento:"),l.createElement("select",{value:E,onChange:U=>m(U.target.value),className:fn},l.createElement("option",null,"Carto de Crdito"),l.createElement("option",null,"PIX"),l.createElement("option",null,"Dinheiro"),l.createElement("option",null,"Dbito"),l.createElement("option",null,"Outro"))),l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"Desconto (%):"),l.createElement("input",{type:"number",min:"0",max:"100",value:p,onChange:U=>y(parseFloat(U.target.value)||0),className:fn}))),E==="Carto de Crdito"&&l.createElement("div",{className:"grid grid-cols-2 gap-4 mt-4"},l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"Juros da Maquininha (%):"),l.createElement("input",{type:"number",min:"0",value:w,onChange:U=>C(parseFloat(U.target.value)||0),className:fn})),l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"N de Parcelas:"),l.createElement("input",{type:"number",min:"1",value:M,onChange:U=>z(parseInt(U.target.value,10)||1),className:fn}))),l.createElement("div",{className:"grid grid-cols-1 gap-4"},l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"Status:"),l.createElement("div",{className:"flex rounded-lg shadow-sm mt-2"},l.createElement("button",{type:"button",onClick:()=>Q("recebido"),className:`w-full py-2 text-sm font-semibold rounded-l-lg transition ${O==="recebido"?"bg-teal-500 text-white":"bg-gray-200 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`}," Recebido"),l.createElement("button",{type:"button",onClick:()=>Q("a_receber"),className:`w-full py-2 text-sm font-semibold rounded-r-lg transition ${O==="a_receber"?"bg-yellow-500 text-white":"bg-gray-200 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`}," A Receber"))),O==="a_receber"&&l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium mt-2"},"Vencimento:"),l.createElement("input",{type:"date",value:D,onChange:U=>N(U.target.value),className:fn,min:new Date().toISOString().split("T")[0]})),l.createElement("div",null,l.createElement("label",{htmlFor:"saleNotes",className:"block text-sm font-medium mt-2"},"Observaes:"),l.createElement("textarea",{id:"saleNotes",value:re,onChange:U=>I(U.target.value),className:fn,rows:"2",placeholder:"Detalhes da venda (ex: embrulhar para presente)..."}))),l.createElement("div",{className:"mt-4 border-t pt-4"},l.createElement("div",{className:"flex justify-between text-base text-gray-500"},l.createElement("span",null,"Subtotal:"),l.createElement("span",null,fe(_))),l.createElement("div",{className:"flex justify-between text-base text-red-500 font-medium"},l.createElement("span",null,"Desconto:"),l.createElement("span",null,"- ",fe(Se))),q>0&&l.createElement("div",{className:"flex justify-between text-base text-yellow-600 font-medium"},l.createElement("span",null,"Juros Carto:"),l.createElement("span",null,"+ ",fe(q))),l.createElement("div",{className:"flex justify-between text-2xl font-bold text-gray-800 pt-2 border-t"},l.createElement("span",null,"Total:"),l.createElement("span",{className:"text-pink-600"},fe(X))),l.createElement("button",{onClick:uc,disabled:d.length===0||v||X<=0,className:"mt-4 w-full py-3 text-white font-bold rounded-full bg-pink-500"},v?"Processando...":"Finalizar Venda"))))),i==="history"&&l.createElement("div",{className:"space-y-4"},l.createElement("input",{type:"text",placeholder:"Buscar por ID da Venda, Cliente ou Produto...",value:u,onChange:U=>c(U.target.value),className:fn}),l.createElement("div",{className:"space-y-3 max-h-[70vh] overflow-y-auto pr-2"},He.map(U=>l.createElement("div",{key:U.id,className:`${vD} border-l-4 ${U.paymentStatus==="estornada"?"border-gray-400":"border-teal-500"}`},l.createElement("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center"},l.createElement("div",null,l.createElement("p",{className:"text-sm text-gray-500"},"ID: ",U.id.substring(0,8),"... | Data: ",new Date(U.createdAt).toLocaleString("pt-BR")),l.createElement("p",{className:"font-semibold text-lg"},U.customerName||"Venda Annima"," ",l.createElement("span",{className:"text-sm text-gray-500"},"- ",U.paymentMethod))),l.createElement("div",{className:"text-right"},l.createElement("p",{className:"text-xl font-bold text-pink-600"},fe(U.finalTotal)),l.createElement("p",{className:"text-sm text-gray-500"},U.items.length," item(s)"))),l.createElement("div",{className:"mt-3"},U.items.map(ge=>l.createElement("div",{key:ge.sku,className:"flex justify-between text-sm border-b py-1"},l.createElement("div",null,ge.productName," (",ge.size," - ",ge.color,")"),l.createElement("div",null,ge.quantity," x ",fe(ge.salePrice)))),U.saleNotes&&l.createElement("p",{className:"mt-2"},l.createElement("strong",null,"Observaes:")," ",U.saleNotes)))),He.length===0&&l.createElement("p",{className:"text-center text-gray-500"},"Nenhuma venda encontrada."))))},Xn="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",wD=({db:t,userId:e,customers:n=[],sales:r=[],showToast:a=()=>{}})=>{const[s,i]=x.useState("list"),[o,u]=x.useState(null),[c,d]=x.useState(!1),[h,f]=x.useState(null),[g,v]=x.useState(!1),[b,E]=x.useState(null),[m,p]=x.useState(""),y={name:"",phone:"",email:"",birthday:"",preferences:"",tags:""},[w,C]=x.useState(y);x.useEffect(()=>{C(h?{name:h.name||"",phone:h.phone||"",email:h.email||"",birthday:h.birthday||"",preferences:h.preferences||"",tags:(h.tags||[]).join(", ")}:y)},[h]);const M=(L=null)=>{f(L),d(!0)},z=async L=>{if(L.preventDefault(),!w.name.trim())return a("O nome da cliente  obrigatrio.","error");if(!t||!e){a("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{const W=wt(t,ve(e,"customers")),re={...w,tags:w.tags?w.tags.split(",").map(I=>I.trim()).filter(Boolean):[],updatedAt:le.now()};h?(await us(_e(W,h.id),re),a("Cliente atualizada!","success")):(await ia(W,{...re,createdAt:le.now()}),a("Nova cliente adicionada!","success")),d(!1),f(null)}catch(W){console.error("Erro ao salvar cliente:",W),a("Erro ao salvar cliente.","error")}},O=L=>{E(L),v(!0)},Q=async()=>{if(b){if(!t||!e){a("Firestore no configurado. Faa login com uma conta vlida.","error"),v(!1),E(null),s==="profile"&&(o==null?void 0:o.id)===b.id&&(i("list"),u(null));return}try{const L=wt(t,ve(e,"customers"));await cs(_e(L,b.id)),a("Cliente excluda!","success")}catch(L){console.error("Erro ao deletar cliente:",L),a("Erro ao excluir cliente.","error")}finally{v(!1),E(null),s==="profile"&&(o==null?void 0:o.id)===b.id&&(i("list"),u(null))}}},D=x.useMemo(()=>(n||[]).filter(L=>L.name.toLowerCase().includes(m.toLowerCase())||L.phone&&L.phone.includes(m)||L.tags&&L.tags.some(W=>W.toLowerCase().includes(m.toLowerCase()))),[n,m]),N=({customer:L})=>{const[W,re]=x.useState([]),[I,A]=x.useState(""),[R,k]=x.useState(null),_=x.useMemo(()=>(r||[]).filter(T=>T.customerId===L.id).sort((T,q)=>{var X,Se;return((X=q.date)==null?void 0:X.seconds)-((Se=T.date)==null?void 0:Se.seconds)}),[r,L.id]);x.useMemo(()=>{var T;const q=_.reduce((Se,He)=>Se+He.totalAmount,0),X=_.length>0?(T=_[0].date)==null?void 0:T.toDate():null;return{totalSpent:q,lastPurchase:X}},[_]),x.useEffect(()=>{(async()=>{if(!t||!e){re([]);return}try{const T=wt(_e(t,ve(e,"customers"),L.id),"notes"),q=(await Ph(T)).docs.map(X=>({id:X.id,...X.data()}));re(q.sort((X,Se)=>{var He,Oe;return(((He=Se.createdAt)==null?void 0:He.seconds)||0)-(((Oe=X.createdAt)==null?void 0:Oe.seconds)||0)}))}catch(T){console.error("Erro ao carregar notas:",T),re([])}})()},[L.id,t,e]);const j=async()=>{if(I.trim()){if(!t||!e){a("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{const T=wt(_e(t,ve(e,"customers"),L.id),"notes");await ia(T,{text:I.trim(),createdAt:le.now()}),A("");const q=(await Ph(T)).docs.map(X=>({id:X.id,...X.data()}));re(q.sort((X,Se)=>{var He,Oe;return(((He=Se.createdAt)==null?void 0:He.seconds)||0)-(((Oe=X.createdAt)==null?void 0:Oe.seconds)||0)})),a("Anotao adicionada!","success")}catch(T){console.error("Erro ao adicionar nota:",T),a("Erro ao adicionar nota.","error")}}};return l.createElement("div",{className:"space-y-6"},l.createElement("div",{className:"flex justify-between items-center"},l.createElement("div",null,l.createElement("button",{onClick:()=>i("list"),className:"text-sm text-pink-600 hover:underline"}," Voltar para a Lista"),l.createElement("h2",{className:"text-3xl font-bold"},L.name)),l.createElement("div",{className:"space-x-2"},l.createElement("button",{onClick:()=>M(L),className:"px-4 py-2 text-sm text-white font-semibold rounded-full bg-indigo-500"},"Editar"),l.createElement("button",{onClick:()=>O(L),className:"px-4 py-2 text-sm text-white font-semibold rounded-full bg-red-500"},"Excluir"))),l.createElement("div",{className:"grid lg:grid-cols-3 gap-6"},l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow lg:col-span-1"},l.createElement("h3",{className:"text-xl font-semibold"},"Informaes"),l.createElement("p",null,l.createElement("strong",null,"Telefone:")," ",L.phone||"N/A"),l.createElement("p",null,l.createElement("strong",null,"Email:")," ",L.email||"N/A"),l.createElement("p",null,l.createElement("strong",null,"Aniversrio:")," ",L.birthday||"N/A"),l.createElement("div",null,l.createElement("h4",{className:"font-semibold"},"Tags:"),l.createElement("div",{className:"flex flex-wrap gap-2 mt-2"},(L.tags||[]).map(T=>l.createElement("span",{key:T,className:"px-2 py-1 text-xs font-semibold text-pink-800 bg-pink-100 rounded-full"},T))))),l.createElement("div",{className:"lg:col-span-2 space-y-6"},l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow"},l.createElement("h3",{className:"text-xl font-semibold"},"Anotaes"),l.createElement("div",{className:"flex space-x-2 mb-4"},l.createElement("textarea",{value:I,onChange:T=>A(T.target.value),rows:"2",className:Xn,placeholder:"Adicionar nova anotao..."}),l.createElement("button",{onClick:j,className:"px-4 text-white font-semibold rounded-lg bg-pink-500"},"Salvar")),l.createElement("div",{className:"space-y-3 max-h-40 overflow-y-auto"},W.map(T=>l.createElement("div",{key:T.id,className:"p-2 bg-gray-50 dark:bg-gray-700/50 rounded"},l.createElement("p",{className:"text-sm"},T.text),l.createElement("p",{className:"text-xs text-right text-gray-400"},new Date(T.createdAt.seconds*1e3).toLocaleString("pt-BR")))))),l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow"},l.createElement("h3",{className:"text-xl font-semibold"},"Histrico de Compras (",_.length,")"),l.createElement("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto"},_.length>0?_.map(T=>{var q;return l.createElement("div",{key:T.id,className:"p-4 rounded-lg border-l-4 bg-white dark:bg-gray-700/50 border-teal-500"},l.createElement("div",{className:"flex justify-between items-center"},l.createElement("div",null,l.createElement("p",{className:"text-sm text-gray-500"},(q=T.date)!=null&&q.toDate?T.date.toDate().toLocaleString("pt-BR"):T.date),l.createElement("p",{className:"font-bold text-lg"},ED(T.totalAmount)," - ",l.createElement("span",{className:"font-medium"},T.paymentMethod))),l.createElement("div",null,l.createElement("button",{onClick:()=>k(R===T.id?null:T.id),className:"text-sm font-semibold text-gray-600"},R===T.id?"Fechar":"Ver Itens"))),R===T.id&&l.createElement("div",{className:"mt-4 pt-4 border-t text-sm"},l.createElement("p",{className:"font-semibold"},"Itens Comprados:"),l.createElement("ul",{className:"list-disc list-inside"},T.items.map(X=>l.createElement("li",{key:X.sku},X.quantity,"x ",X.name," - R$ ",X.salePrice)))))}):l.createElement("p",{className:"text-gray-500"},"Nenhuma compra registrada para esta cliente."))))))};return s==="profile"&&o?l.createElement(N,{customer:o}):l.createElement("div",{className:"space-y-6"},l.createElement("div",{className:"flex flex-col md:flex-row justify-between md:items-center"},l.createElement("h2",{className:"text-2xl font-bold"},"Gesto de Clientes"),l.createElement("div",{className:"flex items-center space-x-2 mt-4 md:mt-0"},l.createElement("input",{type:"text",placeholder:"Buscar por nome, telefone, tag...",value:m,onChange:L=>p(L.target.value),className:Xn+" max-w-sm"}),l.createElement("button",{onClick:()=>M(),className:"px-4 py-3 text-white font-semibold rounded-lg bg-pink-500"},"+ Nova Cliente"))),l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow overflow-x-auto"},l.createElement("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},l.createElement("thead",{className:"bg-gray-50 dark:bg-gray-700"},l.createElement("tr",null,l.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nome"),l.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Telefone"),l.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Tags"),l.createElement("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Aes"))),l.createElement("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},D.map(L=>l.createElement("tr",{key:L.id,className:"hover:bg-gray-50 dark:hover:bg-gray-700"},l.createElement("td",{className:"px-6 py-4"},l.createElement("div",{className:"text-sm font-medium"},L.name),L.email&&l.createElement("div",{className:"text-sm text-gray-500"},L.email)),l.createElement("td",{className:"px-6 py-4"},l.createElement("div",{className:"text-sm"},L.phone||"N/A")),l.createElement("td",{className:"px-6 py-4"},l.createElement("div",{className:"flex flex-wrap gap-1"},(L.tags||[]).slice(0,3).map(W=>l.createElement("span",{key:W,className:"px-2 py-1 text-xs font-semibold text-pink-800 bg-pink-100 rounded-full"},W)))),l.createElement("td",{className:"px-6 py-4 text-right text-sm font-medium"},l.createElement("button",{onClick:()=>M(L),className:"text-indigo-600 mr-4"},"Editar"),l.createElement("button",{onClick:()=>{u(L),i("profile")},className:"text-indigo-600"},"Ver Perfil"))))))),l.createElement(Mt,{isOpen:c,onClose:()=>d(!1),title:h?"Editar Cliente":"Adicionar Cliente",actions:l.createElement(l.Fragment,null,l.createElement("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),l.createElement("button",{onClick:z,className:"px-4 py-2 text-white rounded-full bg-pink-500"},h?"Salvar":"Adicionar"))},l.createElement("form",{className:"space-y-4"},l.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},l.createElement("div",null,l.createElement("label",null,"Nome*"),l.createElement("input",{type:"text",name:"name",value:w.name,onChange:L=>C({...w,name:L.target.value}),className:Xn})),l.createElement("div",null,l.createElement("label",null,"Telefone"),l.createElement("input",{type:"tel",name:"phone",value:w.phone,onChange:L=>C({...w,phone:L.target.value}),className:Xn}))),l.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},l.createElement("div",null,l.createElement("label",null,"Email"),l.createElement("input",{type:"email",name:"email",value:w.email,onChange:L=>C({...w,email:L.target.value}),className:Xn})),l.createElement("div",null,l.createElement("label",null,"Aniversrio"),l.createElement("input",{type:"date",name:"birthday",value:w.birthday,onChange:L=>C({...w,birthday:L.target.value}),className:Xn}))),l.createElement("div",null,l.createElement("label",null,"Preferncias"),l.createElement("textarea",{name:"preferences",rows:"3",value:w.preferences,onChange:L=>C({...w,preferences:L.target.value}),className:Xn})),l.createElement("div",null,l.createElement("label",null,"Tags (separadas por vrgula)"),l.createElement("input",{type:"text",name:"tags",value:w.tags,onChange:L=>C({...w,tags:L.target.value}),className:Xn})))),l.createElement(Mt,{isOpen:g,onClose:()=>v(!1),title:"Confirmar Excluso",size:"max-w-md",actions:l.createElement(l.Fragment,null,l.createElement("button",{onClick:()=>v(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),l.createElement("button",{onClick:Q,className:"px-4 py-2 text-white rounded-full bg-red-500"},"Excluir"))},l.createElement("p",null,"Tem certeza que deseja excluir a cliente ",l.createElement("strong",null,b==null?void 0:b.name),"?")))},ED=(t=0)=>{try{return Number(t).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}catch{return`R$ ${t}`}},Oh="bg-pink-500 hover:bg-pink-600",kD="bg-red-500 hover:bg-red-600",ir="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",nk="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",xD=({expenses:t})=>{const e=l.useMemo(()=>{const r=new Date,a=new Date(r.getFullYear(),r.getMonth(),1),s=(t||[]).filter(o=>o.date&&o.date.toDate?o.date.toDate()>=a:!1).reduce((o,u)=>(o[u.category]=(o[u.category]||0)+u.amount,o),{}),i=Object.values(s).reduce((o,u)=>o+u,0);return Object.entries(s).map(([o,u])=>({category:o,amount:u,percentage:i>0?u/i*100:0})).sort((o,u)=>u.amount-o.amount)},[t]);if(!e||e.length===0)return null;const n=["bg-pink-500","bg-teal-500","bg-yellow-500","bg-purple-500","bg-orange-500","bg-indigo-500"];return l.createElement("div",{className:nk},l.createElement("h3",{className:"text-xl font-semibold mb-4"},"Despesas do Ms por Categoria"),l.createElement("div",{className:"space-y-4"},l.createElement("div",{className:"flex h-6 rounded-full overflow-hidden shadow-inner"},e.map((r,a)=>l.createElement("div",{key:r.category,style:{width:`${r.percentage}%`},className:n[a%n.length],title:`${r.category}: ${r.percentage.toFixed(1)}%`}))),l.createElement("ul",{className:"grid grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-2 text-sm"},e.map((r,a)=>l.createElement("li",{key:r.category,className:"flex items-center space-x-2"},l.createElement("span",{className:`w-3 h-3 rounded-full ${n[a%n.length]}`}),l.createElement("span",{className:"text-gray-700 dark:text-gray-300"},r.category,":"),l.createElement("span",{className:"font-semibold text-gray-800 dark:text-gray-100"},fe(r.amount)))))))},ND=({isOpen:t,onClose:e,db:n,userId:r,showToast:a,recurringExpenses:s=[],onLaunch:i,expenseCategories:o=[]})=>{const[u,c]=x.useState({description:"",amount:"",category:o[0]||"Matria Prima"});x.useEffect(()=>{c({description:"",amount:"",category:o[0]||"Matria Prima"})},[t,o]);const d=v=>c(b=>({...b,[v.target.name]:v.target.value})),h=async()=>{if(!u.description.trim()||parseFloat(u.amount)<=0){a("Descrio e valor so obrigatrios","error");return}if(!n||!r){a("Firestore no configurado. Faa login com uma conta vlida.","error");return}await ia(wt(n,ve(r,"recurringExpenses")),{...u,amount:parseFloat(u.amount)}),c({description:"",amount:"",category:o[0]||"Matria Prima"}),a("Despesa recorrente adicionada!","success")},f=async v=>{if(!n||!r){a("Firestore no configurado. Faa login com uma conta vlida.","error");return}await cs(_e(n,ve(r,"recurringExpenses"),v)),a("Despesa recorrente excluda","success")},g=v=>{i&&i({description:v.description,amount:v.amount,category:v.category,status:"a_pagar",date:new Date().toISOString().split("T")[0],dueDate:new Date().toISOString().split("T")[0]})};return l.createElement(Mt,{isOpen:t,onClose:e,title:"Gerenciar Despesas Recorrentes",size:"max-w-2xl"},l.createElement("div",{className:"space-y-4"},l.createElement("div",{className:"p-4 border rounded-lg bg-gray-50 dark:bg-gray-700/50 space-y-3"},l.createElement("h4",{className:"font-semibold"},"Adicionar Nova Despesa Recorrente"),l.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3"},l.createElement("input",{name:"description",value:u.description,onChange:d,className:ir,placeholder:"Descrio (Ex: Aluguel)"}),l.createElement("input",{name:"amount",value:u.amount,onChange:d,className:ir,placeholder:"Valor (R$)"}),l.createElement("select",{name:"category",value:u.category,onChange:d,className:ir},o.map(v=>l.createElement("option",{key:v,value:v},v)))),l.createElement("button",{onClick:h,className:`w-full py-2 text-white font-semibold rounded-lg ${Oh}`},"Adicionar")),l.createElement("div",{className:"max-h-64 overflow-y-auto"},l.createElement("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700"},(s||[]).map(v=>l.createElement("li",{key:v.id,className:"py-3 flex justify-between items-center"},l.createElement("div",null,l.createElement("p",{className:"font-medium dark:text-gray-200"},v.description," - ",fe(v.amount)),l.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},v.category)),l.createElement("div",{className:"space-x-2"},l.createElement("button",{onClick:()=>g(v),className:"px-3 py-1 text-sm text-white bg-blue-500 rounded-full"},"Lanar no Ms"),l.createElement("button",{onClick:()=>f(v.id),className:"text-red-500"},"Excluir"))))))))},SD=({db:t,userId:e,expenses:n=[],showToast:r=()=>{},recurringExpenses:a=[],onLaunchRecurring:s=null})=>{const[i,o]=x.useState(!1),[u,c]=x.useState(null),[d,h]=x.useState(!1),[f,g]=x.useState(null),[v,b]=x.useState(!1),E={description:"",amount:"",category:"Matria Prima",date:new Date().toISOString().split("T")[0],status:"pago",dueDate:""},[m,p]=x.useState(E),y=["Matria Prima","Marketing","Aluguel","Salrios","Impostos","Outros"];x.useEffect(()=>{if(u){const D=u.date&&u.date.toDate?u.date.toDate().toISOString().split("T")[0]:u.date||new Date().toISOString().split("T")[0],N=u.dueDate&&u.dueDate.toDate?u.dueDate.toDate().toISOString().split("T")[0]:u.dueDate||"";p({...u,date:D,dueDate:N})}},[u]);const w=(D=null)=>{c(null),p(D?{...E,...D}:E),o(!0)};x.useEffect(()=>{s&&w(s)},[s]);const C=D=>{const{name:N,value:L}=D.target;p(W=>({...W,[N]:L}))},M=async D=>{if(D&&D.preventDefault(),!m.description||parseFloat(m.amount)<=0)return r("Preencha a descrio e um valor vlido.","error");if(!t||!e){r("Firestore no configurado. Faa login com uma conta vlida.","error"),o(!1),c(null);return}try{const N={...m,amount:parseFloat(m.amount),date:le.fromDate(new Date(m.date.replace(/-/g,"/"))),dueDate:m.status==="a_pagar"&&m.dueDate?le.fromDate(new Date(m.dueDate.replace(/-/g,"/"))):null},L=wt(t,ve(e,"expenses"));u?(await us(_e(L,u.id),N),r("Despesa atualizada!","success")):(await ia(L,N),r("Despesa adicionada!","success")),o(!1),c(null)}catch(N){console.error("Erro ao salvar despesa:",N),r("Erro ao salvar despesa.","error")}},z=D=>{g(D),h(!0)},O=async()=>{if(f){if(!t||!e){r("Firestore no configurado. Faa login com uma conta vlida.","error"),h(!1),g(null);return}try{await cs(_e(t,ve(e,"expenses"),f.id)),r("Despesa excluda.","success")}catch{r("Erro ao excluir.","error")}finally{h(!1),g(null)}}},Q=async D=>{if(!t||!e){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}const N=_e(t,ve(e,"expenses"),D.id);try{await us(N,{status:"pago"}),r("Despesa marcada como paga!","success")}catch{r("Erro ao atualizar despesa.","error")}};return l.createElement("div",{className:"space-y-6"},l.createElement("div",{className:"flex justify-between items-center"},l.createElement("h2",{className:"text-2xl font-bold"},"Controle de Despesas"),l.createElement("div",{className:"flex space-x-2"},l.createElement("button",{onClick:()=>b(!0),className:"px-4 py-2 text-teal-600 font-semibold bg-teal-100 rounded-lg"},"Gerenciar Recorrentes"),l.createElement("button",{onClick:()=>w(),className:`px-4 py-2 text-white font-semibold rounded-lg ${Oh}`},"+ Nova Despesa"))),l.createElement(xD,{expenses:n}),l.createElement("div",{className:nk},l.createElement("h3",{className:"text-xl font-semibold mb-4"},"Despesas Registradas (",(n||[]).length,")"),l.createElement("div",{className:"overflow-x-auto"},l.createElement("table",{className:"min-w-full divide-y divide-gray-200"},l.createElement("thead",{className:"bg-gray-50"},l.createElement("tr",null,l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Data"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Descrio"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Categoria"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Valor"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Status"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Aes"))),l.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},(n||[]).map(D=>{const N=D.status==="a_pagar"&&D.dueDate&&D.dueDate.toDate?D.dueDate.toDate()<Tn(new Date):!1;return l.createElement("tr",{key:D.id,className:N?"bg-red-50":""},l.createElement("td",{className:"px-3 py-4 text-sm"},D.date&&D.date.toDate?D.date.toDate().toLocaleDateString("pt-BR"):D.date),l.createElement("td",{className:"px-3 py-4 text-sm font-medium"},D.description),l.createElement("td",{className:"px-3 py-4 text-sm"},l.createElement("span",{className:"px-2 inline-flex text-xs font-semibold rounded-full bg-pink-100 text-pink-800"},D.category)),l.createElement("td",{className:"px-3 py-4 text-sm font-semibold text-red-600"},fe(D.amount)),l.createElement("td",{className:"px-3 py-4 text-sm"},D.status==="pago"?l.createElement("span",{className:"text-green-600 font-semibold"},"Pago"):l.createElement("span",{className:"text-yellow-600 font-semibold"},"A Pagar ",D.dueDate?`em ${D.dueDate.toDate().toLocaleDateString("pt-BR")}`:"")),l.createElement("td",{className:"px-3 py-4 text-right text-sm space-x-2"},D.status==="a_pagar"&&l.createElement("button",{onClick:()=>Q(D),className:"text-green-600"},"Pagar"),l.createElement("button",{onClick:()=>{c(D),o(!0)},className:"text-indigo-600"},"Editar"),l.createElement("button",{onClick:()=>z(D),className:"text-red-600"},"Deletar")))}))))),l.createElement(Mt,{isOpen:i,onClose:()=>o(!1),title:u?"Editar Despesa":"Adicionar Despesa",actions:l.createElement(l.Fragment,null,l.createElement("button",{onClick:()=>o(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),l.createElement("button",{onClick:M,className:`px-4 py-2 text-white rounded-full ${Oh}`},u?"Salvar":"Adicionar"))},l.createElement("form",{className:"space-y-4"},l.createElement("div",null,l.createElement("label",null,"Nome / Descrio"),l.createElement("input",{type:"text",name:"description",value:m.description,onChange:C,className:ir})),l.createElement("div",{className:"grid grid-cols-2 gap-4"},l.createElement("div",null,l.createElement("label",null,"Valor (R$)"),l.createElement("input",{type:"number",name:"amount",value:m.amount,onChange:C,className:ir})),l.createElement("div",null,l.createElement("label",null,"Data"),l.createElement("input",{type:"date",name:"date",value:m.date,onChange:C,className:ir}))),l.createElement("div",null,l.createElement("label",null,"Categoria"),l.createElement("select",{name:"category",value:m.category,onChange:C,className:ir},y.map(D=>l.createElement("option",{key:D,value:D},D)))),l.createElement("div",{className:"grid grid-cols-2 gap-4"},l.createElement("div",null,l.createElement("label",null,"Status"),l.createElement("div",{className:"flex"},l.createElement("button",{type:"button",onClick:()=>p({...m,status:"pago"}),className:`w-full py-2 ${m.status==="pago"?"bg-teal-500 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`},"Pago"),l.createElement("button",{type:"button",onClick:()=>p({...m,status:"a_pagar"}),className:`w-full py-2 ${m.status==="a_pagar"?"bg-yellow-500 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`},"A Pagar"))),m.status==="a_pagar"&&l.createElement("div",null,l.createElement("label",null,"Vencimento"),l.createElement("input",{type:"date",name:"dueDate",value:m.dueDate,onChange:C,className:ir}))))),l.createElement(Mt,{isOpen:d,onClose:()=>h(!1),title:"Confirmar Excluso",size:"max-w-md",actions:l.createElement(l.Fragment,null,l.createElement("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),l.createElement("button",{onClick:O,className:`px-4 py-2 text-white rounded-full ${kD}`},"Excluir"))},l.createElement("p",null,"Tem certeza que deseja excluir a despesa ",l.createElement("strong",null,f==null?void 0:f.description),"?")),v&&l.createElement(ND,{isOpen:v,onClose:()=>b(!1),db:t,userId:e,showToast:r,recurringExpenses:a,onLaunch:D=>{b(!1),w(D)},expenseCategories:y}))},sd="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",CD="bg-pink-500 hover:bg-pink-600",Ay="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",ID=({goal:t,sales:e,expenses:n,goalTypes:r})=>{const a=x.useMemo(()=>{if(!t)return{idealPath:[],actualPath:[],daysInMonth:0,today:0};const b=new Date,E=b.getFullYear(),m=b.getMonth(),p=new Date(E,m+1,0).getDate(),y=b.getDate(),w=t.amount/p,C=Array.from({length:p},(N,L)=>w*(L+1)),M=(e||[]).filter(N=>N.date&&N.date.toDate&&N.date.toDate().getMonth()===m&&N.date.toDate().getFullYear()===E&&N.status!=="estornada"),z=(n||[]).filter(N=>N.date&&N.date.toDate&&N.date.toDate().getMonth()===m&&N.date.toDate().getFullYear()===E&&N.status==="pago"),O=Array(p).fill(0);switch(t.type){case"revenue":case"averageTicket":M.forEach(N=>{O[N.date.toDate().getDate()-1]+=N.totalAmount});break;case"netProfit":M.forEach(N=>{O[N.date.toDate().getDate()-1]+=N.profit||0}),z.forEach(N=>{O[N.date.toDate().getDate()-1]-=N.amount});break;case"salesCount":M.forEach(N=>{O[N.date.toDate().getDate()-1]+=1});break;case"itemsSold":M.forEach(N=>{const L=N.date.toDate().getDate()-1;O[L]+=N.items.reduce((W,re)=>W+re.quantity,0)});break}let Q=0;const D=O.map((N,L)=>{if(Q+=N,t.type==="averageTicket"){const W=M.filter(re=>re.date.toDate().getDate()<=L+1);return W.length>0?Q/W.length:0}return Q});return{idealPath:C,actualPath:D,daysInMonth:p,today:y}},[t,e,n]),{idealPath:s,actualPath:i,daysInMonth:o,today:u}=a,c=Math.max(...s,...i,t.amount||0);if(c===0)return l.createElement("p",null,"Sem dados para exibir.");const d=500,h=200,f=b=>b.map((E,m)=>`${m/(o-1)*d},${h-E/c*h}`).join(" "),g=f(s),v=f(i.slice(0,u));return l.createElement("div",{className:"text-center"},l.createElement("svg",{viewBox:`0 0 ${d} ${h}`,className:"w-full h-auto"},l.createElement("polyline",{fill:"none",stroke:"#cbd5e1",strokeWidth:"2",strokeDasharray:"4 4",points:g}),l.createElement("polyline",{fill:"none",stroke:"#ec4899",strokeWidth:"3",points:v})),l.createElement("div",{className:"flex justify-center items-center space-x-4 text-sm mt-2"},l.createElement("div",{className:"flex items-center"},l.createElement("span",{className:"w-4 h-0.5 bg-pink-500 mr-2"})," Realizado"),l.createElement("div",{className:"flex items-center"},l.createElement("span",{className:"w-4 h-0.5 bg-gray-300 border-t-2 border-dashed border-gray-300 mr-2"})," Ideal")),l.createElement("p",{className:"text-sm mt-2"},"Valor atual: ",l.createElement("strong",{className:"text-pink-600"},fe(i[u-1]||0))))},_D=({db:t,userId:e,sales:n=[],expenses:r=[],allGoals:a=[],showToast:s=()=>{}})=>{const i=new Date,o=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`,u=a.find(m=>m.id===o),[c,d]=x.useState("revenue"),[h,f]=x.useState(""),g=[{value:"revenue",label:"Faturamento (Receita Total)",format:fe},{value:"netProfit",label:"Lucro Lquido",format:fe},{value:"salesCount",label:"Nmero de Vendas",format:ad},{value:"itemsSold",label:"Itens Vendidos",format:ad},{value:"averageTicket",label:"Ticket Mdio (R$)",format:fe}];x.useEffect(()=>{u?(d(u.type),f(u.amount)):(d("revenue"),f(""))},[u]);const v=async()=>{const m=parseFloat(h);if(!t||!e||isNaN(m)||m<=0){s("Por favor, insira um valor de meta vlido.","error");return}const p=_e(t,ve(e,"goals"),o);try{await ek(p,{type:c,amount:m}),s("Meta salva com sucesso!","success")}catch(y){console.error("Erro ao salvar meta:",y),s("Erro ao salvar a meta.","error")}},b=(m,p,y)=>{if(!m)return{achieved:0,percentage:0};const[w,C]=m.id.split("-").map(Number),M=new Date(w,C-1,1),z=new Date(w,C,0,23,59,59),O=(p||[]).filter(W=>{const re=W.date&&W.date.toDate?W.date.toDate():new Date(W.date);return re>=M&&re<=z&&W.status!=="estornada"}),Q=(y||[]).filter(W=>{const re=W.date&&W.date.toDate?W.date.toDate():new Date(W.date);return re>=M&&re<=z&&W.status==="pago"});let D=0;const N=O.reduce((W,re)=>W+re.totalAmount,0);switch(m.type){case"revenue":D=N;break;case"netProfit":const W=O.reduce((I,A)=>I+(A.profit||0),0),re=Q.reduce((I,A)=>I+A.amount,0);D=W-re;break;case"salesCount":D=O.length;break;case"itemsSold":D=O.reduce((I,A)=>I+A.items.reduce((R,k)=>R+k.quantity,0),0);break;case"averageTicket":D=O.length>0?N/O.length:0;break;default:D=0}const L=m.amount>0?D/m.amount*100:0;return{achieved:D,percentage:L}},E=x.useMemo(()=>(a||[]).filter(m=>m.id!==o).sort((m,p)=>p.id.localeCompare(m.id)),[a,o]);return l.createElement("div",{className:"space-y-8"},l.createElement("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100"},"Metas e Objetivos"),l.createElement("div",{className:"grid lg:grid-cols-2 gap-6"},l.createElement("div",{className:sd},l.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Definir Meta para ",new Date().toLocaleDateString("pt-BR",{month:"long"})),l.createElement("div",{className:"space-y-4"},l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Tipo de Meta"),l.createElement("select",{value:c,onChange:m=>d(m.target.value),className:Ay},g.map(m=>l.createElement("option",{key:m.value,value:m.value},m.label)))),l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Valor da Meta"),l.createElement("input",{type:"number",value:h,onChange:m=>f(m.target.value),className:Ay,placeholder:"Ex: 5000"})),l.createElement("button",{onClick:v,className:`w-full p-3 rounded-full text-white font-bold ${CD}`},u?"Atualizar Meta":"Salvar Meta"))),l.createElement("div",{className:sd},l.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Ritmo para Atingir a Meta"),u?l.createElement(ID,{goal:u,sales:n,expenses:r,goalTypes:g}):l.createElement("p",{className:"text-center text-gray-500 dark:text-gray-400 py-10"},"Defina uma meta para ver o ritmo de progresso."))),l.createElement("div",{className:sd},l.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Histrico de Metas"),l.createElement("div",{className:"max-h-96 overflow-y-auto"},l.createElement("ul",{className:"space-y-3"},E.map(m=>{const p=b(m,n,r),y=g.find(O=>O.value===m.type)||{format:ad},w=p.percentage>=100,[C,M]=m.id.split("-"),z=new Date(C,M-1,1).toLocaleDateString("pt-BR",{month:"long"});return l.createElement("li",{key:m.id,className:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border dark:border-gray-600"},l.createElement("p",{className:"font-bold text-gray-800 dark:text-gray-200 capitalize"},z," de ",C),l.createElement("div",{className:"flex justify-between items-center mt-1"},l.createElement("div",null,l.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Meta (",y.label,"): ",y.format(m.amount)),l.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Atingido: ",l.createElement("span",{className:"font-semibold"},y.format(p.achieved)))),l.createElement("div",{className:`px-3 py-1 rounded-full text-sm font-bold ${w?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300":"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300"}`},p.percentage.toFixed(1),"% ",w?"":"")))})))))},qt="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",id="w-full p-3 border border-gray-300 rounded-lg bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",TD=({sales:t=[],expenses:e=[]})=>{const n=x.useMemo(()=>{const a=(t||[]).filter(i=>i.paymentStatus==="recebido"&&i.status!=="estornada").reduce((i,o)=>i+o.totalAmount,0),s=(e||[]).filter(i=>i.status==="pago").reduce((i,o)=>i+o.amount,0);return{inflow:a,outflow:s,balance:a-s}},[t,e]),r=Math.max(n.inflow,n.outflow,1);return l.createElement("div",{className:"space-y-4"},l.createElement("div",{className:"flex justify-around items-end h-48"},l.createElement("div",{className:"flex flex-col items-center"},l.createElement("p",{className:"font-bold text-green-600"},fe(n.inflow)),l.createElement("div",{className:"w-16 bg-green-400 rounded-t-lg",style:{height:`${n.inflow/r*150}px`}}),l.createElement("p",{className:"text-sm"},"Entradas")),l.createElement("div",{className:"flex flex-col items-center"},l.createElement("p",{className:"font-bold text-red-600"},fe(n.outflow)),l.createElement("div",{className:"w-16 bg-red-400 rounded-t-lg",style:{height:`${n.outflow/r*150}px`}}),l.createElement("p",{className:"text-sm"},"Sadas"))),l.createElement("div",{className:"text-center border-t pt-3"},l.createElement("p",{className:"text-sm"},"Saldo do Perodo"),l.createElement("p",{className:`text-2xl font-bold ${n.balance>=0?"text-blue-600":"text-orange-600"}`},fe(n.balance))))},DD=({sales:t=[],expenses:e=[],dateRange:n={}})=>{const r=x.useMemo(()=>{if(!n.start||!n.end)return[];const f=new Map,g=new Date(n.start);for(;g<=n.end;)f.set(g.toISOString().split("T")[0],0),g.setDate(g.getDate()+1);(t||[]).filter(b=>b.status!=="estornada").forEach(b=>{const E=b.date.toDate().toISOString().split("T")[0];f.has(E)&&f.set(E,f.get(E)+(b.profit||0))}),(e||[]).forEach(b=>{if(b.status!=="pago")return;const E=b.date.toDate().toISOString().split("T")[0];f.has(E)&&f.set(E,f.get(E)-b.amount)});let v=0;return Array.from(f.values()).map(b=>(v+=b,v))},[t,e,n]);if(r.length===0)return l.createElement("p",{className:"text-center"},"Selecione um perodo para ver a tendncia.");const a=Math.max(...r,0),s=Math.min(...r,0),i=a-s,o=500,u=200,c=f=>i===0?u/2:u-(f-s)/i*u,d=f=>f.length===1?`0,${c(f[0])} ${o},${c(f[0])}`:f.map((g,v)=>`${v/(f.length-1)*o},${c(g)}`).join(" "),h=c(0);return l.createElement("div",{className:"text-center"},l.createElement("svg",{viewBox:`0 0 ${o} ${u}`,className:"w-full h-auto"},h>=0&&h<=u&&l.createElement("line",{x1:"0",y1:h,x2:o,y2:h,stroke:"#9ca3af",strokeWidth:"1",strokeDasharray:"4 4"}),l.createElement("polyline",{fill:"none",stroke:"#10b981",strokeWidth:"3",points:d(r)})),l.createElement("p",{className:"text-sm mt-2"},"Lucro lquido acumulado no perodo."))},AD=({sales:t=[],products:e=[],expenses:n=[],db:r,userId:a,showToast:s=()=>{}})=>{const[i,o]=x.useState("month"),[u,c]=x.useState(""),[d,h]=x.useState(""),{filteredSales:f,filteredExpenses:g,dateRange:v}=x.useMemo(()=>{const I=new Date;let A,R=new Date;R.setHours(23,59,59,999),i==="custom"&&u&&d?(A=Tn(new Date(u.replace(/-/g,"/"))),R=new Date(d.replace(/-/g,"/")),R.setHours(23,59,59,999)):i==="30days"?(A=new Date,A.setDate(I.getDate()-30),A=Tn(A)):i==="month"?A=Tn(new Date(I.getFullYear(),I.getMonth(),1)):i==="year"?A=Tn(new Date(I.getFullYear(),0,1)):A=null;const k=(_,j=!1)=>A?_.filter(T=>{const q=T.date&&T.date.toDate?T.date.toDate():new Date(T.date);return q>=A&&q<=R}):_;return{filteredSales:k(t,!0),filteredExpenses:k(n),dateRange:{start:A,end:R}}},[t,n,i,u,d]),b=I=>{const A=new Date;let R,k;if(I==="month")R=new Date(A.getFullYear(),A.getMonth()-1,1),k=new Date(A.getFullYear(),A.getMonth(),0);else if(I==="30days")R=new Date,R.setDate(A.getDate()-60),k=new Date,k.setDate(A.getDate()-30);else if(I==="year")R=new Date(A.getFullYear()-1,0,1),k=new Date(A.getFullYear()-1,11,31);else return null;return{start:Tn(R),end:k}},E=(I,A)=>{const R=(I||[]).reduce((j,T)=>(j.totalRevenue+=T.totalAmount,j.totalSalesCount+=1,j.grossProfit+=T.profit||0,j),{totalRevenue:0,grossProfit:0,totalSalesCount:0}),k=(A||[]).filter(j=>j.status==="pago").reduce((j,T)=>j+T.amount,0),_=R.grossProfit-k;return{...R,totalExpenses:k,netProfit:_}},m=x.useMemo(()=>{const I=E(f,g),A=b(i);if(!A)return{current:I,changes:null};const R=(t||[]).filter(q=>q.status!=="estornada"&&q.date&&q.date.toDate?q.date.toDate()>=A.start&&q.date.toDate()<=A.end:!1),k=(n||[]).filter(q=>q.date&&q.date.toDate?q.date.toDate()>=A.start&&q.date.toDate()<=A.end:!1),_=E(R,k),j=(q,X)=>X===0?q>0?100:0:(q-X)/X*100,T={revenue:j(I.totalRevenue,_.totalRevenue),netProfit:j(I.netProfit,_.netProfit),salesCount:j(I.totalSalesCount,_.totalSalesCount)};return{current:I,changes:T}},[f,g,t,n,i]),{totalRevenue:p,grossProfit:y,totalSalesCount:w,totalExpenses:C,netProfit:M}=m.current||{totalRevenue:0,grossProfit:0,totalSalesCount:0,totalExpenses:0,netProfit:0},z=x.useMemo(()=>{if(!f||f.length===0)return{A:[],B:[],C:[]};const I=new Map;let A=0;if(f.forEach(T=>T.items.forEach(q=>{const X=q.salePrice*q.quantity;I.set(q.productId,(I.get(q.productId)||0)+X),A+=X})),A===0)return{A:[],B:[],C:[]};const R=new Map((e||[]).map(T=>[T.id,T.name])),k=Array.from(I.entries()).map(([T,q])=>({id:T,name:R.get(T)||"Produto",revenue:q,percentage:q/A*100})).sort((T,q)=>q.revenue-T.revenue),_={A:[],B:[],C:[]};let j=0;return k.forEach(T=>{j+=T.percentage,j<=80?_.A.push(T):j<=95?_.B.push(T):_.C.push(T)}),_},[f,e]),O=x.useMemo(()=>{const I=new Map;(f||[]).forEach(R=>R.items.forEach(k=>{const _=I.get(k.sku)||{quantity:0,revenue:0};I.set(k.sku,{quantity:_.quantity+k.quantity,revenue:_.revenue+k.salePrice*k.quantity})}));const A=new Map((e||[]).flatMap(R=>(R.variants||[]).map(k=>[k.sku,{...k,productName:R.name}])));return Array.from(I.entries()).map(([R,k])=>({sku:R,...A.get(R),...k})).sort((R,k)=>k.quantity-R.quantity).slice(0,10)},[f,e]),Q=x.useMemo(()=>{const I=new Map;(t||[]).forEach(k=>{const _=k.date&&k.date.toDate?k.date.toDate():new Date;k.items.forEach(j=>{(!I.has(j.sku)||_>I.get(j.sku))&&I.set(j.sku,_)})});const A=120,R=new Date;return R.setDate(R.getDate()-A),(e||[]).flatMap(k=>(k.variants||[]).filter(_=>_.quantity>0).map(_=>({..._,productName:k.name,createdAt:k.createdAt&&k.createdAt.toDate?k.createdAt.toDate():null}))).map(k=>{const _=I.get(k.sku),j=_||k.createdAt,T=j?Math.floor((new Date-j)/(1e3*60*60*24)):null;return{...k,lastSale:_,daysSinceLastActivity:T,referenceDate:j}}).filter(k=>k.referenceDate?k.referenceDate<R:!1).sort((k,_)=>k.referenceDate-_.referenceDate)},[t,e]),D=x.useMemo(()=>{const I=[];return(t||[]).filter(A=>A.paymentStatus==="a_receber"&&A.status!=="estornada").forEach(A=>I.push({id:`${A.id}-0`,saleId:A.id,installmentNumber:null,dueDate:A.dueDate?A.dueDate.toDate():A.date.toDate(),customerName:A.customerName||"N/A",amount:A.totalAmount})),(t||[]).filter(A=>A.paymentStatus==="parcelado"&&A.status!=="estornada"&&A.installmentsData).forEach(A=>A.installmentsData.forEach(R=>{R.status==="a_receber"&&I.push({id:`${A.id}-${R.number}`,saleId:A.id,installmentNumber:R.number,dueDate:R.dueDate.toDate(),customerName:A.customerName||"N/A",amount:R.amount,totalInstallments:A.installments})})),I.sort((A,R)=>A.dueDate-R.dueDate)},[t]),N=async(I,A)=>{if(!r||!a)return s("Firebase no configurado para marcar como pago.","error");const R=_e(r,ve(a,"sales"),I);if(A===null)await us(R,{paymentStatus:"recebido"}),s("Venda marcada como recebida!","success");else{const k=await cu(R);if(k.exists()){const _=k.data().installmentsData.map(T=>T.number===A?{...T,status:"recebido"}:T),j=_.every(T=>T.status==="recebido");await us(R,{installmentsData:_,...j&&{paymentStatus:"recebido"}}),s(`Parcela ${A} marcada como recebida!`,"success")}}},L=[{value:"month",label:"Este Ms"},{value:"30days",label:"ltimos 30 Dias"},{value:"year",label:"Este Ano"},{value:"all",label:"Todo o Perodo"},{value:"custom",label:"Personalizado"}],W=()=>{const I=["Data","Tipo","Descrio","Valor","Status"],A=(f||[]).map(q=>[q.date.toDate().toISOString(),"Venda",`Venda para ${q.customerName||"N/A"}`,q.totalAmount,q.paymentStatus]),R=(g||[]).map(q=>[q.date.toDate().toISOString(),"Despesa",q.description,-q.amount,q.status]),k=[...A,...R].sort((q,X)=>new Date(q[0])-new Date(X[0])),_=[I.join(","),...k.map(q=>q.join(","))].join(`
`),j=new Blob([`\uFEFF${_}`],{type:"text/csv;charset=utf-8;"}),T=document.createElement("a");T.href=URL.createObjectURL(j),T.setAttribute("download","relatorio_mia_move.csv"),document.body.appendChild(T),T.click(),document.body.removeChild(T),s("Exportao concluda!","success")},re=I=>{if(I===null||isNaN(I))return l.createElement("span",{className:"text-xs text-gray-400"},"s/ comp.");const A=I>=0,R=A?"text-green-500":"text-red-500";return l.createElement("span",{className:`text-sm font-bold ${R}`},A?"":""," ",Math.abs(I).toFixed(1),"%")};return l.createElement("div",{className:"space-y-8"},l.createElement("div",{className:"flex justify-between items-center"},l.createElement("h2",{className:"text-2xl font-bold"},"Relatrios e Anlises"),l.createElement("div",{className:"flex items-center gap-2"},l.createElement("select",{value:i,onChange:I=>o(I.target.value),className:id},L.map(I=>l.createElement("option",{key:I.value,value:I.value},I.label))),i==="custom"&&l.createElement(l.Fragment,null,l.createElement("input",{type:"date",value:u,onChange:I=>c(I.target.value),className:id}),l.createElement("input",{type:"date",value:d,onChange:I=>h(I.target.value),className:id})),l.createElement("button",{onClick:W,className:"px-4 py-3 bg-gray-200 rounded-lg"},"Exportar CSV"))),l.createElement("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4"},l.createElement("div",{className:`${qt} border-l-4 border-pink-500`},l.createElement("p",{className:"text-sm text-gray-500"},"Receita Total"),l.createElement("p",{className:"text-2xl font-bold text-pink-600 mt-1"},fe(p)),m.changes&&l.createElement("div",{className:"mt-1"},re(m.changes.revenue))),l.createElement("div",{className:`${qt} border-l-4 border-teal-500`},l.createElement("p",{className:"text-sm text-gray-500"},"Lucro Bruto (Vendas)"),l.createElement("p",{className:"text-2xl font-bold text-teal-600 mt-1"},fe(y))),l.createElement("div",{className:`${qt} border-l-4 border-red-500`},l.createElement("p",{className:"text-sm text-gray-500"},"Total Despesas (Pagas)"),l.createElement("p",{className:"text-2xl font-bold text-red-600 mt-1"},fe(C))),l.createElement("div",{className:`${qt} border-l-4 border-green-500 col-span-2 lg:col-span-1`},l.createElement("p",{className:"text-sm text-gray-500"},"Lucro Lquido"),l.createElement("p",{className:"text-3xl font-bold text-green-600 mt-1"},fe(M)),m.changes&&l.createElement("div",{className:"mt-1"},re(m.changes.netProfit)))),l.createElement("div",{className:"grid lg:grid-cols-2 gap-6"},l.createElement("div",{className:qt},l.createElement("h3",{className:"text-xl font-semibold mb-4"},"Fluxo de Caixa (Recebido vs. Pago)"),l.createElement(TD,{sales:f,expenses:g})),l.createElement("div",{className:qt},l.createElement("h3",{className:"text-xl font-semibold mb-4"},"Tendncia de Lucro no Perodo"),l.createElement(DD,{sales:f,expenses:g,dateRange:v}))),l.createElement("div",{className:"grid lg:grid-cols-2 gap-6"},l.createElement("div",{className:`${qt}`},l.createElement("h3",{className:"text-xl font-semibold mb-4"},"Desempenho por Dia da Semana")),l.createElement("div",{className:`${qt}`},l.createElement("h3",{className:"text-xl font-semibold mb-4"},"Distribuio de Pagamentos"))),l.createElement("div",{className:qt},l.createElement("h3",{className:"text-xl font-semibold mb-4"},"Contas a Receber (Geral) (",D.length,")"),l.createElement("div",{className:"overflow-x-auto max-h-80"},l.createElement("table",{className:"min-w-full"},l.createElement("thead",{className:"bg-gray-50"},l.createElement("tr",null,l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Vencimento"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Cliente / Parcela"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Valor"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Ao"))),l.createElement("tbody",{className:"bg-white divide-y"},D.map(I=>{const A=I.dueDate<Tn(new Date);return l.createElement("tr",{key:I.id,className:A?"bg-red-50":""},l.createElement("td",{className:"px-3 py-4"},I.dueDate.toLocaleDateString("pt-BR")),l.createElement("td",{className:"px-3 py-4"},I.customerName,I.installmentNumber&&l.createElement("span",{className:"block text-xs"},"Parcela ",I.installmentNumber,"/",I.totalInstallments)),l.createElement("td",{className:"px-3 py-4 font-bold text-yellow-600"},fe(I.amount)),l.createElement("td",{className:"px-3 py-4"},l.createElement("button",{onClick:()=>N(I.saleId,I.installmentNumber),className:"px-3 py-1 text-xs text-white rounded-full bg-green-500"},"Recebido")))}))))),l.createElement("div",{className:"grid lg:grid-cols-3 gap-6 mt-6"},l.createElement("div",{className:`${qt} lg:col-span-1`},l.createElement("h3",{className:"text-xl font-semibold mb-4"},"Curva ABC de Produtos"),l.createElement("div",{className:"space-y-4"},z.A.length>0?z.A.map(I=>l.createElement("div",{key:I.id,className:"flex justify-between"},l.createElement("span",null,I.name),l.createElement("span",{className:"font-semibold"},fe(I.revenue)))):l.createElement("p",null,"Nenhum dado"))),l.createElement("div",{className:"lg:col-span-2 space-y-6"},l.createElement("div",{className:qt},l.createElement("h3",{className:"text-xl font-semibold mb-4"},"Top 10 Variaes Mais Vendidas"),l.createElement("div",{className:"overflow-x-auto max-h-80"},l.createElement("table",{className:"min-w-full text-sm"},l.createElement("thead",{className:"bg-gray-50"},l.createElement("tr",null,l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Produto"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Qtd."),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Receita"))),l.createElement("tbody",null,O.map(I=>l.createElement("tr",{key:I.sku},l.createElement("td",{className:"py-2 px-2"},I.productName," (",I.size," - ",I.color,")"),l.createElement("td",{className:"py-2 px-2 font-bold"},I.quantity),l.createElement("td",{className:"py-2 px-2 font-semibold text-teal-600"},fe(I.revenue)))))))),l.createElement("div",{className:qt},l.createElement("h3",{className:"text-xl font-semibold mb-4"},"Estoque Encalhado (+120 dias)"),l.createElement("div",{className:"overflow-x-auto max-h-80"},l.createElement("table",{className:"min-w-full text-sm"},l.createElement("thead",{className:"bg-gray-50"},l.createElement("tr",null,l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Produto"),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Qtd."),l.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"ltima Atividade"))),l.createElement("tbody",null,Q.map(I=>l.createElement("tr",{key:I.sku},l.createElement("td",{className:"py-2 px-2"},I.productName," (",I.size," - ",I.color,")"),l.createElement("td",{className:"py-2 px-2 font-bold"},I.quantity),l.createElement("td",{className:"py-2 px-2 text-red-600"},I.daysSinceLastActivity," dias atrs"))))))))))},Ry="bg-pink-500 hover:bg-pink-600",Py="bg-red-500 hover:bg-red-600",RD="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",od="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",PD=({db:t,userId:e,products:n=null,defectiveItems:r=null,showToast:a=()=>{}})=>{const[s,i]=x.useState(!1),[o,u]=x.useState(""),[c,d]=x.useState(null),[h,f]=x.useState(""),[g,v]=x.useState(""),[b,E]=x.useState(null),[m,p]=x.useState(!1),y=!!t&&!!e,w=Array.isArray(n)?n:[],C=r&&Array.isArray(r)?r:[],M=x.useMemo(()=>(w||[]).flatMap(N=>(N.variants||[]).map(L=>({...L,productId:N.id,productName:N.name}))).filter(N=>N.quantity>0&&(N.productName.toLowerCase().includes(o.toLowerCase())||N.sku.toLowerCase().includes(o.toLowerCase()))),[w,o]),z=()=>{i(!0),d(null),f(""),v(""),u("")},O=async()=>{if(!c||!h.trim()){a("Selecione um produto e descreva o defeito.","error");return}if(!y){a("Firestore no configurado. Faa login com uma conta vlida.","error");return}if(y){try{const N=Qm(t),L=n.find(j=>j.id===c.productId);if(!L){a("Produto original no encontrado.","error");return}const W=_e(t,ve(e,"products"),c.productId),re=L.variants.findIndex(j=>j.sku===c.sku),I=L.variants[re].quantity,A=I-1;if(A<0){a("Estoque insuficiente para registrar o defeito.","error");return}const R=[...L.variants];R[re].quantity=A,N.update(W,{variants:R});const k={date:le.now(),productId:c.productId,productName:c.productName,variantSku:c.sku,type:"saida_defeito",quantityChange:1,reason:`Defeito: ${h.substring(0,30)}...`,oldQuantity:I,newQuantity:A};N.set(_e(wt(t,ve(e,"stockMovements"))),k);const _={...c,defectDescription:h,suggestedAction:g,registeredAt:le.now(),status:"pendente"};N.set(_e(wt(t,ve(e,"defectiveItems"))),_),await N.commit(),a("Item defeituoso registrado com sucesso!","success"),i(!1)}catch(N){console.error("Erro ao registrar item defeituoso:",N),a("Erro ao registrar item defeituoso.","error")}return}},Q=async()=>{if(b){if(p(!0),y){try{await cs(_e(t,ve(e,"defectiveItems"),b.id)),a("Item defeituoso resolvido e removido da lista.","success")}catch(N){console.error(N),a("Erro ao resolver o item.","error")}finally{E(null),p(!1)}return}a("Firestore no configurado. Faa login com uma conta vlida.","error"),E(null),p(!1)}},D=N=>{const L=`*Relatrio de Defeito - Mia Move*

*Produto:* ${N.productName}
*Variao:* ${N.size} - ${N.color}
*SKU:* ${N.sku}

*Defeito Descrito:*
${N.defectDescription}

*Ao Sugerida:*
${N.suggestedAction||"Nenhuma"}`,W=`https://wa.me/?text=${encodeURIComponent(L)}`;window.open(W,"_blank")};return l.createElement("div",{className:"space-y-6"},l.createElement("div",{className:"flex flex-col md:flex-row justify-between md:items-center"},l.createElement("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100"},"Controle de Defeitos"),l.createElement("button",{onClick:z,className:`px-4 py-3 text-white font-semibold rounded-lg ${Ry} shadow-md`},"+ Registrar Defeito")),l.createElement("div",{className:RD},l.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Itens com Defeito (",(C||[]).length,")"),l.createElement("div",{className:"space-y-4"},(C||[]).map(N=>l.createElement("div",{key:N.id,className:"p-4 border dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-700/50"},l.createElement("div",{className:"flex flex-col sm:flex-row justify-between sm:items-start"},l.createElement("div",null,l.createElement("p",{className:"font-bold text-lg dark:text-gray-100"},N.productName," (",N.size," - ",N.color,")"),l.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"SKU: ",N.sku," | Registrado em: ",N.registeredAt?new Date(N.registeredAt).toLocaleDateString("pt-BR"):"N/A")),l.createElement("div",{className:"flex items-center space-x-2 mt-3 sm:mt-0"},l.createElement("button",{onClick:()=>D(N),className:"px-3 py-1 text-sm text-white font-semibold rounded-full bg-green-500 hover:bg-green-600 flex items-center space-x-1"},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},l.createElement("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.428A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})),l.createElement("span",null,"WhatsApp")),l.createElement("button",{onClick:()=>E(N),className:`px-3 py-1 text-sm text-white font-semibold rounded-full ${Py}`},"Resolver"))),l.createElement("div",{className:"mt-3 pt-3 border-t dark:border-gray-600 text-sm space-y-2"},l.createElement("p",null,l.createElement("strong",null,"Defeito:")," ",N.defectDescription),l.createElement("p",null,l.createElement("strong",null,"Ao Sugerida:")," ",N.suggestedAction||"N/A")))))),l.createElement(Mt,{isOpen:s,onClose:()=>i(!1),title:"Registrar Item com Defeito",size:"max-w-2xl",actions:l.createElement(l.Fragment,null,l.createElement("button",{onClick:()=>i(!1),className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 rounded-full"},"Cancelar"),l.createElement("button",{onClick:O,className:`px-4 py-2 text-white rounded-full ${Ry}`},"Registrar e Dar Baixa"))},l.createElement("div",{className:"space-y-4"},l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"1. Encontre o Produto em Estoque"),l.createElement("input",{type:"text",placeholder:"Buscar por nome ou SKU...",value:o,onChange:N=>u(N.target.value),className:od}),l.createElement("div",{className:"max-h-40 overflow-y-auto mt-2 space-y-1 pr-2"},o&&M.map(N=>l.createElement("button",{key:N.sku,onClick:()=>{d(N),u("")},className:"w-full text-left p-2 rounded-lg hover:bg-pink-100 dark:hover:bg-pink-900/40"},N.productName," (",N.size," - ",N.color,") - Estoque: ",N.quantity)))),c&&l.createElement("div",{className:"p-3 bg-teal-50 dark:bg-teal-900/40 rounded-lg"},l.createElement("p",{className:"font-semibold text-teal-800 dark:text-teal-200"},"Selecionado: ",c.productName," (",c.size," - ",c.color,")")),l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"2. Descreva o Defeito"),l.createElement("textarea",{value:h,onChange:N=>f(N.target.value),rows:"3",className:od,placeholder:"Ex: Costura solta na manga direita."})),l.createElement("div",null,l.createElement("label",{className:"block text-sm font-medium"},"3. Ao Sugerida (Opcional)"),l.createElement("input",{type:"text",value:g,onChange:N=>v(N.target.value),className:od,placeholder:"Ex: Trocar com fornecedor."})))),l.createElement(Mt,{isOpen:!!b,onClose:()=>E(null),title:"Confirmar Resoluo",size:"max-w-md",actions:l.createElement(l.Fragment,null,l.createElement("button",{onClick:()=>E(null),className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 rounded-full"},"Cancelar"),l.createElement("button",{onClick:Q,disabled:m,className:`px-4 py-2 text-white rounded-full ${Py} disabled:opacity-50`},m?"Resolvendo...":"Confirmar e Remover"))},l.createElement("p",null,"Tem certeza que deseja marcar o item ",l.createElement("strong",null,b==null?void 0:b.productName," (",b==null?void 0:b.size," - ",b==null?void 0:b.color,")")," como resolvido?"),l.createElement("p",{className:"text-sm text-gray-500 mt-2"},"Esta ao ir remover o item permanentemente da lista de defeitos.")))},OD=({db:t,userId:e,showToast:n=()=>{}})=>{const[r,a]=x.useState(""),[s,i]=x.useState(null),[o,u]=x.useState(!1),c=async()=>{if(!r.trim())return n("Digite sua pergunta.","error");u(!0),i(null);try{const d=await fetch((typeof import.meta<"u","http://localhost:4321/api/ai"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:r})}),h=await d.json();d.ok?(i({text:h.text}),n("Resposta recebida (via proxy).","success")):(console.error("AI error",h),n(h.error||"Erro do modelo","error"),i({text:h.detail||JSON.stringify(h)}))}catch(d){console.error("Fetch error",d),n("Falha ao contactar o servidor de IA.","error"),i({text:"Erro ao buscar resposta. Verifique se o servidor proxy est rodando e se a varivel HF_API_KEY foi configurada."})}finally{u(!1)}};return l.createElement("div",{className:"space-y-6"},l.createElement("h2",{className:"text-2xl font-bold"},"Consultor - IA"),l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow"},l.createElement("textarea",{value:r,onChange:d=>a(d.target.value),rows:4,className:"w-full p-3 border rounded",placeholder:"Descreva seu problema ou pea uma sugesto..."}),l.createElement("div",{className:"flex items-center space-x-2 mt-3"},l.createElement("button",{onClick:c,className:"px-4 py-2 bg-pink-500 text-white rounded"},"Perguntar"),o&&l.createElement("span",null,"Carregando...")),s&&l.createElement("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded"},l.createElement("strong",null,"Resposta:"),l.createElement("p",{className:"mt-2"},s.text))))},LD=({sales:t})=>{const e=x.useMemo(()=>{const r=[],a=["Dom","Seg","Ter","Qua","Qui","Sex","Sb"];for(let s=6;s>=0;s--){const i=new Date;i.setDate(i.getDate()-s);const o=Tn(i);r.push({day:a[i.getDay()],revenue:0,date:o})}return(t||[]).filter(s=>s.status!=="estornada").forEach(s=>{const i=Tn(s.date.toDate()),o=r.find(u=>u.date.getTime()===i.getTime());o&&(o.revenue+=s.totalAmount)}),r},[t]),n=Math.max(...e.map(r=>r.revenue),0);return l.createElement("div",{className:"flex justify-around items-end h-[200px] p-2 bg-gray-50 dark:bg-gray-700/50 rounded-xl border border-gray-200 dark:border-gray-700"},e.map((r,a)=>l.createElement("div",{key:a,className:"flex flex-col items-center flex-shrink-0 w-12 text-center"},l.createElement("div",{className:"text-xs font-semibold text-pink-600 dark:text-pink-400 mb-1"},fe(r.revenue)),l.createElement("div",{style:{height:`${n>0?r.revenue/n*120:0}px`,minHeight:"2px"},className:"w-8 bg-pink-400 rounded-t-md transition-all duration-500 shadow-md"}),l.createElement("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mt-1"},r.day))))},MD=({sales:t,expenses:e,monthlyGoal:n,showTitle:r=!1})=>{const{currentValue:a,progressPercentage:s,goalType:i,goalAmount:o}=x.useMemo(()=>{if(!n)return{currentValue:0,progressPercentage:0};const u=new Date,c=new Date(u.getFullYear(),u.getMonth(),1),d=(t||[]).filter(v=>v.date.toDate()>=c&&v.status!=="estornada"),h=(e||[]).filter(v=>v.date.toDate()>=c&&v.status==="pago");let f=0;if(n.type==="revenue")f=d.reduce((v,b)=>v+b.totalAmount,0);else{const v=d.reduce((E,m)=>E+(m.profit||0),0),b=h.reduce((E,m)=>E+m.amount,0);f=v-b}const g=n.amount>0?f/n.amount*100:0;return{currentValue:f,progressPercentage:Math.min(g,100),goalType:n.type==="revenue"?"Faturamento":"Lucro Lquido",goalAmount:n.amount}},[t,e,n]);return n?l.createElement("div",null,r&&l.createElement("h3",{className:"text-xl font-semibold mb-2 text-gray-700 dark:text-gray-200"}," Meta do Ms (",i,")"),l.createElement("div",{className:"flex justify-between items-end mb-1"},l.createElement("span",{className:"text-lg font-bold text-purple-600 dark:text-purple-400"},fe(a)),l.createElement("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400"},"de ",fe(o))),l.createElement("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 shadow-inner"},l.createElement("div",{className:"bg-purple-500 h-4 rounded-full transition-all duration-500",style:{width:`${s}%`}})),l.createElement("p",{className:"text-right text-sm text-gray-600 dark:text-gray-300 mt-1"},s.toFixed(1),"% alcanado")):l.createElement("div",null,r&&l.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"}," Meta do Ms"),l.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"Nenhuma meta definida para este ms. V para a aba 'Metas' para criar uma."))},FD="bg-pink-500 hover:bg-pink-600",UD="bg-teal-500 hover:bg-teal-600",Oy="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",VD=({sales:t=[],expenses:e=[],products:n=[],monthlyGoal:r=null,setActiveTab:a=()=>{}})=>{const s=new Date;s.setHours(0,0,0,0);const{todayRevenue:i,todayNetProfit:o}=x.useMemo(()=>{const h=t.filter(m=>m.date.toDate()>=s&&m.status!=="estornada"),f=e.filter(m=>m.date.toDate()>=s&&m.status==="pago"),g=h.reduce((m,p)=>m+p.totalAmount,0),v=h.reduce((m,p)=>m+(p.profit||0),0),b=f.reduce((m,p)=>m+p.amount,0),E=v-b;return{todayRevenue:g,todayNetProfit:E}},[t,e]),u=x.useMemo(()=>n.flatMap(h=>(h.variants||[]).map(f=>({...f,productName:h.name}))),[n]),c=x.useMemo(()=>{const h=new Date;h.setDate(h.getDate()-7);const f=new Date(h);f.setHours(0,0,0,0);const g=t.filter(E=>E.date.toDate()>=f&&E.status!=="estornada"),v={};g.forEach(E=>E.items.forEach(m=>{v[m.sku]=(v[m.sku]||0)+m.quantity}));const b=new Map(u.map(E=>[E.sku,E]));return Object.entries(v).map(([E,m])=>({...b.get(E),quantitySold:m})).filter(E=>E&&E.productName).sort((E,m)=>m.quantitySold-E.quantitySold).slice(0,3)},[t,u]),d=x.useMemo(()=>u.filter(h=>h.quantity<5),[u]);return l.createElement("div",{className:"space-y-8"},l.createElement("div",null,l.createElement("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100"},"Painel de Controle"),l.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"Resumo do seu negcio hoje, ",new Date().toLocaleDateString("pt-BR",{weekday:"long",day:"numeric",month:"long"}),".")),l.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},l.createElement("div",{className:`${Oy} border-l-4 border-pink-500 col-span-1 md:col-span-2`},l.createElement("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Viso Geral do Dia"),l.createElement("div",{className:"mt-2 grid grid-cols-2 gap-4"},l.createElement("div",null,l.createElement("p",{className:"text-3xl font-bold text-pink-600"},fe(i)),l.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-300"},"Vendas Hoje")),l.createElement("div",null,l.createElement("p",{className:`text-3xl font-bold ${o>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`},fe(o)),l.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-300"},"Lucro Lquido Hoje")))),l.createElement("div",{className:`${Oy} border-l-4 border-purple-500 col-span-1 md:col-span-2`},l.createElement(MD,{sales:t,expenses:e,monthlyGoal:r,showTitle:!0}))),l.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6"},l.createElement("div",{className:"lg:col-span-2 space-y-6"},l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700"},l.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"}," Desempenho da Semana"),l.createElement(LD,{sales:t})),l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700"},l.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"}," Produtos Quentes (ltimos 7 dias)"),c.length>0?l.createElement("ul",{className:"space-y-3"},c.map(h=>l.createElement("li",{key:h.sku,className:"flex justify-between items-center p-2 bg-gray-50 dark:bg-gray-700/50 rounded-xl border-l-4 border-pink-300 dark:border-pink-500"},l.createElement("span",{className:"font-medium text-gray-800 dark:text-gray-200"},h.productName," (",h.size," - ",h.color,")"),l.createElement("span",{className:"font-bold text-pink-600 dark:text-pink-400"},h.quantitySold," uni.")))):l.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"Nenhuma venda nos ltimos 7 dias."))),l.createElement("div",{className:"space-y-6"},l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700"},l.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"}," Avisos Importantes"),l.createElement("div",{className:"space-y-3"},d.length>0&&l.createElement("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/40 rounded-lg flex justify-between items-center"},l.createElement("p",{className:"text-orange-700 dark:text-orange-300 text-sm"},d.length," variae(s) com estoque baixo."),l.createElement("button",{onClick:()=>a("Estoque"),className:"text-sm font-semibold text-orange-800 dark:text-orange-200 hover:underline"},"Ver")),d.length===0&&l.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"Tudo em ordem por aqui!"))),l.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700"},l.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"}," Acesso Rpido"),l.createElement("div",{className:"space-y-3"},l.createElement("button",{onClick:()=>a("Vendas"),className:`w-full text-center p-4 rounded-lg text-white font-bold ${FD}`},"+ Nova Venda"),l.createElement("button",{onClick:()=>a("Clientes"),className:"w-full text-center p-4 rounded-lg text-white font-bold bg-purple-500 hover:bg-purple-600"},"+ Nova Cliente"),l.createElement("button",{onClick:()=>a("Despesas"),className:`w-full text-center p-4 rounded-lg text-white font-bold ${UD}`},"+ Nova Despesa"))))))},zD=()=>{const t=()=>{try{const R=localStorage.getItem("mia-move-theme");if(R==="light"||R==="dark")return R;if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)return"dark"}catch{}return"light"},[e,n]=x.useState(t),[r,a]=x.useState(!1),[s,i]=x.useState(null),[o,u]=x.useState(!1),[c,d]=x.useState(null),[h,f]=x.useState("Incio");x.useLayoutEffect(()=>{const R=window.document.documentElement;e==="dark"?R.classList.add("dark"):R.classList.remove("dark");try{localStorage.setItem("mia-move-theme",e)}catch{}},[e]);const g=x.useCallback((R,k="info")=>{d({message:R,type:k}),setTimeout(()=>d(null),3e3)},[]),v=R=>{try{localStorage.setItem("mia-user",JSON.stringify(R))}catch{}a(!0),i(R),g("Bem-vindo "+(R.email||""),"success")},b=()=>{try{localStorage.removeItem("mia-user")}catch{}a(!1),i(null),g("Sesso encerrada","info");try{Ln&&dl(Ln)}catch{}},E=l.useRef(!1);l.useEffect(()=>{try{const k=window.location.hash&&decodeURIComponent(window.location.hash.slice(1)),_=window.history.state&&window.history.state.tab;k?f(k):_?f(_):window.history.replaceState({tab:h},"")}catch{}const R=k=>{try{const _=k.state&&k.state.tab||(window.location.hash?decodeURIComponent(window.location.hash.slice(1)):"Incio");E.current=!0,f(_)}catch{}};return window.addEventListener("popstate",R),()=>window.removeEventListener("popstate",R)},[]),l.useEffect(()=>{try{E.current?E.current=!1:window.history.pushState({tab:h},"",`#${encodeURIComponent(h)}`)}catch{}},[h]);const m=!!Bi&&!!Bt,p=s?s.uid:null;if(!m)return l.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900"},l.createElement("div",{className:"max-w-xl p-8 bg-white dark:bg-gray-800 rounded-lg shadow"},l.createElement("h2",{className:"text-2xl font-bold mb-2"},"Firebase no configurado"),l.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-300"},"Esta verso da aplicao requer conexo com Firestore. Por favor verifique o `firebaseConfig` e assegure que o Firestore esteja habilitado no projeto.")));x.useEffect(()=>{if(!m||!Ln)return;const R=K1(Ln,async k=>{k?(a(!0),i({uid:k.uid,email:k.email,displayName:k.displayName})):(a(!1),i(null))});return()=>R()},[m]);const[y,w]=x.useState([]),[C,M]=x.useState([]),[z,O]=x.useState([]),[Q,D]=x.useState([]),[N,L]=x.useState([]),[W,re]=x.useState([]),[I,A]=x.useState([]);return x.useEffect(()=>{if(!m||!s)return;const R=s.uid,k=[],_=(j,T,q=!0)=>{try{const X=wt(Bt,ve(R,j)),Se=q?Rh(X,eD("createdAt","desc")):Rh(X),He=rD(Se,Oe=>{const ln=Oe.docs.map(ha=>({id:ha.id,...ha.data()}));T(ln)},Oe=>{console.error("Firestore listen error",j,Oe),g("Erro ao escutar "+j,"error")});k.push(He)}catch(X){console.error("listen setup error",X)}};return _("products",w),_("sales",M),_("defectiveItems",O),_("expenses",D),_("customers",L),_("categories",re),_("goals",A,!1),()=>k.forEach(j=>j())},[m,s]),r?l.createElement("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 font-sans text-gray-800 dark:text-gray-200"},l.createElement("header",{className:"bg-white dark:bg-gray-800 shadow-md"},l.createElement("div",{className:"p-4 flex justify-between items-center"},l.createElement("div",{className:"flex items-center space-x-4"},l.createElement("h1",{onClick:()=>f("Incio"),className:"text-3xl cursor-pointer font-extrabold text-pink-600 tracking-wider"},"Mia Move ",l.createElement("span",{className:"text-teal-500 text-sm font-medium"},"Gesto"))),l.createElement("div",{className:"flex items-center space-x-3 sm:space-x-4"},l.createElement("button",{onClick:()=>u(!0),title:"Sincronizar",className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-pink-600 dark:text-pink-300 hover:bg-gray-300 dark:hover:bg-gray-600"},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V8a4 4 0 014-4h6m1 12v2a2 2 0 01-2 2H9a2 2 0 01-2-2v-2m8-8l3 3m0 0l-3 3m3-3H3"}))),l.createElement("button",{onClick:()=>n(R=>R==="light"?"dark":"light"),title:"Alternar tema",className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"},e==="dark"?l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},l.createElement("path",{d:"M17.293 13.293A8 8 0 116.707 2.707 8 8 0 0017.293 13.293z"})):l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},l.createElement("path",{d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4.22 2.03a1 1 0 011.4 1.42l-.7.7a1 1 0 11-1.4-1.42l.7-.7zM18 9a1 1 0 110 2h-1a1 1 0 110-2h1zM5.46 4.05a1 1 0 011.4 1.42l-.7.7A1 1 0 114.76 5.77l.7-.72zM4 9a1 1 0 100 2H3a1 1 0 100-2h1zM10 16a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM3.05 14.54a1 1 0 011.42 1.4l-.7.7a1 1 0 11-1.42-1.4l.7-.7zM16.95 14.54a1 1 0 011.42 1.4l-.7.7a1 1 0 11-1.42-1.4l.7-.7z"}))),l.createElement("div",{className:"w-9 h-9 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center"},l.createElement("span",{className:"font-semibold text-sm text-gray-700 dark:text-gray-200"},"PR")),l.createElement("button",{onClick:b,title:"Sair",className:"ml-2 px-3 py-1 text-sm rounded bg-gray-100 dark:bg-gray-700"},"Sair")))),l.createElement("main",{className:"p-4 sm:p-6 lg:p-8"},l.createElement("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6 sticky top-0 bg-gray-50 dark:bg-gray-900 z-20"},l.createElement("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto"},["Incio","Estoque","Vendas","Clientes","Despesas","Metas","Relatrios","Defeitos","Consultor - IA"].map(R=>l.createElement("button",{key:R,onClick:()=>f(R),className:`flex-shrink-0 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-base sm:text-lg transition ${h===R?"border-pink-500 text-pink-600 dark:border-pink-400 dark:text-pink-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:border-gray-600"}`},R)))),h==="Incio"?l.createElement(VD,{sales:C,expenses:Q,products:y,monthlyGoal:null,setActiveTab:f}):h==="Estoque"?l.createElement(yD,{db:Bt,userId:p,products:y,showToast:g,categories:W}):h==="Vendas"?l.createElement(bD,{db:Bt,userId:p,products:y,sales:C,customers:N,showToast:g}):h==="Clientes"?l.createElement(wD,{db:Bt,userId:p,customers:N,sales:C,showToast:g}):h==="Despesas"?l.createElement(SD,{db:Bt,userId:p,showToast:g}):h==="Metas"?l.createElement(_D,{db:Bt,userId:p,sales:C,expenses:Q,allGoals:I,showToast:g}):h==="Relatrios"?l.createElement(AD,{db:Bt,userId:p,sales:C,products:y,expenses:Q,showToast:g}):h==="Defeitos"?l.createElement(PD,{db:Bt,userId:p,products:y,defectiveItems:z,showToast:g}):h==="Consultor - IA"?l.createElement(OD,{db:Bt,userId:p,showToast:g}):l.createElement("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow"},"Pgina: ",h," (ainda em desenvolvimento)")),o&&l.createElement(oD,{isOpen:o,onClose:()=>u(!1),showToast:g,onSync:R=>{g("Sincronizado com "+R,"success")},onUnsync:()=>{g("Sincronizao desfeita","info")},currentUid:p,isSynced:!1}),c&&l.createElement(lD,{message:c.message,type:c.type,onClose:()=>d(null)})):l.createElement(uD,{onLogin:v})},jD=K0(document.getElementById("root"));jD.render(l.createElement(l.StrictMode,null,l.createElement(zD,null)));
