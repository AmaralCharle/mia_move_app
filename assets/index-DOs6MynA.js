(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function dx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var By={exports:{}},fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ja=Symbol.for("react.element"),hx=Symbol.for("react.portal"),fx=Symbol.for("react.fragment"),mx=Symbol.for("react.strict_mode"),px=Symbol.for("react.profiler"),gx=Symbol.for("react.provider"),yx=Symbol.for("react.context"),vx=Symbol.for("react.forward_ref"),Ex=Symbol.for("react.suspense"),wx=Symbol.for("react.memo"),kx=Symbol.for("react.lazy"),np=Symbol.iterator;function xx(t){return t===null||typeof t!="object"?null:(t=np&&t[np]||t["@@iterator"],typeof t=="function"?t:null)}var qy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Hy=Object.assign,Wy={};function Ei(t,e,n){this.props=t,this.context=e,this.refs=Wy,this.updater=n||qy}Ei.prototype.isReactComponent={};Ei.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ei.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ky(){}Ky.prototype=Ei.prototype;function jh(t,e,n){this.props=t,this.context=e,this.refs=Wy,this.updater=n||qy}var Bh=jh.prototype=new Ky;Bh.constructor=jh;Hy(Bh,Ei.prototype);Bh.isPureReactComponent=!0;var rp=Array.isArray,Gy=Object.prototype.hasOwnProperty,qh={current:null},Qy={key:!0,ref:!0,__self:!0,__source:!0};function Yy(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)Gy.call(e,r)&&!Qy.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Ja,type:t,key:i,ref:a,props:s,_owner:qh.current}}function Sx(t,e){return{$$typeof:Ja,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Hh(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ja}function Nx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var sp=/\/+/g;function yc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Nx(""+t.key):e.toString(36)}function rl(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Ja:case hx:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+yc(a,0):r,rp(s)?(n="",t!=null&&(n=t.replace(sp,"$&/")+"/"),rl(s,e,n,"",function(c){return c})):s!=null&&(Hh(s)&&(s=Sx(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(sp,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",rp(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+yc(i,l);a+=rl(i,e,n,u,s)}else if(u=xx(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+yc(i,l++),a+=rl(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Do(t,e,n){if(t==null)return t;var r=[],s=0;return rl(t,r,"","",function(i){return e.call(n,i,s++)}),r}function _x(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var bt={current:null},sl={transition:null},Cx={ReactCurrentDispatcher:bt,ReactCurrentBatchConfig:sl,ReactCurrentOwner:qh};function Xy(){throw Error("act(...) is not supported in production builds of React.")}fe.Children={map:Do,forEach:function(t,e,n){Do(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Do(t,function(){e++}),e},toArray:function(t){return Do(t,function(e){return e})||[]},only:function(t){if(!Hh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};fe.Component=Ei;fe.Fragment=fx;fe.Profiler=px;fe.PureComponent=jh;fe.StrictMode=mx;fe.Suspense=Ex;fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cx;fe.act=Xy;fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Hy({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=qh.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Gy.call(e,u)&&!Qy.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:Ja,type:t.type,key:s,ref:i,props:r,_owner:a}};fe.createContext=function(t){return t={$$typeof:yx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:gx,_context:t},t.Consumer=t};fe.createElement=Yy;fe.createFactory=function(t){var e=Yy.bind(null,t);return e.type=t,e};fe.createRef=function(){return{current:null}};fe.forwardRef=function(t){return{$$typeof:vx,render:t}};fe.isValidElement=Hh;fe.lazy=function(t){return{$$typeof:kx,_payload:{_status:-1,_result:t},_init:_x}};fe.memo=function(t,e){return{$$typeof:wx,type:t,compare:e===void 0?null:e}};fe.startTransition=function(t){var e=sl.transition;sl.transition={};try{t()}finally{sl.transition=e}};fe.unstable_act=Xy;fe.useCallback=function(t,e){return bt.current.useCallback(t,e)};fe.useContext=function(t){return bt.current.useContext(t)};fe.useDebugValue=function(){};fe.useDeferredValue=function(t){return bt.current.useDeferredValue(t)};fe.useEffect=function(t,e){return bt.current.useEffect(t,e)};fe.useId=function(){return bt.current.useId()};fe.useImperativeHandle=function(t,e,n){return bt.current.useImperativeHandle(t,e,n)};fe.useInsertionEffect=function(t,e){return bt.current.useInsertionEffect(t,e)};fe.useLayoutEffect=function(t,e){return bt.current.useLayoutEffect(t,e)};fe.useMemo=function(t,e){return bt.current.useMemo(t,e)};fe.useReducer=function(t,e,n){return bt.current.useReducer(t,e,n)};fe.useRef=function(t){return bt.current.useRef(t)};fe.useState=function(t){return bt.current.useState(t)};fe.useSyncExternalStore=function(t,e,n){return bt.current.useSyncExternalStore(t,e,n)};fe.useTransition=function(){return bt.current.useTransition()};fe.version="18.3.1";By.exports=fe;var S=By.exports;const o=dx(S);var Jy={exports:{}},Ht={},Zy={exports:{}},e0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(b,V){var K=b.length;b.push(V);e:for(;0<K;){var de=K-1>>>1,he=b[de];if(0<s(he,V))b[de]=V,b[K]=he,K=de;else break e}}function n(b){return b.length===0?null:b[0]}function r(b){if(b.length===0)return null;var V=b[0],K=b.pop();if(K!==V){b[0]=K;e:for(var de=0,he=b.length,G=he>>>1;de<G;){var N=2*(de+1)-1,D=b[N],O=N+1,H=b[O];if(0>s(D,K))O<he&&0>s(H,D)?(b[de]=H,b[O]=K,de=O):(b[de]=D,b[N]=K,de=N);else if(O<he&&0>s(H,K))b[de]=H,b[O]=K,de=O;else break e}}return V}function s(b,V){var K=b.sortIndex-V.sortIndex;return K!==0?K:b.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],c=[],d=1,h=null,m=3,y=!1,E=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,f=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(b){for(var V=n(c);V!==null;){if(V.callback===null)r(c);else if(V.startTime<=b)r(c),V.sortIndex=V.expirationTime,e(u,V);else break;V=n(c)}}function k(b){if(v=!1,g(b),!E)if(n(u)!==null)E=!0,ce(_);else{var V=n(c);V!==null&&W(k,V.startTime-b)}}function _(b,V){E=!1,v&&(v=!1,f(M),M=-1),y=!0;var K=m;try{for(g(V),h=n(u);h!==null&&(!(h.expirationTime>V)||b&&!T());){var de=h.callback;if(typeof de=="function"){h.callback=null,m=h.priorityLevel;var he=de(h.expirationTime<=V);V=t.unstable_now(),typeof he=="function"?h.callback=he:h===n(u)&&r(u),g(V)}else r(u);h=n(u)}if(h!==null)var G=!0;else{var N=n(c);N!==null&&W(k,N.startTime-V),G=!1}return G}finally{h=null,m=K,y=!1}}var C=!1,P=null,M=-1,X=5,A=-1;function T(){return!(t.unstable_now()-A<X)}function B(){if(P!==null){var b=t.unstable_now();A=b;var V=!0;try{V=P(!0,b)}finally{V?ue():(C=!1,P=null)}}else C=!1}var ue;if(typeof p=="function")ue=function(){p(B)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,le=F.port2;F.port1.onmessage=B,ue=function(){le.postMessage(null)}}else ue=function(){w(B,0)};function ce(b){P=b,C||(C=!0,ue())}function W(b,V){M=w(function(){b(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(b){b.callback=null},t.unstable_continueExecution=function(){E||y||(E=!0,ce(_))},t.unstable_forceFrameRate=function(b){0>b||125<b?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<b?Math.floor(1e3/b):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(b){switch(m){case 1:case 2:case 3:var V=3;break;default:V=m}var K=m;m=V;try{return b()}finally{m=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(b,V){switch(b){case 1:case 2:case 3:case 4:case 5:break;default:b=3}var K=m;m=b;try{return V()}finally{m=K}},t.unstable_scheduleCallback=function(b,V,K){var de=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?de+K:de):K=de,b){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=K+he,b={id:d++,callback:V,priorityLevel:b,startTime:K,expirationTime:he,sortIndex:-1},K>de?(b.sortIndex=K,e(c,b),n(u)===null&&b===n(c)&&(v?(f(M),M=-1):v=!0,W(k,K-de))):(b.sortIndex=he,e(u,b),E||y||(E=!0,ce(_))),b},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(b){var V=m;return function(){var K=m;m=V;try{return b.apply(this,arguments)}finally{m=K}}}})(e0);Zy.exports=e0;var Ix=Zy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tx=S,Bt=Ix;function $(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t0=new Set,pa={};function gs(t,e){ni(t,e),ni(t+"Capture",e)}function ni(t,e){for(pa[t]=e,t=0;t<e.length;t++)t0.add(e[t])}var zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pd=Object.prototype.hasOwnProperty,bx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ip={},ap={};function Dx(t){return pd.call(ap,t)?!0:pd.call(ip,t)?!1:bx.test(t)?ap[t]=!0:(ip[t]=!0,!1)}function Ax(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Rx(t,e,n,r){if(e===null||typeof e>"u"||Ax(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Dt(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var lt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){lt[t]=new Dt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];lt[e]=new Dt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){lt[t]=new Dt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){lt[t]=new Dt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){lt[t]=new Dt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){lt[t]=new Dt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){lt[t]=new Dt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){lt[t]=new Dt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){lt[t]=new Dt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Wh=/[\-:]([a-z])/g;function Kh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Wh,Kh);lt[e]=new Dt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Wh,Kh);lt[e]=new Dt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Wh,Kh);lt[e]=new Dt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){lt[t]=new Dt(t,1,!1,t.toLowerCase(),null,!1,!1)});lt.xlinkHref=new Dt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){lt[t]=new Dt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Gh(t,e,n,r){var s=lt.hasOwnProperty(e)?lt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Rx(e,n,s,r)&&(n=null),r||s===null?Dx(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Yn=Tx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ao=Symbol.for("react.element"),bs=Symbol.for("react.portal"),Ds=Symbol.for("react.fragment"),Qh=Symbol.for("react.strict_mode"),gd=Symbol.for("react.profiler"),n0=Symbol.for("react.provider"),r0=Symbol.for("react.context"),Yh=Symbol.for("react.forward_ref"),yd=Symbol.for("react.suspense"),vd=Symbol.for("react.suspense_list"),Xh=Symbol.for("react.memo"),rr=Symbol.for("react.lazy"),s0=Symbol.for("react.offscreen"),op=Symbol.iterator;function Mi(t){return t===null||typeof t!="object"?null:(t=op&&t[op]||t["@@iterator"],typeof t=="function"?t:null)}var Le=Object.assign,vc;function qi(t){if(vc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);vc=e&&e[1]||""}return`
`+vc+t}var Ec=!1;function wc(t,e){if(!t||Ec)return"";Ec=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=l);break}}}finally{Ec=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?qi(t):""}function Px(t){switch(t.tag){case 5:return qi(t.type);case 16:return qi("Lazy");case 13:return qi("Suspense");case 19:return qi("SuspenseList");case 0:case 2:case 15:return t=wc(t.type,!1),t;case 11:return t=wc(t.type.render,!1),t;case 1:return t=wc(t.type,!0),t;default:return""}}function Ed(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ds:return"Fragment";case bs:return"Portal";case gd:return"Profiler";case Qh:return"StrictMode";case yd:return"Suspense";case vd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case r0:return(t.displayName||"Context")+".Consumer";case n0:return(t._context.displayName||"Context")+".Provider";case Yh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Xh:return e=t.displayName||null,e!==null?e:Ed(t.type)||"Memo";case rr:e=t._payload,t=t._init;try{return Ed(t(e))}catch{}}return null}function Mx(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ed(e);case 8:return e===Qh?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ir(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function i0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ox(t){var e=i0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ro(t){t._valueTracker||(t._valueTracker=Ox(t))}function a0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=i0(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Nl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function wd(t,e){var n=e.checked;return Le({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function lp(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ir(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function o0(t,e){e=e.checked,e!=null&&Gh(t,"checked",e,!1)}function kd(t,e){o0(t,e);var n=Ir(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?xd(t,e.type,n):e.hasOwnProperty("defaultValue")&&xd(t,e.type,Ir(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function up(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function xd(t,e,n){(e!=="number"||Nl(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Hi=Array.isArray;function Bs(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ir(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Sd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return Le({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function cp(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error($(92));if(Hi(n)){if(1<n.length)throw Error($(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ir(n)}}function l0(t,e){var n=Ir(e.value),r=Ir(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function dp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function u0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?u0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Po,c0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Po=Po||document.createElement("div"),Po.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Po.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ga(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ta={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$x=["Webkit","ms","Moz","O"];Object.keys(ta).forEach(function(t){$x.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ta[e]=ta[t]})});function d0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ta.hasOwnProperty(t)&&ta[t]?(""+e).trim():e+"px"}function h0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=d0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var Lx=Le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _d(t,e){if(e){if(Lx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function Cd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Id=null;function Jh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Td=null,qs=null,Hs=null;function hp(t){if(t=to(t)){if(typeof Td!="function")throw Error($(280));var e=t.stateNode;e&&(e=ku(e),Td(t.stateNode,t.type,e))}}function f0(t){qs?Hs?Hs.push(t):Hs=[t]:qs=t}function m0(){if(qs){var t=qs,e=Hs;if(Hs=qs=null,hp(t),e)for(t=0;t<e.length;t++)hp(e[t])}}function p0(t,e){return t(e)}function g0(){}var kc=!1;function y0(t,e,n){if(kc)return t(e,n);kc=!0;try{return p0(t,e,n)}finally{kc=!1,(qs!==null||Hs!==null)&&(g0(),m0())}}function ya(t,e){var n=t.stateNode;if(n===null)return null;var r=ku(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error($(231,e,typeof n));return n}var bd=!1;if(zn)try{var Oi={};Object.defineProperty(Oi,"passive",{get:function(){bd=!0}}),window.addEventListener("test",Oi,Oi),window.removeEventListener("test",Oi,Oi)}catch{bd=!1}function Fx(t,e,n,r,s,i,a,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var na=!1,_l=null,Cl=!1,Dd=null,Ux={onError:function(t){na=!0,_l=t}};function Vx(t,e,n,r,s,i,a,l,u){na=!1,_l=null,Fx.apply(Ux,arguments)}function zx(t,e,n,r,s,i,a,l,u){if(Vx.apply(this,arguments),na){if(na){var c=_l;na=!1,_l=null}else throw Error($(198));Cl||(Cl=!0,Dd=c)}}function ys(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function v0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function fp(t){if(ys(t)!==t)throw Error($(188))}function jx(t){var e=t.alternate;if(!e){if(e=ys(t),e===null)throw Error($(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return fp(s),t;if(i===r)return fp(s),e;i=i.sibling}throw Error($(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?t:e}function E0(t){return t=jx(t),t!==null?w0(t):null}function w0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=w0(t);if(e!==null)return e;t=t.sibling}return null}var k0=Bt.unstable_scheduleCallback,mp=Bt.unstable_cancelCallback,Bx=Bt.unstable_shouldYield,qx=Bt.unstable_requestPaint,Be=Bt.unstable_now,Hx=Bt.unstable_getCurrentPriorityLevel,Zh=Bt.unstable_ImmediatePriority,x0=Bt.unstable_UserBlockingPriority,Il=Bt.unstable_NormalPriority,Wx=Bt.unstable_LowPriority,S0=Bt.unstable_IdlePriority,yu=null,Sn=null;function Kx(t){if(Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot(yu,t,void 0,(t.current.flags&128)===128)}catch{}}var cn=Math.clz32?Math.clz32:Yx,Gx=Math.log,Qx=Math.LN2;function Yx(t){return t>>>=0,t===0?32:31-(Gx(t)/Qx|0)|0}var Mo=64,Oo=4194304;function Wi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Tl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=Wi(l):(i&=a,i!==0&&(r=Wi(i)))}else a=n&~s,a!==0?r=Wi(a):i!==0&&(r=Wi(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-cn(e),s=1<<n,r|=t[n],e&=~s;return r}function Xx(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jx(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-cn(i),l=1<<a,u=s[a];u===-1?(!(l&n)||l&r)&&(s[a]=Xx(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Ad(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function N0(){var t=Mo;return Mo<<=1,!(Mo&4194240)&&(Mo=64),t}function xc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Za(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-cn(e),t[e]=n}function Zx(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-cn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function ef(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-cn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var _e=0;function _0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var C0,tf,I0,T0,b0,Rd=!1,$o=[],pr=null,gr=null,yr=null,va=new Map,Ea=new Map,ir=[],e1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pp(t,e){switch(t){case"focusin":case"focusout":pr=null;break;case"dragenter":case"dragleave":gr=null;break;case"mouseover":case"mouseout":yr=null;break;case"pointerover":case"pointerout":va.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ea.delete(e.pointerId)}}function $i(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=to(e),e!==null&&tf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function t1(t,e,n,r,s){switch(e){case"focusin":return pr=$i(pr,t,e,n,r,s),!0;case"dragenter":return gr=$i(gr,t,e,n,r,s),!0;case"mouseover":return yr=$i(yr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return va.set(i,$i(va.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ea.set(i,$i(Ea.get(i)||null,t,e,n,r,s)),!0}return!1}function D0(t){var e=Kr(t.target);if(e!==null){var n=ys(e);if(n!==null){if(e=n.tag,e===13){if(e=v0(n),e!==null){t.blockedOn=e,b0(t.priority,function(){I0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function il(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Pd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Id=r,n.target.dispatchEvent(r),Id=null}else return e=to(n),e!==null&&tf(e),t.blockedOn=n,!1;e.shift()}return!0}function gp(t,e,n){il(t)&&n.delete(e)}function n1(){Rd=!1,pr!==null&&il(pr)&&(pr=null),gr!==null&&il(gr)&&(gr=null),yr!==null&&il(yr)&&(yr=null),va.forEach(gp),Ea.forEach(gp)}function Li(t,e){t.blockedOn===e&&(t.blockedOn=null,Rd||(Rd=!0,Bt.unstable_scheduleCallback(Bt.unstable_NormalPriority,n1)))}function wa(t){function e(s){return Li(s,t)}if(0<$o.length){Li($o[0],t);for(var n=1;n<$o.length;n++){var r=$o[n];r.blockedOn===t&&(r.blockedOn=null)}}for(pr!==null&&Li(pr,t),gr!==null&&Li(gr,t),yr!==null&&Li(yr,t),va.forEach(e),Ea.forEach(e),n=0;n<ir.length;n++)r=ir[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ir.length&&(n=ir[0],n.blockedOn===null);)D0(n),n.blockedOn===null&&ir.shift()}var Ws=Yn.ReactCurrentBatchConfig,bl=!0;function r1(t,e,n,r){var s=_e,i=Ws.transition;Ws.transition=null;try{_e=1,nf(t,e,n,r)}finally{_e=s,Ws.transition=i}}function s1(t,e,n,r){var s=_e,i=Ws.transition;Ws.transition=null;try{_e=4,nf(t,e,n,r)}finally{_e=s,Ws.transition=i}}function nf(t,e,n,r){if(bl){var s=Pd(t,e,n,r);if(s===null)Rc(t,e,r,Dl,n),pp(t,r);else if(t1(s,t,e,n,r))r.stopPropagation();else if(pp(t,r),e&4&&-1<e1.indexOf(t)){for(;s!==null;){var i=to(s);if(i!==null&&C0(i),i=Pd(t,e,n,r),i===null&&Rc(t,e,r,Dl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Rc(t,e,r,null,n)}}var Dl=null;function Pd(t,e,n,r){if(Dl=null,t=Jh(r),t=Kr(t),t!==null)if(e=ys(t),e===null)t=null;else if(n=e.tag,n===13){if(t=v0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Dl=t,null}function A0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hx()){case Zh:return 1;case x0:return 4;case Il:case Wx:return 16;case S0:return 536870912;default:return 16}default:return 16}}var hr=null,rf=null,al=null;function R0(){if(al)return al;var t,e=rf,n=e.length,r,s="value"in hr?hr.value:hr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return al=s.slice(t,1<r?1-r:void 0)}function ol(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Lo(){return!0}function yp(){return!1}function Wt(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Lo:yp,this.isPropagationStopped=yp,this}return Le(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Lo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Lo)},persist:function(){},isPersistent:Lo}),e}var wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sf=Wt(wi),eo=Le({},wi,{view:0,detail:0}),i1=Wt(eo),Sc,Nc,Fi,vu=Le({},eo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:af,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Fi&&(Fi&&t.type==="mousemove"?(Sc=t.screenX-Fi.screenX,Nc=t.screenY-Fi.screenY):Nc=Sc=0,Fi=t),Sc)},movementY:function(t){return"movementY"in t?t.movementY:Nc}}),vp=Wt(vu),a1=Le({},vu,{dataTransfer:0}),o1=Wt(a1),l1=Le({},eo,{relatedTarget:0}),_c=Wt(l1),u1=Le({},wi,{animationName:0,elapsedTime:0,pseudoElement:0}),c1=Wt(u1),d1=Le({},wi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),h1=Wt(d1),f1=Le({},wi,{data:0}),Ep=Wt(f1),m1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},p1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},g1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function y1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=g1[t])?!!e[t]:!1}function af(){return y1}var v1=Le({},eo,{key:function(t){if(t.key){var e=m1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ol(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?p1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:af,charCode:function(t){return t.type==="keypress"?ol(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ol(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),E1=Wt(v1),w1=Le({},vu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wp=Wt(w1),k1=Le({},eo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:af}),x1=Wt(k1),S1=Le({},wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),N1=Wt(S1),_1=Le({},vu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),C1=Wt(_1),I1=[9,13,27,32],of=zn&&"CompositionEvent"in window,ra=null;zn&&"documentMode"in document&&(ra=document.documentMode);var T1=zn&&"TextEvent"in window&&!ra,P0=zn&&(!of||ra&&8<ra&&11>=ra),kp=" ",xp=!1;function M0(t,e){switch(t){case"keyup":return I1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function O0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var As=!1;function b1(t,e){switch(t){case"compositionend":return O0(e);case"keypress":return e.which!==32?null:(xp=!0,kp);case"textInput":return t=e.data,t===kp&&xp?null:t;default:return null}}function D1(t,e){if(As)return t==="compositionend"||!of&&M0(t,e)?(t=R0(),al=rf=hr=null,As=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return P0&&e.locale!=="ko"?null:e.data;default:return null}}var A1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!A1[t.type]:e==="textarea"}function $0(t,e,n,r){f0(r),e=Al(e,"onChange"),0<e.length&&(n=new sf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var sa=null,ka=null;function R1(t){K0(t,0)}function Eu(t){var e=Ms(t);if(a0(e))return t}function P1(t,e){if(t==="change")return e}var L0=!1;if(zn){var Cc;if(zn){var Ic="oninput"in document;if(!Ic){var Np=document.createElement("div");Np.setAttribute("oninput","return;"),Ic=typeof Np.oninput=="function"}Cc=Ic}else Cc=!1;L0=Cc&&(!document.documentMode||9<document.documentMode)}function _p(){sa&&(sa.detachEvent("onpropertychange",F0),ka=sa=null)}function F0(t){if(t.propertyName==="value"&&Eu(ka)){var e=[];$0(e,ka,t,Jh(t)),y0(R1,e)}}function M1(t,e,n){t==="focusin"?(_p(),sa=e,ka=n,sa.attachEvent("onpropertychange",F0)):t==="focusout"&&_p()}function O1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Eu(ka)}function $1(t,e){if(t==="click")return Eu(e)}function L1(t,e){if(t==="input"||t==="change")return Eu(e)}function F1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var hn=typeof Object.is=="function"?Object.is:F1;function xa(t,e){if(hn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!pd.call(e,s)||!hn(t[s],e[s]))return!1}return!0}function Cp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ip(t,e){var n=Cp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Cp(n)}}function U0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?U0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function V0(){for(var t=window,e=Nl();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Nl(t.document)}return e}function lf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function U1(t){var e=V0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&U0(n.ownerDocument.documentElement,n)){if(r!==null&&lf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Ip(n,i);var a=Ip(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var V1=zn&&"documentMode"in document&&11>=document.documentMode,Rs=null,Md=null,ia=null,Od=!1;function Tp(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Od||Rs==null||Rs!==Nl(r)||(r=Rs,"selectionStart"in r&&lf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ia&&xa(ia,r)||(ia=r,r=Al(Md,"onSelect"),0<r.length&&(e=new sf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Rs)))}function Fo(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ps={animationend:Fo("Animation","AnimationEnd"),animationiteration:Fo("Animation","AnimationIteration"),animationstart:Fo("Animation","AnimationStart"),transitionend:Fo("Transition","TransitionEnd")},Tc={},z0={};zn&&(z0=document.createElement("div").style,"AnimationEvent"in window||(delete Ps.animationend.animation,delete Ps.animationiteration.animation,delete Ps.animationstart.animation),"TransitionEvent"in window||delete Ps.transitionend.transition);function wu(t){if(Tc[t])return Tc[t];if(!Ps[t])return t;var e=Ps[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in z0)return Tc[t]=e[n];return t}var j0=wu("animationend"),B0=wu("animationiteration"),q0=wu("animationstart"),H0=wu("transitionend"),W0=new Map,bp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mr(t,e){W0.set(t,e),gs(e,[t])}for(var bc=0;bc<bp.length;bc++){var Dc=bp[bc],z1=Dc.toLowerCase(),j1=Dc[0].toUpperCase()+Dc.slice(1);Mr(z1,"on"+j1)}Mr(j0,"onAnimationEnd");Mr(B0,"onAnimationIteration");Mr(q0,"onAnimationStart");Mr("dblclick","onDoubleClick");Mr("focusin","onFocus");Mr("focusout","onBlur");Mr(H0,"onTransitionEnd");ni("onMouseEnter",["mouseout","mouseover"]);ni("onMouseLeave",["mouseout","mouseover"]);ni("onPointerEnter",["pointerout","pointerover"]);ni("onPointerLeave",["pointerout","pointerover"]);gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ki="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ki));function Dp(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,zx(r,e,void 0,t),t.currentTarget=null}function K0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var l=r[a],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;Dp(s,l,c),i=u}else for(a=0;a<r.length;a++){if(l=r[a],u=l.instance,c=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;Dp(s,l,c),i=u}}}if(Cl)throw t=Dd,Cl=!1,Dd=null,t}function Te(t,e){var n=e[Vd];n===void 0&&(n=e[Vd]=new Set);var r=t+"__bubble";n.has(r)||(G0(e,t,2,!1),n.add(r))}function Ac(t,e,n){var r=0;e&&(r|=4),G0(n,t,r,e)}var Uo="_reactListening"+Math.random().toString(36).slice(2);function Sa(t){if(!t[Uo]){t[Uo]=!0,t0.forEach(function(n){n!=="selectionchange"&&(B1.has(n)||Ac(n,!1,t),Ac(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Uo]||(e[Uo]=!0,Ac("selectionchange",!1,e))}}function G0(t,e,n,r){switch(A0(e)){case 1:var s=r1;break;case 4:s=s1;break;default:s=nf}n=s.bind(null,e,n,t),s=void 0,!bd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Rc(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Kr(l),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}l=l.parentNode}}r=r.return}y0(function(){var c=i,d=Jh(n),h=[];e:{var m=W0.get(t);if(m!==void 0){var y=sf,E=t;switch(t){case"keypress":if(ol(n)===0)break e;case"keydown":case"keyup":y=E1;break;case"focusin":E="focus",y=_c;break;case"focusout":E="blur",y=_c;break;case"beforeblur":case"afterblur":y=_c;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=vp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=o1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=x1;break;case j0:case B0:case q0:y=c1;break;case H0:y=N1;break;case"scroll":y=i1;break;case"wheel":y=C1;break;case"copy":case"cut":case"paste":y=h1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=wp}var v=(e&4)!==0,w=!v&&t==="scroll",f=v?m!==null?m+"Capture":null:m;v=[];for(var p=c,g;p!==null;){g=p;var k=g.stateNode;if(g.tag===5&&k!==null&&(g=k,f!==null&&(k=ya(p,f),k!=null&&v.push(Na(p,k,g)))),w)break;p=p.return}0<v.length&&(m=new y(m,E,null,n,d),h.push({event:m,listeners:v}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",m&&n!==Id&&(E=n.relatedTarget||n.fromElement)&&(Kr(E)||E[jn]))break e;if((y||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,y?(E=n.relatedTarget||n.toElement,y=c,E=E?Kr(E):null,E!==null&&(w=ys(E),E!==w||E.tag!==5&&E.tag!==6)&&(E=null)):(y=null,E=c),y!==E)){if(v=vp,k="onMouseLeave",f="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(v=wp,k="onPointerLeave",f="onPointerEnter",p="pointer"),w=y==null?m:Ms(y),g=E==null?m:Ms(E),m=new v(k,p+"leave",y,n,d),m.target=w,m.relatedTarget=g,k=null,Kr(d)===c&&(v=new v(f,p+"enter",E,n,d),v.target=g,v.relatedTarget=w,k=v),w=k,y&&E)t:{for(v=y,f=E,p=0,g=v;g;g=Ss(g))p++;for(g=0,k=f;k;k=Ss(k))g++;for(;0<p-g;)v=Ss(v),p--;for(;0<g-p;)f=Ss(f),g--;for(;p--;){if(v===f||f!==null&&v===f.alternate)break t;v=Ss(v),f=Ss(f)}v=null}else v=null;y!==null&&Ap(h,m,y,v,!1),E!==null&&w!==null&&Ap(h,w,E,v,!0)}}e:{if(m=c?Ms(c):window,y=m.nodeName&&m.nodeName.toLowerCase(),y==="select"||y==="input"&&m.type==="file")var _=P1;else if(Sp(m))if(L0)_=L1;else{_=O1;var C=M1}else(y=m.nodeName)&&y.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(_=$1);if(_&&(_=_(t,c))){$0(h,_,n,d);break e}C&&C(t,m,c),t==="focusout"&&(C=m._wrapperState)&&C.controlled&&m.type==="number"&&xd(m,"number",m.value)}switch(C=c?Ms(c):window,t){case"focusin":(Sp(C)||C.contentEditable==="true")&&(Rs=C,Md=c,ia=null);break;case"focusout":ia=Md=Rs=null;break;case"mousedown":Od=!0;break;case"contextmenu":case"mouseup":case"dragend":Od=!1,Tp(h,n,d);break;case"selectionchange":if(V1)break;case"keydown":case"keyup":Tp(h,n,d)}var P;if(of)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else As?M0(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(P0&&n.locale!=="ko"&&(As||M!=="onCompositionStart"?M==="onCompositionEnd"&&As&&(P=R0()):(hr=d,rf="value"in hr?hr.value:hr.textContent,As=!0)),C=Al(c,M),0<C.length&&(M=new Ep(M,t,null,n,d),h.push({event:M,listeners:C}),P?M.data=P:(P=O0(n),P!==null&&(M.data=P)))),(P=T1?b1(t,n):D1(t,n))&&(c=Al(c,"onBeforeInput"),0<c.length&&(d=new Ep("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=P))}K0(h,e)})}function Na(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Al(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ya(t,n),i!=null&&r.unshift(Na(t,i,s)),i=ya(t,e),i!=null&&r.push(Na(t,i,s))),t=t.return}return r}function Ss(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ap(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,s?(u=ya(n,i),u!=null&&a.unshift(Na(n,u,l))):s||(u=ya(n,i),u!=null&&a.push(Na(n,u,l)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var q1=/\r\n?/g,H1=/\u0000|\uFFFD/g;function Rp(t){return(typeof t=="string"?t:""+t).replace(q1,`
`).replace(H1,"")}function Vo(t,e,n){if(e=Rp(e),Rp(t)!==e&&n)throw Error($(425))}function Rl(){}var $d=null,Ld=null;function Fd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ud=typeof setTimeout=="function"?setTimeout:void 0,W1=typeof clearTimeout=="function"?clearTimeout:void 0,Pp=typeof Promise=="function"?Promise:void 0,K1=typeof queueMicrotask=="function"?queueMicrotask:typeof Pp<"u"?function(t){return Pp.resolve(null).then(t).catch(G1)}:Ud;function G1(t){setTimeout(function(){throw t})}function Pc(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),wa(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);wa(e)}function vr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Mp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ki=Math.random().toString(36).slice(2),En="__reactFiber$"+ki,_a="__reactProps$"+ki,jn="__reactContainer$"+ki,Vd="__reactEvents$"+ki,Q1="__reactListeners$"+ki,Y1="__reactHandles$"+ki;function Kr(t){var e=t[En];if(e)return e;for(var n=t.parentNode;n;){if(e=n[jn]||n[En]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Mp(t);t!==null;){if(n=t[En])return n;t=Mp(t)}return e}t=n,n=t.parentNode}return null}function to(t){return t=t[En]||t[jn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ms(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error($(33))}function ku(t){return t[_a]||null}var zd=[],Os=-1;function Or(t){return{current:t}}function Re(t){0>Os||(t.current=zd[Os],zd[Os]=null,Os--)}function Ie(t,e){Os++,zd[Os]=t.current,t.current=e}var Tr={},wt=Or(Tr),$t=Or(!1),ss=Tr;function ri(t,e){var n=t.type.contextTypes;if(!n)return Tr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Lt(t){return t=t.childContextTypes,t!=null}function Pl(){Re($t),Re(wt)}function Op(t,e,n){if(wt.current!==Tr)throw Error($(168));Ie(wt,e),Ie($t,n)}function Q0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error($(108,Mx(t)||"Unknown",s));return Le({},n,r)}function Ml(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Tr,ss=wt.current,Ie(wt,t),Ie($t,$t.current),!0}function $p(t,e,n){var r=t.stateNode;if(!r)throw Error($(169));n?(t=Q0(t,e,ss),r.__reactInternalMemoizedMergedChildContext=t,Re($t),Re(wt),Ie(wt,t)):Re($t),Ie($t,n)}var Rn=null,xu=!1,Mc=!1;function Y0(t){Rn===null?Rn=[t]:Rn.push(t)}function X1(t){xu=!0,Y0(t)}function $r(){if(!Mc&&Rn!==null){Mc=!0;var t=0,e=_e;try{var n=Rn;for(_e=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Rn=null,xu=!1}catch(s){throw Rn!==null&&(Rn=Rn.slice(t+1)),k0(Zh,$r),s}finally{_e=e,Mc=!1}}return null}var $s=[],Ls=0,Ol=null,$l=0,Yt=[],Xt=0,is=null,Mn=1,On="";function qr(t,e){$s[Ls++]=$l,$s[Ls++]=Ol,Ol=t,$l=e}function X0(t,e,n){Yt[Xt++]=Mn,Yt[Xt++]=On,Yt[Xt++]=is,is=t;var r=Mn;t=On;var s=32-cn(r)-1;r&=~(1<<s),n+=1;var i=32-cn(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Mn=1<<32-cn(e)+s|n<<s|r,On=i+t}else Mn=1<<i|n<<s|r,On=t}function uf(t){t.return!==null&&(qr(t,1),X0(t,1,0))}function cf(t){for(;t===Ol;)Ol=$s[--Ls],$s[Ls]=null,$l=$s[--Ls],$s[Ls]=null;for(;t===is;)is=Yt[--Xt],Yt[Xt]=null,On=Yt[--Xt],Yt[Xt]=null,Mn=Yt[--Xt],Yt[Xt]=null}var jt=null,Vt=null,Me=!1,un=null;function J0(t,e){var n=en(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Lp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,jt=t,Vt=vr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,jt=t,Vt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=is!==null?{id:Mn,overflow:On}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=en(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,jt=t,Vt=null,!0):!1;default:return!1}}function jd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Bd(t){if(Me){var e=Vt;if(e){var n=e;if(!Lp(t,e)){if(jd(t))throw Error($(418));e=vr(n.nextSibling);var r=jt;e&&Lp(t,e)?J0(r,n):(t.flags=t.flags&-4097|2,Me=!1,jt=t)}}else{if(jd(t))throw Error($(418));t.flags=t.flags&-4097|2,Me=!1,jt=t}}}function Fp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;jt=t}function zo(t){if(t!==jt)return!1;if(!Me)return Fp(t),Me=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Fd(t.type,t.memoizedProps)),e&&(e=Vt)){if(jd(t))throw Z0(),Error($(418));for(;e;)J0(t,e),e=vr(e.nextSibling)}if(Fp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error($(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Vt=vr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Vt=null}}else Vt=jt?vr(t.stateNode.nextSibling):null;return!0}function Z0(){for(var t=Vt;t;)t=vr(t.nextSibling)}function si(){Vt=jt=null,Me=!1}function df(t){un===null?un=[t]:un.push(t)}var J1=Yn.ReactCurrentBatchConfig;function Ui(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error($(284));if(!n._owner)throw Error($(290,t))}return t}function jo(t,e){throw t=Object.prototype.toString.call(e),Error($(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Up(t){var e=t._init;return e(t._payload)}function ev(t){function e(f,p){if(t){var g=f.deletions;g===null?(f.deletions=[p],f.flags|=16):g.push(p)}}function n(f,p){if(!t)return null;for(;p!==null;)e(f,p),p=p.sibling;return null}function r(f,p){for(f=new Map;p!==null;)p.key!==null?f.set(p.key,p):f.set(p.index,p),p=p.sibling;return f}function s(f,p){return f=xr(f,p),f.index=0,f.sibling=null,f}function i(f,p,g){return f.index=g,t?(g=f.alternate,g!==null?(g=g.index,g<p?(f.flags|=2,p):g):(f.flags|=2,p)):(f.flags|=1048576,p)}function a(f){return t&&f.alternate===null&&(f.flags|=2),f}function l(f,p,g,k){return p===null||p.tag!==6?(p=zc(g,f.mode,k),p.return=f,p):(p=s(p,g),p.return=f,p)}function u(f,p,g,k){var _=g.type;return _===Ds?d(f,p,g.props.children,k,g.key):p!==null&&(p.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===rr&&Up(_)===p.type)?(k=s(p,g.props),k.ref=Ui(f,p,g),k.return=f,k):(k=ml(g.type,g.key,g.props,null,f.mode,k),k.ref=Ui(f,p,g),k.return=f,k)}function c(f,p,g,k){return p===null||p.tag!==4||p.stateNode.containerInfo!==g.containerInfo||p.stateNode.implementation!==g.implementation?(p=jc(g,f.mode,k),p.return=f,p):(p=s(p,g.children||[]),p.return=f,p)}function d(f,p,g,k,_){return p===null||p.tag!==7?(p=es(g,f.mode,k,_),p.return=f,p):(p=s(p,g),p.return=f,p)}function h(f,p,g){if(typeof p=="string"&&p!==""||typeof p=="number")return p=zc(""+p,f.mode,g),p.return=f,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Ao:return g=ml(p.type,p.key,p.props,null,f.mode,g),g.ref=Ui(f,null,p),g.return=f,g;case bs:return p=jc(p,f.mode,g),p.return=f,p;case rr:var k=p._init;return h(f,k(p._payload),g)}if(Hi(p)||Mi(p))return p=es(p,f.mode,g,null),p.return=f,p;jo(f,p)}return null}function m(f,p,g,k){var _=p!==null?p.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return _!==null?null:l(f,p,""+g,k);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ao:return g.key===_?u(f,p,g,k):null;case bs:return g.key===_?c(f,p,g,k):null;case rr:return _=g._init,m(f,p,_(g._payload),k)}if(Hi(g)||Mi(g))return _!==null?null:d(f,p,g,k,null);jo(f,g)}return null}function y(f,p,g,k,_){if(typeof k=="string"&&k!==""||typeof k=="number")return f=f.get(g)||null,l(p,f,""+k,_);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Ao:return f=f.get(k.key===null?g:k.key)||null,u(p,f,k,_);case bs:return f=f.get(k.key===null?g:k.key)||null,c(p,f,k,_);case rr:var C=k._init;return y(f,p,g,C(k._payload),_)}if(Hi(k)||Mi(k))return f=f.get(g)||null,d(p,f,k,_,null);jo(p,k)}return null}function E(f,p,g,k){for(var _=null,C=null,P=p,M=p=0,X=null;P!==null&&M<g.length;M++){P.index>M?(X=P,P=null):X=P.sibling;var A=m(f,P,g[M],k);if(A===null){P===null&&(P=X);break}t&&P&&A.alternate===null&&e(f,P),p=i(A,p,M),C===null?_=A:C.sibling=A,C=A,P=X}if(M===g.length)return n(f,P),Me&&qr(f,M),_;if(P===null){for(;M<g.length;M++)P=h(f,g[M],k),P!==null&&(p=i(P,p,M),C===null?_=P:C.sibling=P,C=P);return Me&&qr(f,M),_}for(P=r(f,P);M<g.length;M++)X=y(P,f,M,g[M],k),X!==null&&(t&&X.alternate!==null&&P.delete(X.key===null?M:X.key),p=i(X,p,M),C===null?_=X:C.sibling=X,C=X);return t&&P.forEach(function(T){return e(f,T)}),Me&&qr(f,M),_}function v(f,p,g,k){var _=Mi(g);if(typeof _!="function")throw Error($(150));if(g=_.call(g),g==null)throw Error($(151));for(var C=_=null,P=p,M=p=0,X=null,A=g.next();P!==null&&!A.done;M++,A=g.next()){P.index>M?(X=P,P=null):X=P.sibling;var T=m(f,P,A.value,k);if(T===null){P===null&&(P=X);break}t&&P&&T.alternate===null&&e(f,P),p=i(T,p,M),C===null?_=T:C.sibling=T,C=T,P=X}if(A.done)return n(f,P),Me&&qr(f,M),_;if(P===null){for(;!A.done;M++,A=g.next())A=h(f,A.value,k),A!==null&&(p=i(A,p,M),C===null?_=A:C.sibling=A,C=A);return Me&&qr(f,M),_}for(P=r(f,P);!A.done;M++,A=g.next())A=y(P,f,M,A.value,k),A!==null&&(t&&A.alternate!==null&&P.delete(A.key===null?M:A.key),p=i(A,p,M),C===null?_=A:C.sibling=A,C=A);return t&&P.forEach(function(B){return e(f,B)}),Me&&qr(f,M),_}function w(f,p,g,k){if(typeof g=="object"&&g!==null&&g.type===Ds&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case Ao:e:{for(var _=g.key,C=p;C!==null;){if(C.key===_){if(_=g.type,_===Ds){if(C.tag===7){n(f,C.sibling),p=s(C,g.props.children),p.return=f,f=p;break e}}else if(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===rr&&Up(_)===C.type){n(f,C.sibling),p=s(C,g.props),p.ref=Ui(f,C,g),p.return=f,f=p;break e}n(f,C);break}else e(f,C);C=C.sibling}g.type===Ds?(p=es(g.props.children,f.mode,k,g.key),p.return=f,f=p):(k=ml(g.type,g.key,g.props,null,f.mode,k),k.ref=Ui(f,p,g),k.return=f,f=k)}return a(f);case bs:e:{for(C=g.key;p!==null;){if(p.key===C)if(p.tag===4&&p.stateNode.containerInfo===g.containerInfo&&p.stateNode.implementation===g.implementation){n(f,p.sibling),p=s(p,g.children||[]),p.return=f,f=p;break e}else{n(f,p);break}else e(f,p);p=p.sibling}p=jc(g,f.mode,k),p.return=f,f=p}return a(f);case rr:return C=g._init,w(f,p,C(g._payload),k)}if(Hi(g))return E(f,p,g,k);if(Mi(g))return v(f,p,g,k);jo(f,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,p!==null&&p.tag===6?(n(f,p.sibling),p=s(p,g),p.return=f,f=p):(n(f,p),p=zc(g,f.mode,k),p.return=f,f=p),a(f)):n(f,p)}return w}var ii=ev(!0),tv=ev(!1),Ll=Or(null),Fl=null,Fs=null,hf=null;function ff(){hf=Fs=Fl=null}function mf(t){var e=Ll.current;Re(Ll),t._currentValue=e}function qd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ks(t,e){Fl=t,hf=Fs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ot=!0),t.firstContext=null)}function nn(t){var e=t._currentValue;if(hf!==t)if(t={context:t,memoizedValue:e,next:null},Fs===null){if(Fl===null)throw Error($(308));Fs=t,Fl.dependencies={lanes:0,firstContext:t}}else Fs=Fs.next=t;return e}var Gr=null;function pf(t){Gr===null?Gr=[t]:Gr.push(t)}function nv(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,pf(e)):(n.next=s.next,s.next=n),e.interleaved=n,Bn(t,r)}function Bn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var sr=!1;function gf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Un(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Er(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Bn(t,n)}return s=r.interleaved,s===null?(e.next=e,pf(r)):(e.next=s.next,s.next=e),r.interleaved=e,Bn(t,n)}function ll(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ef(t,n)}}function Vp(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ul(t,e,n,r){var s=t.updateQueue;sr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,c=u.next;u.next=null,a===null?i=c:a.next=c,a=u;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==a&&(l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(i!==null){var h=s.baseState;a=0,d=c=u=null,l=i;do{var m=l.lane,y=l.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var E=t,v=l;switch(m=e,y=n,v.tag){case 1:if(E=v.payload,typeof E=="function"){h=E.call(y,h,m);break e}h=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=v.payload,m=typeof E=="function"?E.call(y,h,m):E,m==null)break e;h=Le({},h,m);break e;case 2:sr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else y={eventTime:y,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(c=d=y,u=h):d=d.next=y,a|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(d===null&&(u=h),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);os|=a,t.lanes=a,t.memoizedState=h}}function zp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error($(191,s));s.call(r)}}}var no={},Nn=Or(no),Ca=Or(no),Ia=Or(no);function Qr(t){if(t===no)throw Error($(174));return t}function yf(t,e){switch(Ie(Ia,e),Ie(Ca,t),Ie(Nn,no),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Nd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Nd(e,t)}Re(Nn),Ie(Nn,e)}function ai(){Re(Nn),Re(Ca),Re(Ia)}function sv(t){Qr(Ia.current);var e=Qr(Nn.current),n=Nd(e,t.type);e!==n&&(Ie(Ca,t),Ie(Nn,n))}function vf(t){Ca.current===t&&(Re(Nn),Re(Ca))}var Oe=Or(0);function Vl(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Oc=[];function Ef(){for(var t=0;t<Oc.length;t++)Oc[t]._workInProgressVersionPrimary=null;Oc.length=0}var ul=Yn.ReactCurrentDispatcher,$c=Yn.ReactCurrentBatchConfig,as=0,$e=null,Ge=null,Ze=null,zl=!1,aa=!1,Ta=0,Z1=0;function ut(){throw Error($(321))}function wf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!hn(t[n],e[n]))return!1;return!0}function kf(t,e,n,r,s,i){if(as=i,$e=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ul.current=t===null||t.memoizedState===null?rS:sS,t=n(r,s),aa){i=0;do{if(aa=!1,Ta=0,25<=i)throw Error($(301));i+=1,Ze=Ge=null,e.updateQueue=null,ul.current=iS,t=n(r,s)}while(aa)}if(ul.current=jl,e=Ge!==null&&Ge.next!==null,as=0,Ze=Ge=$e=null,zl=!1,e)throw Error($(300));return t}function xf(){var t=Ta!==0;return Ta=0,t}function vn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ze===null?$e.memoizedState=Ze=t:Ze=Ze.next=t,Ze}function rn(){if(Ge===null){var t=$e.alternate;t=t!==null?t.memoizedState:null}else t=Ge.next;var e=Ze===null?$e.memoizedState:Ze.next;if(e!==null)Ze=e,Ge=t;else{if(t===null)throw Error($(310));Ge=t,t={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},Ze===null?$e.memoizedState=Ze=t:Ze=Ze.next=t}return Ze}function ba(t,e){return typeof e=="function"?e(t):e}function Lc(t){var e=rn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=Ge,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,u=null,c=i;do{var d=c.lane;if((as&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=h,a=r):u=u.next=h,$e.lanes|=d,os|=d}c=c.next}while(c!==null&&c!==i);u===null?a=r:u.next=l,hn(r,e.memoizedState)||(Ot=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,$e.lanes|=i,os|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Fc(t){var e=rn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);hn(i,e.memoizedState)||(Ot=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function iv(){}function av(t,e){var n=$e,r=rn(),s=e(),i=!hn(r.memoizedState,s);if(i&&(r.memoizedState=s,Ot=!0),r=r.queue,Sf(uv.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Ze!==null&&Ze.memoizedState.tag&1){if(n.flags|=2048,Da(9,lv.bind(null,n,r,s,e),void 0,null),et===null)throw Error($(349));as&30||ov(n,e,s)}return s}function ov(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function lv(t,e,n,r){e.value=n,e.getSnapshot=r,cv(e)&&dv(t)}function uv(t,e,n){return n(function(){cv(e)&&dv(t)})}function cv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!hn(t,n)}catch{return!0}}function dv(t){var e=Bn(t,1);e!==null&&dn(e,t,1,-1)}function jp(t){var e=vn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:t},e.queue=t,t=t.dispatch=nS.bind(null,$e,t),[e.memoizedState,t]}function Da(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=$e.updateQueue,e===null?(e={lastEffect:null,stores:null},$e.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function hv(){return rn().memoizedState}function cl(t,e,n,r){var s=vn();$e.flags|=t,s.memoizedState=Da(1|e,n,void 0,r===void 0?null:r)}function Su(t,e,n,r){var s=rn();r=r===void 0?null:r;var i=void 0;if(Ge!==null){var a=Ge.memoizedState;if(i=a.destroy,r!==null&&wf(r,a.deps)){s.memoizedState=Da(e,n,i,r);return}}$e.flags|=t,s.memoizedState=Da(1|e,n,i,r)}function Bp(t,e){return cl(8390656,8,t,e)}function Sf(t,e){return Su(2048,8,t,e)}function fv(t,e){return Su(4,2,t,e)}function mv(t,e){return Su(4,4,t,e)}function pv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function gv(t,e,n){return n=n!=null?n.concat([t]):null,Su(4,4,pv.bind(null,e,t),n)}function Nf(){}function yv(t,e){var n=rn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function vv(t,e){var n=rn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&wf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ev(t,e,n){return as&21?(hn(n,e)||(n=N0(),$e.lanes|=n,os|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ot=!0),t.memoizedState=n)}function eS(t,e){var n=_e;_e=n!==0&&4>n?n:4,t(!0);var r=$c.transition;$c.transition={};try{t(!1),e()}finally{_e=n,$c.transition=r}}function wv(){return rn().memoizedState}function tS(t,e,n){var r=kr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},kv(t))xv(e,n);else if(n=nv(t,e,n,r),n!==null){var s=Ct();dn(n,t,r,s),Sv(n,e,r)}}function nS(t,e,n){var r=kr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(kv(t))xv(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,hn(l,a)){var u=e.interleaved;u===null?(s.next=s,pf(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=nv(t,e,s,r),n!==null&&(s=Ct(),dn(n,t,r,s),Sv(n,e,r))}}function kv(t){var e=t.alternate;return t===$e||e!==null&&e===$e}function xv(t,e){aa=zl=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Sv(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ef(t,n)}}var jl={readContext:nn,useCallback:ut,useContext:ut,useEffect:ut,useImperativeHandle:ut,useInsertionEffect:ut,useLayoutEffect:ut,useMemo:ut,useReducer:ut,useRef:ut,useState:ut,useDebugValue:ut,useDeferredValue:ut,useTransition:ut,useMutableSource:ut,useSyncExternalStore:ut,useId:ut,unstable_isNewReconciler:!1},rS={readContext:nn,useCallback:function(t,e){return vn().memoizedState=[t,e===void 0?null:e],t},useContext:nn,useEffect:Bp,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,cl(4194308,4,pv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return cl(4194308,4,t,e)},useInsertionEffect:function(t,e){return cl(4,2,t,e)},useMemo:function(t,e){var n=vn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=vn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=tS.bind(null,$e,t),[r.memoizedState,t]},useRef:function(t){var e=vn();return t={current:t},e.memoizedState=t},useState:jp,useDebugValue:Nf,useDeferredValue:function(t){return vn().memoizedState=t},useTransition:function(){var t=jp(!1),e=t[0];return t=eS.bind(null,t[1]),vn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=$e,s=vn();if(Me){if(n===void 0)throw Error($(407));n=n()}else{if(n=e(),et===null)throw Error($(349));as&30||ov(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Bp(uv.bind(null,r,i,t),[t]),r.flags|=2048,Da(9,lv.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=vn(),e=et.identifierPrefix;if(Me){var n=On,r=Mn;n=(r&~(1<<32-cn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ta++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Z1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},sS={readContext:nn,useCallback:yv,useContext:nn,useEffect:Sf,useImperativeHandle:gv,useInsertionEffect:fv,useLayoutEffect:mv,useMemo:vv,useReducer:Lc,useRef:hv,useState:function(){return Lc(ba)},useDebugValue:Nf,useDeferredValue:function(t){var e=rn();return Ev(e,Ge.memoizedState,t)},useTransition:function(){var t=Lc(ba)[0],e=rn().memoizedState;return[t,e]},useMutableSource:iv,useSyncExternalStore:av,useId:wv,unstable_isNewReconciler:!1},iS={readContext:nn,useCallback:yv,useContext:nn,useEffect:Sf,useImperativeHandle:gv,useInsertionEffect:fv,useLayoutEffect:mv,useMemo:vv,useReducer:Fc,useRef:hv,useState:function(){return Fc(ba)},useDebugValue:Nf,useDeferredValue:function(t){var e=rn();return Ge===null?e.memoizedState=t:Ev(e,Ge.memoizedState,t)},useTransition:function(){var t=Fc(ba)[0],e=rn().memoizedState;return[t,e]},useMutableSource:iv,useSyncExternalStore:av,useId:wv,unstable_isNewReconciler:!1};function on(t,e){if(t&&t.defaultProps){e=Le({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Hd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Le({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Nu={isMounted:function(t){return(t=t._reactInternals)?ys(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ct(),s=kr(t),i=Un(r,s);i.payload=e,n!=null&&(i.callback=n),e=Er(t,i,s),e!==null&&(dn(e,t,s,r),ll(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ct(),s=kr(t),i=Un(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Er(t,i,s),e!==null&&(dn(e,t,s,r),ll(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ct(),r=kr(t),s=Un(n,r);s.tag=2,e!=null&&(s.callback=e),e=Er(t,s,r),e!==null&&(dn(e,t,r,n),ll(e,t,r))}};function qp(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!xa(n,r)||!xa(s,i):!0}function Nv(t,e,n){var r=!1,s=Tr,i=e.contextType;return typeof i=="object"&&i!==null?i=nn(i):(s=Lt(e)?ss:wt.current,r=e.contextTypes,i=(r=r!=null)?ri(t,s):Tr),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Nu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Hp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Nu.enqueueReplaceState(e,e.state,null)}function Wd(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},gf(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=nn(i):(i=Lt(e)?ss:wt.current,s.context=ri(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Hd(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Nu.enqueueReplaceState(s,s.state,null),Ul(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function oi(t,e){try{var n="",r=e;do n+=Px(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Uc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Kd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var aS=typeof WeakMap=="function"?WeakMap:Map;function _v(t,e,n){n=Un(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ql||(ql=!0,rh=r),Kd(t,e)},n}function Cv(t,e,n){n=Un(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Kd(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Kd(t,e),typeof r!="function"&&(wr===null?wr=new Set([this]):wr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Wp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new aS;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=wS.bind(null,t,e,n),e.then(t,t))}function Kp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Gp(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Un(-1,1),e.tag=2,Er(n,e,1))),n.lanes|=1),t)}var oS=Yn.ReactCurrentOwner,Ot=!1;function St(t,e,n,r){e.child=t===null?tv(e,null,n,r):ii(e,t.child,n,r)}function Qp(t,e,n,r,s){n=n.render;var i=e.ref;return Ks(e,s),r=kf(t,e,n,r,i,s),n=xf(),t!==null&&!Ot?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qn(t,e,s)):(Me&&n&&uf(e),e.flags|=1,St(t,e,r,s),e.child)}function Yp(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Rf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,Iv(t,e,i,r,s)):(t=ml(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:xa,n(a,r)&&t.ref===e.ref)return qn(t,e,s)}return e.flags|=1,t=xr(i,r),t.ref=e.ref,t.return=e,e.child=t}function Iv(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(xa(i,r)&&t.ref===e.ref)if(Ot=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Ot=!0);else return e.lanes=t.lanes,qn(t,e,s)}return Gd(t,e,n,r,s)}function Tv(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ie(Vs,Ut),Ut|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ie(Vs,Ut),Ut|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ie(Vs,Ut),Ut|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ie(Vs,Ut),Ut|=r;return St(t,e,s,n),e.child}function bv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Gd(t,e,n,r,s){var i=Lt(n)?ss:wt.current;return i=ri(e,i),Ks(e,s),n=kf(t,e,n,r,i,s),r=xf(),t!==null&&!Ot?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qn(t,e,s)):(Me&&r&&uf(e),e.flags|=1,St(t,e,n,s),e.child)}function Xp(t,e,n,r,s){if(Lt(n)){var i=!0;Ml(e)}else i=!1;if(Ks(e,s),e.stateNode===null)dl(t,e),Nv(e,n,r),Wd(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var u=a.context,c=n.contextType;typeof c=="object"&&c!==null?c=nn(c):(c=Lt(n)?ss:wt.current,c=ri(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||u!==c)&&Hp(e,a,r,c),sr=!1;var m=e.memoizedState;a.state=m,Ul(e,r,a,s),u=e.memoizedState,l!==r||m!==u||$t.current||sr?(typeof d=="function"&&(Hd(e,n,d,r),u=e.memoizedState),(l=sr||qp(e,n,l,r,m,u,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=c,r=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,rv(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:on(e.type,l),a.props=c,h=e.pendingProps,m=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=nn(u):(u=Lt(n)?ss:wt.current,u=ri(e,u));var y=n.getDerivedStateFromProps;(d=typeof y=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==h||m!==u)&&Hp(e,a,r,u),sr=!1,m=e.memoizedState,a.state=m,Ul(e,r,a,s);var E=e.memoizedState;l!==h||m!==E||$t.current||sr?(typeof y=="function"&&(Hd(e,n,y,r),E=e.memoizedState),(c=sr||qp(e,n,c,r,m,E,u)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,E,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,E,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),a.props=r,a.state=E,a.context=u,r=c):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Qd(t,e,n,r,i,s)}function Qd(t,e,n,r,s,i){bv(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&$p(e,n,!1),qn(t,e,i);r=e.stateNode,oS.current=e;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=ii(e,t.child,null,i),e.child=ii(e,null,l,i)):St(t,e,l,i),e.memoizedState=r.state,s&&$p(e,n,!0),e.child}function Dv(t){var e=t.stateNode;e.pendingContext?Op(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Op(t,e.context,!1),yf(t,e.containerInfo)}function Jp(t,e,n,r,s){return si(),df(s),e.flags|=256,St(t,e,n,r),e.child}var Yd={dehydrated:null,treeContext:null,retryLane:0};function Xd(t){return{baseLanes:t,cachePool:null,transitions:null}}function Av(t,e,n){var r=e.pendingProps,s=Oe.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ie(Oe,s&1),t===null)return Bd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Iu(a,r,0,null),t=es(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Xd(n),e.memoizedState=Yd,t):_f(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return lS(t,e,a,r,l,s,n);if(i){i=r.fallback,a=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=xr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=xr(l,i):(i=es(i,a,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=t.child.memoizedState,a=a===null?Xd(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~n,e.memoizedState=Yd,r}return i=t.child,t=i.sibling,r=xr(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function _f(t,e){return e=Iu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Bo(t,e,n,r){return r!==null&&df(r),ii(e,t.child,null,n),t=_f(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function lS(t,e,n,r,s,i,a){if(n)return e.flags&256?(e.flags&=-257,r=Uc(Error($(422))),Bo(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Iu({mode:"visible",children:r.children},s,0,null),i=es(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ii(e,t.child,null,a),e.child.memoizedState=Xd(a),e.memoizedState=Yd,i);if(!(e.mode&1))return Bo(t,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error($(419)),r=Uc(i,r,void 0),Bo(t,e,a,r)}if(l=(a&t.childLanes)!==0,Ot||l){if(r=et,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Bn(t,s),dn(r,t,s,-1))}return Af(),r=Uc(Error($(421))),Bo(t,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=kS.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Vt=vr(s.nextSibling),jt=e,Me=!0,un=null,t!==null&&(Yt[Xt++]=Mn,Yt[Xt++]=On,Yt[Xt++]=is,Mn=t.id,On=t.overflow,is=e),e=_f(e,r.children),e.flags|=4096,e)}function Zp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),qd(t.return,e,n)}function Vc(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Rv(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(St(t,e,r.children,n),r=Oe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Zp(t,n,e);else if(t.tag===19)Zp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ie(Oe,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Vl(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Vc(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Vl(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Vc(e,!0,n,null,i);break;case"together":Vc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function dl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),os|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error($(153));if(e.child!==null){for(t=e.child,n=xr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=xr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function uS(t,e,n){switch(e.tag){case 3:Dv(e),si();break;case 5:sv(e);break;case 1:Lt(e.type)&&Ml(e);break;case 4:yf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ie(Ll,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ie(Oe,Oe.current&1),e.flags|=128,null):n&e.child.childLanes?Av(t,e,n):(Ie(Oe,Oe.current&1),t=qn(t,e,n),t!==null?t.sibling:null);Ie(Oe,Oe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Rv(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ie(Oe,Oe.current),r)break;return null;case 22:case 23:return e.lanes=0,Tv(t,e,n)}return qn(t,e,n)}var Pv,Jd,Mv,Ov;Pv=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Jd=function(){};Mv=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Qr(Nn.current);var i=null;switch(n){case"input":s=wd(t,s),r=wd(t,r),i=[];break;case"select":s=Le({},s,{value:void 0}),r=Le({},r,{value:void 0}),i=[];break;case"textarea":s=Sd(t,s),r=Sd(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Rl)}_d(n,r);var a;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var l=s[c];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(pa.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var u=r[c];if(l=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(pa.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Te("scroll",t),i||l===u||(i=[])):(i=i||[]).push(c,u))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};Ov=function(t,e,n,r){n!==r&&(e.flags|=4)};function Vi(t,e){if(!Me)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ct(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function cS(t,e,n){var r=e.pendingProps;switch(cf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ct(e),null;case 1:return Lt(e.type)&&Pl(),ct(e),null;case 3:return r=e.stateNode,ai(),Re($t),Re(wt),Ef(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(zo(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,un!==null&&(ah(un),un=null))),Jd(t,e),ct(e),null;case 5:vf(e);var s=Qr(Ia.current);if(n=e.type,t!==null&&e.stateNode!=null)Mv(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return ct(e),null}if(t=Qr(Nn.current),zo(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[En]=e,r[_a]=i,t=(e.mode&1)!==0,n){case"dialog":Te("cancel",r),Te("close",r);break;case"iframe":case"object":case"embed":Te("load",r);break;case"video":case"audio":for(s=0;s<Ki.length;s++)Te(Ki[s],r);break;case"source":Te("error",r);break;case"img":case"image":case"link":Te("error",r),Te("load",r);break;case"details":Te("toggle",r);break;case"input":lp(r,i),Te("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Te("invalid",r);break;case"textarea":cp(r,i),Te("invalid",r)}_d(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Vo(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Vo(r.textContent,l,t),s=["children",""+l]):pa.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Te("scroll",r)}switch(n){case"input":Ro(r),up(r,i,!0);break;case"textarea":Ro(r),dp(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Rl)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=u0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[En]=e,t[_a]=r,Pv(t,e,!1,!1),e.stateNode=t;e:{switch(a=Cd(n,r),n){case"dialog":Te("cancel",t),Te("close",t),s=r;break;case"iframe":case"object":case"embed":Te("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ki.length;s++)Te(Ki[s],t);s=r;break;case"source":Te("error",t),s=r;break;case"img":case"image":case"link":Te("error",t),Te("load",t),s=r;break;case"details":Te("toggle",t),s=r;break;case"input":lp(t,r),s=wd(t,r),Te("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Le({},r,{value:void 0}),Te("invalid",t);break;case"textarea":cp(t,r),s=Sd(t,r),Te("invalid",t);break;default:s=r}_d(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?h0(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&c0(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ga(t,u):typeof u=="number"&&ga(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(pa.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Te("scroll",t):u!=null&&Gh(t,i,u,a))}switch(n){case"input":Ro(t),up(t,r,!1);break;case"textarea":Ro(t),dp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ir(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Bs(t,!!r.multiple,i,!1):r.defaultValue!=null&&Bs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Rl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ct(e),null;case 6:if(t&&e.stateNode!=null)Ov(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(n=Qr(Ia.current),Qr(Nn.current),zo(e)){if(r=e.stateNode,n=e.memoizedProps,r[En]=e,(i=r.nodeValue!==n)&&(t=jt,t!==null))switch(t.tag){case 3:Vo(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Vo(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[En]=e,e.stateNode=r}return ct(e),null;case 13:if(Re(Oe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Me&&Vt!==null&&e.mode&1&&!(e.flags&128))Z0(),si(),e.flags|=98560,i=!1;else if(i=zo(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error($(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[En]=e}else si(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ct(e),i=!1}else un!==null&&(ah(un),un=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Oe.current&1?Qe===0&&(Qe=3):Af())),e.updateQueue!==null&&(e.flags|=4),ct(e),null);case 4:return ai(),Jd(t,e),t===null&&Sa(e.stateNode.containerInfo),ct(e),null;case 10:return mf(e.type._context),ct(e),null;case 17:return Lt(e.type)&&Pl(),ct(e),null;case 19:if(Re(Oe),i=e.memoizedState,i===null)return ct(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)Vi(i,!1);else{if(Qe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=Vl(t),a!==null){for(e.flags|=128,Vi(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ie(Oe,Oe.current&1|2),e.child}t=t.sibling}i.tail!==null&&Be()>li&&(e.flags|=128,r=!0,Vi(i,!1),e.lanes=4194304)}else{if(!r)if(t=Vl(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Vi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Me)return ct(e),null}else 2*Be()-i.renderingStartTime>li&&n!==1073741824&&(e.flags|=128,r=!0,Vi(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Be(),e.sibling=null,n=Oe.current,Ie(Oe,r?n&1|2:n&1),e):(ct(e),null);case 22:case 23:return Df(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ut&1073741824&&(ct(e),e.subtreeFlags&6&&(e.flags|=8192)):ct(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function dS(t,e){switch(cf(e),e.tag){case 1:return Lt(e.type)&&Pl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ai(),Re($t),Re(wt),Ef(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return vf(e),null;case 13:if(Re(Oe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error($(340));si()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Re(Oe),null;case 4:return ai(),null;case 10:return mf(e.type._context),null;case 22:case 23:return Df(),null;case 24:return null;default:return null}}var qo=!1,ft=!1,hS=typeof WeakSet=="function"?WeakSet:Set,q=null;function Us(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(t,e,r)}else n.current=null}function Zd(t,e,n){try{n()}catch(r){Ue(t,e,r)}}var eg=!1;function fS(t,e){if($d=bl,t=V0(),lf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,u=-1,c=0,d=0,h=t,m=null;t:for(;;){for(var y;h!==n||s!==0&&h.nodeType!==3||(l=a+s),h!==i||r!==0&&h.nodeType!==3||(u=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(y=h.firstChild)!==null;)m=h,h=y;for(;;){if(h===t)break t;if(m===n&&++c===s&&(l=a),m===i&&++d===r&&(u=a),(y=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=y}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ld={focusedElem:t,selectionRange:n},bl=!1,q=e;q!==null;)if(e=q,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,q=t;else for(;q!==null;){e=q;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var v=E.memoizedProps,w=E.memoizedState,f=e.stateNode,p=f.getSnapshotBeforeUpdate(e.elementType===e.type?v:on(e.type,v),w);f.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(k){Ue(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,q=t;break}q=e.return}return E=eg,eg=!1,E}function oa(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Zd(e,n,i)}s=s.next}while(s!==r)}}function _u(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function eh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function $v(t){var e=t.alternate;e!==null&&(t.alternate=null,$v(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[En],delete e[_a],delete e[Vd],delete e[Q1],delete e[Y1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Lv(t){return t.tag===5||t.tag===3||t.tag===4}function tg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Lv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function th(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Rl));else if(r!==4&&(t=t.child,t!==null))for(th(t,e,n),t=t.sibling;t!==null;)th(t,e,n),t=t.sibling}function nh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(nh(t,e,n),t=t.sibling;t!==null;)nh(t,e,n),t=t.sibling}var rt=null,ln=!1;function er(t,e,n){for(n=n.child;n!==null;)Fv(t,e,n),n=n.sibling}function Fv(t,e,n){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount(yu,n)}catch{}switch(n.tag){case 5:ft||Us(n,e);case 6:var r=rt,s=ln;rt=null,er(t,e,n),rt=r,ln=s,rt!==null&&(ln?(t=rt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):rt.removeChild(n.stateNode));break;case 18:rt!==null&&(ln?(t=rt,n=n.stateNode,t.nodeType===8?Pc(t.parentNode,n):t.nodeType===1&&Pc(t,n),wa(t)):Pc(rt,n.stateNode));break;case 4:r=rt,s=ln,rt=n.stateNode.containerInfo,ln=!0,er(t,e,n),rt=r,ln=s;break;case 0:case 11:case 14:case 15:if(!ft&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Zd(n,e,a),s=s.next}while(s!==r)}er(t,e,n);break;case 1:if(!ft&&(Us(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ue(n,e,l)}er(t,e,n);break;case 21:er(t,e,n);break;case 22:n.mode&1?(ft=(r=ft)||n.memoizedState!==null,er(t,e,n),ft=r):er(t,e,n);break;default:er(t,e,n)}}function ng(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new hS),e.forEach(function(r){var s=xS.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function an(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:rt=l.stateNode,ln=!1;break e;case 3:rt=l.stateNode.containerInfo,ln=!0;break e;case 4:rt=l.stateNode.containerInfo,ln=!0;break e}l=l.return}if(rt===null)throw Error($(160));Fv(i,a,s),rt=null,ln=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){Ue(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Uv(e,t),e=e.sibling}function Uv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(an(e,t),gn(t),r&4){try{oa(3,t,t.return),_u(3,t)}catch(v){Ue(t,t.return,v)}try{oa(5,t,t.return)}catch(v){Ue(t,t.return,v)}}break;case 1:an(e,t),gn(t),r&512&&n!==null&&Us(n,n.return);break;case 5:if(an(e,t),gn(t),r&512&&n!==null&&Us(n,n.return),t.flags&32){var s=t.stateNode;try{ga(s,"")}catch(v){Ue(t,t.return,v)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&o0(s,i),Cd(l,a);var c=Cd(l,i);for(a=0;a<u.length;a+=2){var d=u[a],h=u[a+1];d==="style"?h0(s,h):d==="dangerouslySetInnerHTML"?c0(s,h):d==="children"?ga(s,h):Gh(s,d,h,c)}switch(l){case"input":kd(s,i);break;case"textarea":l0(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?Bs(s,!!i.multiple,y,!1):m!==!!i.multiple&&(i.defaultValue!=null?Bs(s,!!i.multiple,i.defaultValue,!0):Bs(s,!!i.multiple,i.multiple?[]:"",!1))}s[_a]=i}catch(v){Ue(t,t.return,v)}}break;case 6:if(an(e,t),gn(t),r&4){if(t.stateNode===null)throw Error($(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(v){Ue(t,t.return,v)}}break;case 3:if(an(e,t),gn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{wa(e.containerInfo)}catch(v){Ue(t,t.return,v)}break;case 4:an(e,t),gn(t);break;case 13:an(e,t),gn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Tf=Be())),r&4&&ng(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(ft=(c=ft)||d,an(e,t),ft=c):an(e,t),gn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(q=t,d=t.child;d!==null;){for(h=q=d;q!==null;){switch(m=q,y=m.child,m.tag){case 0:case 11:case 14:case 15:oa(4,m,m.return);break;case 1:Us(m,m.return);var E=m.stateNode;if(typeof E.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(v){Ue(r,n,v)}}break;case 5:Us(m,m.return);break;case 22:if(m.memoizedState!==null){sg(h);continue}}y!==null?(y.return=m,q=y):sg(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,u=h.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=d0("display",a))}catch(v){Ue(t,t.return,v)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){Ue(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:an(e,t),gn(t),r&4&&ng(t);break;case 21:break;default:an(e,t),gn(t)}}function gn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Lv(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ga(s,""),r.flags&=-33);var i=tg(t);nh(t,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=tg(t);th(t,l,a);break;default:throw Error($(161))}}catch(u){Ue(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function mS(t,e,n){q=t,Vv(t)}function Vv(t,e,n){for(var r=(t.mode&1)!==0;q!==null;){var s=q,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||qo;if(!a){var l=s.alternate,u=l!==null&&l.memoizedState!==null||ft;l=qo;var c=ft;if(qo=a,(ft=u)&&!c)for(q=s;q!==null;)a=q,u=a.child,a.tag===22&&a.memoizedState!==null?ig(s):u!==null?(u.return=a,q=u):ig(s);for(;i!==null;)q=i,Vv(i),i=i.sibling;q=s,qo=l,ft=c}rg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,q=i):rg(t)}}function rg(t){for(;q!==null;){var e=q;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ft||_u(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ft)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:on(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&zp(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}zp(e,a,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&wa(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}ft||e.flags&512&&eh(e)}catch(m){Ue(e,e.return,m)}}if(e===t){q=null;break}if(n=e.sibling,n!==null){n.return=e.return,q=n;break}q=e.return}}function sg(t){for(;q!==null;){var e=q;if(e===t){q=null;break}var n=e.sibling;if(n!==null){n.return=e.return,q=n;break}q=e.return}}function ig(t){for(;q!==null;){var e=q;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{_u(4,e)}catch(u){Ue(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ue(e,s,u)}}var i=e.return;try{eh(e)}catch(u){Ue(e,i,u)}break;case 5:var a=e.return;try{eh(e)}catch(u){Ue(e,a,u)}}}catch(u){Ue(e,e.return,u)}if(e===t){q=null;break}var l=e.sibling;if(l!==null){l.return=e.return,q=l;break}q=e.return}}var pS=Math.ceil,Bl=Yn.ReactCurrentDispatcher,Cf=Yn.ReactCurrentOwner,tn=Yn.ReactCurrentBatchConfig,ve=0,et=null,We=null,at=0,Ut=0,Vs=Or(0),Qe=0,Aa=null,os=0,Cu=0,If=0,la=null,Pt=null,Tf=0,li=1/0,An=null,ql=!1,rh=null,wr=null,Ho=!1,fr=null,Hl=0,ua=0,sh=null,hl=-1,fl=0;function Ct(){return ve&6?Be():hl!==-1?hl:hl=Be()}function kr(t){return t.mode&1?ve&2&&at!==0?at&-at:J1.transition!==null?(fl===0&&(fl=N0()),fl):(t=_e,t!==0||(t=window.event,t=t===void 0?16:A0(t.type)),t):1}function dn(t,e,n,r){if(50<ua)throw ua=0,sh=null,Error($(185));Za(t,n,r),(!(ve&2)||t!==et)&&(t===et&&(!(ve&2)&&(Cu|=n),Qe===4&&ar(t,at)),Ft(t,r),n===1&&ve===0&&!(e.mode&1)&&(li=Be()+500,xu&&$r()))}function Ft(t,e){var n=t.callbackNode;Jx(t,e);var r=Tl(t,t===et?at:0);if(r===0)n!==null&&mp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&mp(n),e===1)t.tag===0?X1(ag.bind(null,t)):Y0(ag.bind(null,t)),K1(function(){!(ve&6)&&$r()}),n=null;else{switch(_0(r)){case 1:n=Zh;break;case 4:n=x0;break;case 16:n=Il;break;case 536870912:n=S0;break;default:n=Il}n=Gv(n,zv.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function zv(t,e){if(hl=-1,fl=0,ve&6)throw Error($(327));var n=t.callbackNode;if(Gs()&&t.callbackNode!==n)return null;var r=Tl(t,t===et?at:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Wl(t,r);else{e=r;var s=ve;ve|=2;var i=Bv();(et!==t||at!==e)&&(An=null,li=Be()+500,Zr(t,e));do try{vS();break}catch(l){jv(t,l)}while(!0);ff(),Bl.current=i,ve=s,We!==null?e=0:(et=null,at=0,e=Qe)}if(e!==0){if(e===2&&(s=Ad(t),s!==0&&(r=s,e=ih(t,s))),e===1)throw n=Aa,Zr(t,0),ar(t,r),Ft(t,Be()),n;if(e===6)ar(t,r);else{if(s=t.current.alternate,!(r&30)&&!gS(s)&&(e=Wl(t,r),e===2&&(i=Ad(t),i!==0&&(r=i,e=ih(t,i))),e===1))throw n=Aa,Zr(t,0),ar(t,r),Ft(t,Be()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:Hr(t,Pt,An);break;case 3:if(ar(t,r),(r&130023424)===r&&(e=Tf+500-Be(),10<e)){if(Tl(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Ct(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Ud(Hr.bind(null,t,Pt,An),e);break}Hr(t,Pt,An);break;case 4:if(ar(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-cn(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*pS(r/1960))-r,10<r){t.timeoutHandle=Ud(Hr.bind(null,t,Pt,An),r);break}Hr(t,Pt,An);break;case 5:Hr(t,Pt,An);break;default:throw Error($(329))}}}return Ft(t,Be()),t.callbackNode===n?zv.bind(null,t):null}function ih(t,e){var n=la;return t.current.memoizedState.isDehydrated&&(Zr(t,e).flags|=256),t=Wl(t,e),t!==2&&(e=Pt,Pt=n,e!==null&&ah(e)),t}function ah(t){Pt===null?Pt=t:Pt.push.apply(Pt,t)}function gS(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!hn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ar(t,e){for(e&=~If,e&=~Cu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-cn(e),r=1<<n;t[n]=-1,e&=~r}}function ag(t){if(ve&6)throw Error($(327));Gs();var e=Tl(t,0);if(!(e&1))return Ft(t,Be()),null;var n=Wl(t,e);if(t.tag!==0&&n===2){var r=Ad(t);r!==0&&(e=r,n=ih(t,r))}if(n===1)throw n=Aa,Zr(t,0),ar(t,e),Ft(t,Be()),n;if(n===6)throw Error($(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Hr(t,Pt,An),Ft(t,Be()),null}function bf(t,e){var n=ve;ve|=1;try{return t(e)}finally{ve=n,ve===0&&(li=Be()+500,xu&&$r())}}function ls(t){fr!==null&&fr.tag===0&&!(ve&6)&&Gs();var e=ve;ve|=1;var n=tn.transition,r=_e;try{if(tn.transition=null,_e=1,t)return t()}finally{_e=r,tn.transition=n,ve=e,!(ve&6)&&$r()}}function Df(){Ut=Vs.current,Re(Vs)}function Zr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,W1(n)),We!==null)for(n=We.return;n!==null;){var r=n;switch(cf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Pl();break;case 3:ai(),Re($t),Re(wt),Ef();break;case 5:vf(r);break;case 4:ai();break;case 13:Re(Oe);break;case 19:Re(Oe);break;case 10:mf(r.type._context);break;case 22:case 23:Df()}n=n.return}if(et=t,We=t=xr(t.current,null),at=Ut=e,Qe=0,Aa=null,If=Cu=os=0,Pt=la=null,Gr!==null){for(e=0;e<Gr.length;e++)if(n=Gr[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}Gr=null}return t}function jv(t,e){do{var n=We;try{if(ff(),ul.current=jl,zl){for(var r=$e.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}zl=!1}if(as=0,Ze=Ge=$e=null,aa=!1,Ta=0,Cf.current=null,n===null||n.return===null){Qe=1,Aa=e,We=null;break}e:{var i=t,a=n.return,l=n,u=e;if(e=at,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var y=Kp(a);if(y!==null){y.flags&=-257,Gp(y,a,l,i,e),y.mode&1&&Wp(i,c,e),e=y,u=c;var E=e.updateQueue;if(E===null){var v=new Set;v.add(u),e.updateQueue=v}else E.add(u);break e}else{if(!(e&1)){Wp(i,c,e),Af();break e}u=Error($(426))}}else if(Me&&l.mode&1){var w=Kp(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Gp(w,a,l,i,e),df(oi(u,l));break e}}i=u=oi(u,l),Qe!==4&&(Qe=2),la===null?la=[i]:la.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var f=_v(i,u,e);Vp(i,f);break e;case 1:l=u;var p=i.type,g=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(wr===null||!wr.has(g)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=Cv(i,l,e);Vp(i,k);break e}}i=i.return}while(i!==null)}Hv(n)}catch(_){e=_,We===n&&n!==null&&(We=n=n.return);continue}break}while(!0)}function Bv(){var t=Bl.current;return Bl.current=jl,t===null?jl:t}function Af(){(Qe===0||Qe===3||Qe===2)&&(Qe=4),et===null||!(os&268435455)&&!(Cu&268435455)||ar(et,at)}function Wl(t,e){var n=ve;ve|=2;var r=Bv();(et!==t||at!==e)&&(An=null,Zr(t,e));do try{yS();break}catch(s){jv(t,s)}while(!0);if(ff(),ve=n,Bl.current=r,We!==null)throw Error($(261));return et=null,at=0,Qe}function yS(){for(;We!==null;)qv(We)}function vS(){for(;We!==null&&!Bx();)qv(We)}function qv(t){var e=Kv(t.alternate,t,Ut);t.memoizedProps=t.pendingProps,e===null?Hv(t):We=e,Cf.current=null}function Hv(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=dS(n,e),n!==null){n.flags&=32767,We=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qe=6,We=null;return}}else if(n=cS(n,e,Ut),n!==null){We=n;return}if(e=e.sibling,e!==null){We=e;return}We=e=t}while(e!==null);Qe===0&&(Qe=5)}function Hr(t,e,n){var r=_e,s=tn.transition;try{tn.transition=null,_e=1,ES(t,e,n,r)}finally{tn.transition=s,_e=r}return null}function ES(t,e,n,r){do Gs();while(fr!==null);if(ve&6)throw Error($(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error($(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(Zx(t,i),t===et&&(We=et=null,at=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ho||(Ho=!0,Gv(Il,function(){return Gs(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=tn.transition,tn.transition=null;var a=_e;_e=1;var l=ve;ve|=4,Cf.current=null,fS(t,n),Uv(n,t),U1(Ld),bl=!!$d,Ld=$d=null,t.current=n,mS(n),qx(),ve=l,_e=a,tn.transition=i}else t.current=n;if(Ho&&(Ho=!1,fr=t,Hl=s),i=t.pendingLanes,i===0&&(wr=null),Kx(n.stateNode),Ft(t,Be()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ql)throw ql=!1,t=rh,rh=null,t;return Hl&1&&t.tag!==0&&Gs(),i=t.pendingLanes,i&1?t===sh?ua++:(ua=0,sh=t):ua=0,$r(),null}function Gs(){if(fr!==null){var t=_0(Hl),e=tn.transition,n=_e;try{if(tn.transition=null,_e=16>t?16:t,fr===null)var r=!1;else{if(t=fr,fr=null,Hl=0,ve&6)throw Error($(331));var s=ve;for(ve|=4,q=t.current;q!==null;){var i=q,a=i.child;if(q.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(q=c;q!==null;){var d=q;switch(d.tag){case 0:case 11:case 15:oa(8,d,i)}var h=d.child;if(h!==null)h.return=d,q=h;else for(;q!==null;){d=q;var m=d.sibling,y=d.return;if($v(d),d===c){q=null;break}if(m!==null){m.return=y,q=m;break}q=y}}}var E=i.alternate;if(E!==null){var v=E.child;if(v!==null){E.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}q=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,q=a;else e:for(;q!==null;){if(i=q,i.flags&2048)switch(i.tag){case 0:case 11:case 15:oa(9,i,i.return)}var f=i.sibling;if(f!==null){f.return=i.return,q=f;break e}q=i.return}}var p=t.current;for(q=p;q!==null;){a=q;var g=a.child;if(a.subtreeFlags&2064&&g!==null)g.return=a,q=g;else e:for(a=p;q!==null;){if(l=q,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:_u(9,l)}}catch(_){Ue(l,l.return,_)}if(l===a){q=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,q=k;break e}q=l.return}}if(ve=s,$r(),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot(yu,t)}catch{}r=!0}return r}finally{_e=n,tn.transition=e}}return!1}function og(t,e,n){e=oi(n,e),e=_v(t,e,1),t=Er(t,e,1),e=Ct(),t!==null&&(Za(t,1,e),Ft(t,e))}function Ue(t,e,n){if(t.tag===3)og(t,t,n);else for(;e!==null;){if(e.tag===3){og(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(wr===null||!wr.has(r))){t=oi(n,t),t=Cv(e,t,1),e=Er(e,t,1),t=Ct(),e!==null&&(Za(e,1,t),Ft(e,t));break}}e=e.return}}function wS(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ct(),t.pingedLanes|=t.suspendedLanes&n,et===t&&(at&n)===n&&(Qe===4||Qe===3&&(at&130023424)===at&&500>Be()-Tf?Zr(t,0):If|=n),Ft(t,e)}function Wv(t,e){e===0&&(t.mode&1?(e=Oo,Oo<<=1,!(Oo&130023424)&&(Oo=4194304)):e=1);var n=Ct();t=Bn(t,e),t!==null&&(Za(t,e,n),Ft(t,n))}function kS(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Wv(t,n)}function xS(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),Wv(t,n)}var Kv;Kv=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||$t.current)Ot=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ot=!1,uS(t,e,n);Ot=!!(t.flags&131072)}else Ot=!1,Me&&e.flags&1048576&&X0(e,$l,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;dl(t,e),t=e.pendingProps;var s=ri(e,wt.current);Ks(e,n),s=kf(null,e,r,t,s,n);var i=xf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Lt(r)?(i=!0,Ml(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,gf(e),s.updater=Nu,e.stateNode=s,s._reactInternals=e,Wd(e,r,t,n),e=Qd(null,e,r,!0,i,n)):(e.tag=0,Me&&i&&uf(e),St(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(dl(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=NS(r),t=on(r,t),s){case 0:e=Gd(null,e,r,t,n);break e;case 1:e=Xp(null,e,r,t,n);break e;case 11:e=Qp(null,e,r,t,n);break e;case 14:e=Yp(null,e,r,on(r.type,t),n);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:on(r,s),Gd(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:on(r,s),Xp(t,e,r,s,n);case 3:e:{if(Dv(e),t===null)throw Error($(387));r=e.pendingProps,i=e.memoizedState,s=i.element,rv(t,e),Ul(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=oi(Error($(423)),e),e=Jp(t,e,r,n,s);break e}else if(r!==s){s=oi(Error($(424)),e),e=Jp(t,e,r,n,s);break e}else for(Vt=vr(e.stateNode.containerInfo.firstChild),jt=e,Me=!0,un=null,n=tv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(si(),r===s){e=qn(t,e,n);break e}St(t,e,r,n)}e=e.child}return e;case 5:return sv(e),t===null&&Bd(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Fd(r,s)?a=null:i!==null&&Fd(r,i)&&(e.flags|=32),bv(t,e),St(t,e,a,n),e.child;case 6:return t===null&&Bd(e),null;case 13:return Av(t,e,n);case 4:return yf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ii(e,null,r,n):St(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:on(r,s),Qp(t,e,r,s,n);case 7:return St(t,e,e.pendingProps,n),e.child;case 8:return St(t,e,e.pendingProps.children,n),e.child;case 12:return St(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Ie(Ll,r._currentValue),r._currentValue=a,i!==null)if(hn(i.value,a)){if(i.children===s.children&&!$t.current){e=qn(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Un(-1,n&-n),u.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),qd(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error($(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),qd(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}St(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ks(e,n),s=nn(s),r=r(s),e.flags|=1,St(t,e,r,n),e.child;case 14:return r=e.type,s=on(r,e.pendingProps),s=on(r.type,s),Yp(t,e,r,s,n);case 15:return Iv(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:on(r,s),dl(t,e),e.tag=1,Lt(r)?(t=!0,Ml(e)):t=!1,Ks(e,n),Nv(e,r,s),Wd(e,r,s,n),Qd(null,e,r,!0,t,n);case 19:return Rv(t,e,n);case 22:return Tv(t,e,n)}throw Error($(156,e.tag))};function Gv(t,e){return k0(t,e)}function SS(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(t,e,n,r){return new SS(t,e,n,r)}function Rf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function NS(t){if(typeof t=="function")return Rf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Yh)return 11;if(t===Xh)return 14}return 2}function xr(t,e){var n=t.alternate;return n===null?(n=en(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ml(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")Rf(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Ds:return es(n.children,s,i,e);case Qh:a=8,s|=8;break;case gd:return t=en(12,n,e,s|2),t.elementType=gd,t.lanes=i,t;case yd:return t=en(13,n,e,s),t.elementType=yd,t.lanes=i,t;case vd:return t=en(19,n,e,s),t.elementType=vd,t.lanes=i,t;case s0:return Iu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case n0:a=10;break e;case r0:a=9;break e;case Yh:a=11;break e;case Xh:a=14;break e;case rr:a=16,r=null;break e}throw Error($(130,t==null?t:typeof t,""))}return e=en(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function es(t,e,n,r){return t=en(7,t,r,e),t.lanes=n,t}function Iu(t,e,n,r){return t=en(22,t,r,e),t.elementType=s0,t.lanes=n,t.stateNode={isHidden:!1},t}function zc(t,e,n){return t=en(6,t,null,e),t.lanes=n,t}function jc(t,e,n){return e=en(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _S(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xc(0),this.expirationTimes=xc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Pf(t,e,n,r,s,i,a,l,u){return t=new _S(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=en(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},gf(i),t}function CS(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Qv(t){if(!t)return Tr;t=t._reactInternals;e:{if(ys(t)!==t||t.tag!==1)throw Error($(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Lt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(t.tag===1){var n=t.type;if(Lt(n))return Q0(t,n,e)}return e}function Yv(t,e,n,r,s,i,a,l,u){return t=Pf(n,r,!0,t,s,i,a,l,u),t.context=Qv(null),n=t.current,r=Ct(),s=kr(n),i=Un(r,s),i.callback=e??null,Er(n,i,s),t.current.lanes=s,Za(t,s,r),Ft(t,r),t}function Tu(t,e,n,r){var s=e.current,i=Ct(),a=kr(s);return n=Qv(n),e.context===null?e.context=n:e.pendingContext=n,e=Un(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Er(s,e,a),t!==null&&(dn(t,s,a,i),ll(t,s,a)),a}function Kl(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function lg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Mf(t,e){lg(t,e),(t=t.alternate)&&lg(t,e)}function IS(){return null}var Xv=typeof reportError=="function"?reportError:function(t){console.error(t)};function Of(t){this._internalRoot=t}bu.prototype.render=Of.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error($(409));Tu(t,e,null,null)};bu.prototype.unmount=Of.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ls(function(){Tu(null,t,null,null)}),e[jn]=null}};function bu(t){this._internalRoot=t}bu.prototype.unstable_scheduleHydration=function(t){if(t){var e=T0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ir.length&&e!==0&&e<ir[n].priority;n++);ir.splice(n,0,t),n===0&&D0(t)}};function $f(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Du(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ug(){}function TS(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Kl(a);i.call(c)}}var a=Yv(e,r,t,0,null,!1,!1,"",ug);return t._reactRootContainer=a,t[jn]=a.current,Sa(t.nodeType===8?t.parentNode:t),ls(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var c=Kl(u);l.call(c)}}var u=Pf(t,0,!1,null,null,!1,!1,"",ug);return t._reactRootContainer=u,t[jn]=u.current,Sa(t.nodeType===8?t.parentNode:t),ls(function(){Tu(e,u,n,r)}),u}function Au(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var u=Kl(a);l.call(u)}}Tu(e,a,t,s)}else a=TS(n,e,t,s,r);return Kl(a)}C0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Wi(e.pendingLanes);n!==0&&(ef(e,n|1),Ft(e,Be()),!(ve&6)&&(li=Be()+500,$r()))}break;case 13:ls(function(){var r=Bn(t,1);if(r!==null){var s=Ct();dn(r,t,1,s)}}),Mf(t,1)}};tf=function(t){if(t.tag===13){var e=Bn(t,134217728);if(e!==null){var n=Ct();dn(e,t,134217728,n)}Mf(t,134217728)}};I0=function(t){if(t.tag===13){var e=kr(t),n=Bn(t,e);if(n!==null){var r=Ct();dn(n,t,e,r)}Mf(t,e)}};T0=function(){return _e};b0=function(t,e){var n=_e;try{return _e=t,e()}finally{_e=n}};Td=function(t,e,n){switch(e){case"input":if(kd(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ku(r);if(!s)throw Error($(90));a0(r),kd(r,s)}}}break;case"textarea":l0(t,n);break;case"select":e=n.value,e!=null&&Bs(t,!!n.multiple,e,!1)}};p0=bf;g0=ls;var bS={usingClientEntryPoint:!1,Events:[to,Ms,ku,f0,m0,bf]},zi={findFiberByHostInstance:Kr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},DS={bundleType:zi.bundleType,version:zi.version,rendererPackageName:zi.rendererPackageName,rendererConfig:zi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Yn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=E0(t),t===null?null:t.stateNode},findFiberByHostInstance:zi.findFiberByHostInstance||IS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wo.isDisabled&&Wo.supportsFiber)try{yu=Wo.inject(DS),Sn=Wo}catch{}}Ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bS;Ht.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$f(e))throw Error($(200));return CS(t,e,null,n)};Ht.createRoot=function(t,e){if(!$f(t))throw Error($(299));var n=!1,r="",s=Xv;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Pf(t,1,!1,null,null,n,!1,r,s),t[jn]=e.current,Sa(t.nodeType===8?t.parentNode:t),new Of(e)};Ht.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error($(188)):(t=Object.keys(t).join(","),Error($(268,t)));return t=E0(e),t=t===null?null:t.stateNode,t};Ht.flushSync=function(t){return ls(t)};Ht.hydrate=function(t,e,n){if(!Du(e))throw Error($(200));return Au(null,t,e,!0,n)};Ht.hydrateRoot=function(t,e,n){if(!$f(t))throw Error($(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=Xv;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=Yv(e,null,t,1,n??null,s,!1,i,a),t[jn]=e.current,Sa(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new bu(e)};Ht.render=function(t,e,n){if(!Du(e))throw Error($(200));return Au(null,t,e,!1,n)};Ht.unmountComponentAtNode=function(t){if(!Du(t))throw Error($(40));return t._reactRootContainer?(ls(function(){Au(null,null,t,!1,function(){t._reactRootContainer=null,t[jn]=null})}),!0):!1};Ht.unstable_batchedUpdates=bf;Ht.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Du(n))throw Error($(200));if(t==null||t._reactInternals===void 0)throw Error($(38));return Au(t,e,n,!1,r)};Ht.version="18.3.1-next-f1338f8080-20240426";function Jv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Jv)}catch(t){console.error(t)}}Jv(),Jy.exports=Ht;var AS=Jy.exports,Zv,cg=AS;Zv=cg.createRoot,cg.hydrateRoot;var dg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},RS=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],a=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(a&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],a=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},tE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,l=a?t[s+1]:0,u=s+2<t.length,c=u?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let m=(l&15)<<2|c>>6,y=c&63;u||(y=64,a||(m=64)),r.push(n[d],n[h],n[m],n[y])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(eE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):RS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||c==null||h==null)throw new PS;const m=i<<2|l>>4;if(r.push(m),c!==64){const y=l<<4&240|c>>2;if(r.push(y),h!==64){const E=c<<6&192|h;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class PS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const MS=function(t){const e=eE(t);return tE.encodeByteArray(e,!0)},Gl=function(t){return MS(t).replace(/\./g,"")},nE=function(t){try{return tE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=()=>OS().__FIREBASE_DEFAULTS__,LS=()=>{if(typeof process>"u"||typeof dg>"u")return;const t=dg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},FS=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&nE(t[1]);return e&&JSON.parse(e)},Lf=()=>{try{return $S()||LS()||FS()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},rE=t=>{var e,n;return(n=(e=Lf())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},US=t=>{const e=rE(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},sE=()=>{var t;return(t=Lf())===null||t===void 0?void 0:t.config},iE=t=>{var e;return(e=Lf())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zS(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Gl(JSON.stringify(n)),Gl(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(kt())}function BS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function qS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function HS(){const t=kt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function WS(){try{return typeof indexedDB=="object"}catch{return!1}}function KS(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="FirebaseError";class Xn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=GS,Object.setPrototypeOf(this,Xn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ro.prototype.create)}}class ro{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?QS(i,r):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new Xn(s,l,r)}}function QS(t,e){return t.replace(YS,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const YS=/\{\$([^}]+)}/g;function XS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ql(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],a=e[s];if(hg(i)&&hg(a)){if(!Ql(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function hg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function so(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Gi(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Qi(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function JS(t,e){const n=new ZS(t,e);return n.subscribe.bind(n)}class ZS{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");eN(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Bc),s.error===void 0&&(s.error=Bc),s.complete===void 0&&(s.complete=Bc);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function eN(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Bc(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(t){return t&&t._delegate?t._delegate:t}class us{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tN{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new VS;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(rN(e))try{this.getOrInitializeService({instanceIdentifier:Wr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Wr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Wr){return this.instances.has(e)}getOptions(e=Wr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&a.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:nN(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Wr){return this.component?this.component.multipleInstances?e:Wr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function nN(t){return t===Wr?void 0:t}function rN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new tN(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var we;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(we||(we={}));const iN={debug:we.DEBUG,verbose:we.VERBOSE,info:we.INFO,warn:we.WARN,error:we.ERROR,silent:we.SILENT},aN=we.INFO,oN={[we.DEBUG]:"log",[we.VERBOSE]:"log",[we.INFO]:"info",[we.WARN]:"warn",[we.ERROR]:"error"},lN=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=oN[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ff{constructor(e){this.name=e,this._logLevel=aN,this._logHandler=lN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in we))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?iN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,we.DEBUG,...e),this._logHandler(this,we.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,we.VERBOSE,...e),this._logHandler(this,we.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,we.INFO,...e),this._logHandler(this,we.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,we.WARN,...e),this._logHandler(this,we.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,we.ERROR,...e),this._logHandler(this,we.ERROR,...e)}}const uN=(t,e)=>e.some(n=>t instanceof n);let fg,mg;function cN(){return fg||(fg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dN(){return mg||(mg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aE=new WeakMap,oh=new WeakMap,oE=new WeakMap,qc=new WeakMap,Uf=new WeakMap;function hN(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(Sr(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&aE.set(n,t)}).catch(()=>{}),Uf.set(e,t),e}function fN(t){if(oh.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});oh.set(t,e)}let lh={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return oh.get(t);if(e==="objectStoreNames")return t.objectStoreNames||oE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Sr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function mN(t){lh=t(lh)}function pN(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Hc(this),e,...n);return oE.set(r,e.sort?e.sort():[e]),Sr(r)}:dN().includes(t)?function(...e){return t.apply(Hc(this),e),Sr(aE.get(this))}:function(...e){return Sr(t.apply(Hc(this),e))}}function gN(t){return typeof t=="function"?pN(t):(t instanceof IDBTransaction&&fN(t),uN(t,cN())?new Proxy(t,lh):t)}function Sr(t){if(t instanceof IDBRequest)return hN(t);if(qc.has(t))return qc.get(t);const e=gN(t);return e!==t&&(qc.set(t,e),Uf.set(e,t)),e}const Hc=t=>Uf.get(t);function yN(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),l=Sr(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Sr(a.result),u.oldVersion,u.newVersion,Sr(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const vN=["get","getKey","getAll","getAllKeys","count"],EN=["put","add","delete","clear"],Wc=new Map;function pg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Wc.get(e))return Wc.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=EN.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||vN.includes(n)))return;const i=async function(a,...l){const u=this.transaction(a,s?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),s&&u.done]))[0]};return Wc.set(e,i),i}mN(t=>({...t,get:(e,n,r)=>pg(e,n)||t.get(e,n,r),has:(e,n)=>!!pg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(kN(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function kN(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const uh="@firebase/app",gg="0.9.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cs=new Ff("@firebase/app"),xN="@firebase/app-compat",SN="@firebase/analytics-compat",NN="@firebase/analytics",_N="@firebase/app-check-compat",CN="@firebase/app-check",IN="@firebase/auth",TN="@firebase/auth-compat",bN="@firebase/database",DN="@firebase/database-compat",AN="@firebase/functions",RN="@firebase/functions-compat",PN="@firebase/installations",MN="@firebase/installations-compat",ON="@firebase/messaging",$N="@firebase/messaging-compat",LN="@firebase/performance",FN="@firebase/performance-compat",UN="@firebase/remote-config",VN="@firebase/remote-config-compat",zN="@firebase/storage",jN="@firebase/storage-compat",BN="@firebase/firestore",qN="@firebase/firestore-compat",HN="firebase",WN="9.23.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch="[DEFAULT]",KN={[uh]:"fire-core",[xN]:"fire-core-compat",[NN]:"fire-analytics",[SN]:"fire-analytics-compat",[CN]:"fire-app-check",[_N]:"fire-app-check-compat",[IN]:"fire-auth",[TN]:"fire-auth-compat",[bN]:"fire-rtdb",[DN]:"fire-rtdb-compat",[AN]:"fire-fn",[RN]:"fire-fn-compat",[PN]:"fire-iid",[MN]:"fire-iid-compat",[ON]:"fire-fcm",[$N]:"fire-fcm-compat",[LN]:"fire-perf",[FN]:"fire-perf-compat",[UN]:"fire-rc",[VN]:"fire-rc-compat",[zN]:"fire-gcs",[jN]:"fire-gcs-compat",[BN]:"fire-fst",[qN]:"fire-fst-compat","fire-js":"fire-js",[HN]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl=new Map,dh=new Map;function GN(t,e){try{t.container.addComponent(e)}catch(n){cs.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ui(t){const e=t.name;if(dh.has(e))return cs.debug(`There were multiple attempts to register component ${e}.`),!1;dh.set(e,t);for(const n of Yl.values())GN(n,t);return!0}function Vf(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Nr=new ro("app","Firebase",QN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new us("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Nr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xi=WN;function lE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:ch,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Nr.create("bad-app-name",{appName:String(s)});if(n||(n=sE()),!n)throw Nr.create("no-options");const i=Yl.get(s);if(i){if(Ql(n,i.options)&&Ql(r,i.config))return i;throw Nr.create("duplicate-app",{appName:s})}const a=new sN(s);for(const u of dh.values())a.addComponent(u);const l=new YN(n,r,a);return Yl.set(s,l),l}function uE(t=ch){const e=Yl.get(t);if(!e&&t===ch&&sE())return lE();if(!e)throw Nr.create("no-app",{appName:t});return e}function _r(t,e,n){var r;let s=(r=KN[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),cs.warn(l.join(" "));return}ui(new us(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XN="firebase-heartbeat-database",JN=1,Ra="firebase-heartbeat-store";let Kc=null;function cE(){return Kc||(Kc=yN(XN,JN,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ra)}}}).catch(t=>{throw Nr.create("idb-open",{originalErrorMessage:t.message})})),Kc}async function ZN(t){try{return await(await cE()).transaction(Ra).objectStore(Ra).get(dE(t))}catch(e){if(e instanceof Xn)cs.warn(e.message);else{const n=Nr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});cs.warn(n.message)}}}async function yg(t,e){try{const r=(await cE()).transaction(Ra,"readwrite");await r.objectStore(Ra).put(e,dE(t)),await r.done}catch(n){if(n instanceof Xn)cs.warn(n.message);else{const r=Nr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});cs.warn(r.message)}}}function dE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=1024,t_=30*24*60*60*1e3;class n_{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new s_(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=vg();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=t_}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=vg(),{heartbeatsToSend:n,unsentEntries:r}=r_(this._heartbeatsCache.heartbeats),s=Gl(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function vg(){return new Date().toISOString().substring(0,10)}function r_(t,e=e_){const n=[];let r=t.slice();for(const s of t){const i=n.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Eg(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Eg(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class s_{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return WS()?KS().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await ZN(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return yg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return yg(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Eg(t){return Gl(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(t){ui(new us("platform-logger",e=>new wN(e),"PRIVATE")),ui(new us("heartbeat",e=>new n_(e),"PRIVATE")),_r(uh,gg,t),_r(uh,gg,"esm2017"),_r("fire-js","")}i_("");var a_="firebase",o_="9.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_r(a_,o_,"app");function zf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function hE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const l_=hE,fE=new ro("auth","Firebase",hE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xl=new Ff("@firebase/auth");function u_(t,...e){Xl.logLevel<=we.WARN&&Xl.warn(`Auth (${xi}): ${t}`,...e)}function pl(t,...e){Xl.logLevel<=we.ERROR&&Xl.error(`Auth (${xi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(t,...e){throw jf(t,...e)}function _n(t,...e){return jf(t,...e)}function c_(t,e,n){const r=Object.assign(Object.assign({},l_()),{[e]:n});return new ro("auth","Firebase",r).create(e,{appName:t.name})}function jf(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return fE.create(t,...e)}function ne(t,e,...n){if(!t)throw jf(e,...n)}function $n(t){const e="INTERNAL ASSERTION FAILED: "+t;throw pl(e),new Error(e)}function Hn(t,e){t||$n(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function d_(){return wg()==="http:"||wg()==="https:"}function wg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(d_()||BS()||"connection"in navigator)?navigator.onLine:!0}function f_(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(e,n){this.shortDelay=e,this.longDelay=n,Hn(n>e,"Short delay should be less than long delay!"),this.isMobile=jS()||qS()}get(){return h_()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bf(t,e){Hn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mE{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;$n("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;$n("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;$n("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_=new io(3e4,6e4);function ao(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Si(t,e,n,r,s={}){return pE(t,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const l=so(Object.assign({key:t.config.apiKey},a)).slice(1),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),mE.fetch()(gE(t,t.config.apiHost,n,l),Object.assign({method:e,headers:u,referrerPolicy:"no-referrer"},i))})}async function pE(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},m_),e);try{const s=new g_(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Ko(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const l=i.ok?a.errorMessage:a.error.message,[u,c]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ko(t,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Ko(t,"email-already-in-use",a);if(u==="USER_DISABLED")throw Ko(t,"user-disabled",a);const d=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw c_(t,d,c);fn(t,d)}}catch(s){if(s instanceof Xn)throw s;fn(t,"network-request-failed",{message:String(s)})}}async function Ru(t,e,n,r,s={}){const i=await Si(t,e,n,r,s);return"mfaPendingCredential"in i&&fn(t,"multi-factor-auth-required",{_serverResponse:i}),i}function gE(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Bf(t.config,s):`${t.config.apiScheme}://${s}`}class g_{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(_n(this.auth,"network-request-failed")),p_.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ko(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=_n(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y_(t,e){return Si(t,"POST","/v1/accounts:delete",e)}async function v_(t,e){return Si(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function E_(t,e=!1){const n=Ve(t),r=await n.getIdToken(e),s=qf(r);ne(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ca(Gc(s.auth_time)),issuedAtTime:ca(Gc(s.iat)),expirationTime:ca(Gc(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Gc(t){return Number(t)*1e3}function qf(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return pl("JWT malformed, contained fewer than 3 sections"),null;try{const s=nE(n);return s?JSON.parse(s):(pl("Failed to decode base64 JWT payload"),null)}catch(s){return pl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function w_(t){const e=qf(t);return ne(e,"internal-error"),ne(typeof e.exp<"u","internal-error"),ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pa(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Xn&&k_(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function k_({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yE{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ca(this.lastLoginAt),this.creationTime=ca(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jl(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Pa(t,v_(n,{idToken:r}));ne(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?__(i.providerUserInfo):[],l=N_(t.providerData,a),u=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=u?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new yE(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function S_(t){const e=Ve(t);await Jl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function N_(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function __(t){return t.map(e=>{var{providerId:n}=e,r=zf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C_(t,e){const n=await pE(t,{},async()=>{const r=so({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=gE(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",mE.fetch()(a,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ne(e.idToken,"internal-error"),ne(typeof e.idToken<"u","internal-error"),ne(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):w_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return ne(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await C_(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,a=new Ma;return r&&(ne(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(ne(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(ne(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ma,this.toJSON())}_performRefresh(){return $n("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(t,e){ne(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ts{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=zf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new x_(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new yE(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Pa(this,this.stsTokenManager.getToken(this.auth,e));return ne(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return E_(this,e)}reload(){return S_(this)}_assign(e){this!==e&&(ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ts(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Jl(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Pa(this,y_(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,a,l,u,c,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(s=n.email)!==null&&s!==void 0?s:void 0,y=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,E=(a=n.photoURL)!==null&&a!==void 0?a:void 0,v=(l=n.tenantId)!==null&&l!==void 0?l:void 0,w=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,f=(c=n.createdAt)!==null&&c!==void 0?c:void 0,p=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:g,emailVerified:k,isAnonymous:_,providerData:C,stsTokenManager:P}=n;ne(g&&P,e,"internal-error");const M=Ma.fromJSON(this.name,P);ne(typeof g=="string",e,"internal-error"),tr(h,e.name),tr(m,e.name),ne(typeof k=="boolean",e,"internal-error"),ne(typeof _=="boolean",e,"internal-error"),tr(y,e.name),tr(E,e.name),tr(v,e.name),tr(w,e.name),tr(f,e.name),tr(p,e.name);const X=new ts({uid:g,auth:e,email:m,emailVerified:k,displayName:h,isAnonymous:_,photoURL:E,phoneNumber:y,tenantId:v,stsTokenManager:M,createdAt:f,lastLoginAt:p});return C&&Array.isArray(C)&&(X.providerData=C.map(A=>Object.assign({},A))),w&&(X._redirectEventId=w),X}static async _fromIdTokenResponse(e,n,r=!1){const s=new Ma;s.updateFromServerResponse(n);const i=new ts({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Jl(i),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kg=new Map;function Ln(t){Hn(t instanceof Function,"Expected a class definition");let e=kg.get(t);return e?(Hn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,kg.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}vE.type="NONE";const xg=vE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gl(t,e,n){return`firebase:${t}:${e}:${n}`}class Qs{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=gl(this.userKey,s.apiKey,i),this.fullPersistenceKey=gl("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ts._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Qs(Ln(xg),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Ln(xg);const a=gl(r,e.config.apiKey,e.name);let l=null;for(const c of n)try{const d=await c._get(a);if(d){const h=ts._fromJSON(e,d);c!==i&&(l=h),i=c;break}}catch{}const u=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Qs(i,e,r):(i=u[0],l&&await i._set(a,l.toJSON()),await Promise.all(n.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new Qs(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sg(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(kE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(EE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(SE(e))return"Blackberry";if(NE(e))return"Webos";if(Hf(e))return"Safari";if((e.includes("chrome/")||wE(e))&&!e.includes("edge/"))return"Chrome";if(xE(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function EE(t=kt()){return/firefox\//i.test(t)}function Hf(t=kt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wE(t=kt()){return/crios\//i.test(t)}function kE(t=kt()){return/iemobile/i.test(t)}function xE(t=kt()){return/android/i.test(t)}function SE(t=kt()){return/blackberry/i.test(t)}function NE(t=kt()){return/webos/i.test(t)}function Pu(t=kt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function I_(t=kt()){var e;return Pu(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function T_(){return HS()&&document.documentMode===10}function _E(t=kt()){return Pu(t)||xE(t)||NE(t)||SE(t)||/windows phone/i.test(t)||kE(t)}function b_(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CE(t,e=[]){let n;switch(t){case"Browser":n=Sg(kt());break;case"Worker":n=`${Sg(kt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${xi}/${r}`}async function IE(t,e){return Si(t,"GET","/v2/recaptchaConfig",ao(t,e))}function Ng(t){return t!==void 0&&t.enterprise!==void 0}class TE{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(n=>n.provider==="EMAIL_PASSWORD_PROVIDER"&&n.enforcementState!=="OFF")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function bE(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=_n("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",D_().appendChild(r)})}function A_(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const R_="https://www.google.com/recaptcha/enterprise.js?render=",P_="recaptcha-enterprise",M_="NO_RECAPTCHA";class DE{constructor(e){this.type=P_,this.auth=oo(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,l)=>{IE(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const c=new TE(u);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,a(c.siteKey)}}).catch(u=>{l(u)})})}function s(i,a,l){const u=window.grecaptcha;Ng(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(c=>{a(c)}).catch(()=>{a(M_)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,a)=>{r(this.auth).then(l=>{if(!n&&Ng(window.grecaptcha))s(l,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}bE(R_+l).then(()=>{s(l,i,a)}).catch(u=>{a(u)})}}).catch(l=>{a(l)})})}}async function _g(t,e,n,r=!1){const s=new DE(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:i}):Object.assign(a,{captchaResponse:i}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O_{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((a,l)=>{try{const u=e(i);a(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Cg(this),this.idTokenSubscription=new Cg(this),this.beforeStateQueue=new O_(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ln(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Qs.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!a||a===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Jl(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=f_()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?Ve(e):null;return n&&ne(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Ln(e))})}async initializeRecaptchaConfig(){const e=await IE(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new TE(e);this.tenantId==null?this._agentRecaptchaConfig=n:this._tenantRecaptchaConfigs[this.tenantId]=n,n.emailPasswordEnabled&&new DE(this).verify()}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ro("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ln(e)||this._popupRedirectResolver;ne(n,this,"argument-error"),this.redirectPersistenceManager=await Qs.create(this,[Ln(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n),a=this._isInitialized?Promise.resolve():this._initializationPromise;return ne(a,this,"internal-error"),a.then(()=>i(this.currentUser)),typeof n=="function"?e.addObserver(n,r,s):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=CE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&u_(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function oo(t){return Ve(t)}class Cg{constructor(e){this.auth=e,this.observer=null,this.addObserver=JS(n=>this.observer=n)}get next(){return ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(t,e){const n=Vf(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Ql(i,e??{}))return s;fn(s,"already-initialized")}return n.initialize({options:e})}function F_(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Ln);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function U_(t,e,n){const r=oo(t);ne(r._canInitEmulator,r,"emulator-config-failed"),ne(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=AE(e),{host:a,port:l}=V_(e),u=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${a}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),z_()}function AE(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function V_(t){const e=AE(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Ig(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Ig(a)}}}function Ig(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function z_(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return $n("not implemented")}_getIdTokenResponse(e){return $n("not implemented")}_linkToIdToken(e,n){return $n("not implemented")}_getReauthenticationResolver(e){return $n("not implemented")}}async function j_(t,e){return Si(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qc(t,e){return Ru(t,"POST","/v1/accounts:signInWithPassword",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B_(t,e){return Ru(t,"POST","/v1/accounts:signInWithEmailLink",ao(t,e))}async function q_(t,e){return Ru(t,"POST","/v1/accounts:signInWithEmailLink",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa extends Wf{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Oa(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Oa(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){var n;switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(!((n=e._getRecaptchaConfig())===null||n===void 0)&&n.emailPasswordEnabled){const s=await _g(e,r,"signInWithPassword");return Qc(e,s)}else return Qc(e,r).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const i=await _g(e,r,"signInWithPassword");return Qc(e,i)}else return Promise.reject(s)});case"emailLink":return B_(e,{email:this._email,oobCode:this._password});default:fn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return j_(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return q_(e,{idToken:n,email:this._email,oobCode:this._password});default:fn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ys(t,e){return Ru(t,"POST","/v1/accounts:signInWithIdp",ao(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H_="http://localhost";class ds extends Wf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ds(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):fn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=zf(n,["providerId","signInMethod"]);if(!r||!s)return null;const a=new ds(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const n=this.buildRequest();return Ys(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ys(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ys(e,n)}buildRequest(){const e={requestUri:H_,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=so(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W_(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function K_(t){const e=Gi(Qi(t)).link,n=e?Gi(Qi(e)).deep_link_id:null,r=Gi(Qi(t)).deep_link_id;return(r?Gi(Qi(r)).link:null)||r||n||e||t}class Kf{constructor(e){var n,r,s,i,a,l;const u=Gi(Qi(e)),c=(n=u.apiKey)!==null&&n!==void 0?n:null,d=(r=u.oobCode)!==null&&r!==void 0?r:null,h=W_((s=u.mode)!==null&&s!==void 0?s:null);ne(c&&d&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=d,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(a=u.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(l=u.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=K_(e);try{return new Kf(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(){this.providerId=Ni.PROVIDER_ID}static credential(e,n){return Oa._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Kf.parseLink(n);return ne(r,"argument-error"),Oa._fromEmailAndCode(e,r.code,r.tenantId)}}Ni.PROVIDER_ID="password";Ni.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ni.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo extends RE{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or extends lo{constructor(){super("facebook.com")}static credential(e){return ds._fromParams({providerId:or.PROVIDER_ID,signInMethod:or.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return or.credentialFromTaggedObject(e)}static credentialFromError(e){return or.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return or.credential(e.oauthAccessToken)}catch{return null}}}or.FACEBOOK_SIGN_IN_METHOD="facebook.com";or.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr extends lo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ds._fromParams({providerId:lr.PROVIDER_ID,signInMethod:lr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return lr.credentialFromTaggedObject(e)}static credentialFromError(e){return lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return lr.credential(n,r)}catch{return null}}}lr.GOOGLE_SIGN_IN_METHOD="google.com";lr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur extends lo{constructor(){super("github.com")}static credential(e){return ds._fromParams({providerId:ur.PROVIDER_ID,signInMethod:ur.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ur.credentialFromTaggedObject(e)}static credentialFromError(e){return ur.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ur.credential(e.oauthAccessToken)}catch{return null}}}ur.GITHUB_SIGN_IN_METHOD="github.com";ur.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr extends lo{constructor(){super("twitter.com")}static credential(e,n){return ds._fromParams({providerId:cr.PROVIDER_ID,signInMethod:cr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return cr.credentialFromTaggedObject(e)}static credentialFromError(e){return cr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return cr.credential(n,r)}catch{return null}}}cr.TWITTER_SIGN_IN_METHOD="twitter.com";cr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await ts._fromIdTokenResponse(e,r,s),a=Tg(r);return new ci({user:i,providerId:a,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Tg(r);return new ci({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Tg(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl extends Xn{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Zl.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Zl(e,n,r,s)}}function PE(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Zl._fromErrorAndOperation(t,i,e,r):i})}async function G_(t,e,n=!1){const r=await Pa(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ci._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q_(t,e,n=!1){const{auth:r}=t,s="reauthenticate";try{const i=await Pa(t,PE(r,s,e,t),n);ne(i.idToken,r,"internal-error");const a=qf(i.idToken);ne(a,r,"internal-error");const{sub:l}=a;return ne(t.uid===l,r,"user-mismatch"),ci._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&fn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ME(t,e,n=!1){const r="signIn",s=await PE(t,r,e),i=await ci._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Y_(t,e){return ME(oo(t),e)}function X_(t,e,n){return Y_(Ve(t),Ni.credential(e,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(t,e){return Ve(t).setPersistence(e)}function J_(t,e,n,r){return Ve(t).onIdTokenChanged(e,n,r)}function Z_(t,e,n){return Ve(t).beforeAuthStateChanged(e,n)}function eC(t,e,n,r){return Ve(t).onAuthStateChanged(e,n,r)}function yl(t){return Ve(t).signOut()}const eu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(eu,"1"),this.storage.removeItem(eu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tC(){const t=kt();return Hf(t)||Pu(t)}const nC=1e3,rC=10;class LE extends $E{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=tC()&&b_(),this.fallbackToPolling=_E(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((a,l,u)=>{this.notifyListeners(a,u)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(r);if(e.newValue!==a)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const s=()=>{const a=this.storage.getItem(r);!n&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);T_()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,rC):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},nC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}LE.type="LOCAL";const FE=LE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE extends $E{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}UE.type="SESSION";const Mu=UE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Ou(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(a).map(async c=>c(n.origin,i)),u=await sC(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ou.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gf(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((l,u)=>{const c=Gf("",20);s.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(h){const m=h;if(m.data.eventId===c)switch(m.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(m.data.response);break;default:clearTimeout(d),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cn(){return window}function aC(t){Cn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VE(){return typeof Cn().WorkerGlobalScope<"u"&&typeof Cn().importScripts=="function"}async function oC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function lC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function uC(){return VE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE="firebaseLocalStorageDb",cC=1,tu="firebaseLocalStorage",jE="fbase_key";class uo{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function $u(t,e){return t.transaction([tu],e?"readwrite":"readonly").objectStore(tu)}function dC(){const t=indexedDB.deleteDatabase(zE);return new uo(t).toPromise()}function fh(){const t=indexedDB.open(zE,cC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(tu,{keyPath:jE})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(tu)?e(r):(r.close(),await dC(),e(await fh()))})})}async function bg(t,e,n){const r=$u(t,!0).put({[jE]:e,value:n});return new uo(r).toPromise()}async function hC(t,e){const n=$u(t,!1).get(e),r=await new uo(n).toPromise();return r===void 0?null:r.value}function Dg(t,e){const n=$u(t,!0).delete(e);return new uo(n).toPromise()}const fC=800,mC=3;class BE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>mC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return VE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ou._getInstance(uC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await oC(),!this.activeServiceWorker)return;this.sender=new iC(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||lC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fh();return await bg(e,eu,"1"),await Dg(e,eu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>bg(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>hC(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Dg(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=$u(s,!1).getAll();return new uo(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),fC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}BE.type="LOCAL";const pC=BE;new io(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(t,e){return e?Ln(e):(ne(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf extends Wf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ys(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ys(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ys(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function yC(t){return ME(t.auth,new Qf(t),t.bypassAuthState)}function vC(t){const{auth:e,user:n}=t;return ne(n,e,"internal-error"),Q_(n,new Qf(t),t.bypassAuthState)}async function EC(t){const{auth:e,user:n}=t;return ne(n,e,"internal-error"),G_(n,new Qf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:a,type:l}=e;if(a){this.reject(a);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return yC;case"linkViaPopup":case"linkViaRedirect":return EC;case"reauthViaPopup":case"reauthViaRedirect":return vC;default:fn(this.auth,"internal-error")}}resolve(e){Hn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Hn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wC=new io(2e3,1e4);class zs extends qE{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,zs.currentPopupAction&&zs.currentPopupAction.cancel(),zs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ne(e,this.auth,"internal-error"),e}async onExecution(){Hn(this.filter.length===1,"Popup operations only handle one event");const e=Gf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(_n(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_n(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_n(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,wC.get())};e()}}zs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC="pendingRedirect",vl=new Map;class xC extends qE{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=vl.get(this.auth._key());if(!e){try{const r=await SC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}vl.set(this.auth._key(),e)}return this.bypassAuthState||vl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function SC(t,e){const n=CC(e),r=_C(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function NC(t,e){vl.set(t._key(),e)}function _C(t){return Ln(t._redirectPersistence)}function CC(t){return gl(kC,t.config.apiKey,t.name)}async function IC(t,e,n=!1){const r=oo(t),s=gC(r,e),a=await new xC(r,s,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TC=10*60*1e3;class bC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!DC(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!HE(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(_n(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=TC&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ag(e))}saveEventToCache(e){this.cachedEventUids.add(Ag(e)),this.lastProcessedEventTime=Date.now()}}function Ag(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function HE({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function DC(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return HE(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AC(t,e={}){return Si(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,PC=/^https?/;async function MC(t){if(t.config.emulator)return;const{authorizedDomains:e}=await AC(t);for(const n of e)try{if(OC(n))return}catch{}fn(t,"unauthorized-domain")}function OC(t){const e=hh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&a.hostname===r}if(!PC.test(n))return!1;if(RC.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C=new io(3e4,6e4);function Rg(){const t=Cn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function LC(t){return new Promise((e,n)=>{var r,s,i;function a(){Rg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Rg(),n(_n(t,"network-request-failed"))},timeout:$C.get()})}if(!((s=(r=Cn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Cn().gapi)===null||i===void 0)&&i.load)a();else{const l=A_("iframefcb");return Cn()[l]=()=>{gapi.load?a():n(_n(t,"network-request-failed"))},bE(`https://apis.google.com/js/api.js?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw El=null,e})}let El=null;function FC(t){return El=El||LC(t),El}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=new io(5e3,15e3),VC="__/auth/iframe",zC="emulator/auth/iframe",jC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},BC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function qC(t){const e=t.config;ne(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Bf(e,zC):`https://${t.config.authDomain}/${VC}`,r={apiKey:e.apiKey,appName:t.name,v:xi},s=BC.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${so(r).slice(1)}`}async function HC(t){const e=await FC(t),n=Cn().gapi;return ne(n,t,"internal-error"),e.open({where:document.body,url:qC(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jC,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=_n(t,"network-request-failed"),l=Cn().setTimeout(()=>{i(a)},UC.get());function u(){Cn().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},KC=500,GC=600,QC="_blank",YC="http://localhost";class Pg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function XC(t,e,n,r=KC,s=GC){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},WC),{width:r.toString(),height:s.toString(),top:i,left:a}),c=kt().toLowerCase();n&&(l=wE(c)?QC:n),EE(c)&&(e=e||YC,u.scrollbars="yes");const d=Object.entries(u).reduce((m,[y,E])=>`${m}${y}=${E},`,"");if(I_(c)&&l!=="_self")return JC(e||"",l),new Pg(null);const h=window.open(e||"",l,d);ne(h,t,"popup-blocked");try{h.focus()}catch{}return new Pg(h)}function JC(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZC="__/auth/handler",eI="emulator/auth/handler",tI=encodeURIComponent("fac");async function Mg(t,e,n,r,s,i){ne(t.config.authDomain,t,"auth-domain-config-required"),ne(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:xi,eventId:s};if(e instanceof RE){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",XS(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))a[d]=h}if(e instanceof lo){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(a.scopes=d.join(","))}t.tenantId&&(a.tid=t.tenantId);const l=a;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const u=await t._getAppCheckToken(),c=u?`#${tI}=${encodeURIComponent(u)}`:"";return`${nI(t)}?${so(l).slice(1)}${c}`}function nI({config:t}){return t.emulator?Bf(t,eI):`https://${t.authDomain}/${ZC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yc="webStorageSupport";class rI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Mu,this._completeRedirectFn=IC,this._overrideRedirectResult=NC}async _openPopup(e,n,r,s){var i;Hn((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await Mg(e,n,r,hh(),s);return XC(e,a,Gf())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Mg(e,n,r,hh(),s);return aC(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Hn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await HC(e),r=new bC(e);return n.register("authEvent",s=>(ne(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Yc,{type:Yc},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Yc];a!==void 0&&n(!!a),fn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=MC(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return _E()||Hf()||Pu()}}const sI=rI;var Og="@firebase/auth",$g="0.23.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function oI(t){ui(new us("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=r.options;ne(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:a,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:CE(t)},c=new $_(r,s,i,u);return F_(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ui(new us("auth-internal",e=>{const n=oo(e.getProvider("auth").getImmediate());return(r=>new iI(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),_r(Og,$g,aI(t)),_r(Og,$g,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI=5*60,uI=iE("authIdTokenMaxAge")||lI;let Lg=null;const cI=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>uI)return;const s=n==null?void 0:n.token;Lg!==s&&(Lg=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function dI(t=uE()){const e=Vf(t,"auth");if(e.isInitialized())return e.getImmediate();const n=L_(t,{popupRedirectResolver:sI,persistence:[pC,FE,Mu]}),r=iE("authTokenSyncURL");if(r){const i=cI(r);Z_(n,i,()=>i(n.currentUser)),J_(n,a=>i(a))}const s=rE("auth");return s&&U_(n,`http://${s}`),n}oI("Browser");var hI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},z,Yf=Yf||{},se=hI||self;function Lu(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Fu(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function fI(t,e,n){return t.call.apply(t.bind,arguments)}function mI(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function gt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?gt=fI:gt=mI,gt.apply(null,arguments)}function Go(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function nt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,s,i){for(var a=Array(arguments.length-2),l=2;l<arguments.length;l++)a[l-2]=arguments[l];return e.prototype[s].apply(r,a)}}function Lr(){this.s=this.s,this.o=this.o}var pI=0;Lr.prototype.s=!1;Lr.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),pI!=0)};Lr.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const WE=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Xf(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Fg(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Lu(r)){const s=t.length||0,i=r.length||0;t.length=s+i;for(let a=0;a<i;a++)t[s+a]=r[a]}else t.push(r)}}function yt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}yt.prototype.h=function(){this.defaultPrevented=!0};var gI=function(){if(!se.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{se.addEventListener("test",()=>{},e),se.removeEventListener("test",()=>{},e)}catch{}return t}();function $a(t){return/^[\s\xa0]*$/.test(t)}function Uu(){var t=se.navigator;return t&&(t=t.userAgent)?t:""}function wn(t){return Uu().indexOf(t)!=-1}function Jf(t){return Jf[" "](t),t}Jf[" "]=function(){};function yI(t,e){var n=cT;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var vI=wn("Opera"),di=wn("Trident")||wn("MSIE"),KE=wn("Edge"),mh=KE||di,GE=wn("Gecko")&&!(Uu().toLowerCase().indexOf("webkit")!=-1&&!wn("Edge"))&&!(wn("Trident")||wn("MSIE"))&&!wn("Edge"),EI=Uu().toLowerCase().indexOf("webkit")!=-1&&!wn("Edge");function QE(){var t=se.document;return t?t.documentMode:void 0}var ph;e:{var Xc="",Jc=function(){var t=Uu();if(GE)return/rv:([^\);]+)(\)|;)/.exec(t);if(KE)return/Edge\/([\d\.]+)/.exec(t);if(di)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(EI)return/WebKit\/(\S+)/.exec(t);if(vI)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Jc&&(Xc=Jc?Jc[1]:""),di){var Zc=QE();if(Zc!=null&&Zc>parseFloat(Xc)){ph=String(Zc);break e}}ph=Xc}var gh;if(se.document&&di){var Ug=QE();gh=Ug||parseInt(ph,10)||void 0}else gh=void 0;var wI=gh;function La(t,e){if(yt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(GE){e:{try{Jf(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:kI[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&La.$.h.call(this)}}nt(La,yt);var kI={2:"touch",3:"pen",4:"mouse"};La.prototype.h=function(){La.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Vu="closure_listenable_"+(1e6*Math.random()|0),xI=0;function SI(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=s,this.key=++xI,this.fa=this.ia=!1}function zu(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Zf(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function NI(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function YE(t){const e={};for(const n in t)e[n]=t[n];return e}const Vg="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function XE(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<Vg.length;i++)n=Vg[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ju(t){this.src=t,this.g={},this.h=0}ju.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var a=vh(t,e,r,s);return-1<a?(e=t[a],n||(e.ia=!1)):(e=new SI(e,this.src,i,!!r,s),e.ia=n,t.push(e)),e};function yh(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=WE(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(zu(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function vh(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.fa&&i.listener==e&&i.capture==!!n&&i.la==r)return s}return-1}var em="closure_lm_"+(1e6*Math.random()|0),ed={};function JE(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)JE(t,e[i],n,r,s);return null}return n=tw(n),t&&t[Vu]?t.O(e,n,Fu(r)?!!r.capture:!1,s):_I(t,e,n,!1,r,s)}function _I(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var a=Fu(s)?!!s.capture:!!s,l=nm(t);if(l||(t[em]=l=new ju(t)),n=l.add(e,n,r,a,i),n.proxy)return n;if(r=CI(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)gI||(s=a),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(ew(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function CI(){function t(n){return e.call(t.src,t.listener,n)}const e=II;return t}function ZE(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)ZE(t,e[i],n,r,s);else r=Fu(r)?!!r.capture:!!r,n=tw(n),t&&t[Vu]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=vh(i,n,r,s),-1<n&&(zu(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=nm(t))&&(e=t.g[e.toString()],t=-1,e&&(t=vh(e,n,r,s)),(n=-1<t?e[t]:null)&&tm(n))}function tm(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Vu])yh(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(ew(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=nm(e))?(yh(n,t),n.h==0&&(n.src=null,e[em]=null)):zu(t)}}}function ew(t){return t in ed?ed[t]:ed[t]="on"+t}function II(t,e){if(t.fa)t=!0;else{e=new La(e,this);var n=t.listener,r=t.la||t.src;t.ia&&tm(t),t=n.call(r,e)}return t}function nm(t){return t=t[em],t instanceof ju?t:null}var td="__closure_events_fn_"+(1e9*Math.random()>>>0);function tw(t){return typeof t=="function"?t:(t[td]||(t[td]=function(e){return t.handleEvent(e)}),t[td])}function tt(){Lr.call(this),this.i=new ju(this),this.S=this,this.J=null}nt(tt,Lr);tt.prototype[Vu]=!0;tt.prototype.removeEventListener=function(t,e,n,r){ZE(this,t,e,n,r)};function ot(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new yt(e,t);else if(e instanceof yt)e.target=e.target||t;else{var s=e;e=new yt(r,t),XE(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var a=e.g=n[i];s=Qo(a,r,!0,e)&&s}if(a=e.g=t,s=Qo(a,r,!0,e)&&s,s=Qo(a,r,!1,e)&&s,n)for(i=0;i<n.length;i++)a=e.g=n[i],s=Qo(a,r,!1,e)&&s}tt.prototype.N=function(){if(tt.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)zu(n[r]);delete t.g[e],t.h--}}this.J=null};tt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};tt.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Qo(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var a=e[i];if(a&&!a.fa&&a.capture==n){var l=a.listener,u=a.la||a.src;a.ia&&yh(t.i,a),s=l.call(u,r)!==!1&&s}}return s&&!r.defaultPrevented}var rm=se.JSON.stringify;class TI{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function bI(){var t=sm;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class DI{constructor(){this.h=this.g=null}add(e,n){const r=nw.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var nw=new TI(()=>new AI,t=>t.reset());class AI{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function RI(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function PI(t){se.setTimeout(()=>{throw t},0)}let Fa,Ua=!1,sm=new DI,rw=()=>{const t=se.Promise.resolve(void 0);Fa=()=>{t.then(MI)}};var MI=()=>{for(var t;t=bI();){try{t.h.call(t.g)}catch(n){PI(n)}var e=nw;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Ua=!1};function Bu(t,e){tt.call(this),this.h=t||1,this.g=e||se,this.j=gt(this.qb,this),this.l=Date.now()}nt(Bu,tt);z=Bu.prototype;z.ga=!1;z.T=null;z.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ot(this,"tick"),this.ga&&(im(this),this.start()))}};z.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function im(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}z.N=function(){Bu.$.N.call(this),im(this),delete this.g};function am(t,e,n){if(typeof t=="function")n&&(t=gt(t,n));else if(t&&typeof t.handleEvent=="function")t=gt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:se.setTimeout(t,e||0)}function sw(t){t.g=am(()=>{t.g=null,t.i&&(t.i=!1,sw(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class OI extends Lr{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:sw(this)}N(){super.N(),this.g&&(se.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Va(t){Lr.call(this),this.h=t,this.g={}}nt(Va,Lr);var zg=[];function iw(t,e,n,r){Array.isArray(n)||(n&&(zg[0]=n.toString()),n=zg);for(var s=0;s<n.length;s++){var i=JE(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function aw(t){Zf(t.g,function(e,n){this.g.hasOwnProperty(n)&&tm(e)},t),t.g={}}Va.prototype.N=function(){Va.$.N.call(this),aw(this)};Va.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function qu(){this.g=!0}qu.prototype.Ea=function(){this.g=!1};function $I(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var a="",l=i.split("&"),u=0;u<l.length;u++){var c=l[u].split("=");if(1<c.length){var d=c[0];c=c[1];var h=d.split("_");a=2<=h.length&&h[1]=="type"?a+(d+"="+c+"&"):a+(d+"=redacted&")}}else a=null;else a=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+a})}function LI(t,e,n,r,s,i,a){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+a})}function js(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+UI(t,n)+(r?" "+r:"")})}function FI(t,e){t.info(function(){return"TIMEOUT: "+e})}qu.prototype.info=function(){};function UI(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var a=1;a<s.length;a++)s[a]=""}}}}return rm(n)}catch{return e}}var vs={},jg=null;function Hu(){return jg=jg||new tt}vs.Ta="serverreachability";function ow(t){yt.call(this,vs.Ta,t)}nt(ow,yt);function za(t){const e=Hu();ot(e,new ow(e))}vs.STAT_EVENT="statevent";function lw(t,e){yt.call(this,vs.STAT_EVENT,t),this.stat=e}nt(lw,yt);function Nt(t){const e=Hu();ot(e,new lw(e,t))}vs.Ua="timingevent";function uw(t,e){yt.call(this,vs.Ua,t),this.size=e}nt(uw,yt);function co(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return se.setTimeout(function(){t()},e)}var Wu={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},cw={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function om(){}om.prototype.h=null;function Bg(t){return t.h||(t.h=t.i())}function dw(){}var ho={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function lm(){yt.call(this,"d")}nt(lm,yt);function um(){yt.call(this,"c")}nt(um,yt);var Eh;function Ku(){}nt(Ku,om);Ku.prototype.g=function(){return new XMLHttpRequest};Ku.prototype.i=function(){return{}};Eh=new Ku;function fo(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Va(this),this.P=VI,t=mh?125:void 0,this.V=new Bu(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new hw}function hw(){this.i=null,this.g="",this.h=!1}var VI=45e3,wh={},nu={};z=fo.prototype;z.setTimeout=function(t){this.P=t};function kh(t,e,n){t.L=1,t.v=Qu(Wn(e)),t.s=n,t.S=!0,fw(t,null)}function fw(t,e){t.G=Date.now(),mo(t),t.A=Wn(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),kw(n.i,"t",r),t.C=0,n=t.l.J,t.h=new hw,t.g=jw(t.l,n?e:null,!t.s),0<t.O&&(t.M=new OI(gt(t.Pa,t,t.g),t.O)),iw(t.U,t.g,"readystatechange",t.nb),e=t.I?YE(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),za(),$I(t.j,t.u,t.A,t.m,t.W,t.s)}z.nb=function(t){t=t.target;const e=this.M;e&&kn(t)==3?e.l():this.Pa(t)};z.Pa=function(t){try{if(t==this.g)e:{const d=kn(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>d)&&(d!=3||mh||this.g&&(this.h.h||this.g.ja()||Kg(this.g)))){this.J||d!=4||e==7||(e==8||0>=h?za(3):za(2)),Gu(this);var n=this.g.da();this.ca=n;t:if(mw(this)){var r=Kg(this.g);t="";var s=r.length,i=kn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Yr(this),da(this);var a="";break t}this.h.i=new se.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,a=this.h.g}else a=this.g.ja();if(this.i=n==200,LI(this.j,this.u,this.A,this.m,this.W,d,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var l,u=this.g;if((l=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$a(l)){var c=l;break t}}c=null}if(n=c)js(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,xh(this,n);else{this.i=!1,this.o=3,Nt(12),Yr(this),da(this);break e}}this.S?(pw(this,d,a),mh&&this.i&&d==3&&(iw(this.U,this.V,"tick",this.mb),this.V.start())):(js(this.j,this.m,a,null),xh(this,a)),d==4&&Yr(this),this.i&&!this.J&&(d==4?Fw(this.l,this):(this.i=!1,mo(this)))}else oT(this.g),n==400&&0<a.indexOf("Unknown SID")?(this.o=3,Nt(12)):(this.o=0,Nt(13)),Yr(this),da(this)}}}catch{}finally{}};function mw(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function pw(t,e,n){let r=!0,s;for(;!t.J&&t.C<n.length;)if(s=zI(t,n),s==nu){e==4&&(t.o=4,Nt(14),r=!1),js(t.j,t.m,null,"[Incomplete Response]");break}else if(s==wh){t.o=4,Nt(15),js(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else js(t.j,t.m,s,null),xh(t,s);mw(t)&&s!=nu&&s!=wh&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,Nt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),pm(e),e.M=!0,Nt(11))):(js(t.j,t.m,n,"[Invalid Chunked Response]"),Yr(t),da(t))}z.mb=function(){if(this.g){var t=kn(this.g),e=this.g.ja();this.C<e.length&&(Gu(this),pw(this,t,e),this.i&&t!=4&&mo(this))}};function zI(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?nu:(n=Number(e.substring(n,r)),isNaN(n)?wh:(r+=1,r+n>e.length?nu:(e=e.slice(r,r+n),t.C=r+n,e)))}z.cancel=function(){this.J=!0,Yr(this)};function mo(t){t.Y=Date.now()+t.P,gw(t,t.P)}function gw(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=co(gt(t.lb,t),e)}function Gu(t){t.B&&(se.clearTimeout(t.B),t.B=null)}z.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(FI(this.j,this.A),this.L!=2&&(za(),Nt(17)),Yr(this),this.o=2,da(this)):gw(this,this.Y-t)};function da(t){t.l.H==0||t.J||Fw(t.l,t)}function Yr(t){Gu(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,im(t.V),aw(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function xh(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Sh(n.i,t))){if(!t.K&&Sh(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)iu(n),Ju(n);else break e;mm(n),Nt(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&n.A==0&&!n.v&&(n.v=co(gt(n.ib,n),6e3));if(1>=Nw(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Xr(n,11)}else if((t.K||n.g==t)&&iu(n),!$a(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let c=s[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];const d=c[3];d!=null&&(n.ra=d,n.l.info("VER="+n.ra));const h=c[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const m=c[5];m!=null&&typeof m=="number"&&0<m&&(r=1.5*m,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const y=t.g;if(y){const E=y.g?y.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(E){var i=r.i;i.g||E.indexOf("spdy")==-1&&E.indexOf("quic")==-1&&E.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(cm(i,i.h),i.h=null))}if(r.F){const v=y.g?y.g.getResponseHeader("X-HTTP-Session-Id"):null;v&&(r.Da=v,be(r.I,r.F,v))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var a=t;if(r.wa=zw(r,r.J?r.pa:null,r.Y),a.K){_w(r.i,a);var l=a,u=r.L;u&&l.setTimeout(u),l.B&&(Gu(l),mo(l)),r.g=a}else $w(r);0<n.j.length&&Zu(n)}else c[0]!="stop"&&c[0]!="close"||Xr(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Xr(n,7):fm(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}za(4)}catch{}}function jI(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Lu(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function BI(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Lu(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function yw(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Lu(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=BI(t),r=jI(t),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}var vw=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qI(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function ns(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof ns){this.h=t.h,ru(this,t.j),this.s=t.s,this.g=t.g,su(this,t.m),this.l=t.l;var e=t.i,n=new ja;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),qg(this,n),this.o=t.o}else t&&(e=String(t).match(vw))?(this.h=!1,ru(this,e[1]||"",!0),this.s=Yi(e[2]||""),this.g=Yi(e[3]||"",!0),su(this,e[4]),this.l=Yi(e[5]||"",!0),qg(this,e[6]||"",!0),this.o=Yi(e[7]||"")):(this.h=!1,this.i=new ja(null,this.h))}ns.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Xi(e,Hg,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Xi(e,Hg,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Xi(n,n.charAt(0)=="/"?KI:WI,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Xi(n,QI)),t.join("")};function Wn(t){return new ns(t)}function ru(t,e,n){t.j=n?Yi(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function su(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function qg(t,e,n){e instanceof ja?(t.i=e,YI(t.i,t.h)):(n||(e=Xi(e,GI)),t.i=new ja(e,t.h))}function be(t,e,n){t.i.set(e,n)}function Qu(t){return be(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Yi(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Xi(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,HI),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function HI(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Hg=/[#\/\?@]/g,WI=/[#\?:]/g,KI=/[#\?]/g,GI=/[#\?@]/g,QI=/#/g;function ja(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Fr(t){t.g||(t.g=new Map,t.h=0,t.i&&qI(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}z=ja.prototype;z.add=function(t,e){Fr(this),this.i=null,t=_i(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function Ew(t,e){Fr(t),e=_i(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function ww(t,e){return Fr(t),e=_i(t,e),t.g.has(e)}z.forEach=function(t,e){Fr(this),this.g.forEach(function(n,r){n.forEach(function(s){t.call(e,s,r,this)},this)},this)};z.ta=function(){Fr(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let i=0;i<s.length;i++)n.push(e[r])}return n};z.Z=function(t){Fr(this);let e=[];if(typeof t=="string")ww(this,t)&&(e=e.concat(this.g.get(_i(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};z.set=function(t,e){return Fr(this),this.i=null,t=_i(this,t),ww(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};z.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function kw(t,e,n){Ew(t,e),0<n.length&&(t.i=null,t.g.set(_i(t,e),Xf(n)),t.h+=n.length)}z.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const i=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var s=i;a[r]!==""&&(s+="="+encodeURIComponent(String(a[r]))),t.push(s)}}return this.i=t.join("&")};function _i(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function YI(t,e){e&&!t.j&&(Fr(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(Ew(this,r),kw(this,s,n))},t)),t.j=e}var XI=class{constructor(t,e){this.g=t,this.map=e}};function xw(t){this.l=t||JI,se.PerformanceNavigationTiming?(t=se.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(se.g&&se.g.Ka&&se.g.Ka()&&se.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var JI=10;function Sw(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function Nw(t){return t.h?1:t.g?t.g.size:0}function Sh(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function cm(t,e){t.g?t.g.add(e):t.h=e}function _w(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}xw.prototype.cancel=function(){if(this.i=Cw(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function Cw(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Xf(t.i)}var ZI=class{stringify(t){return se.JSON.stringify(t,void 0)}parse(t){return se.JSON.parse(t,void 0)}};function eT(){this.g=new ZI}function tT(t,e,n){const r=n||"";try{yw(t,function(s,i){let a=s;Fu(s)&&(a=rm(s)),e.push(r+i+"="+encodeURIComponent(a))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function nT(t,e){const n=new qu;if(se.Image){const r=new Image;r.onload=Go(Yo,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Go(Yo,n,r,"TestLoadImage: error",!1,e),r.onabort=Go(Yo,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Go(Yo,n,r,"TestLoadImage: timeout",!1,e),se.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Yo(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function po(t){this.l=t.fc||null,this.j=t.ob||!1}nt(po,om);po.prototype.g=function(){return new Yu(this.l,this.j)};po.prototype.i=function(t){return function(){return t}}({});function Yu(t,e){tt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=dm,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}nt(Yu,tt);var dm=0;z=Yu.prototype;z.open=function(t,e){if(this.readyState!=dm)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ba(this)};z.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||se).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};z.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,go(this)),this.readyState=dm};z.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ba(this)),this.g&&(this.readyState=3,Ba(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof se.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Iw(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function Iw(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}z.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?go(this):Ba(this),this.readyState==3&&Iw(this)}};z.Za=function(t){this.g&&(this.response=this.responseText=t,go(this))};z.Ya=function(t){this.g&&(this.response=t,go(this))};z.ka=function(){this.g&&go(this)};function go(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ba(t)}z.setRequestHeader=function(t,e){this.v.append(t,e)};z.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};z.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Ba(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Yu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var rT=se.JSON.parse;function ze(t){tt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Tw,this.L=this.M=!1}nt(ze,tt);var Tw="",sT=/^https?$/i,iT=["POST","PUT"];z=ze.prototype;z.Oa=function(t){this.M=t};z.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Eh.g(),this.C=this.u?Bg(this.u):Bg(Eh),this.g.onreadystatechange=gt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(i){Wg(this,i);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=se.FormData&&t instanceof se.FormData,!(0<=WE(iT,e))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Aw(this),0<this.B&&((this.L=aT(this.g))?(this.g.timeout=this.B,this.g.ontimeout=gt(this.ua,this)):this.A=am(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){Wg(this,i)}};function aT(t){return di&&typeof t.timeout=="number"&&t.ontimeout!==void 0}z.ua=function(){typeof Yf<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ot(this,"timeout"),this.abort(8))};function Wg(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,bw(t),Xu(t)}function bw(t){t.F||(t.F=!0,ot(t,"complete"),ot(t,"error"))}z.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,ot(this,"complete"),ot(this,"abort"),Xu(this))};z.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Xu(this,!0)),ze.$.N.call(this)};z.La=function(){this.s||(this.G||this.v||this.l?Dw(this):this.kb())};z.kb=function(){Dw(this)};function Dw(t){if(t.h&&typeof Yf<"u"&&(!t.C[1]||kn(t)!=4||t.da()!=2)){if(t.v&&kn(t)==4)am(t.La,0,t);else if(ot(t,"readystatechange"),kn(t)==4){t.h=!1;try{const a=t.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.I).match(vw)[1]||null;!s&&se.self&&se.self.location&&(s=se.self.location.protocol.slice(0,-1)),r=!sT.test(s?s.toLowerCase():"")}n=r}if(n)ot(t,"complete"),ot(t,"success");else{t.m=6;try{var i=2<kn(t)?t.g.statusText:""}catch{i=""}t.j=i+" ["+t.da()+"]",bw(t)}}finally{Xu(t)}}}}function Xu(t,e){if(t.g){Aw(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||ot(t,"ready");try{n.onreadystatechange=r}catch{}}}function Aw(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(se.clearTimeout(t.A),t.A=null)}z.isActive=function(){return!!this.g};function kn(t){return t.g?t.g.readyState:0}z.da=function(){try{return 2<kn(this)?this.g.status:-1}catch{return-1}};z.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};z.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),rT(e)}};function Kg(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Tw:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function oT(t){const e={};t=(t.g&&2<=kn(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if($a(t[r]))continue;var n=RI(t[r]);const s=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const i=e[s]||[];e[s]=i,i.push(n)}NI(e,function(r){return r.join(", ")})}z.Ia=function(){return this.m};z.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function Rw(t){let e="";return Zf(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function hm(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Rw(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):be(t,e,n))}function ji(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Pw(t){this.Ga=0,this.j=[],this.l=new qu,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ji("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ji("baseRetryDelayMs",5e3,t),this.hb=ji("retryDelaySeedMs",1e4,t),this.eb=ji("forwardChannelMaxRetries",2,t),this.xa=ji("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new xw(t&&t.concurrentRequestLimit),this.Ja=new eT,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}z=Pw.prototype;z.ra=8;z.H=1;function fm(t){if(Mw(t),t.H==3){var e=t.W++,n=Wn(t.I);if(be(n,"SID",t.K),be(n,"RID",e),be(n,"TYPE","terminate"),yo(t,n),e=new fo(t,t.l,e),e.L=2,e.v=Qu(Wn(n)),n=!1,se.navigator&&se.navigator.sendBeacon)try{n=se.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&se.Image&&(new Image().src=e.v,n=!0),n||(e.g=jw(e.l,null),e.g.ha(e.v)),e.G=Date.now(),mo(e)}Vw(t)}function Ju(t){t.g&&(pm(t),t.g.cancel(),t.g=null)}function Mw(t){Ju(t),t.u&&(se.clearTimeout(t.u),t.u=null),iu(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&se.clearTimeout(t.m),t.m=null)}function Zu(t){if(!Sw(t.i)&&!t.m){t.m=!0;var e=t.Na;Fa||rw(),Ua||(Fa(),Ua=!0),sm.add(e,t),t.C=0}}function lT(t,e){return Nw(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=co(gt(t.Na,t,e),Uw(t,t.C)),t.C++,!0)}z.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new fo(this,this.l,t);let i=this.s;if(this.U&&(i?(i=YE(i),XE(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=Ow(this,s,e),n=Wn(this.I),be(n,"RID",t),be(n,"CVER",22),this.F&&be(n,"X-HTTP-Session-Id",this.F),yo(this,n),i&&(this.O?e="headers="+encodeURIComponent(String(Rw(i)))+"&"+e:this.o&&hm(n,this.o,i)),cm(this.i,s),this.bb&&be(n,"TYPE","init"),this.P?(be(n,"$req",e),be(n,"SID","null"),s.aa=!0,kh(s,n,null)):kh(s,n,e),this.H=2}}else this.H==3&&(t?Gg(this,t):this.j.length==0||Sw(this.i)||Gg(this))};function Gg(t,e){var n;e?n=e.m:n=t.W++;const r=Wn(t.I);be(r,"SID",t.K),be(r,"RID",n),be(r,"AID",t.V),yo(t,r),t.o&&t.s&&hm(r,t.o,t.s),n=new fo(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Ow(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),cm(t.i,n),kh(n,r,e)}function yo(t,e){t.na&&Zf(t.na,function(n,r){be(e,r,n)}),t.h&&yw({},function(n,r){be(e,r,n)})}function Ow(t,e,n){n=Math.min(t.j.length,n);var r=t.h?gt(t.h.Va,t.h,t):null;e:{var s=t.j;let i=-1;for(;;){const a=["count="+n];i==-1?0<n?(i=s[0].g,a.push("ofs="+i)):i=0:a.push("ofs="+i);let l=!0;for(let u=0;u<n;u++){let c=s[u].g;const d=s[u].map;if(c-=i,0>c)i=Math.max(0,s[u].g-100),l=!1;else try{tT(d,a,"req"+c+"_")}catch{r&&r(d)}}if(l){r=a.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function $w(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Fa||rw(),Ua||(Fa(),Ua=!0),sm.add(e,t),t.A=0}}function mm(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=co(gt(t.Ma,t),Uw(t,t.A)),t.A++,!0)}z.Ma=function(){if(this.u=null,Lw(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=co(gt(this.jb,this),t)}};z.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Nt(10),Ju(this),Lw(this))};function pm(t){t.B!=null&&(se.clearTimeout(t.B),t.B=null)}function Lw(t){t.g=new fo(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Wn(t.wa);be(e,"RID","rpc"),be(e,"SID",t.K),be(e,"AID",t.V),be(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&be(e,"TO",t.qa),be(e,"TYPE","xmlhttp"),yo(t,e),t.o&&t.s&&hm(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=Qu(Wn(e)),n.s=null,n.S=!0,fw(n,t)}z.ib=function(){this.v!=null&&(this.v=null,Ju(this),mm(this),Nt(19))};function iu(t){t.v!=null&&(se.clearTimeout(t.v),t.v=null)}function Fw(t,e){var n=null;if(t.g==e){iu(t),pm(t),t.g=null;var r=2}else if(Sh(t.i,e))n=e.F,_w(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var s=t.C;r=Hu(),ot(r,new uw(r,n)),Zu(t)}else $w(t);else if(s=e.o,s==3||s==0&&0<e.ca||!(r==1&&lT(t,e)||r==2&&mm(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:Xr(t,5);break;case 4:Xr(t,10);break;case 3:Xr(t,6);break;default:Xr(t,2)}}}function Uw(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Xr(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=gt(t.pb,t);n||(n=new ns("//www.google.com/images/cleardot.gif"),se.location&&se.location.protocol=="http"||ru(n,"https"),Qu(n)),nT(n.toString(),r)}else Nt(2);t.H=0,t.h&&t.h.za(e),Vw(t),Mw(t)}z.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Nt(2)):(this.l.info("Failed to ping google.com"),Nt(1))};function Vw(t){if(t.H=0,t.ma=[],t.h){const e=Cw(t.i);(e.length!=0||t.j.length!=0)&&(Fg(t.ma,e),Fg(t.ma,t.j),t.i.i.length=0,Xf(t.j),t.j.length=0),t.h.ya()}}function zw(t,e,n){var r=n instanceof ns?Wn(n):new ns(n);if(r.g!="")e&&(r.g=e+"."+r.g),su(r,r.m);else{var s=se.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new ns(null);r&&ru(i,r),e&&(i.g=e),s&&su(i,s),n&&(i.l=n),r=i}return n=t.F,e=t.Da,n&&e&&be(r,n,e),be(r,"VER",t.ra),yo(t,r),r}function jw(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new ze(new po({ob:!0})):new ze(t.va),e.Oa(t.J),e}z.isActive=function(){return!!this.h&&this.h.isActive(this)};function Bw(){}z=Bw.prototype;z.Ba=function(){};z.Aa=function(){};z.za=function(){};z.ya=function(){};z.isActive=function(){return!0};z.Va=function(){};function au(){if(di&&!(10<=Number(wI)))throw Error("Environmental error: no available transport.")}au.prototype.g=function(t,e){return new qt(t,e)};function qt(t,e){tt.call(this),this.g=new Pw(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!$a(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!$a(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Ci(this)}nt(qt,tt);qt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Nt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=zw(t,null,t.Y),Zu(t)};qt.prototype.close=function(){fm(this.g)};qt.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=rm(t),t=n);e.j.push(new XI(e.fb++,t)),e.H==3&&Zu(e)};qt.prototype.N=function(){this.g.h=null,delete this.j,fm(this.g),delete this.g,qt.$.N.call(this)};function qw(t){lm.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}nt(qw,lm);function Hw(){um.call(this),this.status=1}nt(Hw,um);function Ci(t){this.g=t}nt(Ci,Bw);Ci.prototype.Ba=function(){ot(this.g,"a")};Ci.prototype.Aa=function(t){ot(this.g,new qw(t))};Ci.prototype.za=function(t){ot(this.g,new Hw)};Ci.prototype.ya=function(){ot(this.g,"b")};function uT(){this.blockSize=-1}function mn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}nt(mn,uT);mn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function nd(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var s=0;16>s;++s)r[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var i=t.g[3],a=e+(i^n&(s^i))+r[0]+3614090360&4294967295;e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[1]+3905402710&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[2]+606105819&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[3]+3250441966&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(i^n&(s^i))+r[4]+4118548399&4294967295,e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[5]+1200080426&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[6]+2821735955&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[7]+4249261313&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(i^n&(s^i))+r[8]+1770035416&4294967295,e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[9]+2336552879&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[10]+4294925233&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[11]+2304563134&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(i^n&(s^i))+r[12]+1804603682&4294967295,e=n+(a<<7&4294967295|a>>>25),a=i+(s^e&(n^s))+r[13]+4254626195&4294967295,i=e+(a<<12&4294967295|a>>>20),a=s+(n^i&(e^n))+r[14]+2792965006&4294967295,s=i+(a<<17&4294967295|a>>>15),a=n+(e^s&(i^e))+r[15]+1236535329&4294967295,n=s+(a<<22&4294967295|a>>>10),a=e+(s^i&(n^s))+r[1]+4129170786&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[6]+3225465664&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[11]+643717713&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[0]+3921069994&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(s^i&(n^s))+r[5]+3593408605&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[10]+38016083&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[15]+3634488961&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[4]+3889429448&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(s^i&(n^s))+r[9]+568446438&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[14]+3275163606&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[3]+4107603335&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[8]+1163531501&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(s^i&(n^s))+r[13]+2850285829&4294967295,e=n+(a<<5&4294967295|a>>>27),a=i+(n^s&(e^n))+r[2]+4243563512&4294967295,i=e+(a<<9&4294967295|a>>>23),a=s+(e^n&(i^e))+r[7]+1735328473&4294967295,s=i+(a<<14&4294967295|a>>>18),a=n+(i^e&(s^i))+r[12]+2368359562&4294967295,n=s+(a<<20&4294967295|a>>>12),a=e+(n^s^i)+r[5]+4294588738&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[8]+2272392833&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[11]+1839030562&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[14]+4259657740&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(n^s^i)+r[1]+2763975236&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[4]+1272893353&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[7]+4139469664&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[10]+3200236656&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(n^s^i)+r[13]+681279174&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[0]+3936430074&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[3]+3572445317&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[6]+76029189&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(n^s^i)+r[9]+3654602809&4294967295,e=n+(a<<4&4294967295|a>>>28),a=i+(e^n^s)+r[12]+3873151461&4294967295,i=e+(a<<11&4294967295|a>>>21),a=s+(i^e^n)+r[15]+530742520&4294967295,s=i+(a<<16&4294967295|a>>>16),a=n+(s^i^e)+r[2]+3299628645&4294967295,n=s+(a<<23&4294967295|a>>>9),a=e+(s^(n|~i))+r[0]+4096336452&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[7]+1126891415&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[14]+2878612391&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[5]+4237533241&4294967295,n=s+(a<<21&4294967295|a>>>11),a=e+(s^(n|~i))+r[12]+1700485571&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[3]+2399980690&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[10]+4293915773&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[1]+2240044497&4294967295,n=s+(a<<21&4294967295|a>>>11),a=e+(s^(n|~i))+r[8]+1873313359&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[15]+4264355552&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[6]+2734768916&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[13]+1309151649&4294967295,n=s+(a<<21&4294967295|a>>>11),a=e+(s^(n|~i))+r[4]+4149444226&4294967295,e=n+(a<<6&4294967295|a>>>26),a=i+(n^(e|~s))+r[11]+3174756917&4294967295,i=e+(a<<10&4294967295|a>>>22),a=s+(e^(i|~n))+r[2]+718787259&4294967295,s=i+(a<<15&4294967295|a>>>17),a=n+(i^(s|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(a<<21&4294967295|a>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+i&4294967295}mn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,s=this.h,i=0;i<e;){if(s==0)for(;i<=n;)nd(this,t,i),i+=this.blockSize;if(typeof t=="string"){for(;i<e;)if(r[s++]=t.charCodeAt(i++),s==this.blockSize){nd(this,r),s=0;break}}else for(;i<e;)if(r[s++]=t[i++],s==this.blockSize){nd(this,r),s=0;break}}this.h=s,this.i+=e};mn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ce(t,e){this.h=e;for(var n=[],r=!0,s=t.length-1;0<=s;s--){var i=t[s]|0;r&&i==e||(n[s]=i,r=!1)}this.g=n}var cT={};function gm(t){return-128<=t&&128>t?yI(t,function(e){return new Ce([e|0],0>e?-1:0)}):new Ce([t|0],0>t?-1:0)}function xn(t){if(isNaN(t)||!isFinite(t))return Xs;if(0>t)return it(xn(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Nh;return new Ce(e,0)}function Ww(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return it(Ww(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=xn(Math.pow(e,8)),r=Xs,s=0;s<t.length;s+=8){var i=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+i),e);8>i?(i=xn(Math.pow(e,i)),r=r.R(i).add(xn(a))):(r=r.R(n),r=r.add(xn(a)))}return r}var Nh=4294967296,Xs=gm(0),_h=gm(1),Qg=gm(16777216);z=Ce.prototype;z.ea=function(){if(Zt(this))return-it(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Nh+r)*e,e*=Nh}return t};z.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Fn(this))return"0";if(Zt(this))return"-"+it(this).toString(t);for(var e=xn(Math.pow(t,6)),n=this,r="";;){var s=lu(n,e).g;n=ou(n,s.R(e));var i=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=s,Fn(n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};z.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Fn(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Zt(t){return t.h==-1}z.X=function(t){return t=ou(this,t),Zt(t)?-1:Fn(t)?0:1};function it(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ce(n,~t.h).add(_h)}z.abs=function(){return Zt(this)?it(this):this};z.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,s=0;s<=e;s++){var i=r+(this.D(s)&65535)+(t.D(s)&65535),a=(i>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);r=a>>>16,i&=65535,a&=65535,n[s]=a<<16|i}return new Ce(n,n[n.length-1]&-2147483648?-1:0)};function ou(t,e){return t.add(it(e))}z.R=function(t){if(Fn(this)||Fn(t))return Xs;if(Zt(this))return Zt(t)?it(this).R(it(t)):it(it(this).R(t));if(Zt(t))return it(this.R(it(t)));if(0>this.X(Qg)&&0>t.X(Qg))return xn(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<t.g.length;s++){var i=this.D(r)>>>16,a=this.D(r)&65535,l=t.D(s)>>>16,u=t.D(s)&65535;n[2*r+2*s]+=a*u,Xo(n,2*r+2*s),n[2*r+2*s+1]+=i*u,Xo(n,2*r+2*s+1),n[2*r+2*s+1]+=a*l,Xo(n,2*r+2*s+1),n[2*r+2*s+2]+=i*l,Xo(n,2*r+2*s+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ce(n,0)};function Xo(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Bi(t,e){this.g=t,this.h=e}function lu(t,e){if(Fn(e))throw Error("division by zero");if(Fn(t))return new Bi(Xs,Xs);if(Zt(t))return e=lu(it(t),e),new Bi(it(e.g),it(e.h));if(Zt(e))return e=lu(t,it(e)),new Bi(it(e.g),e.h);if(30<t.g.length){if(Zt(t)||Zt(e))throw Error("slowDivide_ only works with positive integers.");for(var n=_h,r=e;0>=r.X(t);)n=Yg(n),r=Yg(r);var s=Ns(n,1),i=Ns(r,1);for(r=Ns(r,2),n=Ns(n,2);!Fn(r);){var a=i.add(r);0>=a.X(t)&&(s=s.add(n),i=a),r=Ns(r,1),n=Ns(n,1)}return e=ou(t,s.R(e)),new Bi(s,e)}for(s=Xs;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=xn(n),a=i.R(e);Zt(a)||0<a.X(t);)n-=r,i=xn(n),a=i.R(e);Fn(i)&&(i=_h),s=s.add(i),t=ou(t,a)}return new Bi(s,t)}z.gb=function(t){return lu(this,t).h};z.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ce(n,this.h&t.h)};z.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ce(n,this.h|t.h)};z.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ce(n,this.h^t.h)};function Yg(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ce(n,t.h)}function Ns(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,s=[],i=0;i<r;i++)s[i]=0<e?t.D(i+n)>>>e|t.D(i+n+1)<<32-e:t.D(i+n);return new Ce(s,t.h)}au.prototype.createWebChannel=au.prototype.g;qt.prototype.send=qt.prototype.u;qt.prototype.open=qt.prototype.m;qt.prototype.close=qt.prototype.close;Wu.NO_ERROR=0;Wu.TIMEOUT=8;Wu.HTTP_ERROR=6;cw.COMPLETE="complete";dw.EventType=ho;ho.OPEN="a";ho.CLOSE="b";ho.ERROR="c";ho.MESSAGE="d";tt.prototype.listen=tt.prototype.O;ze.prototype.listenOnce=ze.prototype.P;ze.prototype.getLastError=ze.prototype.Sa;ze.prototype.getLastErrorCode=ze.prototype.Ia;ze.prototype.getStatus=ze.prototype.da;ze.prototype.getResponseJson=ze.prototype.Wa;ze.prototype.getResponseText=ze.prototype.ja;ze.prototype.send=ze.prototype.ha;ze.prototype.setWithCredentials=ze.prototype.Oa;mn.prototype.digest=mn.prototype.l;mn.prototype.reset=mn.prototype.reset;mn.prototype.update=mn.prototype.j;Ce.prototype.add=Ce.prototype.add;Ce.prototype.multiply=Ce.prototype.R;Ce.prototype.modulo=Ce.prototype.gb;Ce.prototype.compare=Ce.prototype.X;Ce.prototype.toNumber=Ce.prototype.ea;Ce.prototype.toString=Ce.prototype.toString;Ce.prototype.getBits=Ce.prototype.D;Ce.fromNumber=xn;Ce.fromString=Ww;var dT=function(){return new au},hT=function(){return Hu()},rd=Wu,fT=cw,mT=vs,Xg={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},pT=po,Jo=dw,gT=ze,yT=mn,Js=Ce;const Jg="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ht.UNAUTHENTICATED=new ht(null),ht.GOOGLE_CREDENTIALS=new ht("google-credentials-uid"),ht.FIRST_PARTY=new ht("first-party-uid"),ht.MOCK_USER=new ht("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ii="9.23.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br=new Ff("@firebase/firestore");function Zg(){return br.logLevel}function ey(t){br.setLogLevel(t)}function Q(t,...e){if(br.logLevel<=we.DEBUG){const n=e.map(ym);br.debug(`Firestore (${Ii}): ${t}`,...n)}}function Kn(t,...e){if(br.logLevel<=we.ERROR){const n=e.map(ym);br.error(`Firestore (${Ii}): ${t}`,...n)}}function hi(t,...e){if(br.logLevel<=we.WARN){const n=e.map(ym);br.warn(`Firestore (${Ii}): ${t}`,...n)}}function ym(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function re(t="Unexpected state"){const e=`FIRESTORE (${Ii}) INTERNAL ASSERTION FAILED: `+t;throw Kn(e),new Error(e)}function Pe(t,e){t||re()}function oe(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class j extends Xn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class vT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ht.UNAUTHENTICATED))}shutdown(){}}class ET{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class wT{constructor(e){this.t=e,this.currentUser=ht.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Vn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Vn,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{Q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Vn)}},0),a()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Pe(typeof r.accessToken=="string"),new Kw(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Pe(e===null||typeof e=="string"),new ht(e)}}class kT{constructor(e,n,r){this.h=e,this.l=n,this.m=r,this.type="FirstParty",this.user=ht.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class xT{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new kT(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(ht.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ST{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class NT{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,n){const r=i=>{i.error!=null&&Q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.T;return this.T=i.token,Q("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.I.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.I.getImmediate({optional:!0});i?s(i):Q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Pe(typeof n.token=="string"),this.T=n.token,new ST(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _T(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=_T(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function xe(t,e){return t<e?-1:t>e?1:0}function fi(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new j(I.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new j(I.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new j(I.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new j(I.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return me.fromMillis(Date.now())}static fromDate(e){return me.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new me(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ie(e)}static min(){return new ie(new me(0,0))}static max(){return new ie(new me(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,n,r){n===void 0?n=0:n>e.length&&re(),r===void 0?r=e.length-n:r>e.length-n&&re(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return qa.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof qa?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),a=n.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class De extends qa{construct(e,n,r){return new De(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new j(I.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new De(n)}static emptyPath(){return new De([])}}const CT=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pt extends qa{construct(e,n,r){return new pt(e,n,r)}static isValidIdentifier(e){return CT.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new pt(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new j(I.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new j(I.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new j(I.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(r+=l,s++):(i(),s++)}if(i(),a)throw new j(I.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pt(n)}static emptyPath(){return new pt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.path=e}static fromPath(e){return new Y(De.fromString(e))}static fromName(e){return new Y(De.fromString(e).popFirst(5))}static empty(){return new Y(De.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&De.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return De.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Y(new De(e.slice()))}}function IT(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ie.fromTimestamp(r===1e9?new me(n+1,0):new me(n,r));return new Dr(s,Y.empty(),e)}function TT(t){return new Dr(t.readTime,t.key,-1)}class Dr{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Dr(ie.min(),Y.empty(),-1)}static max(){return new Dr(ie.max(),Y.empty(),-1)}}function bT(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Y.comparator(t.documentKey,e.documentKey),n!==0?n:xe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class AT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vo(t){if(t.code!==I.FAILED_PRECONDITION||t.message!==DT)throw t;Q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&re(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new L((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):L.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):L.reject(n)}static resolve(e){return new L((n,r)=>{n(e)})}static reject(e){return new L((n,r)=>{r(e)})}static waitFor(e){return new L((n,r)=>{let s=0,i=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++i,a&&i===s&&n()},u=>r(u))}),a=!0,i===s&&n()})}static or(e){let n=L.resolve(!1);for(const r of e)n=n.next(s=>s?L.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new L((r,s)=>{const i=e.length,a=new Array(i);let l=0;for(let u=0;u<i;u++){const c=u;n(e[c]).next(d=>{a[c]=d,++l,l===i&&r(a)},d=>s(d))}})}static doWhile(e,n){return new L((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function Eo(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>n.writeSequenceNumber(r))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}vm.ct=-1;function ec(t){return t==null}function uu(t){return t===0&&1/t==-1/0}function RT(t){return typeof t=="number"&&Number.isInteger(t)&&!uu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Es(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Qw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e,n){this.comparator=e,this.root=n||st.EMPTY}insert(e,n){return new Fe(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,st.BLACK,null,null))}remove(e){return new Fe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,st.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zo(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zo(this.root,e,this.comparator,!0)}}class Zo{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class st{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??st.RED,this.left=s??st.EMPTY,this.right=i??st.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new st(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return st.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return st.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,st.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,st.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw re();const e=this.left.check();if(e!==this.right.check())throw re();return e+(this.isRed()?0:1)}}st.EMPTY=null,st.RED=!0,st.BLACK=!1;st.EMPTY=new class{constructor(){this.size=0}get key(){throw re()}get value(){throw re()}get color(){throw re()}get left(){throw re()}get right(){throw re()}copy(t,e,n,r,s){return this}insert(t,e,n){return new st(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.comparator=e,this.data=new Fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ny(this.data.getIterator())}getIteratorFrom(e){return new ny(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof vt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new vt(this.comparator);return n.data=e,n}}class ny{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.fields=e,e.sort(pt.comparator)}static empty(){return new zt([])}unionWith(e){let n=new vt(pt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new zt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return fi(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Yw("Invalid base64 string: "+s):s}}(e);return new xt(n)}static fromUint8Array(e){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new xt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}xt.EMPTY_BYTE_STRING=new xt("");const PT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ar(t){if(Pe(!!t),typeof t=="string"){let e=0;const n=PT.exec(t);if(Pe(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:He(t.seconds),nanos:He(t.nanos)}}function He(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function hs(t){return typeof t=="string"?xt.fromBase64String(t):xt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Em(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function wm(t){const e=t.mapValue.fields.__previous_value__;return Em(e)?wm(e):e}function Ha(t){const e=Ar(t.mapValue.fields.__local_write_time__.timestampValue);return new me(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT{constructor(e,n,r,s,i,a,l,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=c}}class Wa{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Wa("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Wa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const el={mapValue:{}};function fs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Em(t)?4:OT(t)?9007199254740991:10:re()}function Tn(t,e){if(t===e)return!0;const n=fs(t);if(n!==fs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ha(t).isEqual(Ha(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=Ar(r.timestampValue),a=Ar(s.timestampValue);return i.seconds===a.seconds&&i.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return hs(r.bytesValue).isEqual(hs(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return He(r.geoPointValue.latitude)===He(s.geoPointValue.latitude)&&He(r.geoPointValue.longitude)===He(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return He(r.integerValue)===He(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=He(r.doubleValue),a=He(s.doubleValue);return i===a?uu(i)===uu(a):isNaN(i)&&isNaN(a)}return!1}(t,e);case 9:return fi(t.arrayValue.values||[],e.arrayValue.values||[],Tn);case 10:return function(r,s){const i=r.mapValue.fields||{},a=s.mapValue.fields||{};if(ty(i)!==ty(a))return!1;for(const l in i)if(i.hasOwnProperty(l)&&(a[l]===void 0||!Tn(i[l],a[l])))return!1;return!0}(t,e);default:return re()}}function Ka(t,e){return(t.values||[]).find(n=>Tn(n,e))!==void 0}function mi(t,e){if(t===e)return 0;const n=fs(t),r=fs(e);if(n!==r)return xe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xe(t.booleanValue,e.booleanValue);case 2:return function(s,i){const a=He(s.integerValue||s.doubleValue),l=He(i.integerValue||i.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return ry(t.timestampValue,e.timestampValue);case 4:return ry(Ha(t),Ha(e));case 5:return xe(t.stringValue,e.stringValue);case 6:return function(s,i){const a=hs(s),l=hs(i);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const a=s.split("/"),l=i.split("/");for(let u=0;u<a.length&&u<l.length;u++){const c=xe(a[u],l[u]);if(c!==0)return c}return xe(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const a=xe(He(s.latitude),He(i.latitude));return a!==0?a:xe(He(s.longitude),He(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,i){const a=s.values||[],l=i.values||[];for(let u=0;u<a.length&&u<l.length;++u){const c=mi(a[u],l[u]);if(c)return c}return xe(a.length,l.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===el.mapValue&&i===el.mapValue)return 0;if(s===el.mapValue)return 1;if(i===el.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=i.fields||{},c=Object.keys(u);l.sort(),c.sort();for(let d=0;d<l.length&&d<c.length;++d){const h=xe(l[d],c[d]);if(h!==0)return h;const m=mi(a[l[d]],u[c[d]]);if(m!==0)return m}return xe(l.length,c.length)}(t.mapValue,e.mapValue);default:throw re()}}function ry(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return xe(t,e);const n=Ar(t),r=Ar(e),s=xe(n.seconds,r.seconds);return s!==0?s:xe(n.nanos,r.nanos)}function pi(t){return Ch(t)}function Ch(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=Ar(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?hs(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Y.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",i=!0;for(const a of r.values||[])i?i=!1:s+=",",s+=Ch(a);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const l of s)a?a=!1:i+=",",i+=`${l}:${Ch(r.fields[l])}`;return i+"}"}(t.mapValue):re();var e,n}function sy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Ih(t){return!!t&&"integerValue"in t}function km(t){return!!t&&"arrayValue"in t}function iy(t){return!!t&&"nullValue"in t}function ay(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function wl(t){return!!t&&"mapValue"in t}function ha(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Es(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ha(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ha(t.arrayValue.values[n]);return e}return Object.assign({},t)}function OT(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.value=e}static empty(){return new Mt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!wl(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ha(n)}setAll(e){let n=pt.emptyPath(),r={},s=[];e.forEach((a,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}a?r[l.lastSegment()]=ha(a):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());wl(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Tn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];wl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Es(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Mt(ha(this.value))}}function Xw(t){const e=[];return Es(t.fields,(n,r)=>{const s=new pt([n]);if(wl(r)){const i=Xw(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new zt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,n,r,s,i,a,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new mt(e,0,ie.min(),ie.min(),ie.min(),Mt.empty(),0)}static newFoundDocument(e,n,r,s){return new mt(e,1,n,ie.min(),r,s,0)}static newNoDocument(e,n){return new mt(e,2,n,ie.min(),ie.min(),Mt.empty(),0)}static newUnknownDocument(e,n){return new mt(e,3,n,ie.min(),ie.min(),Mt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Mt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Mt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof mt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new mt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e,n){this.position=e,this.inclusive=n}}function oy(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?r=Y.comparator(Y.fromName(a.referenceValue),n.key):r=mi(a,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function ly(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Tn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,n="asc"){this.field=e,this.dir=n}}function $T(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{}class Ke extends Jw{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new FT(e,n,r):n==="array-contains"?new zT(e,r):n==="in"?new jT(e,r):n==="not-in"?new BT(e,r):n==="array-contains-any"?new qT(e,r):new Ke(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new UT(e,r):new VT(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(mi(n,this.value)):n!==null&&fs(this.value)===fs(n)&&this.matchesComparison(mi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return re()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class pn extends Jw{constructor(e,n){super(),this.filters=e,this.op=n,this.lt=null}static create(e,n){return new pn(e,n)}matches(e){return Zw(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.lt!==null||(this.lt=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(n=>n.isInequality());return e!==null?e.field:null}ft(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function Zw(t){return t.op==="and"}function ek(t){return LT(t)&&Zw(t)}function LT(t){for(const e of t.filters)if(e instanceof pn)return!1;return!0}function Th(t){if(t instanceof Ke)return t.field.canonicalString()+t.op.toString()+pi(t.value);if(ek(t))return t.filters.map(e=>Th(e)).join(",");{const e=t.filters.map(n=>Th(n)).join(",");return`${t.op}(${e})`}}function tk(t,e){return t instanceof Ke?function(n,r){return r instanceof Ke&&n.op===r.op&&n.field.isEqual(r.field)&&Tn(n.value,r.value)}(t,e):t instanceof pn?function(n,r){return r instanceof pn&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((s,i,a)=>s&&tk(i,r.filters[a]),!0):!1}(t,e):void re()}function nk(t){return t instanceof Ke?function(e){return`${e.field.canonicalString()} ${e.op} ${pi(e.value)}`}(t):t instanceof pn?function(e){return e.op.toString()+" {"+e.getFilters().map(nk).join(" ,")+"}"}(t):"Filter"}class FT extends Ke{constructor(e,n,r){super(e,n,r),this.key=Y.fromName(r.referenceValue)}matches(e){const n=Y.comparator(e.key,this.key);return this.matchesComparison(n)}}class UT extends Ke{constructor(e,n){super(e,"in",n),this.keys=rk("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class VT extends Ke{constructor(e,n){super(e,"not-in",n),this.keys=rk("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function rk(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Y.fromName(r.referenceValue))}class zT extends Ke{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return km(n)&&Ka(n.arrayValue,this.value)}}class jT extends Ke{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ka(this.value.arrayValue,n)}}class BT extends Ke{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ka(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ka(this.value.arrayValue,n)}}class qT extends Ke{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!km(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ka(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HT{constructor(e,n=null,r=[],s=[],i=null,a=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=l,this.dt=null}}function uy(t,e=null,n=[],r=[],s=null,i=null,a=null){return new HT(t,e,n,r,s,i,a)}function xm(t){const e=oe(t);if(e.dt===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Th(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ec(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>pi(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>pi(r)).join(",")),e.dt=n}return e.dt}function Sm(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!$T(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!tk(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ly(t.startAt,e.startAt)&&ly(t.endAt,e.endAt)}function bh(t){return Y.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,n=null,r=[],s=[],i=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=l,this.endAt=u,this.wt=null,this._t=null,this.startAt,this.endAt}}function WT(t,e,n,r,s,i,a,l){return new Ti(t,e,n,r,s,i,a,l)}function tc(t){return new Ti(t)}function cy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Nm(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function nc(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function sk(t){return t.collectionGroup!==null}function ei(t){const e=oe(t);if(e.wt===null){e.wt=[];const n=nc(e),r=Nm(e);if(n!==null&&r===null)n.isKeyField()||e.wt.push(new Zs(n)),e.wt.push(new Zs(pt.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.wt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new Zs(pt.keyField(),i))}}}return e.wt}function Gn(t){const e=oe(t);if(!e._t)if(e.limitType==="F")e._t=uy(e.path,e.collectionGroup,ei(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of ei(e)){const a=i.dir==="desc"?"asc":"desc";n.push(new Zs(i.field,a))}const r=e.endAt?new cu(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new cu(e.startAt.position,e.startAt.inclusive):null;e._t=uy(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e._t}function Dh(t,e){e.getFirstInequalityField(),nc(t);const n=t.filters.concat([e]);return new Ti(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ah(t,e,n){return new Ti(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function rc(t,e){return Sm(Gn(t),Gn(e))&&t.limitType===e.limitType}function ik(t){return`${xm(Gn(t))}|lt:${t.limitType}`}function Rh(t){return`Query(target=${function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(r=>nk(r)).join(", ")}]`),ec(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(r=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(r)).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>pi(r)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>pi(r)).join(",")),`Target(${n})`}(Gn(t))}; limitType=${t.limitType})`}function sc(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Y.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of ei(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,i,a){const l=oy(s,i,a);return s.inclusive?l<=0:l<0}(n.startAt,ei(n),r)||n.endAt&&!function(s,i,a){const l=oy(s,i,a);return s.inclusive?l>=0:l>0}(n.endAt,ei(n),r))}(t,e)}function KT(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function ak(t){return(e,n)=>{let r=!1;for(const s of ei(t)){const i=GT(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function GT(t,e,n){const r=t.field.isKeyField()?Y.comparator(e.key,n.key):function(s,i,a){const l=i.data.field(s),u=a.data.field(s);return l!==null&&u!==null?mi(l,u):re()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return re()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Es(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Qw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QT=new Fe(Y.comparator);function Qn(){return QT}const ok=new Fe(Y.comparator);function Ji(...t){let e=ok;for(const n of t)e=e.insert(n.key,n);return e}function lk(t){let e=ok;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Jr(){return fa()}function uk(){return fa()}function fa(){return new bi(t=>t.toString(),(t,e)=>t.isEqual(e))}const YT=new Fe(Y.comparator),XT=new vt(Y.comparator);function pe(...t){let e=XT;for(const n of t)e=e.add(n);return e}const JT=new vt(xe);function ZT(){return JT}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ck(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:uu(e)?"-0":e}}function dk(t){return{integerValue:""+t}}function eb(t,e){return RT(e)?dk(e):ck(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(){this._=void 0}}function tb(t,e,n){return t instanceof Ga?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Em(s)&&(s=wm(s)),s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,e):t instanceof Qa?fk(t,e):t instanceof Ya?mk(t,e):function(r,s){const i=hk(r,s),a=dy(i)+dy(r.gt);return Ih(i)&&Ih(r.gt)?dk(a):ck(r.serializer,a)}(t,e)}function nb(t,e,n){return t instanceof Qa?fk(t,e):t instanceof Ya?mk(t,e):n}function hk(t,e){return t instanceof du?Ih(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class Ga extends ic{}class Qa extends ic{constructor(e){super(),this.elements=e}}function fk(t,e){const n=pk(e);for(const r of t.elements)n.some(s=>Tn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Ya extends ic{constructor(e){super(),this.elements=e}}function mk(t,e){let n=pk(e);for(const r of t.elements)n=n.filter(s=>!Tn(s,r));return{arrayValue:{values:n}}}class du extends ic{constructor(e,n){super(),this.serializer=e,this.gt=n}}function dy(t){return He(t.integerValue||t.doubleValue)}function pk(t){return km(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e,n){this.field=e,this.transform=n}}function sb(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof Qa&&r instanceof Qa||n instanceof Ya&&r instanceof Ya?fi(n.elements,r.elements,Tn):n instanceof du&&r instanceof du?Tn(n.gt,r.gt):n instanceof Ga&&r instanceof Ga}(t.transform,e.transform)}class ib{constructor(e,n){this.version=e,this.transformResults=n}}class It{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new It}static exists(e){return new It(void 0,e)}static updateTime(e){return new It(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ac{}function gk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new oc(t.key,It.none()):new wo(t.key,t.data,It.none());{const n=t.data,r=Mt.empty();let s=new vt(pt.comparator);for(let i of e.fields)if(!s.has(i)){let a=n.field(i);a===null&&i.length>1&&(i=i.popLast(),a=n.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Ur(t.key,r,new zt(s.toArray()),It.none())}}function ab(t,e,n){t instanceof wo?function(r,s,i){const a=r.value.clone(),l=fy(r.fieldTransforms,s,i.transformResults);a.setAll(l),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ur?function(r,s,i){if(!kl(r.precondition,s))return void s.convertToUnknownDocument(i.version);const a=fy(r.fieldTransforms,s,i.transformResults),l=s.data;l.setAll(yk(r)),l.setAll(a),s.convertToFoundDocument(i.version,l).setHasCommittedMutations()}(t,e,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function ma(t,e,n,r){return t instanceof wo?function(s,i,a,l){if(!kl(s.precondition,i))return a;const u=s.value.clone(),c=my(s.fieldTransforms,l,i);return u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ur?function(s,i,a,l){if(!kl(s.precondition,i))return a;const u=my(s.fieldTransforms,l,i),c=i.data;return c.setAll(yk(s)),c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,i,a){return kl(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a}(t,e,n)}function ob(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=hk(r.transform,s||null);i!=null&&(n===null&&(n=Mt.empty()),n.set(r.field,i))}return n||null}function hy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&fi(n,r,(s,i)=>sb(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class wo extends ac{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ur extends ac{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function yk(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function fy(t,e,n){const r=new Map;Pe(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],a=i.transform,l=e.data.field(i.field);r.set(i.field,nb(a,l,n[s]))}return r}function my(t,e,n){const r=new Map;for(const s of t){const i=s.transform,a=n.data.field(s.field);r.set(s.field,tb(i,a,e))}return r}class oc extends ac{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class lb extends ac{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&ab(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ma(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ma(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=uk();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let l=this.applyToLocalView(a,i.mutatedFields);l=n.has(s.key)?null:l;const u=gk(a,l);u!==null&&r.set(s.key,u),a.isValidDocument()||a.convertToNoDocument(ie.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),pe())}isEqual(e){return this.batchId===e.batchId&&fi(this.mutations,e.mutations,(n,r)=>hy(n,r))&&fi(this.baseMutations,e.baseMutations,(n,r)=>hy(n,r))}}class _m{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Pe(e.mutations.length===r.length);let s=YT;const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new _m(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qe,ye;function hb(t){switch(t){default:return re();case I.CANCELLED:case I.UNKNOWN:case I.DEADLINE_EXCEEDED:case I.RESOURCE_EXHAUSTED:case I.INTERNAL:case I.UNAVAILABLE:case I.UNAUTHENTICATED:return!1;case I.INVALID_ARGUMENT:case I.NOT_FOUND:case I.ALREADY_EXISTS:case I.PERMISSION_DENIED:case I.FAILED_PRECONDITION:case I.ABORTED:case I.OUT_OF_RANGE:case I.UNIMPLEMENTED:case I.DATA_LOSS:return!0}}function vk(t){if(t===void 0)return Kn("GRPC error has no .code"),I.UNKNOWN;switch(t){case qe.OK:return I.OK;case qe.CANCELLED:return I.CANCELLED;case qe.UNKNOWN:return I.UNKNOWN;case qe.DEADLINE_EXCEEDED:return I.DEADLINE_EXCEEDED;case qe.RESOURCE_EXHAUSTED:return I.RESOURCE_EXHAUSTED;case qe.INTERNAL:return I.INTERNAL;case qe.UNAVAILABLE:return I.UNAVAILABLE;case qe.UNAUTHENTICATED:return I.UNAUTHENTICATED;case qe.INVALID_ARGUMENT:return I.INVALID_ARGUMENT;case qe.NOT_FOUND:return I.NOT_FOUND;case qe.ALREADY_EXISTS:return I.ALREADY_EXISTS;case qe.PERMISSION_DENIED:return I.PERMISSION_DENIED;case qe.FAILED_PRECONDITION:return I.FAILED_PRECONDITION;case qe.ABORTED:return I.ABORTED;case qe.OUT_OF_RANGE:return I.OUT_OF_RANGE;case qe.UNIMPLEMENTED:return I.UNIMPLEMENTED;case qe.DATA_LOSS:return I.DATA_LOSS;default:return re()}}(ye=qe||(qe={}))[ye.OK=0]="OK",ye[ye.CANCELLED=1]="CANCELLED",ye[ye.UNKNOWN=2]="UNKNOWN",ye[ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ye[ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ye[ye.NOT_FOUND=5]="NOT_FOUND",ye[ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",ye[ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",ye[ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",ye[ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ye[ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ye[ye.ABORTED=10]="ABORTED",ye[ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",ye[ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",ye[ye.INTERNAL=13]="INTERNAL",ye[ye.UNAVAILABLE=14]="UNAVAILABLE",ye[ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return tl}static getOrCreateInstance(){return tl===null&&(tl=new Cm),tl}onExistenceFilterMismatch(e){const n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),()=>this.onExistenceFilterMismatchCallbacks.delete(n)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(n=>n(e))}}let tl=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb=new Js([4294967295,4294967295],0);function py(t){const e=fb().encode(t),n=new yT;return n.update(e),new Uint8Array(n.digest())}function gy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Js([n,r],0),new Js([s,i],0)]}class Im{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Zi(`Invalid padding: ${n}`);if(r<0)throw new Zi(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Zi(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Zi(`Invalid padding when bitmap length is 0: ${n}`);this.It=8*e.length-n,this.Tt=Js.fromNumber(this.It)}Et(e,n,r){let s=e.add(n.multiply(Js.fromNumber(r)));return s.compare(mb)===1&&(s=new Js([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Tt).toNumber()}At(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}vt(e){if(this.It===0)return!1;const n=py(e),[r,s]=gy(n);for(let i=0;i<this.hashCount;i++){const a=this.Et(r,s,i);if(!this.At(a))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new Im(i,s,n);return r.forEach(l=>a.insert(l)),a}insert(e){if(this.It===0)return;const n=py(e),[r,s]=gy(n);for(let i=0;i<this.hashCount;i++){const a=this.Et(r,s,i);this.Rt(a)}}Rt(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Zi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,ko.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new lc(ie.min(),s,new Fe(xe),Qn(),pe())}}class ko{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ko(r,n,pe(),pe(),pe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(e,n,r,s){this.Pt=e,this.removedTargetIds=n,this.key=r,this.bt=s}}class Ek{constructor(e,n){this.targetId=e,this.Vt=n}}class wk{constructor(e,n,r=xt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class yy{constructor(){this.St=0,this.Dt=Ey(),this.Ct=xt.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return this.St!==0}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=pe(),n=pe(),r=pe();return this.Dt.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:re()}}),new ko(this.Ct,this.xt,e,n,r)}Ft(){this.Nt=!1,this.Dt=Ey()}Bt(e,n){this.Nt=!0,this.Dt=this.Dt.insert(e,n)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class pb{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Qn(),this.zt=vy(),this.Wt=new Fe(xe)}Ht(e){for(const n of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(n,e.bt):this.Yt(n,e.key,e.bt);for(const n of e.removedTargetIds)this.Yt(n,e.key,e.bt)}Xt(e){this.forEachTarget(e,n=>{const r=this.Zt(n);switch(e.state){case 0:this.te(n)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(n);break;case 3:this.te(n)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:this.te(n)&&(this.ee(n),r.$t(e.resumeToken));break;default:re()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Qt.forEach((r,s)=>{this.te(s)&&n(s)})}ne(e){var n;const r=e.targetId,s=e.Vt.count,i=this.se(r);if(i){const a=i.target;if(bh(a))if(s===0){const l=new Y(a.path);this.Yt(r,l,mt.newNoDocument(l,ie.min()))}else Pe(s===1);else{const l=this.ie(r);if(l!==s){const u=this.re(e,l);if(u!==0){this.ee(r);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(r,c)}(n=Cm.instance)===null||n===void 0||n.notifyOnExistenceFilterMismatch(function(c,d,h){var m,y,E,v,w,f;const p={localCacheCount:d,existenceFilterCount:h.count},g=h.unchangedNames;return g&&(p.bloomFilter={applied:c===0,hashCount:(m=g==null?void 0:g.hashCount)!==null&&m!==void 0?m:0,bitmapLength:(v=(E=(y=g==null?void 0:g.bits)===null||y===void 0?void 0:y.bitmap)===null||E===void 0?void 0:E.length)!==null&&v!==void 0?v:0,padding:(f=(w=g==null?void 0:g.bits)===null||w===void 0?void 0:w.padding)!==null&&f!==void 0?f:0}),p}(u,l,e.Vt))}}}}re(e,n){const{unchangedNames:r,count:s}=e.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=r;let u,c;try{u=hs(i).toUint8Array()}catch(d){if(d instanceof Yw)return hi("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw d}try{c=new Im(u,a,l)}catch(d){return hi(d instanceof Zi?"BloomFilter error: ":"Applying bloom filter failed: ",d),1}return c.It===0?1:s!==n-this.oe(e.targetId,c)?2:0}oe(e,n){const r=this.Gt.getRemoteKeysForTarget(e);let s=0;return r.forEach(i=>{const a=this.Gt.ue(),l=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;n.vt(l)||(this.Yt(e,i,null),s++)}),s}ce(e){const n=new Map;this.Qt.forEach((i,a)=>{const l=this.se(a);if(l){if(i.current&&bh(l.target)){const u=new Y(l.target.path);this.jt.get(u)!==null||this.ae(a,u)||this.Yt(a,u,mt.newNoDocument(u,e))}i.Mt&&(n.set(a,i.Ot()),i.Ft())}});let r=pe();this.zt.forEach((i,a)=>{let l=!0;a.forEachWhile(u=>{const c=this.se(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.jt.forEach((i,a)=>a.setReadTime(e));const s=new lc(e,n,this.Wt,this.jt,r);return this.jt=Qn(),this.zt=vy(),this.Wt=new Fe(xe),s}Jt(e,n){if(!this.te(e))return;const r=this.ae(e,n.key)?2:0;this.Zt(e).Bt(n.key,r),this.jt=this.jt.insert(n.key,n),this.zt=this.zt.insert(n.key,this.he(n.key).add(e))}Yt(e,n,r){if(!this.te(e))return;const s=this.Zt(e);this.ae(e,n)?s.Bt(n,1):s.Lt(n),this.zt=this.zt.insert(n,this.he(n).delete(e)),r&&(this.jt=this.jt.insert(n,r))}removeTarget(e){this.Qt.delete(e)}ie(e){const n=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let n=this.Qt.get(e);return n||(n=new yy,this.Qt.set(e,n)),n}he(e){let n=this.zt.get(e);return n||(n=new vt(xe),this.zt=this.zt.insert(e,n)),n}te(e){const n=this.se(e)!==null;return n||Q("WatchChangeAggregator","Detected inactive target",e),n}se(e){const n=this.Qt.get(e);return n&&n.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new yy),this.Gt.getRemoteKeysForTarget(e).forEach(n=>{this.Yt(e,n,null)})}ae(e,n){return this.Gt.getRemoteKeysForTarget(e).has(n)}}function vy(){return new Fe(Y.comparator)}function Ey(){return new Fe(Y.comparator)}const gb={asc:"ASCENDING",desc:"DESCENDING"},yb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vb={and:"AND",or:"OR"};class Eb{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ph(t,e){return t.useProto3Json||ec(e)?e:{value:e}}function hu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function kk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function wb(t,e){return hu(t,e.toTimestamp())}function In(t){return Pe(!!t),ie.fromTimestamp(function(e){const n=Ar(e);return new me(n.seconds,n.nanos)}(t))}function Tm(t,e){return function(n){return new De(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function xk(t){const e=De.fromString(t);return Pe(Ck(e)),e}function Mh(t,e){return Tm(t.databaseId,e.path)}function sd(t,e){const n=xk(e);if(n.get(1)!==t.databaseId.projectId)throw new j(I.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new j(I.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Y(Sk(n))}function Oh(t,e){return Tm(t.databaseId,e)}function kb(t){const e=xk(t);return e.length===4?De.emptyPath():Sk(e)}function $h(t){return new De(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Sk(t){return Pe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function wy(t,e,n){return{name:Mh(t,e),fields:n.value.mapValue.fields}}function xb(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:re()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,c){return u.useProto3Json?(Pe(c===void 0||typeof c=="string"),xt.fromBase64String(c||"")):(Pe(c===void 0||c instanceof Uint8Array),xt.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(u){const c=u.code===void 0?I.UNKNOWN:vk(u.code);return new j(c,u.message||"")}(a);n=new wk(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=sd(t,r.document.name),i=In(r.document.updateTime),a=r.document.createTime?In(r.document.createTime):ie.min(),l=new Mt({mapValue:{fields:r.document.fields}}),u=mt.newFoundDocument(s,i,a,l),c=r.targetIds||[],d=r.removedTargetIds||[];n=new xl(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=sd(t,r.document),i=r.readTime?In(r.readTime):ie.min(),a=mt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new xl([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=sd(t,r.document),i=r.removedTargetIds||[];n=new xl([],i,s,null)}else{if(!("filter"in e))return re();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new db(s,i),l=r.targetId;n=new Ek(l,a)}}return n}function Sb(t,e){let n;if(e instanceof wo)n={update:wy(t,e.key,e.value)};else if(e instanceof oc)n={delete:Mh(t,e.key)};else if(e instanceof Ur)n={update:wy(t,e.key,e.data),updateMask:Rb(e.fieldMask)};else{if(!(e instanceof lb))return re();n={verify:Mh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const a=i.transform;if(a instanceof Ga)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Qa)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ya)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof du)return{fieldPath:i.field.canonicalString(),increment:a.gt};throw re()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:wb(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:re()}(t,e.precondition)),n}function Nb(t,e){return t&&t.length>0?(Pe(e!==void 0),t.map(n=>function(r,s){let i=r.updateTime?In(r.updateTime):In(s);return i.isEqual(ie.min())&&(i=In(s)),new ib(i,r.transformResults||[])}(n,e))):[]}function _b(t,e){return{documents:[Oh(t,e.path)]}}function Cb(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Oh(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Oh(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(u){if(u.length!==0)return _k(pn.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const i=function(u){if(u.length!==0)return u.map(c=>function(d){return{field:Is(d.field),direction:bb(d.dir)}}(c))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const a=Ph(t,e.limit);var l;return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt={before:(l=e.startAt).inclusive,values:l.position}),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),n}function Ib(t){let e=kb(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Pe(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(d){const h=Nk(d);return h instanceof pn&&ek(h)?h.getFilters():[h]}(n.where));let a=[];n.orderBy&&(a=n.orderBy.map(d=>function(h){return new Zs(Ts(h.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(d)));let l=null;n.limit&&(l=function(d){let h;return h=typeof d=="object"?d.value:d,ec(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(d){const h=!!d.before,m=d.values||[];return new cu(m,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){const h=!d.before,m=d.values||[];return new cu(m,h)}(n.endAt)),WT(e,s,a,i,l,"F",u,c)}function Tb(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return re()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Nk(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=Ts(e.unaryFilter.field);return Ke.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Ts(e.unaryFilter.field);return Ke.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ts(e.unaryFilter.field);return Ke.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ts(e.unaryFilter.field);return Ke.create(i,"!=",{nullValue:"NULL_VALUE"});default:return re()}}(t):t.fieldFilter!==void 0?function(e){return Ke.create(Ts(e.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return re()}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return pn.create(e.compositeFilter.filters.map(n=>Nk(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return re()}}(e.compositeFilter.op))}(t):re()}function bb(t){return gb[t]}function Db(t){return yb[t]}function Ab(t){return vb[t]}function Is(t){return{fieldPath:t.canonicalString()}}function Ts(t){return pt.fromServerFormat(t.fieldPath)}function _k(t){return t instanceof Ke?function(e){if(e.op==="=="){if(ay(e.value))return{unaryFilter:{field:Is(e.field),op:"IS_NAN"}};if(iy(e.value))return{unaryFilter:{field:Is(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(ay(e.value))return{unaryFilter:{field:Is(e.field),op:"IS_NOT_NAN"}};if(iy(e.value))return{unaryFilter:{field:Is(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Is(e.field),op:Db(e.op),value:e.value}}}(t):t instanceof pn?function(e){const n=e.getFilters().map(r=>_k(r));return n.length===1?n[0]:{compositeFilter:{op:Ab(e.op),filters:n}}}(t):re()}function Rb(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Ck(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,n,r,s,i=ie.min(),a=ie.min(),l=xt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new mr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e){this.fe=e}}function Mb(t){const e=Ib({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ah(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(){this.rn=new $b}addToCollectionParentIndex(e,n){return this.rn.add(n),L.resolve()}getCollectionParents(e,n){return L.resolve(this.rn.getEntries(n))}addFieldIndex(e,n){return L.resolve()}deleteFieldIndex(e,n){return L.resolve()}getDocumentsMatchingTarget(e,n){return L.resolve(null)}getIndexType(e,n){return L.resolve(0)}getFieldIndexes(e,n){return L.resolve([])}getNextCollectionGroupToUpdate(e){return L.resolve(null)}getMinOffset(e,n){return L.resolve(Dr.min())}getMinOffsetFromCollectionGroup(e,n){return L.resolve(Dr.min())}updateCollectionGroup(e,n,r){return L.resolve()}updateIndexEntries(e,n){return L.resolve()}}class $b{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new vt(De.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new vt(De.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new gi(0)}static Mn(){return new gi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(){this.changes=new bi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,mt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&ma(r.mutation,s,zt.empty(),me.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,pe()).next(()=>r))}getLocalViewOfDocuments(e,n,r=pe()){const s=Jr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let a=Ji();return i.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,n){const r=Jr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,pe()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,l)=>{n.set(a,l)})})}computeViews(e,n,r,s){let i=Qn();const a=fa(),l=fa();return n.forEach((u,c)=>{const d=r.get(c.key);s.has(c.key)&&(d===void 0||d.mutation instanceof Ur)?i=i.insert(c.key,c):d!==void 0?(a.set(c.key,d.mutation.getFieldMask()),ma(d.mutation,c,d.mutation.getFieldMask(),me.now())):a.set(c.key,zt.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((c,d)=>a.set(c,d)),n.forEach((c,d)=>{var h;return l.set(c,new Fb(d,(h=a.get(c))!==null&&h!==void 0?h:null))}),l))}recalculateAndSaveOverlays(e,n){const r=fa();let s=new Fe((a,l)=>a-l),i=pe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(a=>{for(const l of a)l.keys().forEach(u=>{const c=n.get(u);if(c===null)return;let d=r.get(u)||zt.empty();d=l.applyToLocalView(c,d),r.set(u,d);const h=(s.get(l.batchId)||pe()).add(u);s=s.insert(l.batchId,h)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),c=u.key,d=u.value,h=uk();d.forEach(m=>{if(!i.has(m)){const y=gk(n.get(m),r.get(m));y!==null&&h.set(m,y),i=i.add(m)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return L.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return Y.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):sk(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):L.resolve(Jr());let l=-1,u=i;return a.next(c=>L.forEach(c,(d,h)=>(l<h.largestBatchId&&(l=h.largestBatchId),i.get(d)?L.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{u=u.insert(d,m)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,u,c,pe())).next(d=>({batchId:l,changes:lk(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Y(n)).next(r=>{let s=Ji();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=Ji();return this.indexManager.getCollectionParents(e,s).next(a=>L.forEach(a,l=>{const u=function(c,d){return new Ti(d,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r).next(c=>{c.forEach((d,h)=>{i=i.insert(d,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s))).next(i=>{s.forEach((l,u)=>{const c=u.getKey();i.get(c)===null&&(i=i.insert(c,mt.newInvalidDocument(c)))});let a=Ji();return i.forEach((l,u)=>{const c=s.get(l);c!==void 0&&ma(c.mutation,u,zt.empty(),me.now()),sc(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,n){return L.resolve(this.cs.get(n))}saveBundleMetadata(e,n){var r;return this.cs.set(n.id,{id:(r=n).id,version:r.version,createTime:In(r.createTime)}),L.resolve()}getNamedQuery(e,n){return L.resolve(this.hs.get(n))}saveNamedQuery(e,n){return this.hs.set(n.name,function(r){return{name:r.name,query:Mb(r.bundledQuery),readTime:In(r.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(){this.overlays=new Fe(Y.comparator),this.ls=new Map}getOverlay(e,n){return L.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Jr();return L.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.we(e,n,i)}),L.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.ls.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.ls.delete(r)),L.resolve()}getOverlaysForCollection(e,n,r){const s=Jr(),i=n.length+1,a=new Y(n.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const u=l.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return L.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Fe((c,d)=>c-d);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=i.get(c.largestBatchId);d===null&&(d=Jr(),i=i.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const l=Jr(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>l.set(c,d)),!(l.size()>=s)););return L.resolve(l)}we(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.ls.get(s.largestBatchId).delete(r.key);this.ls.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new cb(n,r));let i=this.ls.get(n);i===void 0&&(i=pe(),this.ls.set(n,i)),this.ls.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(){this.fs=new vt(Je.ds),this.ws=new vt(Je._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,n){const r=new Je(e,n);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.ys(new Je(e,n))}ps(e,n){e.forEach(r=>this.removeReference(r,n))}Is(e){const n=new Y(new De([])),r=new Je(n,e),s=new Je(n,e+1),i=[];return this.ws.forEachInRange([r,s],a=>{this.ys(a),i.push(a.key)}),i}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const n=new Y(new De([])),r=new Je(n,e),s=new Je(n,e+1);let i=pe();return this.ws.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const n=new Je(e,0),r=this.fs.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Je{constructor(e,n){this.key=e,this.As=n}static ds(e,n){return Y.comparator(e.key,n.key)||xe(e.As,n.As)}static _s(e,n){return xe(e.As,n.As)||Y.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.vs=1,this.Rs=new vt(Je.ds)}checkEmpty(e){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ub(i,n,r,s);this.mutationQueue.push(a);for(const l of s)this.Rs=this.Rs.add(new Je(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return L.resolve(a)}lookupMutationBatch(e,n){return L.resolve(this.Ps(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.bs(r),i=s<0?0:s;return L.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?-1:this.vs-1)}getAllMutationBatches(e){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Je(n,0),s=new Je(n,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([r,s],a=>{const l=this.Ps(a.As);i.push(l)}),L.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new vt(xe);return n.forEach(s=>{const i=new Je(s,0),a=new Je(s,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([i,a],l=>{r=r.add(l.As)})}),L.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Y.isDocumentKey(i)||(i=i.child(""));const a=new Je(new Y(i),0);let l=new vt(xe);return this.Rs.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(l=l.add(u.As)),!0)},a),L.resolve(this.Vs(l))}Vs(e){const n=[];return e.forEach(r=>{const s=this.Ps(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Pe(this.Ss(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.Rs;return L.forEach(n.mutations,s=>{const i=new Je(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Rs=r})}Cn(e){}containsKey(e,n){const r=new Je(n,0),s=this.Rs.firstAfterOrEqual(r);return L.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,L.resolve()}Ss(e,n){return this.bs(e)}bs(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Ps(e){const n=this.bs(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e){this.Ds=e,this.docs=new Fe(Y.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,a=this.Ds(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():mt.newInvalidDocument(n))}getEntries(e,n){let r=Qn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():mt.newInvalidDocument(s))}),L.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Qn();const a=n.path,l=new Y(a.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||bT(TT(d),r)<=0||(s.has(d.key)||sc(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return L.resolve(i)}getAllFromCollectionGroup(e,n,r,s){re()}Cs(e,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new qb(this)}getSize(e){return L.resolve(this.size)}}class qb extends Lb{constructor(e){super(),this.os=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.os.addEntry(e,s)):this.os.removeEntry(r)}),L.waitFor(n)}getFromCache(e,n){return this.os.getEntry(e,n)}getAllFromCache(e,n){return this.os.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(e){this.persistence=e,this.xs=new bi(n=>xm(n),Sm),this.lastRemoteSnapshotVersion=ie.min(),this.highestTargetId=0,this.Ns=0,this.ks=new bm,this.targetCount=0,this.Ms=gi.kn()}forEachTarget(e,n){return this.xs.forEach((r,s)=>n(s)),L.resolve()}getLastRemoteSnapshotVersion(e){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return L.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Ns&&(this.Ns=n),L.resolve()}Fn(e){this.xs.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Ms=new gi(n),this.highestTargetId=n),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,n){return this.Fn(n),this.targetCount+=1,L.resolve()}updateTargetData(e,n){return this.Fn(n),L.resolve()}removeTargetData(e,n){return this.xs.delete(n.target),this.ks.Is(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.xs.forEach((a,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.xs.delete(a),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),L.waitFor(i).next(()=>s)}getTargetCount(e){return L.resolve(this.targetCount)}getTargetData(e,n){const r=this.xs.get(n)||null;return L.resolve(r)}addMatchingKeys(e,n,r){return this.ks.gs(n,r),L.resolve()}removeMatchingKeys(e,n,r){this.ks.ps(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),L.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.ks.Is(n),L.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ks.Es(n);return L.resolve(r)}containsKey(e,n){return L.resolve(this.ks.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(e,n){this.$s={},this.overlays={},this.Os=new vm(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new Hb(this),this.indexManager=new Ob,this.remoteDocumentCache=function(r){return new Bb(r)}(r=>this.referenceDelegate.Ls(r)),this.serializer=new Pb(n),this.qs=new Vb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new zb,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.$s[e.toKey()];return r||(r=new jb(n,this.referenceDelegate),this.$s[e.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,n,r){Q("MemoryPersistence","Starting transaction:",e);const s=new Kb(this.Os.next());return this.referenceDelegate.Us(),r(s).next(i=>this.referenceDelegate.Ks(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Gs(e,n){return L.or(Object.values(this.$s).map(r=>()=>r.containsKey(e,n)))}}class Kb extends AT{constructor(e){super(),this.currentSequenceNumber=e}}class Dm{constructor(e){this.persistence=e,this.Qs=new bm,this.js=null}static zs(e){return new Dm(e)}get Ws(){if(this.js)return this.js;throw re()}addReference(e,n,r){return this.Qs.addReference(r,n),this.Ws.delete(r.toString()),L.resolve()}removeReference(e,n,r){return this.Qs.removeReference(r,n),this.Ws.add(r.toString()),L.resolve()}markPotentiallyOrphaned(e,n){return this.Ws.add(n.toString()),L.resolve()}removeTarget(e,n){this.Qs.Is(n.targetId).forEach(s=>this.Ws.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Ws.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Us(){this.js=new Set}Ks(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.Ws,r=>{const s=Y.fromPath(r);return this.Hs(e,s).next(i=>{i||n.removeEntry(s,ie.min())})}).next(()=>(this.js=null,n.apply(e)))}updateLimboDocument(e,n){return this.Hs(e,n).next(r=>{r?this.Ws.delete(n.toString()):this.Ws.add(n.toString())})}Ls(e){return 0}Hs(e,n){return L.or([()=>L.resolve(this.Qs.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gs(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Fi=r,this.Bi=s}static Li(e,n){let r=pe(),s=pe();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Am(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(){this.qi=!1}initialize(e,n){this.Ui=e,this.indexManager=n,this.qi=!0}getDocumentsMatchingQuery(e,n,r,s){return this.Ki(e,n).next(i=>i||this.Gi(e,n,s,r)).next(i=>i||this.Qi(e,n))}Ki(e,n){if(cy(n))return L.resolve(null);let r=Gn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Ah(n,null,"F"),r=Gn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=pe(...i);return this.Ui.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.ji(n,l);return this.zi(n,c,a,u.readTime)?this.Ki(e,Ah(n,null,"F")):this.Wi(e,c,n,u)}))})))}Gi(e,n,r,s){return cy(n)||s.isEqual(ie.min())?this.Qi(e,n):this.Ui.getDocuments(e,r).next(i=>{const a=this.ji(n,i);return this.zi(n,a,r,s)?this.Qi(e,n):(Zg()<=we.DEBUG&&Q("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Rh(n)),this.Wi(e,a,n,IT(s,-1)))})}ji(e,n){let r=new vt(ak(e));return n.forEach((s,i)=>{sc(e,i)&&(r=r.add(i))}),r}zi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Qi(e,n){return Zg()<=we.DEBUG&&Q("QueryEngine","Using full collection scan to execute query:",Rh(n)),this.Ui.getDocumentsMatchingQuery(e,n,Dr.min())}Wi(e,n,r,s){return this.Ui.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(e,n,r,s){this.persistence=e,this.Hi=n,this.serializer=s,this.Ji=new Fe(xe),this.Yi=new bi(i=>xm(i),Sm),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(r)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ub(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ji))}}function Yb(t,e,n,r){return new Qb(t,e,n,r)}async function Ik(t,e){const n=oe(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.tr(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],l=[];let u=pe();for(const c of s){a.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of i){l.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return n.localDocuments.getDocuments(r,u).next(c=>({er:c,removedBatchIds:a,addedBatchIds:l}))})})}function Xb(t,e){const n=oe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Zi.newChangeBuffer({trackRemovals:!0});return function(a,l,u,c){const d=u.batch,h=d.keys();let m=L.resolve();return h.forEach(y=>{m=m.next(()=>c.getEntry(l,y)).next(E=>{const v=u.docVersions.get(y);Pe(v!==null),E.version.compareTo(v)<0&&(d.applyToRemoteDocument(E,u),E.isValidDocument()&&(E.setReadTime(u.commitVersion),c.addEntry(E)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=pe();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Tk(t){const e=oe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Bs.getLastRemoteSnapshotVersion(n))}function Jb(t,e){const n=oe(t),r=e.snapshotVersion;let s=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=n.Zi.newChangeBuffer({trackRemovals:!0});s=n.Ji;const l=[];e.targetChanges.forEach((d,h)=>{const m=s.get(h);if(!m)return;l.push(n.Bs.removeMatchingKeys(i,d.removedDocuments,h).next(()=>n.Bs.addMatchingKeys(i,d.addedDocuments,h)));let y=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?y=y.withResumeToken(xt.EMPTY_BYTE_STRING,ie.min()).withLastLimboFreeSnapshotVersion(ie.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),s=s.insert(h,y),function(E,v,w){return E.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(m,y,d)&&l.push(n.Bs.updateTargetData(i,y))});let u=Qn(),c=pe();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(Zb(i,a,e.documentUpdates).next(d=>{u=d.nr,c=d.sr})),!r.isEqual(ie.min())){const d=n.Bs.getLastRemoteSnapshotVersion(i).next(h=>n.Bs.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return L.waitFor(l).next(()=>a.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,c)).next(()=>u)}).then(i=>(n.Ji=s,i))}function Zb(t,e,n){let r=pe(),s=pe();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let a=Qn();return n.forEach((l,u)=>{const c=i.get(l);u.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(ie.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):Q("LocalStore","Ignoring outdated watch update for ",l,". Current version:",c.version," Watch version:",u.version)}),{nr:a,sr:s}})}function eD(t,e){const n=oe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function tD(t,e){const n=oe(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Bs.getTargetData(r,e).next(i=>i?(s=i,L.resolve(s)):n.Bs.allocateTargetId(r).next(a=>(s=new mr(e,a,"TargetPurposeListen",r.currentSequenceNumber),n.Bs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ji.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(r.targetId,r),n.Yi.set(e,r.targetId)),r})}async function Lh(t,e,n){const r=oe(t),s=r.Ji.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Eo(a))throw a;Q("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(s.target)}function ky(t,e,n){const r=oe(t);let s=ie.min(),i=pe();return r.persistence.runTransaction("Execute query","readonly",a=>function(l,u,c){const d=oe(l),h=d.Yi.get(c);return h!==void 0?L.resolve(d.Ji.get(h)):d.Bs.getTargetData(u,c)}(r,a,Gn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(a,l.targetId).next(u=>{i=u})}).next(()=>r.Hi.getDocumentsMatchingQuery(a,e,n?s:ie.min(),n?i:pe())).next(l=>(nD(r,KT(e),l),{documents:l,ir:i})))}function nD(t,e,n){let r=t.Xi.get(e)||ie.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Xi.set(e,r)}class xy{constructor(){this.activeTargetIds=ZT()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rD{constructor(){this.Hr=new xy,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,n,r){this.Jr[e]=n}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new xy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{Yr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nl=null;function id(){return nl===null?nl=268435456+Math.round(2147483648*Math.random()):nl++,"0x"+nl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt="WebChannelConnection";class oD extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.mo=n+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,n,r,s,i){const a=id(),l=this.To(e,n);Q("RestConnection",`Sending RPC '${e}' ${a}:`,l,r);const u={};return this.Eo(u,s,i),this.Ao(e,l,u,r).then(c=>(Q("RestConnection",`Received RPC '${e}' ${a}: `,c),c),c=>{throw hi("RestConnection",`RPC '${e}' ${a} failed with error: `,c,"url: ",l,"request:",r),c})}vo(e,n,r,s,i,a){return this.Io(e,n,r,s,i)}Eo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ii,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}To(e,n){const r=iD[e];return`${this.mo}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,n,r,s){const i=id();return new Promise((a,l)=>{const u=new gT;u.setWithCredentials(!0),u.listenOnce(fT.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case rd.NO_ERROR:const d=u.getResponseJson();Q(dt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),a(d);break;case rd.TIMEOUT:Q(dt,`RPC '${e}' ${i} timed out`),l(new j(I.DEADLINE_EXCEEDED,"Request time out"));break;case rd.HTTP_ERROR:const h=u.getStatus();if(Q(dt,`RPC '${e}' ${i} failed with status:`,h,"response text:",u.getResponseText()),h>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m==null?void 0:m.error;if(y&&y.status&&y.message){const E=function(v){const w=v.toLowerCase().replace(/_/g,"-");return Object.values(I).indexOf(w)>=0?w:I.UNKNOWN}(y.status);l(new j(E,y.message))}else l(new j(I.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new j(I.UNAVAILABLE,"Connection failed."));break;default:re()}}finally{Q(dt,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);Q(dt,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",c,r,15)})}Ro(e,n,r){const s=id(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=dT(),l=hT(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.xmlHttpFactory=new pT({})),this.Eo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const d=i.join("");Q(dt,`Creating RPC '${e}' stream ${s}: ${d}`,u);const h=a.createWebChannel(d,u);let m=!1,y=!1;const E=new aD({ro:w=>{y?Q(dt,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(m||(Q(dt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),m=!0),Q(dt,`RPC '${e}' stream ${s} sending:`,w),h.send(w))},oo:()=>h.close()}),v=(w,f,p)=>{w.listen(f,g=>{try{p(g)}catch(k){setTimeout(()=>{throw k},0)}})};return v(h,Jo.EventType.OPEN,()=>{y||Q(dt,`RPC '${e}' stream ${s} transport opened.`)}),v(h,Jo.EventType.CLOSE,()=>{y||(y=!0,Q(dt,`RPC '${e}' stream ${s} transport closed`),E.wo())}),v(h,Jo.EventType.ERROR,w=>{y||(y=!0,hi(dt,`RPC '${e}' stream ${s} transport errored:`,w),E.wo(new j(I.UNAVAILABLE,"The operation could not be completed")))}),v(h,Jo.EventType.MESSAGE,w=>{var f;if(!y){const p=w.data[0];Pe(!!p);const g=p,k=g.error||((f=g[0])===null||f===void 0?void 0:f.error);if(k){Q(dt,`RPC '${e}' stream ${s} received error:`,k);const _=k.status;let C=function(M){const X=qe[M];if(X!==void 0)return vk(X)}(_),P=k.message;C===void 0&&(C=I.INTERNAL,P="Unknown error status: "+_+" with message "+k.message),y=!0,E.wo(new j(C,P)),h.close()}else Q(dt,`RPC '${e}' stream ${s} received:`,p),E._o(p)}}),v(l,mT.STAT_EVENT,w=>{w.stat===Xg.PROXY?Q(dt,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===Xg.NOPROXY&&Q(dt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{E.fo()},0),E}}function ad(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(t){return new Eb(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bk{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ii=e,this.timerId=n,this.Po=r,this.bo=s,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const n=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),s=Math.max(0,n-r);s>0&&Q("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.So} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,s,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){this.Do!==null&&(this.Do.skipDelay(),this.Do=null)}cancel(){this.Do!==null&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e,n,r,s,i,a,l,u){this.ii=e,this.$o=r,this.Oo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new bk(e,n)}Uo(){return this.state===1||this.state===5||this.Ko()}Ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&this.Bo===null&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,n){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,e!==4?this.qo.reset():n&&n.code===I.RESOURCE_EXHAUSTED?(Kn(n.toString()),Kn("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):n&&n.code===I.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(n)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),n=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Fo===n&&this.Zo(r,s)},r=>{e(()=>{const s=new j(I.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(s)})})}Zo(e,n){const r=this.Xo(this.Fo);this.stream=this.eu(e,n),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(s=>{r(()=>this.tu(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return Q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return n=>{this.ii.enqueueAndForget(()=>this.Fo===e?n():(Q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lD extends Dk{constructor(e,n,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i}eu(e,n){return this.connection.Ro("Listen",e,n)}onMessage(e){this.qo.reset();const n=xb(this.serializer,e),r=function(s){if(!("targetChange"in s))return ie.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?ie.min():i.readTime?In(i.readTime):ie.min()}(e);return this.listener.nu(n,r)}su(e){const n={};n.database=$h(this.serializer),n.addTarget=function(s,i){let a;const l=i.target;if(a=bh(l)?{documents:_b(s,l)}:{query:Cb(s,l)},a.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){a.resumeToken=kk(s,i.resumeToken);const u=Ph(s,i.expectedCount);u!==null&&(a.expectedCount=u)}else if(i.snapshotVersion.compareTo(ie.min())>0){a.readTime=hu(s,i.snapshotVersion.toTimestamp());const u=Ph(s,i.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=Tb(this.serializer,e);r&&(n.labels=r),this.Wo(n)}iu(e){const n={};n.database=$h(this.serializer),n.removeTarget=e,this.Wo(n)}}class uD extends Dk{constructor(e,n,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,a),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,n){return this.connection.Ro("Write",e,n)}onMessage(e){if(Pe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const n=Nb(e.writeResults,e.commitTime),r=In(e.commitTime);return this.listener.cu(r,n)}return Pe(!e.writeResults||e.writeResults.length===0),this.ru=!0,this.listener.au()}hu(){const e={};e.database=$h(this.serializer),this.Wo(e)}uu(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Sb(this.serializer,r))};this.Wo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.lu=!1}fu(){if(this.lu)throw new j(I.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Io(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===I.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new j(I.UNKNOWN,s.toString())})}vo(e,n,r,s){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.vo(e,n,r,i,a,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===I.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new j(I.UNKNOWN,i.toString())})}terminate(){this.lu=!0}}class dD{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){this.wu===0&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){this.state==="Online"?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,e==="Online"&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Kn(n),this.mu=!1):Q("OnlineStateTracker",n)}Tu(){this._u!==null&&(this._u.cancel(),this._u=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hD{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr(a=>{r.enqueueAndForget(async()=>{ws(this)&&(Q("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=oe(l);u.vu.add(4),await xo(u),u.bu.set("Unknown"),u.vu.delete(4),await cc(u)}(this))})}),this.bu=new dD(r,s)}}async function cc(t){if(ws(t))for(const e of t.Ru)await e(!0)}async function xo(t){for(const e of t.Ru)await e(!1)}function Ak(t,e){const n=oe(t);n.Au.has(e.targetId)||(n.Au.set(e.targetId,e),Mm(n)?Pm(n):Di(n).Ko()&&Rm(n,e))}function Rk(t,e){const n=oe(t),r=Di(n);n.Au.delete(e),r.Ko()&&Pk(n,e),n.Au.size===0&&(r.Ko()?r.jo():ws(n)&&n.bu.set("Unknown"))}function Rm(t,e){if(t.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ie.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Di(t).su(e)}function Pk(t,e){t.Vu.qt(e),Di(t).iu(e)}function Pm(t){t.Vu=new pb({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),le:e=>t.Au.get(e)||null,ue:()=>t.datastore.serializer.databaseId}),Di(t).start(),t.bu.gu()}function Mm(t){return ws(t)&&!Di(t).Uo()&&t.Au.size>0}function ws(t){return oe(t).vu.size===0}function Mk(t){t.Vu=void 0}async function fD(t){t.Au.forEach((e,n)=>{Rm(t,e)})}async function mD(t,e){Mk(t),Mm(t)?(t.bu.Iu(e),Pm(t)):t.bu.set("Unknown")}async function pD(t,e,n){if(t.bu.set("Online"),e instanceof wk&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const a of s.targetIds)r.Au.has(a)&&(await r.remoteSyncer.rejectListen(a,i),r.Au.delete(a),r.Vu.removeTarget(a))}(t,e)}catch(r){Q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await fu(t,r)}else if(e instanceof xl?t.Vu.Ht(e):e instanceof Ek?t.Vu.ne(e):t.Vu.Xt(e),!n.isEqual(ie.min()))try{const r=await Tk(t.localStore);n.compareTo(r)>=0&&await function(s,i){const a=s.Vu.ce(i);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const c=s.Au.get(u);c&&s.Au.set(u,c.withResumeToken(l.resumeToken,i))}}),a.targetMismatches.forEach((l,u)=>{const c=s.Au.get(l);if(!c)return;s.Au.set(l,c.withResumeToken(xt.EMPTY_BYTE_STRING,c.snapshotVersion)),Pk(s,l);const d=new mr(c.target,l,u,c.sequenceNumber);Rm(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){Q("RemoteStore","Failed to raise snapshot:",r),await fu(t,r)}}async function fu(t,e,n){if(!Eo(e))throw e;t.vu.add(1),await xo(t),t.bu.set("Offline"),n||(n=()=>Tk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Q("RemoteStore","Retrying IndexedDB access"),await n(),t.vu.delete(1),await cc(t)})}function Ok(t,e){return e().catch(n=>fu(t,n,e))}async function dc(t){const e=oe(t),n=Rr(e);let r=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;gD(e);)try{const s=await eD(e.localStore,r);if(s===null){e.Eu.length===0&&n.jo();break}r=s.batchId,yD(e,s)}catch(s){await fu(e,s)}$k(e)&&Lk(e)}function gD(t){return ws(t)&&t.Eu.length<10}function yD(t,e){t.Eu.push(e);const n=Rr(t);n.Ko()&&n.ou&&n.uu(e.mutations)}function $k(t){return ws(t)&&!Rr(t).Uo()&&t.Eu.length>0}function Lk(t){Rr(t).start()}async function vD(t){Rr(t).hu()}async function ED(t){const e=Rr(t);for(const n of t.Eu)e.uu(n.mutations)}async function wD(t,e,n){const r=t.Eu.shift(),s=_m.from(r,e,n);await Ok(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await dc(t)}async function kD(t,e){e&&Rr(t).ou&&await async function(n,r){if(s=r.code,hb(s)&&s!==I.ABORTED){const i=n.Eu.shift();Rr(n).Qo(),await Ok(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await dc(n)}var s}(t,e),$k(t)&&Lk(t)}async function Ny(t,e){const n=oe(t);n.asyncQueue.verifyOperationInProgress(),Q("RemoteStore","RemoteStore received new credentials");const r=ws(n);n.vu.add(3),await xo(n),r&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.vu.delete(3),await cc(n)}async function xD(t,e){const n=oe(t);e?(n.vu.delete(2),await cc(n)):e||(n.vu.add(2),await xo(n),n.bu.set("Unknown"))}function Di(t){return t.Su||(t.Su=function(e,n,r){const s=oe(e);return s.fu(),new lD(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(t.datastore,t.asyncQueue,{uo:fD.bind(null,t),ao:mD.bind(null,t),nu:pD.bind(null,t)}),t.Ru.push(async e=>{e?(t.Su.Qo(),Mm(t)?Pm(t):t.bu.set("Unknown")):(await t.Su.stop(),Mk(t))})),t.Su}function Rr(t){return t.Du||(t.Du=function(e,n,r){const s=oe(e);return s.fu(),new uD(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(t.datastore,t.asyncQueue,{uo:vD.bind(null,t),ao:kD.bind(null,t),au:ED.bind(null,t),cu:wD.bind(null,t)}),t.Ru.push(async e=>{e?(t.Du.Qo(),await dc(t)):(await t.Du.stop(),t.Eu.length>0&&(Q("RemoteStore",`Stopping write stream with ${t.Eu.length} pending writes`),t.Eu=[]))})),t.Du}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Vn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}static createAndSchedule(e,n,r,s,i){const a=Date.now()+r,l=new Om(e,n,a,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new j(I.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $m(t,e){if(Kn("AsyncQueue",`${e}: ${t}`),Eo(t))return new j(I.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Y.comparator(n.key,r.key):(n,r)=>Y.comparator(n.key,r.key),this.keyedMap=Ji(),this.sortedSet=new Fe(this.comparator)}static emptySet(e){return new ti(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ti)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ti;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(){this.Cu=new Fe(Y.comparator)}track(e){const n=e.doc.key,r=this.Cu.get(n);r?e.type!==0&&r.type===3?this.Cu=this.Cu.insert(n,e):e.type===3&&r.type!==1?this.Cu=this.Cu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Cu=this.Cu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Cu=this.Cu.remove(n):e.type===1&&r.type===2?this.Cu=this.Cu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):re():this.Cu=this.Cu.insert(n,e)}xu(){const e=[];return this.Cu.inorderTraversal((n,r)=>{e.push(r)}),e}}class yi{constructor(e,n,r,s,i,a,l,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,s,i){const a=[];return n.forEach(l=>{a.push({type:0,doc:l})}),new yi(e,n,ti.emptySet(n),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SD{constructor(){this.Nu=void 0,this.listeners=[]}}class ND{constructor(){this.queries=new bi(e=>ik(e),rc),this.onlineState="Unknown",this.ku=new Set}}async function Lm(t,e){const n=oe(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new SD),s)try{i.Nu=await n.onListen(r)}catch(a){const l=$m(a,`Initialization of query '${Rh(e.query)}' failed`);return void e.onError(l)}n.queries.set(r,i),i.listeners.push(e),e.Mu(n.onlineState),i.Nu&&e.$u(i.Nu)&&Um(n)}async function Fm(t,e){const n=oe(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const a=i.listeners.indexOf(e);a>=0&&(i.listeners.splice(a,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function _D(t,e){const n=oe(t);let r=!1;for(const s of e){const i=s.query,a=n.queries.get(i);if(a){for(const l of a.listeners)l.$u(s)&&(r=!0);a.Nu=s}}r&&Um(n)}function CD(t,e,n){const r=oe(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function Um(t){t.ku.forEach(e=>{e.next()})}class Vm{constructor(e,n,r){this.query=e,this.Ou=n,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new yi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),n=!0):this.qu(e,this.onlineState)&&(this.Uu(e),n=!0),this.Bu=e,n}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let n=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),n=!0),n}qu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Ku||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Lu(e){if(e.docChanges.length>0)return!0;const n=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Uu(e){e=yi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk{constructor(e){this.key=e}}class Uk{constructor(e){this.key=e}}class ID{constructor(e,n){this.query=e,this.Yu=n,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=pe(),this.mutatedKeys=pe(),this.tc=ak(e),this.ec=new ti(this.tc)}get nc(){return this.Yu}sc(e,n){const r=n?n.ic:new _y,s=n?n.ec:this.ec;let i=n?n.mutatedKeys:this.mutatedKeys,a=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const m=s.get(d),y=sc(this.query,h)?h:null,E=!!m&&this.mutatedKeys.has(m.key),v=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let w=!1;m&&y?m.data.isEqual(y.data)?E!==v&&(r.track({type:3,doc:y}),w=!0):this.rc(m,y)||(r.track({type:2,doc:y}),w=!0,(u&&this.tc(y,u)>0||c&&this.tc(y,c)<0)&&(l=!0)):!m&&y?(r.track({type:0,doc:y}),w=!0):m&&!y&&(r.track({type:1,doc:m}),w=!0,(u||c)&&(l=!0)),w&&(y?(a=a.add(y),i=v?i.add(d):i.delete(d)):(a=a.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const d=this.query.limitType==="F"?a.last():a.first();a=a.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{ec:a,ic:r,zi:l,mutatedKeys:i}}rc(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const i=e.ic.xu();i.sort((c,d)=>function(h,m){const y=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return re()}};return y(h)-y(m)}(c.type,d.type)||this.tc(c.doc,d.doc)),this.oc(r);const a=n?this.uc():[],l=this.Zu.size===0&&this.current?1:0,u=l!==this.Xu;return this.Xu=l,i.length!==0||u?{snapshot:new yi(this.query,e.ec,s,i,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:a}:{cc:a}}Mu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ec:this.ec,ic:new _y,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(n=>this.Yu=this.Yu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Yu=this.Yu.delete(n)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=pe(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});const n=[];return e.forEach(r=>{this.Zu.has(r)||n.push(new Uk(r))}),this.Zu.forEach(r=>{e.has(r)||n.push(new Fk(r))}),n}hc(e){this.Yu=e.ir,this.Zu=pe();const n=this.sc(e.documents);return this.applyChanges(n,!0)}lc(){return yi.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,this.Xu===0,this.hasCachedResults)}}class TD{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class bD{constructor(e){this.key=e,this.fc=!1}}class DD{constructor(e,n,r,s,i,a){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.dc={},this.wc=new bi(l=>ik(l),rc),this._c=new Map,this.mc=new Set,this.gc=new Fe(Y.comparator),this.yc=new Map,this.Ic=new bm,this.Tc={},this.Ec=new Map,this.Ac=gi.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return this.vc===!0}}async function AD(t,e){const n=zD(t);let r,s;const i=n.wc.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.lc();else{const a=await tD(n.localStore,Gn(e)),l=n.sharedClientState.addLocalQueryTarget(a.targetId);r=a.targetId,s=await RD(n,e,r,l==="current",a.resumeToken),n.isPrimaryClient&&Ak(n.remoteStore,a)}return s}async function RD(t,e,n,r,s){t.Rc=(h,m,y)=>async function(E,v,w,f){let p=v.view.sc(w);p.zi&&(p=await ky(E.localStore,v.query,!1).then(({documents:_})=>v.view.sc(_,p)));const g=f&&f.targetChanges.get(v.targetId),k=v.view.applyChanges(p,E.isPrimaryClient,g);return Iy(E,v.targetId,k.cc),k.snapshot}(t,h,m,y);const i=await ky(t.localStore,e,!0),a=new ID(e,i.ir),l=a.sc(i.documents),u=ko.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),c=a.applyChanges(l,t.isPrimaryClient,u);Iy(t,n,c.cc);const d=new TD(e,n,a);return t.wc.set(e,d),t._c.has(n)?t._c.get(n).push(e):t._c.set(n,[e]),c.snapshot}async function PD(t,e){const n=oe(t),r=n.wc.get(e),s=n._c.get(r.targetId);if(s.length>1)return n._c.set(r.targetId,s.filter(i=>!rc(i,e))),void n.wc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Lh(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Rk(n.remoteStore,r.targetId),Fh(n,r.targetId)}).catch(vo)):(Fh(n,r.targetId),await Lh(n.localStore,r.targetId,!0))}async function MD(t,e,n){const r=jD(t);try{const s=await function(i,a){const l=oe(i),u=me.now(),c=a.reduce((m,y)=>m.add(y.key),pe());let d,h;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=Qn(),E=pe();return l.Zi.getEntries(m,c).next(v=>{y=v,y.forEach((w,f)=>{f.isValidDocument()||(E=E.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(v=>{d=v;const w=[];for(const f of a){const p=ob(f,d.get(f.key).overlayedDocument);p!=null&&w.push(new Ur(f.key,p,Xw(p.value.mapValue),It.exists(!0)))}return l.mutationQueue.addMutationBatch(m,u,w,a)}).next(v=>{h=v;const w=v.applyToLocalDocumentSet(d,E);return l.documentOverlayCache.saveOverlays(m,v.batchId,w)})}).then(()=>({batchId:h.batchId,changes:lk(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,a,l){let u=i.Tc[i.currentUser.toKey()];u||(u=new Fe(xe)),u=u.insert(a,l),i.Tc[i.currentUser.toKey()]=u}(r,s.batchId,n),await So(r,s.changes),await dc(r.remoteStore)}catch(s){const i=$m(s,"Failed to persist write");n.reject(i)}}async function Vk(t,e){const n=oe(t);try{const r=await Jb(n.localStore,e);e.targetChanges.forEach((s,i)=>{const a=n.yc.get(i);a&&(Pe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.fc=!0:s.modifiedDocuments.size>0?Pe(a.fc):s.removedDocuments.size>0&&(Pe(a.fc),a.fc=!1))}),await So(n,r,e)}catch(r){await vo(r)}}function Cy(t,e,n){const r=oe(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.wc.forEach((i,a)=>{const l=a.view.Mu(e);l.snapshot&&s.push(l.snapshot)}),function(i,a){const l=oe(i);l.onlineState=a;let u=!1;l.queries.forEach((c,d)=>{for(const h of d.listeners)h.Mu(a)&&(u=!0)}),u&&Um(l)}(r.eventManager,e),s.length&&r.dc.nu(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function OD(t,e,n){const r=oe(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.yc.get(e),i=s&&s.key;if(i){let a=new Fe(Y.comparator);a=a.insert(i,mt.newNoDocument(i,ie.min()));const l=pe().add(i),u=new lc(ie.min(),new Map,new Fe(xe),a,l);await Vk(r,u),r.gc=r.gc.remove(i),r.yc.delete(e),zm(r)}else await Lh(r.localStore,e,!1).then(()=>Fh(r,e,n)).catch(vo)}async function $D(t,e){const n=oe(t),r=e.batch.batchId;try{const s=await Xb(n.localStore,e);jk(n,r,null),zk(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await So(n,s)}catch(s){await vo(s)}}async function LD(t,e,n){const r=oe(t);try{const s=await function(i,a){const l=oe(i);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return l.mutationQueue.lookupMutationBatch(u,a).next(d=>(Pe(d!==null),c=d.keys(),l.mutationQueue.removeMutationBatch(u,d))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,c,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,c)).next(()=>l.localDocuments.getDocuments(u,c))})}(r.localStore,e);jk(r,e,n),zk(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await So(r,s)}catch(s){await vo(s)}}function zk(t,e){(t.Ec.get(e)||[]).forEach(n=>{n.resolve()}),t.Ec.delete(e)}function jk(t,e,n){const r=oe(t);let s=r.Tc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Tc[r.currentUser.toKey()]=s}}function Fh(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t._c.get(e))t.wc.delete(r),n&&t.dc.Pc(r,n);t._c.delete(e),t.isPrimaryClient&&t.Ic.Is(e).forEach(r=>{t.Ic.containsKey(r)||Bk(t,r)})}function Bk(t,e){t.mc.delete(e.path.canonicalString());const n=t.gc.get(e);n!==null&&(Rk(t.remoteStore,n),t.gc=t.gc.remove(e),t.yc.delete(n),zm(t))}function Iy(t,e,n){for(const r of n)r instanceof Fk?(t.Ic.addReference(r.key,e),FD(t,r)):r instanceof Uk?(Q("SyncEngine","Document no longer in limbo: "+r.key),t.Ic.removeReference(r.key,e),t.Ic.containsKey(r.key)||Bk(t,r.key)):re()}function FD(t,e){const n=e.key,r=n.path.canonicalString();t.gc.get(n)||t.mc.has(r)||(Q("SyncEngine","New document in limbo: "+n),t.mc.add(r),zm(t))}function zm(t){for(;t.mc.size>0&&t.gc.size<t.maxConcurrentLimboResolutions;){const e=t.mc.values().next().value;t.mc.delete(e);const n=new Y(De.fromString(e)),r=t.Ac.next();t.yc.set(r,new bD(n)),t.gc=t.gc.insert(n,r),Ak(t.remoteStore,new mr(Gn(tc(n.path)),r,"TargetPurposeLimboResolution",vm.ct))}}async function So(t,e,n){const r=oe(t),s=[],i=[],a=[];r.wc.isEmpty()||(r.wc.forEach((l,u)=>{a.push(r.Rc(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c!=null&&c.fromCache?"not-current":"current"),c){s.push(c);const d=Am.Li(u.targetId,c);i.push(d)}}))}),await Promise.all(a),r.dc.nu(s),await async function(l,u){const c=oe(l);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>L.forEach(u,h=>L.forEach(h.Fi,m=>c.persistence.referenceDelegate.addReference(d,h.targetId,m)).next(()=>L.forEach(h.Bi,m=>c.persistence.referenceDelegate.removeReference(d,h.targetId,m)))))}catch(d){if(!Eo(d))throw d;Q("LocalStore","Failed to update sequence numbers: "+d)}for(const d of u){const h=d.targetId;if(!d.fromCache){const m=c.Ji.get(h),y=m.snapshotVersion,E=m.withLastLimboFreeSnapshotVersion(y);c.Ji=c.Ji.insert(h,E)}}}(r.localStore,i))}async function UD(t,e){const n=oe(t);if(!n.currentUser.isEqual(e)){Q("SyncEngine","User change. New user:",e.toKey());const r=await Ik(n.localStore,e);n.currentUser=e,function(s,i){s.Ec.forEach(a=>{a.forEach(l=>{l.reject(new j(I.CANCELLED,i))})}),s.Ec.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await So(n,r.er)}}function VD(t,e){const n=oe(t),r=n.yc.get(e);if(r&&r.fc)return pe().add(r.key);{let s=pe();const i=n._c.get(e);if(!i)return s;for(const a of i){const l=n.wc.get(a);s=s.unionWith(l.view.nc)}return s}}function zD(t){const e=oe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Vk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=VD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=OD.bind(null,e),e.dc.nu=_D.bind(null,e.eventManager),e.dc.Pc=CD.bind(null,e.eventManager),e}function jD(t){const e=oe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$D.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=LD.bind(null,e),e}class Ty{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=uc(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return Yb(this.persistence,new Gb,e.initialUser,this.serializer)}createPersistence(e){return new Wb(Dm.zs,this.serializer)}createSharedClientState(e){return new rD}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class BD{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Cy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=UD.bind(null,this.syncEngine),await xD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new ND}createDatastore(e){const n=uc(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new oD(s));var s;return function(i,a,l,u){return new cD(i,a,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,i=l=>Cy(this.syncEngine,l,0),a=Sy.D()?new Sy:new sD,new hD(n,r,s,i,a);var n,r,s,i,a}createSyncEngine(e,n){return function(r,s,i,a,l,u,c){const d=new DD(r,s,i,a,l,u);return c&&(d.vc=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=oe(e);Q("RemoteStore","RemoteStore shutting down."),n.vu.add(5),await xo(n),n.Pu.shutdown(),n.bu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Kn("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qD{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=ht.UNAUTHENTICATED,this.clientId=Gw.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{Q("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(Q("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new j(I.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Vn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=$m(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function od(t,e){t.asyncQueue.verifyOperationInProgress(),Q("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Ik(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function by(t,e){t.asyncQueue.verifyOperationInProgress();const n=await WD(t);Q("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>Ny(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>Ny(e.remoteStore,i)),t._onlineComponents=e}function HD(t){return t.name==="FirebaseError"?t.code===I.FAILED_PRECONDITION||t.code===I.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function WD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Q("FirestoreClient","Using user provided OfflineComponentProvider");try{await od(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!HD(n))throw n;hi("Error using user provided cache. Falling back to memory cache: "+n),await od(t,new Ty)}}else Q("FirestoreClient","Using default OfflineComponentProvider"),await od(t,new Ty);return t._offlineComponents}async function qk(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Q("FirestoreClient","Using user provided OnlineComponentProvider"),await by(t,t._uninitializedComponentsProvider._online)):(Q("FirestoreClient","Using default OnlineComponentProvider"),await by(t,new BD))),t._onlineComponents}function KD(t){return qk(t).then(e=>e.syncEngine)}async function mu(t){const e=await qk(t),n=e.eventManager;return n.onListen=AD.bind(null,e.syncEngine),n.onUnlisten=PD.bind(null,e.syncEngine),n}function GD(t,e,n={}){const r=new Vn;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,a,l,u){const c=new jm({next:h=>{i.enqueueAndForget(()=>Fm(s,d));const m=h.docs.has(a);!m&&h.fromCache?u.reject(new j(I.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&h.fromCache&&l&&l.source==="server"?u.reject(new j(I.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new Vm(tc(a.path),c,{includeMetadataChanges:!0,Ku:!0});return Lm(s,d)}(await mu(t),t.asyncQueue,e,n,r)),r.promise}function QD(t,e,n={}){const r=new Vn;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,a,l,u){const c=new jm({next:h=>{i.enqueueAndForget(()=>Fm(s,d)),h.fromCache&&l.source==="server"?u.reject(new j(I.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new Vm(a,c,{includeMetadataChanges:!0,Ku:!0});return Lm(s,d)}(await mu(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hk(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dy=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wk(t,e,n){if(!n)throw new j(I.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function YD(t,e,n,r){if(e===!0&&r===!0)throw new j(I.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Ay(t){if(!Y.isDocumentKey(t))throw new j(I.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ry(t){if(Y.isDocumentKey(t))throw new j(I.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function hc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":re()}function Tt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new j(I.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=hc(t);throw new j(I.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new j(I.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new j(I.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}YD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Hk((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new j(I.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new j(I.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new j(I.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(n=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,n.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var n,r}}class fc{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Py({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new j(I.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new j(I.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Py(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new vT;switch(n.type){case"firstParty":return new xT(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new j(I.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=Dy.get(e);n&&(Q("ComponentProvider","Removing Datastore"),Dy.delete(e),n.terminate())}(this),Promise.resolve()}}function XD(t,e,n,r={}){var s;const i=(t=Tt(t,fc))._getSettings(),a=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&hi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=ht.MOCK_USER;else{l=zS(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new j(I.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new ht(c)}t._authCredentials=new ET(new Kw(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Et(this.firestore,e,this._key)}}class Vr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Vr(this.firestore,e,this._query)}}class Cr extends Vr{constructor(e,n,r){super(e,n,tc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Et(this.firestore,null,new Y(e))}withConverter(e){return new Cr(this.firestore,e,this._path)}}function Ye(t,e,...n){if(t=Ve(t),Wk("collection","path",e),t instanceof fc){const r=De.fromString(e,...n);return Ry(r),new Cr(t,null,r)}{if(!(t instanceof Et||t instanceof Cr))throw new j(I.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(De.fromString(e,...n));return Ry(r),new Cr(t.firestore,null,r)}}function Ae(t,e,...n){if(t=Ve(t),arguments.length===1&&(e=Gw.A()),Wk("doc","path",e),t instanceof fc){const r=De.fromString(e,...n);return Ay(r),new Et(t,null,new Y(r))}{if(!(t instanceof Et||t instanceof Cr))throw new j(I.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(De.fromString(e,...n));return Ay(r),new Et(t.firestore,t instanceof Cr?t.converter:null,new Y(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new bk(this,"async_queue_retry"),this.Xc=()=>{const n=ad();n&&Q("AsyncQueue","Visibility state changed to "+n.visibilityState),this.qo.Mo()};const e=ad();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const n=ad();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const n=new Vn;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(this.Qc.length!==0){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!Eo(e))throw e;Q("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const n=this.Gc.then(()=>(this.Hc=!0,e().catch(r=>{this.Wc=r,this.Hc=!1;const s=function(i){let a=i.message||"";return i.stack&&(a=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),a}(r);throw Kn("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Hc=!1,r))));return this.Gc=n,n}enqueueAfterDelay(e,n,r){this.Zc(),this.Yc.indexOf(e)>-1&&(n=0);const s=Om.createAndSchedule(this,e,n,r,i=>this.na(i));return this.zc.push(s),s}Zc(){this.Wc&&re()}verifyOperationInProgress(){}async sa(){let e;do e=this.Gc,await e;while(e!==this.Gc)}ia(e){for(const n of this.zc)if(n.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.zc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const n=this.zc.indexOf(e);this.zc.splice(n,1)}}function My(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(t,["next","error","complete"])}class bn extends fc{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new JD,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Kk(this),this._firestoreClient.terminate()}}function ZD(t,e){const n=typeof t=="object"?t:uE(),r=typeof t=="string"?t:"(default)",s=Vf(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=US("firestore");i&&XD(s,...i)}return s}function No(t){return t._firestoreClient||Kk(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Kk(t){var e,n,r;const s=t._freezeSettings(),i=function(a,l,u,c){return new MT(a,l,u,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,Hk(c.experimentalLongPollingOptions),c.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new qD(t._authCredentials,t._appCheckCredentials,t._queue,i),!((n=s.cache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.cache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.cache.kind,_offline:s.cache._offlineComponentProvider,_online:s.cache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new vi(xt.fromBase64String(e))}catch(n){throw new j(I.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new vi(xt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new j(I.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new j(I.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new j(I.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA=/^__.*__$/;class tA{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ur(e,this.data,this.fieldMask,n,this.fieldTransforms):new wo(e,this.data,n,this.fieldTransforms)}}class Gk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ur(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Qk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw re()}}class qm{constructor(e,n,r,s,i,a){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new qm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.aa({path:r,la:!1});return s.fa(e),s}da(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.aa({path:r,la:!1});return s.ua(),s}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return pu(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(e.length===0)throw this._a("Document fields must not be empty");if(Qk(this.ca)&&eA.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class nA{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||uc(e)}ya(e,n,r,s=!1){return new qm({ca:e,methodName:n,ga:r,path:pt.emptyPath(),la:!1,ma:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Co(t){const e=t._freezeSettings(),n=uc(t._databaseId);return new nA(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Hm(t,e,n,r,s,i={}){const a=t.ya(i.merge||i.mergeFields?2:0,e,n,s);Km("Data must be an object, but it was:",a,r);const l=Jk(r,a);let u,c;if(i.merge)u=new zt(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const m=Uh(e,h,n);if(!a.contains(m))throw new j(I.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);ex(d,m)||d.push(m)}u=new zt(d),c=a.fieldTransforms.filter(h=>u.covers(h.field))}else u=null,c=a.fieldTransforms;return new tA(new Mt(l),u,c)}class pc extends mc{_toFieldTransform(e){if(e.ca!==2)throw e.ca===1?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pc}}class Wm extends mc{_toFieldTransform(e){return new rb(e.path,new Ga)}isEqual(e){return e instanceof Wm}}function Yk(t,e,n,r){const s=t.ya(1,e,n);Km("Data must be an object, but it was:",s,r);const i=[],a=Mt.empty();Es(r,(u,c)=>{const d=Gm(e,u,n);c=Ve(c);const h=s.da(d);if(c instanceof pc)i.push(d);else{const m=Io(c,h);m!=null&&(i.push(d),a.set(d,m))}});const l=new zt(i);return new Gk(a,l,s.fieldTransforms)}function Xk(t,e,n,r,s,i){const a=t.ya(1,e,n),l=[Uh(e,r,n)],u=[s];if(i.length%2!=0)throw new j(I.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(Uh(e,i[m])),u.push(i[m+1]);const c=[],d=Mt.empty();for(let m=l.length-1;m>=0;--m)if(!ex(c,l[m])){const y=l[m];let E=u[m];E=Ve(E);const v=a.da(y);if(E instanceof pc)c.push(y);else{const w=Io(E,v);w!=null&&(c.push(y),d.set(y,w))}}const h=new zt(c);return new Gk(d,h,a.fieldTransforms)}function rA(t,e,n,r=!1){return Io(n,t.ya(r?4:3,e))}function Io(t,e){if(Zk(t=Ve(t)))return Km("Unsupported field value:",e,t),Jk(t,e);if(t instanceof mc)return function(n,r){if(!Qk(r.ca))throw r._a(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.la&&e.ca!==4)throw e._a("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const a of n){let l=Io(a,r.wa(i));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),i++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=Ve(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return eb(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=me.fromDate(n);return{timestampValue:hu(r.serializer,s)}}if(n instanceof me){const s=new me(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:hu(r.serializer,s)}}if(n instanceof Bm)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof vi)return{bytesValue:kk(r.serializer,n._byteString)};if(n instanceof Et){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r._a(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Tm(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r._a(`Unsupported field value: ${hc(n)}`)}(t,e)}function Jk(t,e){const n={};return Qw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Es(t,(r,s)=>{const i=Io(s,e.ha(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Zk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof me||t instanceof Bm||t instanceof vi||t instanceof Et||t instanceof mc)}function Km(t,e,n){if(!Zk(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=hc(n);throw r==="an object"?e._a(t+" a custom object"):e._a(t+" "+r)}}function Uh(t,e,n){if((e=Ve(e))instanceof _o)return e._internalPath;if(typeof e=="string")return Gm(t,e);throw pu("Field path arguments must be of type string or ",t,!1,void 0,n)}const sA=new RegExp("[~\\*/\\[\\]]");function Gm(t,e,n){if(e.search(sA)>=0)throw pu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new _o(...e.split("."))._internalPath}catch{throw pu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function pu(t,e,n,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||a)&&(u+=" (found",i&&(u+=` in field ${r}`),a&&(u+=` in document ${s}`),u+=")"),new j(I.INVALID_ARGUMENT,l+t+u)}function ex(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Et(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new iA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Qm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class iA extends tx{data(){return super.data()}}function Qm(t,e){return typeof e=="string"?Gm(t,e):e instanceof _o?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nx(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new j(I.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ym{}class rx extends Ym{}function Vh(t,e,...n){let r=[];e instanceof Ym&&r.push(e),r=r.concat(n),function(s){const i=s.filter(l=>l instanceof Jm).length,a=s.filter(l=>l instanceof Xm).length;if(i>1||i>0&&a>0)throw new j(I.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Xm extends rx{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Xm(e,n,r)}_apply(e){const n=this._parse(e);return sx(e._query,n),new Vr(e.firestore,e.converter,Dh(e._query,n))}_parse(e){const n=Co(e.firestore);return function(s,i,a,l,u,c,d){let h;if(u.isKeyField()){if(c==="array-contains"||c==="array-contains-any")throw new j(I.INVALID_ARGUMENT,`Invalid Query. You can't perform '${c}' queries on documentId().`);if(c==="in"||c==="not-in"){$y(d,c);const m=[];for(const y of d)m.push(Oy(l,s,y));h={arrayValue:{values:m}}}else h=Oy(l,s,d)}else c!=="in"&&c!=="not-in"&&c!=="array-contains-any"||$y(d,c),h=rA(a,i,d,c==="in"||c==="not-in");return Ke.create(u,c,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Jm extends Ym{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Jm(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:pn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,s){let i=r;const a=s.getFlattenedFilters();for(const l of a)sx(i,l),i=Dh(i,l)}(e._query,n),new Vr(e.firestore,e.converter,Dh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Zm extends rx{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Zm(e,n)}_apply(e){const n=function(r,s,i){if(r.startAt!==null)throw new j(I.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new j(I.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const a=new Zs(s,i);return function(l,u){if(Nm(l)===null){const c=nc(l);c!==null&&ix(l,c,u.field)}}(r,a),a}(e._query,this._field,this._direction);return new Vr(e.firestore,e.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new Ti(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function aA(t,e="asc"){const n=e,r=Qm("orderBy",t);return Zm._create(r,n)}function Oy(t,e,n){if(typeof(n=Ve(n))=="string"){if(n==="")throw new j(I.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sk(e)&&n.indexOf("/")!==-1)throw new j(I.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(De.fromString(n));if(!Y.isDocumentKey(r))throw new j(I.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return sy(t,new Y(r))}if(n instanceof Et)return sy(t,n._key);throw new j(I.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hc(n)}.`)}function $y(t,e){if(!Array.isArray(t)||t.length===0)throw new j(I.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sx(t,e){if(e.isInequality()){const r=nc(t),s=e.field;if(r!==null&&!r.isEqual(s))throw new j(I.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${s.toString()}'`);const i=Nm(t);i!==null&&ix(t,s,i)}const n=function(r,s){for(const i of r)for(const a of i.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new j(I.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new j(I.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function ix(t,e,n){if(!n.isEqual(e))throw new j(I.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class oA{convertValue(e,n="none"){switch(fs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return He(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(hs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw re()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Es(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new Bm(He(e.latitude),He(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=wm(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ha(e));default:return null}}convertTimestamp(e){const n=Ar(e);return new me(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=De.fromString(e);Pe(Ck(r));const s=new Wa(r.get(1),r.get(3)),i=new Y(r.popFirst(5));return s.isEqual(n)||Kn(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ax extends tx{constructor(e,n,r,s,i,a){super(e,n,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Sl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Qm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Sl extends ax{data(e={}){return super.data(e)}}class ox{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new ea(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Sl(this._firestore,this._userDataWriter,r.key,r,new ea(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new j(I.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(a=>{const l=new Sl(r._firestore,r._userDataWriter,a.doc.key,a.doc,new ea(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:i++}})}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Sl(r._firestore,r._userDataWriter,a.doc.key,a.doc,new ea(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,c=-1;return a.type!==0&&(u=i.indexOf(a.doc.key),i=i.delete(a.doc.key)),a.type!==1&&(i=i.add(a.doc),c=i.indexOf(a.doc.key)),{type:lA(a.type),doc:l,oldIndex:u,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function lA(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return re()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gu(t){t=Tt(t,Et);const e=Tt(t.firestore,bn);return GD(No(e),t._key).then(n=>ux(e,t,n))}class tp extends oA{constructor(e){super(),this.firestore=e}convertBytes(e){return new vi(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Et(this.firestore,null,n)}}function ms(t){t=Tt(t,Vr);const e=Tt(t.firestore,bn),n=No(e),r=new tp(e);return nx(t._query),QD(n,t._query).then(s=>new ox(e,r,t,s))}function lx(t,e,n){t=Tt(t,Et);const r=Tt(t.firestore,bn),s=ep(t.converter,e,n);return To(r,[Hm(Co(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,It.none())])}function ps(t,e,n,...r){t=Tt(t,Et);const s=Tt(t.firestore,bn),i=Co(s);let a;return a=typeof(e=Ve(e))=="string"||e instanceof _o?Xk(i,"updateDoc",t._key,e,n,r):Yk(i,"updateDoc",t._key,e),To(s,[a.toMutation(t._key,It.exists(!0))])}function rs(t){return To(Tt(t.firestore,bn),[new oc(t._key,It.none())])}function Pr(t,e){const n=Tt(t.firestore,bn),r=Ae(t),s=ep(t.converter,e);return To(n,[Hm(Co(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,It.exists(!1))]).then(()=>r)}function uA(t,...e){var n,r,s;t=Ve(t);let i={includeMetadataChanges:!1},a=0;typeof e[a]!="object"||My(e[a])||(i=e[a],a++);const l={includeMetadataChanges:i.includeMetadataChanges};if(My(e[a])){const h=e[a];e[a]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[a+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[a+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let u,c,d;if(t instanceof Et)c=Tt(t.firestore,bn),d=tc(t._key.path),u={next:h=>{e[a]&&e[a](ux(c,t,h))},error:e[a+1],complete:e[a+2]};else{const h=Tt(t,Vr);c=Tt(h.firestore,bn),d=h._query;const m=new tp(c);u={next:y=>{e[a]&&e[a](new ox(c,m,h,y))},error:e[a+1],complete:e[a+2]},nx(t._query)}return function(h,m,y,E){const v=new jm(E),w=new Vm(m,v,y);return h.asyncQueue.enqueueAndForget(async()=>Lm(await mu(h),w)),()=>{v.Dc(),h.asyncQueue.enqueueAndForget(async()=>Fm(await mu(h),w))}}(No(c),d,l,u)}function To(t,e){return function(n,r){const s=new Vn;return n.asyncQueue.enqueueAndForget(async()=>MD(await KD(n),r,s)),s.promise}(No(t),e)}function ux(t,e,n){const r=n.docs.get(e._key),s=new tp(t);return new ax(t,s,e._key,r,new ea(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Co(e)}set(e,n,r){this._verifyNotCommitted();const s=ld(e,this._firestore),i=ep(s.converter,n,r),a=Hm(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(a.toMutation(s._key,It.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=ld(e,this._firestore);let a;return a=typeof(n=Ve(n))=="string"||n instanceof _o?Xk(this._dataReader,"WriteBatch.update",i._key,n,r,s):Yk(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(a.toMutation(i._key,It.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=ld(e,this._firestore);return this._mutations=this._mutations.concat(new oc(n._key,It.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new j(I.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ld(t,e){if((t=Ve(t)).firestore!==e)throw new j(I.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function dA(){return new Wm("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gc(t){return No(t=Tt(t,bn)),new cA(t,e=>To(t,e))}(function(t,e=!0){(function(n){Ii=n})(xi),ui(new us("firestore",(n,{instanceIdentifier:r,options:s})=>{const i=n.getProvider("app").getImmediate(),a=new bn(new wT(n.getProvider("auth-internal")),new NT(n.getProvider("app-check-internal")),function(l,u){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new j(I.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wa(l.options.projectId,u)}(i,r),i);return s=Object.assign({useFetchStreams:e},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),_r(Jg,"3.13.0",t),_r(Jg,"3.13.0","esm2017")})();let ud=null,Rt=null,Jt=null,Xa=typeof __firebase_config<"u"?JSON.parse(__firebase_config):null;Xa||(Xa={apiKey:"AIzaSyDkiLiR8QI7XDLkQ3S4R7psfSiAhL8Ds7U",authDomain:"mia-move-dev.firebaseapp.com",projectId:"mia-move-dev",storageBucket:"mia-move-dev.firebasestorage.app",messagingSenderId:"539510852507",appId:"1:539510852507:web:0d2293397af8756a2f6f3e",measurementId:"G-JRW1F0E3K8"});if(Xa){try{ey&&ey("debug")}catch{}ud=lE(Xa),Rt=ZD(ud),Jt=dI(ud)}const ke=(t,e,n=typeof __app_id<"u"?__app_id:"mia-move-app")=>`/artifacts/${n}/users/${t}/${e}`,_t=({title:t,children:e,isOpen:n,onClose:r,actions:s,size:i="max-w-lg",compact:a=!1})=>{if(!n)return null;const l=a?"p-4":"p-6",u=a?"rounded-md":"rounded-xl";return o.createElement("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4",onClick:r},o.createElement("div",{className:`bg-white dark:bg-gray-800 ${u} w-full ${i} ${l} shadow-2xl max-h-[90vh] flex flex-col`,onClick:c=>c.stopPropagation()},o.createElement("div",{className:"flex justify-between items-center mb-4 border-b pb-2 border-gray-200 dark:border-gray-700"},o.createElement("h3",{className:"text-xl font-bold text-pink-600"},t),o.createElement("button",{onClick:r,"aria-label":"Fechar modal",className:"text-gray-600 hover:text-gray-800 dark:text-gray-200 dark:hover:text-gray-100 text-2xl"},"")),o.createElement("div",{className:"mb-6 overflow-y-auto flex-1 min-h-0"},e),s&&o.createElement("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700"},s)))},hA=async t=>{if(navigator.clipboard&&navigator.clipboard.writeText)return navigator.clipboard.writeText(t);const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select();try{document.execCommand("copy")}finally{document.body.removeChild(e)}},fA=({isOpen:t,onClose:e,showToast:n,onSync:r,onUnsync:s,currentUid:i,isSynced:a})=>{const[l,u]=S.useState(""),c=async()=>{try{await hA(i||""),n("ID da Sesso copiado!","success")}catch{n("Falha ao copiar o ID.","error")}},d=()=>{if(!l.trim())return n("Por favor, cole um ID para sincronizar.","error");r(l.trim()),e()};return o.createElement(_t,{isOpen:t,onClose:e,title:"Sincronizar Dispositivos",size:"max-w-xl"},o.createElement("div",{className:"space-y-6"},o.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Use esta funo para acessar os mesmos dados em diferentes aparelhos."),o.createElement("div",{className:"p-4 border dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700/50"},o.createElement("h4",{className:"font-semibold text-lg mb-2"},"1. Copie o ID do Dispositivo Principal"),o.createElement("div",{className:"mt-4 text-center bg-pink-100 dark:bg-pink-900/40 p-3 rounded-lg flex items-center justify-between"},o.createElement("span",{className:"text-sm font-mono break-all text-pink-800 dark:text-pink-200"},i),o.createElement("button",{onClick:c,className:"ml-4 px-3 py-2 text-sm font-semibold bg-pink-500 text-white rounded-lg hover:bg-pink-600"},"Copiar"))),o.createElement("div",{className:"p-4 border dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700/50"},o.createElement("h4",{className:"font-semibold text-lg mb-2"},"2. Cole o ID no Novo Dispositivo"),o.createElement("div",{className:"flex space-x-2"},o.createElement("input",{type:"text",value:l,onChange:h=>u(h.target.value),placeholder:"Cole o ID da Sesso aqui",className:"w-full p-3 border border-gray-300 rounded-lg"}),o.createElement("button",{onClick:d,className:"px-6 py-2 font-semibold text-white rounded-lg bg-teal-500 hover:bg-teal-600"},"Sincronizar"))),a&&o.createElement("div",{className:"text-center pt-4 border-t"},o.createElement("button",{onClick:s,className:"px-4 py-2 text-sm font-semibold rounded-full bg-red-500 text-white"},"Desfazer Sincronizao neste Dispositivo"))))},mA=({message:t,type:e,onClose:n})=>{const r="fixed bottom-5 right-5 p-4 rounded-lg shadow-xl text-white font-semibold flex items-center space-x-3 transition-opacity duration-300 z-50";let s="";switch(e){case"success":s="bg-teal-500";break;case"error":s="bg-red-500";break;default:s="bg-gray-700"}return o.createElement("div",{className:`${r} ${s}`},o.createElement("span",null,t),o.createElement("button",{onClick:n,className:"ml-4 opacity-75 hover:opacity-100"},""))},pA=({onLogin:t})=>{const[e,n]=S.useState(""),[r,s]=S.useState(""),[i,a]=S.useState(!1),[l,u]=S.useState(!1),c="usemiamove@gmail.com",d=async h=>{if(h.preventDefault(),!e.trim()||!r.trim())return alert("Preencha email e senha");a(!0);try{try{await OE(Jt,l?FE:Mu)}catch(p){console.warn("setPersistence failed",p)}const y=(await X_(Jt,e.trim(),r)).user,E=Ae(Rt,"users",y.uid),v=await gu(E);if(!v.exists())if(y.email===c)try{await lx(E,{email:y.email,role:"master",createdAt:dA()})}catch(p){return console.error("Failed to create master user doc",p),await yl(Jt),a(!1),alert("Falha ao criar o perfil do usurio. Contate o administrador.")}else return await yl(Jt),a(!1),alert("Usurio autenticado, mas documento de perfil no encontrado. Contate o administrador.");const w=await gu(E),f=w.exists()?w.data():v.exists()?v.data():null;if(!f||f.role!=="master")return await yl(Jt),a(!1),alert("Acesso negado: usurio no tem permisso de master.");t&&t({uid:y.uid,email:y.email,displayName:y.displayName})}catch(m){console.error("Login error",m),alert("Falha no login: "+(m.message||m.code||"erro desconhecido"))}finally{a(!1)}};return o.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900"},o.createElement("div",{className:"relative z-10 w-full max-w-md p-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg"},o.createElement("h1",{className:"text-2xl font-extrabold text-pink-600 mb-2"},"Mia Move"),o.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-300 mb-6"},"Entre com sua conta para continuar"),o.createElement("form",{onSubmit:d,className:"space-y-4"},o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Email"),o.createElement("input",{type:"email",value:e,onChange:h=>n(h.target.value),className:"mt-1 w-full p-3 border rounded bg-white dark:bg-gray-700 dark:text-gray-50",placeholder:"vc@exemplo.com"})),o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Senha"),o.createElement("input",{type:"password",value:r,onChange:h=>s(h.target.value),className:"mt-1 w-full p-3 border rounded bg-white dark:bg-gray-700 dark:text-gray-50",placeholder:""})),o.createElement("div",{className:"flex items-center justify-between"},o.createElement("label",{className:"flex items-center text-sm"},o.createElement("input",{type:"checkbox",checked:l,onChange:h=>u(h.target.checked),className:"mr-2"})," Lembrar"),o.createElement("a",{className:"text-sm text-pink-600 hover:underline",href:"#"},"Esqueci a senha")),o.createElement("button",{disabled:i,type:"submit",className:"w-full py-3 bg-pink-500 text-white font-bold rounded-lg"},i?"Entrando...":"Entrar"))))},gA=({variants:t=[],db:e=null,userId:n=null,mediumThresholdPct:r=50,lowThresholdPct:s=10})=>{const[l,u]=S.useState(null),[c,d]=S.useState(!1),h=S.useMemo(()=>{if(!t||t.length===0)return{full:{count:0,percentage:0},medium:{count:0,percentage:0},low:{count:0,percentage:0},outOfStock:{count:0,percentage:0},total:0};let y=0,E=0,v=0,w=0;t.forEach(p=>{const g=typeof p.quantity=="number"?p.quantity:parseInt(p.quantity||0,10)||0;if(g===0){w++;return}const k=p.sku||p.SKU||"",_=l&&k?l[k]:null;if(_&&_>0){const C=g/_*100;C<=s?v++:C<=r?E++:y++}else g<5?v++:g<10?E++:y++});const f=t.length;return{full:{count:y,percentage:y/f*100},medium:{count:E,percentage:E/f*100},low:{count:v,percentage:v/f*100},outOfStock:{count:w,percentage:w/f*100},total:f}},[t,l,r,s]),m=({percentage:y,color:E,radius:v,strokeWidth:w,label:f,count:p})=>{const g=2*Math.PI*v,k=g-y/100*g;return o.createElement("div",{className:"relative flex flex-col items-center justify-center"},o.createElement("svg",{className:"transform -rotate-90",width:v*2+w*2,height:v*2+w*2},o.createElement("circle",{className:"text-gray-200 dark:text-gray-700",stroke:"currentColor",strokeWidth:w,fill:"transparent",r:v,cx:v+w,cy:v+w}),o.createElement("circle",{className:E,stroke:"currentColor",strokeWidth:w,strokeLinecap:"round",fill:"transparent",r:v,cx:v+w,cy:v+w,style:{strokeDasharray:g,strokeDashoffset:k,transition:"stroke-dashoffset 0.5s ease-out"}})),o.createElement("div",{className:"absolute flex flex-col items-center"},o.createElement("span",{className:"text-xl font-bold"},p),o.createElement("span",{className:"text-xs text-gray-500 dark:text-gray-400"},f)))};return S.useEffect(()=>{let y=!1;return(async()=>{if(!e||!n)return u(null);d(!0);try{const v=Ye(e,ke(n,"stockMovements")),w=await ms(v),f={};w.forEach(p=>{const g=p.data(),k=g.variantSku||g.sku||"";if(!k)return;const _=typeof g.oldQuantity=="number"?g.oldQuantity:g.oldQuantity&&g.oldQuantity.seconds?null:parseInt(g.oldQuantity||0,10),C=typeof g.newQuantity=="number"?g.newQuantity:g.newQuantity&&g.newQuantity.seconds?null:parseInt(g.newQuantity||0,10),P=[];_!=null&&!Number.isNaN(_)&&P.push(_),C!=null&&!Number.isNaN(C)&&P.push(C),f[k]||(f[k]=0),P.forEach(M=>{typeof M=="number"&&M>f[k]&&(f[k]=M)})})(t||[]).forEach(p=>{const g=p.sku||p.SKU||"",k=typeof p.quantity=="number"?p.quantity:parseInt(p.quantity||0,10)||0;g&&(f[g]=Math.max(f[g]||0,k))}),y||u(f)}catch(v){console.error("Erro ao carregar stockMovements para baselines:",v),y||u(null)}finally{y||d(!1)}})(),()=>{y=!0}},[e,n,t]),o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700"},o.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Viso Geral do Estoque"),h.total===0?o.createElement("p",{className:"text-center text-gray-500 dark:text-gray-400 py-8"},"Nenhum item em estoque para exibir."):o.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 justify-items-center text-center"},o.createElement(m,{percentage:h.full.percentage,color:"text-green-500",radius:40,strokeWidth:8,label:"Estoque Cheio",count:h.full.count}),o.createElement(m,{percentage:h.medium.percentage,color:"text-blue-500",radius:40,strokeWidth:8,label:"Estoque Mdio",count:h.medium.count}),o.createElement(m,{percentage:h.low.percentage,color:"text-orange-500",radius:40,strokeWidth:8,label:"Estoque Baixo",count:h.low.count}),o.createElement(m,{percentage:h.outOfStock.percentage,color:"text-red-500",radius:40,strokeWidth:8,label:"Esgotado",count:h.outOfStock.count})))},_s="w-full p-2 border border-gray-300 rounded-lg bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50 text-sm",yA=({variant:t,index:e,onChange:n,onRemove:r,showRemove:s,applyToAll:i})=>{const a=l=>n(e,l);return o.createElement("div",{className:"p-3 border dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700/50 relative"},o.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3 items-end"},o.createElement("div",null,o.createElement("label",{className:"block text-xs font-medium"},"SKU*:"),o.createElement("input",{type:"text",name:"sku",value:t.sku,onChange:a,required:!0,className:_s})),o.createElement("div",null,o.createElement("label",{className:"block text-xs font-medium"},"Tamanho:"),o.createElement("input",{type:"text",name:"size",value:t.size,onChange:a,className:_s})),o.createElement("div",null,o.createElement("label",{className:"block text-xs font-medium"},"Cor:"),o.createElement("input",{type:"text",name:"color",value:t.color,onChange:a,className:_s})),o.createElement("div",null,o.createElement("label",{className:"block text-xs font-medium"},"Qtd*:"),o.createElement("input",{type:"number",name:"quantity",value:t.quantity,onChange:a,required:!0,min:"0",className:_s})),o.createElement("div",{className:"flex items-center"},o.createElement("div",{className:"flex-grow"},o.createElement("label",{className:"block text-xs font-medium"},"Custo (R$):"),o.createElement("input",{type:"number",name:"costPrice",value:t.costPrice,onChange:a,step:"0.01",min:"0",className:_s}))),o.createElement("div",{className:"flex items-center"},o.createElement("div",{className:"flex-grow"},o.createElement("label",{className:"block text-xs font-medium"},"Venda (R$)*:"),o.createElement("input",{type:"number",name:"salePrice",value:t.salePrice,onChange:a,required:!0,step:"0.01",min:"0.01",className:_s})))),s&&o.createElement("button",{type:"button",onClick:()=>r(e),className:"absolute top-2 right-2 text-red-500 hover:text-red-700 text-lg font-bold"},""),i&&i.show&&o.createElement("div",{className:"absolute top-2 left-2 flex space-x-1"},i.fields.map(l=>o.createElement("button",{key:l.key,type:"button",title:`Aplicar ${l.label} para todos`,onClick:()=>i.onApply(l.key,t[l.key]),className:"p-1 text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400"},o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"}))))))},Ly="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",vA=({isOpen:t,onClose:e,variant:n,onAdjust:r})=>{const[s,i]=S.useState((n==null?void 0:n.quantity)||0),[a,l]=S.useState(""),u=["Avaria","Perda","Acerto de contagem","Devoluo","Outro"];return S.useEffect(()=>{i((n==null?void 0:n.quantity)||0),l("")},[n,t]),o.createElement(_t,{isOpen:t,onClose:e,title:`Ajustar Estoque: ${(n==null?void 0:n.productName)||""}`,size:"max-w-md",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:e,className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),o.createElement("button",{onClick:()=>r(parseInt(s,10),a),className:"px-4 py-2 text-white rounded-full bg-pink-500"},"Confirmar Ajuste"))},o.createElement("div",{className:"space-y-4"},o.createElement("p",null,"Variao: ",o.createElement("strong",null,n==null?void 0:n.size," - ",n==null?void 0:n.color)," (SKU: ",n==null?void 0:n.sku,")"),o.createElement("p",null,"Quantidade Atual: ",o.createElement("strong",null,n==null?void 0:n.quantity)),o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"Nova Quantidade:"),o.createElement("input",{type:"number",value:s,onChange:c=>i(c.target.value),className:Ly,min:"0"})),o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"Motivo do Ajuste:"),o.createElement("select",{value:a,onChange:c=>l(c.target.value),className:Ly},o.createElement("option",{value:""},"Selecione um motivo"),u.map(c=>o.createElement("option",{key:c,value:c},c))))))};function te(t){if(!t&&t!==0)return null;if(t&&typeof t.toDate=="function")try{return t.toDate()}catch{return null}if(t instanceof Date)return t;if(typeof t=="number"||typeof t=="string"){const e=new Date(t);return isNaN(e.getTime())?null:e}return null}const EA=({isOpen:t,onClose:e,variant:n,movements:r=[]})=>{const s=i=>{switch(i){case"venda":return o.createElement("span",{className:"text-red-600 font-semibold"},"Venda");case"estorno":return o.createElement("span",{className:"text-blue-600 font-semibold"},"Estorno");case"ajuste_entrada":return o.createElement("span",{className:"text-green-600 font-semibold"},"Ajuste (Entrada)");case"ajuste_saida":return o.createElement("span",{className:"text-orange-600 font-semibold"},"Ajuste (Sada)");case"saida_defeito":return o.createElement("span",{className:"text-yellow-600 font-semibold"},"Sada (Defeito)");default:return i}};return o.createElement(_t,{isOpen:t,onClose:e,title:`Histrico: ${(n==null?void 0:n.productName)||""} (${(n==null?void 0:n.size)||""} - ${(n==null?void 0:n.color)||""})`,size:"max-w-2xl"},o.createElement("div",{className:"max-h-[60vh] overflow-y-auto"},o.createElement("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},o.createElement("thead",{className:"bg-gray-50 dark:bg-gray-700"},o.createElement("tr",null,o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Data"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Tipo"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Alterao"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Saldo Final"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Motivo / Venda ID"))),o.createElement("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},r.map((i,a)=>o.createElement("tr",{key:a},o.createElement("td",{className:"px-3 py-4 text-sm"},te(i.date)&&te(i.date).toLocaleString("pt-BR")||""),o.createElement("td",{className:"px-3 py-4 text-sm"},s(i.type)),o.createElement("td",{className:`px-3 py-4 text-sm font-bold ${i.type==="ajuste_entrada"||i.type==="estorno"?"text-green-600":"text-red-600"}`},i.type==="ajuste_entrada"||i.type==="estorno"?`+${i.quantityChange}`:`-${i.quantityChange}`),o.createElement("td",{className:"px-3 py-4 text-sm font-bold"},i.newQuantity),o.createElement("td",{className:"px-3 py-4 text-sm"},i.reason||i.saleId)))))))},cd="bg-pink-500 hover:bg-pink-600",wA="bg-teal-500 hover:bg-teal-600",Fy="bg-red-500 hover:bg-red-600",kA="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",Br="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50 dark:placeholder-gray-400",Cs={sku:"",size:"",color:"",quantity:0,costPrice:0,salePrice:0},xA=({db:t,userId:e,products:n=[],showToast:r=()=>{},categories:s=[]})=>{const i=!!t&&!!e,[a,l]=S.useState(!1),[u,c]=S.useState(null),[d,h]=S.useState(!1),[m,y]=S.useState(null),[E,v]=S.useState(!1),[w,f]=S.useState(null),[p,g]=S.useState(!1),[k,_]=S.useState(null),[C,P]=S.useState(!1),[M,X]=S.useState(null),[A,T]=S.useState([]),[B,ue]=S.useState("all"),[F,le]=S.useState(!1),[ce,W]=S.useState(""),[b,V]=S.useState({name:"",categoryId:"",variants:[Cs]}),[K,de]=S.useState(""),[he,G]=S.useState(""),[N,D]=S.useState("");S.useEffect(()=>{V(u?{name:u.name||"",categoryId:u.categoryId||"",variants:u.variants&&u.variants.length>0?u.variants:[Cs]}:{name:"",categoryId:"",variants:[Cs]})},[u]);const O=R=>V(Z=>({...Z,[R.target.name]:R.target.value})),H=(R,Z)=>{const{name:ge,value:Ne}=Z.target,Ee=[...b.variants];Ee[R]={...Ee[R],[ge]:Ne},V(At=>({...At,variants:Ee}))},J=()=>V(R=>({...R,variants:[...R.variants,Cs]})),ae=R=>V(Z=>({...Z,variants:Z.variants.filter((ge,Ne)=>Ne!==R)})),x=(R,Z)=>{V(ge=>({...ge,variants:ge.variants.map(Ne=>({...Ne,[R]:Z}))}))},U=()=>{const R=K.split(",").map(Ee=>Ee.trim()).filter(Boolean),Z=he.split(",").map(Ee=>Ee.trim()).filter(Boolean);if(R.length===0&&Z.length===0)return r("Informe cores e/ou tamanhos para gerar variaes.","error");const ge=[];R.length>0&&Z.length>0?R.forEach(Ee=>Z.forEach(At=>ge.push({color:Ee,size:At}))):R.length>0?R.forEach(Ee=>ge.push({color:Ee,size:""})):Z.length>0&&Z.forEach(Ee=>ge.push({color:"",size:Ee}));const Ne=ge.map((Ee,At)=>{const xs=String(At+1).padStart(3,"0"),Ri=Ee.color?Ee.color.replace(/\s+/g,"").toUpperCase().slice(0,6):"",bo=Ee.size?Ee.size.replace(/\s+/g,"").toUpperCase().slice(0,6):"",Dn=[];N&&Dn.push(N.replace(/\s+/g,"").toUpperCase()),Ri&&Dn.push(Ri),bo&&Dn.push(bo),Dn.push(xs);const Pi=Dn.join("-");return{...Cs,sku:Pi,color:Ee.color,size:Ee.size}});V(Ee=>({...Ee,variants:Ne.length>0?Ne:[Cs]})),r("Variaes geradas.","success")},ee=async R=>{if(R.preventDefault(),!b.name.trim())return r("O nome do produto  obrigatrio.","error");if(b.variants.some(ge=>!ge.sku.trim()||parseFloat(ge.salePrice)<=0))return r("Todas as variaes devem ter SKU e Preo de Venda vlidos.","error");if(!i){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}const Z=Ye(t,ke(e,"products"));try{const ge={...b,variants:b.variants.map(Ne=>({...Ne,quantity:parseInt(Ne.quantity,10)||0,costPrice:parseFloat(Ne.costPrice)||0,salePrice:parseFloat(Ne.salePrice)||0})),updatedAt:me.now()};u?(await ps(Ae(Z,u.id),ge),r("Produto atualizado!","success")):(await Pr(Z,{...ge,createdAt:me.now()}),r("Novo produto adicionado!","success")),l(!1),c(null)}catch(ge){console.error("Erro ao salvar o produto:",ge),r("Erro ao salvar produto.","error")}},je=async()=>{if(m){if(!i){r("Firestore no configurado. Faa login com uma conta vlida.","error"),h(!1),y(null);return}try{await rs(Ae(t,ke(e,"products"),m.id)),r(`Produto ${m.name} excludo.`,"success")}catch(R){console.error("Erro ao deletar produto:",R),r("Erro ao deletar produto.","error")}finally{h(!1),y(null)}}},Ai=R=>{f(R),v(!0)},ks=async()=>{if(w){if(!i){r("Firestore no configurado. Faa login com uma conta vlida.","error"),v(!1),f(null);return}try{const R=Ae(t,ke(e,"products"),w.productId),Z=n.find(Ne=>Ne.id===w.productId);if(!Z)throw new Error("Produto pai no encontrado");const ge=(Z.variants||[]).filter(Ne=>(Ne.sku||Ne.SKU)!==(w.sku||w.SKU));ge.length===0?(await rs(R),r(`Produto ${Z.name} removido (sem variaes).`,"success")):(await ps(R,{variants:ge}),r(`Variao ${w.sku} removida.`,"success"))}catch(R){console.error("Erro ao deletar variao:",R),r("Erro ao deletar variao.","error")}finally{v(!1),f(null)}}},Kt=(R=null)=>{c(R),l(!0)},Jn=R=>{_(R),g(!0)},Xe=async R=>{if(X(R),!i){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{const Z=Ye(t,ke(e,"stockMovements")),ge=Vh(Z),Ee=(await ms(ge)).docs.map(At=>At.data()).filter(At=>At.variantSku===R.sku).sort((At,xs)=>xs.date.seconds-At.date.seconds);T(Ee),P(!0)}catch(Z){console.error("Erro ao buscar histrico:",Z),r("Erro ao buscar histrico.","error")}},zr=async(R,Z)=>{if(!k||Z.trim()==="")return r("Nova quantidade e motivo so obrigatrios.","error");if(!i){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{const ge=Ae(t,ke(e,"products"),k.productId),Ne=n.find(Pi=>Pi.id===k.productId),Ee=Ne.variants.findIndex(Pi=>Pi.sku===k.sku);if(Ee===-1)return;const At=Ne.variants[Ee].quantity,xs=R-At,Ri=[...Ne.variants];Ri[Ee].quantity=R;const bo={date:me.now(),productId:k.productId,productName:k.productName,variantSku:k.sku,type:xs>0?"ajuste_entrada":"ajuste_saida",quantityChange:Math.abs(xs),reason:Z,oldQuantity:At,newQuantity:R},Dn=gc(t);Dn.update(ge,{variants:Ri}),Dn.set(Ae(Ye(t,ke(e,"stockMovements"))),bo),await Dn.commit(),r("Estoque ajustado com sucesso!","success"),g(!1),_(null)}catch(ge){console.error("Erro ao ajustar estoque:",ge),r("Erro ao ajustar estoque.","error")}},sn=async()=>{if(!ce.trim())return r("Preencha o nome da categoria.","error");const R=ce.trim();if(!i){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{const Z=Ye(t,ke(e,"categories"));await Pr(Z,{name:R,createdAt:me.now()}),W(""),r("Categoria adicionada!","success")}catch(Z){console.error("Erro ao adicionar categoria",Z),r("Erro ao adicionar categoria.","error")}},jr=async R=>{if(R){if(!i){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{await rs(Ae(t,ke(e,"categories"),R.id)),r("Categoria removida!","success")}catch(Z){console.error("Erro ao deletar categoria",Z),r("Erro ao excluir categoria.","error")}}},Zn=S.useMemo(()=>(n||[]).filter(R=>B==="all"||R.categoryId===B).flatMap(R=>(R.variants||[]).map(Z=>{var ge;return{...Z,quantity:parseInt(Z.quantity,10)||0,productId:R.id,productName:R.name,category:((ge=(s||[]).find(Ne=>Ne.id===R.categoryId))==null?void 0:ge.name)||"Sem Categoria"}})),[n,s,B]),Gt=S.useMemo(()=>Zn.filter(R=>R.quantity<5),[Zn]);return o.createElement("div",{className:"space-y-6"},o.createElement("div",{className:"flex flex-col md:flex-row justify-between md:items-center"},o.createElement("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100"},"Estoque Mia Move"),o.createElement("div",{className:"flex items-center space-x-2 mt-4 md:mt-0"},o.createElement("select",{value:B,onChange:R=>ue(R.target.value),className:Br+" max-w-xs"},o.createElement("option",{value:"all"},"Todas as Categorias"),(s||[]).map(R=>o.createElement("option",{key:R.id,value:R.id},R.name))),o.createElement("button",{onClick:()=>le(!0),className:"px-4 py-3 text-pink-600 dark:text-pink-300 font-semibold bg-pink-100 dark:bg-pink-900/40 rounded-lg hover:bg-pink-200 dark:hover:bg-pink-900/60 whitespace-nowrap"},"Gerenciar Categorias"),o.createElement("button",{onClick:()=>Kt(),className:`px-4 py-3 text-white font-semibold rounded-lg ${cd} shadow-md whitespace-nowrap`},"+ Novo Produto"))),o.createElement(gA,{variants:Zn,db:t,userId:e}),Gt.length>0&&o.createElement("div",{className:"bg-orange-100 dark:bg-orange-900/40 border-l-4 border-orange-500 p-4 rounded-xl shadow-md"},o.createElement("p",{className:"font-bold text-orange-800 dark:text-orange-200"}," ",Gt.length," Variae(s) com Estoque Baixo!")),o.createElement("div",{className:`${kA}`},o.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Variaes em Estoque (",Zn.length,")"),o.createElement("div",{className:"overflow-x-auto"},o.createElement("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},o.createElement("thead",{className:"bg-gray-50 dark:bg-gray-700"},o.createElement("tr",null,o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Produto / Categoria"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"SKU"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Variao"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Qtd"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Venda"),o.createElement("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase"},"Aes"))),o.createElement("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Zn.map((R,Z)=>{var Ne;const ge=n.find(Ee=>Ee.id===R.productId);return o.createElement("tr",{key:`${R.productId}-${R.sku}-${Z}`,className:R.quantity<5?"bg-red-50 dark:bg-red-900/30 hover:bg-red-100 dark:hover:bg-red-900/50":"hover:bg-gray-50 dark:hover:bg-gray-700"},o.createElement("td",{className:"px-3 py-4 text-sm font-medium"},R.productName," ",o.createElement("span",{className:"block text-xs text-gray-500 dark:text-gray-400"},R.category)),o.createElement("td",{className:"px-3 py-4 text-sm"},R.sku),o.createElement("td",{className:"px-3 py-4 text-sm text-gray-600 dark:text-gray-300"},R.size," - ",R.color),o.createElement("td",{className:"px-3 py-4 text-sm font-bold"},R.quantity),o.createElement("td",{className:"px-3 py-4 text-sm font-semibold text-teal-600 dark:text-teal-400"},(Ne=R.salePrice)!=null&&Ne.toLocaleString?R.salePrice.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}):`R$ ${R.salePrice}`),o.createElement("td",{className:"px-3 py-4 text-right text-sm font-medium space-x-2"},o.createElement("button",{onClick:()=>Xe(R),className:"text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-100"},"Histrico"),o.createElement("button",{onClick:()=>Jn(R),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300"},"Ajustar"),o.createElement("button",{onClick:()=>Kt(ge),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300"},"Editar"),o.createElement("button",{onClick:()=>Ai(R),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},"Excluir")))}))))),o.createElement(_t,{isOpen:a,onClose:()=>l(!1),title:u?"Editar Produto":"Adicionar Novo Produto",size:"max-w-3xl",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),o.createElement("button",{onClick:ee,className:`px-5 py-2 text-white rounded-full ${cd}`},u?"Salvar Alteraes":"Adicionar Produto"))},o.createElement("form",{className:"space-y-6"},o.createElement("div",{className:"p-4 border dark:border-gray-700 rounded-lg grid grid-cols-1 md:grid-cols-2 gap-4"},o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"Nome do Produto:"),o.createElement("input",{type:"text",name:"name",value:b.name,onChange:O,required:!0,className:Br})),o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"Categoria:"),o.createElement("select",{name:"categoryId",value:b.categoryId,onChange:O,className:Br},o.createElement("option",{value:""},"Selecione uma categoria"),(s||[]).map(R=>o.createElement("option",{key:R.id,value:R.id},R.name))))),!u&&o.createElement("div",{className:"p-4 border dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-700/50"},o.createElement("h4",{className:"font-semibold text-lg mb-3 text-gray-700 dark:text-gray-200"},"Gerador de Variaes em Massa"),o.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3 items-start"},o.createElement("div",{className:"flex flex-col"},o.createElement("label",{className:"block text-sm font-medium mb-2 min-h-[2.1rem] leading-tight"},"Cores (separadas por vrgula):"),o.createElement("input",{type:"text",value:K,onChange:R=>de(R.target.value),placeholder:"Preto, Azul, Rosa",className:Br+" h-10 text-sm"})),o.createElement("div",{className:"flex flex-col"},o.createElement("label",{className:"block text-sm font-medium mb-2 min-h-[2.1rem] leading-tight"},"Tamanhos (separadas por vrgula):"),o.createElement("input",{type:"text",value:he,onChange:R=>G(R.target.value),placeholder:"P, M, G",className:Br+" h-10 text-sm"})),o.createElement("div",{className:"flex flex-col"},o.createElement("label",{className:"block text-sm font-medium mb-2 min-h-[2.1rem] leading-tight"},"Prefixo do SKU (Opcional):"),o.createElement("input",{type:"text",value:N,onChange:R=>D(R.target.value),placeholder:"LEG-FLARE",className:Br+" h-10 text-sm"}))),o.createElement("button",{type:"button",onClick:U,className:`w-full text-center py-3 text-sm font-semibold text-white rounded-full ${wA} transition`},"Gerar Variaes")),o.createElement("div",{className:"space-y-4"},o.createElement("h4",{className:"font-semibold text-lg text-gray-700 dark:text-gray-200"},"Variaes do Produto"),o.createElement("div",{className:"max-h-[40vh] overflow-y-auto space-y-4 pr-2 border-t border-b py-4 dark:border-gray-700"},b.variants.map((R,Z)=>o.createElement(yA,{key:Z,variant:R,index:Z,onChange:H,onRemove:ae,showRemove:b.variants.length>1,applyToAll:Z===0&&b.variants.length>1?{show:!0,fields:[{key:"costPrice",label:"Custo"},{key:"salePrice",label:"Venda"}],onApply:x}:null}))),o.createElement("button",{type:"button",onClick:J,className:"w-full text-center py-2 text-sm font-semibold text-pink-600 dark:text-pink-400 border-2 border-dashed border-pink-300 dark:border-pink-500 rounded-lg hover:bg-pink-50 dark:hover:bg-pink-900/30 transition"},"+ Adicionar Variao Manualmente")))),o.createElement(_t,{isOpen:d,onClose:()=>h(!1),title:"Confirmar Excluso",size:"max-w-md",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),o.createElement("button",{onClick:je,className:`px-4 py-2 text-white rounded-full ${Fy}`},"Excluir"))},o.createElement("p",null,"Voc tem certeza que deseja deletar o produto ",o.createElement("strong",null,m==null?void 0:m.name)," e todas as suas variaes?")),o.createElement(_t,{isOpen:E,onClose:()=>v(!1),title:"Confirmar Excluso da Variao",size:"max-w-md",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:()=>v(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),o.createElement("button",{onClick:ks,className:`px-4 py-2 text-white rounded-full ${Fy}`},"Excluir"))},o.createElement("p",null,"Voc tem certeza que deseja deletar a variao ",o.createElement("strong",null,w==null?void 0:w.sku)," do produto ",o.createElement("strong",null,w==null?void 0:w.productName),"?")),k&&o.createElement(vA,{isOpen:p,onClose:()=>g(!1),variant:k,onAdjust:zr}),M&&o.createElement(EA,{isOpen:C,onClose:()=>P(!1),variant:M,movements:A}),o.createElement(_t,{isOpen:F,onClose:()=>le(!1),title:"Gerenciar Categorias",size:"max-w-md",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:()=>le(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Fechar"),o.createElement("button",{onClick:()=>{sn()},className:`px-4 py-2 text-white rounded-full ${cd}`},"Adicionar"))},o.createElement("div",{className:"space-y-4"},o.createElement("input",{type:"text",placeholder:"Nome da nova categoria",value:ce,onChange:R=>W(R.target.value),className:Br}),o.createElement("div",{className:"space-y-2"},(s||[]).length===0&&o.createElement("p",{className:"text-gray-500"},"Nenhuma categoria cadastrada."),(s||[]).map(R=>o.createElement("div",{key:R.id,className:"flex justify-between items-center p-2 bg-gray-50 dark:bg-gray-700/50 rounded"},o.createElement("div",{className:"text-sm"},R.name),o.createElement("div",{className:"space-x-2"},o.createElement("button",{onClick:()=>{ue(R.id),le(!1)},className:"text-sm text-teal-600"},"Selecionar"),o.createElement("button",{onClick:()=>jr(R),className:"text-sm text-red-600"},"Excluir"))))))))},Se=t=>{const e=typeof t=="number"?t:0;return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)},dd=t=>new Intl.NumberFormat("pt-BR").format(t),Pn=t=>{const e=new Date(t);return e.setHours(0,0,0,0),e},yn="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",SA="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",NA=({db:t,userId:e,products:n=[],sales:r=[],customers:s=[],showToast:i=()=>{}})=>{const[a,l]=S.useState("new"),[u,c]=S.useState(""),[d,h]=S.useState([]),[m,y]=S.useState(""),[E,v]=S.useState(!1),[w,f]=S.useState("Carto de Crdito"),[p,g]=S.useState(0),[k,_]=S.useState(0),[C,P]=S.useState(1),[M,X]=S.useState("recebido"),[A,T]=S.useState(""),[B,ue]=S.useState(""),[F,le]=S.useState(""),[ce,W]=S.useState(""),b=S.useMemo(()=>(n||[]).flatMap(x=>(x.variants||[]).map(U=>({...U,productId:x.id,productName:x.name}))).filter(x=>x.productName.toLowerCase().includes(m.toLowerCase())||x.color.toLowerCase().includes(m.toLowerCase())||x.size.toLowerCase().includes(m.toLowerCase())||x.sku.toLowerCase().includes(m.toLowerCase())),[n,m]),{subtotal:V,costOfGoodsSold:K,totalAfterDiscount:de,feeAmount:he,finalTotal:G}=S.useMemo(()=>{const x=d.reduce((ks,Kt)=>ks+Kt.salePrice*Kt.quantity,0),U=d.reduce((ks,Kt)=>ks+Kt.costPrice*Kt.quantity,0),ee=x*(1-p/100);let je=0;w==="Carto de Crdito"&&k>0&&(je=ee*(k/100));const Ai=ee+je;return{subtotal:x,costOfGoodsSold:U,totalAfterDiscount:ee,feeAmount:je,finalTotal:Ai}},[d,p,k,w]),N=V-de,D=S.useMemo(()=>{const x=u.trim().toLowerCase();return(r||[]).filter(U=>!!(!x||(U.id||"").toLowerCase().includes(x)||(U.customerName||"").toLowerCase().includes(x)||U.items&&U.items.some(ee=>(ee.productName||"").toLowerCase().includes(x)||(ee.sku||"").toLowerCase().includes(x))))},[r,u]),O=x=>{const U=d.find(ee=>ee.sku===x.sku);U?U.quantity<x.quantity?h(ee=>ee.map(je=>je.sku===x.sku?{...je,quantity:je.quantity+1}:je)):i("Estoque insuficiente.","error"):h(ee=>[...ee,{productId:x.productId,productName:x.productName,sku:x.sku,size:x.size,color:x.color,quantity:1,salePrice:x.salePrice,costPrice:x.costPrice,stockQuantity:x.quantity}]),y("")},H=(x,U)=>h(ee=>ee.map(je=>je.sku===x?{...je,quantity:Math.min(Math.max(1,U),je.stockQuantity)}:je)),J=x=>h(U=>U.filter(ee=>ee.sku!==x)),ae=async()=>{if(d.length===0)return i("O carrinho est vazio.","error");if(M==="a_receber"&&!B.trim())return i("Digite um nome de cliente para vendas a receber.","error");if(M==="a_receber"&&!A)return i("Preencha a data de vencimento.","error");v(!0);try{if(console.log("processSale start",{selectedItems:d,subtotal:V,finalTotal:G,paymentStatus:M}),i("Iniciando processamento da venda...","info"),!t||!e){i("Firestore no configurado. Faa login com uma conta vlida.","error"),v(!1);return}else try{const x=Ye(t,ke(e,"sales"));let U=null;try{if(B&&B.trim()){const Xe=B.trim().toLowerCase(),zr=(s||[]).find(sn=>sn.whatsapp&&sn.whatsapp===(ce||"")||sn.name&&sn.name.toLowerCase()===Xe);if(zr)U=zr.id;else{const sn=Ye(t,ke(e,"customers")),jr={name:B.trim(),whatsapp:ce||"",phone:ce||"",createdAt:me.now(),updatedAt:me.now()};U=(await Pr(sn,jr)).id}}}catch(Xe){console.error("Erro ao localizar/crear cliente:",Xe)}const ee=V-K-N-he,je=me.now(),Ai={items:d,subtotal:V,costOfGoodsSold:K,discountPercentage:p,totalDiscount:N,feeAmount:he,finalTotal:G,totalAmount:G,profit:ee,date:je,paymentMethod:w,paymentStatus:M,dueDate:M==="a_receber"&&A?me.fromDate(new Date(A)):null,customerId:U||null,customerName:B,customerWhatsapp:ce,saleNotes:F,installments:C,createdAt:je,updatedAt:je},ks=await Pr(x,Ai),Kt=gc(t),Jn={};d.forEach(Xe=>{Jn[Xe.productId]||(Jn[Xe.productId]=[]),Jn[Xe.productId].push({sku:Xe.sku,qty:Xe.quantity})});for(const Xe of Object.keys(Jn)){const zr=Ae(t,ke(e,"products"),Xe),sn=await gu(zr);if(!sn.exists())continue;const jr=sn.data(),Zn=(jr.variants||[]).map(Gt=>{const R=Jn[Xe].find(Z=>Z.sku===Gt.sku);if(R){const Z=parseInt(Gt.quantity||0,10);return{...Gt,quantity:Math.max(0,Z-R.qty)}}return Gt});Kt.update(zr,{variants:Zn,updatedAt:me.now()}),Jn[Xe].forEach(Gt=>{const R=(jr.variants||[]).find(Ee=>Ee.sku===Gt.sku),Z=R?parseInt(R.quantity||0,10):0,ge=Math.max(0,Z-Gt.qty),Ne=Ae(Ye(t,ke(e,"stockMovements")));Kt.set(Ne,{date:me.now(),productId:Xe,productName:jr.name,variantSku:Gt.sku,type:"venda",quantityChange:Gt.qty,oldQuantity:Z,newQuantity:ge})})}await Kt.commit(),i(`Venda registrada: ${Se(G)}`,"success");try{window.dispatchEvent(new CustomEvent("mia:products-updated",{detail:{userId:e}}))}catch(Xe){console.warn("dispatch mia:products-updated failed",Xe)}h([]),g(0),f("Carto de Crdito"),X("recebido"),T(""),ue(""),le(""),_(0),P(1),W("")}catch(x){console.error("Erro ao processar venda com Firebase:",x),i("Erro ao processar a venda (Firebase).","error")}}catch(x){console.error("Erro ao processar a venda:",x),i("Erro ao processar a venda.","error")}finally{v(!1)}};return o.createElement("div",{className:"space-y-6"},o.createElement("div",{className:"flex flex-col md:flex-row justify-between md:items-center"},o.createElement("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100"},"Vendas"),o.createElement("div",{className:"flex rounded-lg shadow-sm border border-gray-300 dark:border-gray-600 mt-4 md:mt-0"},o.createElement("button",{onClick:()=>l("new"),className:`px-4 py-2 font-semibold rounded-l-lg transition ${a==="new"?"bg-pink-500 text-white":"bg-white dark:bg-gray-700 hover:bg-gray-50"}`},"Nova Venda"),o.createElement("button",{onClick:()=>l("history"),className:`px-4 py-2 font-semibold rounded-r-lg transition ${a==="history"?"bg-pink-500 text-white":"bg-white dark:bg-gray-700 hover:bg-gray-50"}`},"Histrico de Vendas"))),a==="new"&&o.createElement("div",{className:"grid lg:grid-cols-3 gap-6"},o.createElement("div",{className:"lg:col-span-1 space-y-4"},o.createElement("h3",{className:"text-xl font-bold"},"1. Adicionar Produtos"),o.createElement("input",{type:"text",placeholder:"Buscar produto...",value:m,onChange:x=>y(x.target.value),className:yn}),o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow max-h-[500px] overflow-y-auto"},(b||[]).map(x=>o.createElement("div",{key:x.sku,className:"flex justify-between items-center p-3 border rounded-xl mb-2"},o.createElement("div",null,o.createElement("p",{className:"font-medium"},x.productName," (",x.size," - ",x.color,")"),o.createElement("p",{className:"text-sm text-gray-500"},"Qtd: ",x.quantity," | ",Se(x.salePrice))),o.createElement("button",{onClick:()=>O(x),className:"p-2 bg-teal-500 text-white rounded-full"},"+"))))),o.createElement("div",{className:"lg:col-span-2 space-y-4"},o.createElement("h3",{className:"text-xl font-bold"},"2. Finalizar Venda"),o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow"},o.createElement("h3",{className:"font-semibold text-xl mb-4"},"Resumo da Venda"),d.length===0?o.createElement("p",{className:"text-gray-500 text-center py-8"},"O carrinho est vazio."):o.createElement("div",{className:"space-y-3 max-h-80 overflow-y-auto pr-2 mb-4 border-b pb-4"},d.map(x=>o.createElement("div",{key:x.sku,className:"flex items-center justify-between border-b pb-2"},o.createElement("div",null,o.createElement("p",{className:"font-medium"},x.productName," (",x.size," - ",x.color,")"),o.createElement("p",{className:"text-sm text-gray-500"},Se(x.salePrice)," x ",x.quantity)),o.createElement("div",{className:"flex items-center space-x-2"},o.createElement("input",{type:"number",min:"1",max:x.stockQuantity,value:x.quantity,onChange:U=>H(x.sku,parseInt(U.target.value,10)),className:"w-16 p-1 text-center border rounded-lg text-sm"}),o.createElement("button",{onClick:()=>J(x.sku),className:"text-red-500"},"Remover"))))),o.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"Nome da Cliente"),o.createElement("input",{type:"text",value:B,onChange:x=>ue(x.target.value),className:yn,placeholder:"Para venda annima, deixe em branco"})),o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"Contato WhatsApp (Opcional)"),o.createElement("input",{type:"tel",value:ce,onChange:x=>W(x.target.value),className:yn,placeholder:"Ser salvo no cadastro"}))),o.createElement("div",{className:"grid grid-cols-2 gap-4 mt-4"},o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"Pagamento:"),o.createElement("select",{value:w,onChange:x=>f(x.target.value),className:yn},o.createElement("option",null,"Carto de Crdito"),o.createElement("option",null,"PIX"),o.createElement("option",null,"Dinheiro"),o.createElement("option",null,"Dbito"),o.createElement("option",null,"Outro"))),o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"Desconto (%):"),o.createElement("input",{type:"number",min:"0",max:"100",value:p,onChange:x=>g(parseFloat(x.target.value)||0),className:yn}))),w==="Carto de Crdito"&&o.createElement("div",{className:"grid grid-cols-2 gap-4 mt-4"},o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"Juros da Maquininha (%):"),o.createElement("input",{type:"number",min:"0",value:k,onChange:x=>_(parseFloat(x.target.value)||0),className:yn})),o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"N de Parcelas:"),o.createElement("input",{type:"number",min:"1",value:C,onChange:x=>P(parseInt(x.target.value,10)||1),className:yn}))),o.createElement("div",{className:"grid grid-cols-1 gap-4"},o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"Status:"),o.createElement("div",{className:"flex rounded-lg shadow-sm mt-2"},o.createElement("button",{type:"button",onClick:()=>X("recebido"),className:`w-full py-2 text-sm font-semibold rounded-l-lg transition ${M==="recebido"?"bg-teal-500 text-white":"bg-gray-200 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`}," Recebido"),o.createElement("button",{type:"button",onClick:()=>X("a_receber"),className:`w-full py-2 text-sm font-semibold rounded-r-lg transition ${M==="a_receber"?"bg-yellow-500 text-white":"bg-gray-200 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`}," A Receber"))),M==="a_receber"&&o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium mt-2"},"Vencimento:"),o.createElement("input",{type:"date",value:A,onChange:x=>T(x.target.value),className:yn,min:new Date().toISOString().split("T")[0]})),o.createElement("div",null,o.createElement("label",{htmlFor:"saleNotes",className:"block text-sm font-medium mt-2"},"Observaes:"),o.createElement("textarea",{id:"saleNotes",value:F,onChange:x=>le(x.target.value),className:yn,rows:"2",placeholder:"Detalhes da venda (ex: embrulhar para presente)..."}))),o.createElement("div",{className:"mt-4 border-t pt-4"},o.createElement("div",{className:"flex justify-between text-base text-gray-500"},o.createElement("span",null,"Subtotal:"),o.createElement("span",null,Se(V))),o.createElement("div",{className:"flex justify-between text-base text-red-500 font-medium"},o.createElement("span",null,"Desconto:"),o.createElement("span",null,"- ",Se(N))),he>0&&o.createElement("div",{className:"flex justify-between text-base text-yellow-600 font-medium"},o.createElement("span",null,"Juros Carto:"),o.createElement("span",null,"+ ",Se(he))),o.createElement("div",{className:"flex justify-between text-2xl font-bold text-gray-800 pt-2 border-t"},o.createElement("span",null,"Total:"),o.createElement("span",{className:"text-pink-600"},Se(G))),o.createElement("button",{onClick:ae,disabled:d.length===0||E||G<=0,className:"mt-4 w-full py-3 text-white font-bold rounded-full bg-pink-500"},E?"Processando...":"Finalizar Venda"))))),a==="history"&&o.createElement("div",{className:"space-y-4"},o.createElement("input",{type:"text",placeholder:"Buscar por ID da Venda, Cliente ou Produto...",value:u,onChange:x=>c(x.target.value),className:yn}),o.createElement("div",{className:"space-y-3 max-h-[70vh] overflow-y-auto pr-2"},D.map(x=>o.createElement("div",{key:x.id,className:`${SA} border-l-4 ${x.paymentStatus==="estornada"?"border-gray-400":"border-teal-500"}`},o.createElement("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center"},o.createElement("div",null,o.createElement("p",{className:"text-sm text-gray-500"},"ID: ",x.id.substring(0,8),"... | Data: ",new Date(x.createdAt).toLocaleString("pt-BR")),o.createElement("p",{className:"font-semibold text-lg"},x.customerName||"Venda Annima"," ",o.createElement("span",{className:"text-sm text-gray-500"},"- ",x.paymentMethod))),o.createElement("div",{className:"text-right"},o.createElement("p",{className:"text-xl font-bold text-pink-600"},Se(x.finalTotal)),o.createElement("p",{className:"text-sm text-gray-500"},x.items.length," item(s)"))),o.createElement("div",{className:"mt-3"},x.items.map(U=>o.createElement("div",{key:U.sku,className:"flex justify-between text-sm border-b py-1"},o.createElement("div",null,U.productName," (",U.size," - ",U.color,")"),o.createElement("div",null,U.quantity," x ",Se(U.salePrice)))),x.saleNotes&&o.createElement("p",{className:"mt-2"},o.createElement("strong",null,"Observaes:")," ",x.saleNotes)))),D.length===0&&o.createElement("p",{className:"text-center text-gray-500"},"Nenhuma venda encontrada."))))},nr="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",_A=({db:t,userId:e,customers:n=[],sales:r=[],showToast:s=()=>{}})=>{const[i,a]=S.useState("list"),[l,u]=S.useState(null),[c,d]=S.useState(!1),[h,m]=S.useState(null),[y,E]=S.useState(!1),[v,w]=S.useState(null),[f,p]=S.useState(!1),[g,k]=S.useState(""),_={name:"",phone:"",email:"",birthday:"",preferences:"",tags:""},[C,P]=S.useState(_);S.useEffect(()=>{P(h?{name:h.name||"",phone:h.phone||"",email:h.email||"",birthday:h.birthday||"",preferences:h.preferences||"",tags:(h.tags||[]).join(", ")}:_)},[h]);const M=(F=null)=>{m(F),d(!0)},X=async F=>{if(F.preventDefault(),!C.name.trim())return s("O nome da cliente  obrigatrio.","error");if(!t||!e){s("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{const le=Ye(t,ke(e,"customers")),ce={...C,tags:C.tags?C.tags.split(",").map(W=>W.trim()).filter(Boolean):[],updatedAt:me.now()};h?(await ps(Ae(le,h.id),ce),s("Cliente atualizada!","success")):(await Pr(le,{...ce,createdAt:me.now()}),s("Nova cliente adicionada!","success")),d(!1),m(null)}catch(le){console.error("Erro ao salvar cliente:",le),s("Erro ao salvar cliente.","error")}},A=F=>{w(F),E(!0)},T=async()=>{if(v){if(!t||!e){s("Firestore no configurado. Faa login com uma conta vlida.","error"),E(!1),w(null),i==="profile"&&(l==null?void 0:l.id)===v.id&&(a("list"),u(null));return}try{p(!0);const F=Ae(t,ke(e,"customers"),v.id);await rs(F),s("Cliente excluda!","success")}catch(F){console.error("Erro ao deletar cliente:",F),s("Erro ao excluir cliente.","error")}finally{E(!1),w(null),p(!1),i==="profile"&&(l==null?void 0:l.id)===v.id&&(a("list"),u(null))}}},B=S.useMemo(()=>(n||[]).filter(F=>{const le=g.toLowerCase(),ce=(F.name||"").toLowerCase().includes(le),W=(F.phone||"").includes(g)||(F.whatsapp||"").includes(g),b=(F.tags||[]).some(V=>V.toLowerCase().includes(le));return ce||W||b}),[n,g]),ue=({customer:F})=>{const[le,ce]=S.useState([]),[W,b]=S.useState(""),[V,K]=S.useState(null),de=S.useMemo(()=>(r||[]).filter(G=>G.customerId===F.id).sort((G,N)=>{var D,O;return(((D=te(N.date))==null?void 0:D.getTime())||0)-(((O=te(G.date))==null?void 0:O.getTime())||0)}),[r,F.id]);S.useMemo(()=>{const G=de.reduce((D,O)=>D+(O.totalAmount||O.finalTotal||0),0),N=de.length>0?te(de[0].date):null;return{totalSpent:G,lastPurchase:N}},[de]),S.useEffect(()=>{(async()=>{if(!t||!e){ce([]);return}try{const N=Ye(Ae(t,ke(e,"customers"),F.id),"notes"),O=(await ms(N)).docs.map(H=>({id:H.id,...H.data()}));ce(O.sort((H,J)=>{var ae,x;return(((ae=J.createdAt)==null?void 0:ae.seconds)||0)-(((x=H.createdAt)==null?void 0:x.seconds)||0)}))}catch(N){console.error("Erro ao carregar notas:",N),ce([])}})()},[F.id,t,e]);const he=async()=>{if(W.trim()){if(!t||!e){s("Firestore no configurado. Faa login com uma conta vlida.","error");return}try{const G=Ye(Ae(t,ke(e,"customers"),F.id),"notes");await Pr(G,{text:W.trim(),createdAt:me.now()}),b("");const D=(await ms(G)).docs.map(O=>({id:O.id,...O.data()}));ce(D.sort((O,H)=>{var J,ae;return(((J=H.createdAt)==null?void 0:J.seconds)||0)-(((ae=O.createdAt)==null?void 0:ae.seconds)||0)})),s("Anotao adicionada!","success")}catch(G){console.error("Erro ao adicionar nota:",G),s("Erro ao adicionar nota.","error")}}};return o.createElement("div",{className:"space-y-6"},o.createElement("div",{className:"flex justify-between items-center"},o.createElement("div",null,o.createElement("button",{onClick:()=>a("list"),className:"text-sm text-pink-600 hover:underline"}," Voltar para a Lista"),o.createElement("h2",{className:"text-3xl font-bold"},F.name)),o.createElement("div",{className:"space-x-2"},o.createElement("button",{onClick:()=>M(F),className:"px-4 py-2 text-sm text-white font-semibold rounded-full bg-indigo-500"},"Editar"),o.createElement("button",{onClick:()=>A(F),disabled:f,className:`px-4 py-2 text-sm text-white font-semibold rounded-full ${f?"bg-red-300 cursor-not-allowed":"bg-red-500"}`},"Excluir"))),o.createElement("div",{className:"grid lg:grid-cols-3 gap-6"},o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow lg:col-span-1"},o.createElement("h3",{className:"text-xl font-semibold"},"Informaes"),o.createElement("p",null,o.createElement("strong",null,"Telefone:")," ",F.phone||F.whatsapp||"N/A"),o.createElement("p",null,o.createElement("strong",null,"Email:")," ",F.email||"N/A"),o.createElement("p",null,o.createElement("strong",null,"Aniversrio:")," ",F.birthday||"N/A"),o.createElement("div",null,o.createElement("h4",{className:"font-semibold"},"Tags:"),o.createElement("div",{className:"flex flex-wrap gap-2 mt-2"},(F.tags||[]).map(G=>o.createElement("span",{key:G,className:"px-2 py-1 text-xs font-semibold text-pink-800 bg-pink-100 rounded-full"},G))))),o.createElement("div",{className:"lg:col-span-2 space-y-6"},o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow"},o.createElement("h3",{className:"text-xl font-semibold"},"Anotaes"),o.createElement("div",{className:"flex space-x-2 mb-4"},o.createElement("textarea",{value:W,onChange:G=>b(G.target.value),rows:"2",className:nr,placeholder:"Adicionar nova anotao..."}),o.createElement("button",{onClick:he,className:"px-4 text-white font-semibold rounded-lg bg-pink-500"},"Salvar")),o.createElement("div",{className:"space-y-3 max-h-40 overflow-y-auto"},le.map(G=>o.createElement("div",{key:G.id,className:"p-2 bg-gray-50 dark:bg-gray-700/50 rounded"},o.createElement("p",{className:"text-sm"},G.text),o.createElement("p",{className:"text-xs text-right text-gray-400"},new Date(G.createdAt.seconds*1e3).toLocaleString("pt-BR")))))),o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow"},o.createElement("h3",{className:"text-xl font-semibold"},"Histrico de Compras (",de.length,")"),o.createElement("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto"},de.length>0?de.map(G=>o.createElement("div",{key:G.id,className:"p-4 rounded-lg border-l-4 bg-white dark:bg-gray-700/50 border-teal-500"},o.createElement("div",{className:"flex justify-between items-center"},o.createElement("div",null,o.createElement("p",{className:"text-sm text-gray-500"},te(G.date)&&te(G.date).toLocaleString("pt-BR")||G.date),o.createElement("p",{className:"font-bold text-lg"},CA(G.totalAmount)," - ",o.createElement("span",{className:"font-medium"},G.paymentMethod))),o.createElement("div",null,o.createElement("button",{onClick:()=>K(V===G.id?null:G.id),className:"text-sm font-semibold text-gray-600"},V===G.id?"Fechar":"Ver Itens"))),V===G.id&&o.createElement("div",{className:"mt-4 pt-4 border-t text-sm"},o.createElement("p",{className:"font-semibold"},"Itens Comprados:"),o.createElement("ul",{className:"list-disc list-inside"},G.items.map(N=>o.createElement("li",{key:N.sku},N.quantity,"x ",N.name," - R$ ",N.salePrice)))))):o.createElement("p",{className:"text-gray-500"},"Nenhuma compra registrada para esta cliente."))))))};return i==="profile"&&l?o.createElement(ue,{customer:l}):o.createElement("div",{className:"space-y-6"},o.createElement("div",{className:"flex flex-col md:flex-row justify-between md:items-center"},o.createElement("h2",{className:"text-2xl font-bold"},"Gesto de Clientes"),o.createElement("div",{className:"flex items-center space-x-2 mt-4 md:mt-0"},o.createElement("input",{type:"text",placeholder:"Buscar por nome, telefone, tag...",value:g,onChange:F=>k(F.target.value),className:nr+" max-w-sm"}),o.createElement("button",{onClick:()=>M(),className:"px-4 py-3 text-white font-semibold rounded-lg bg-pink-500"},"+ Nova Cliente"))),o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow overflow-x-auto"},o.createElement("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},o.createElement("thead",{className:"bg-gray-50 dark:bg-gray-700"},o.createElement("tr",null,o.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Nome"),o.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Telefone"),o.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Tags"),o.createElement("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Aes"))),o.createElement("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},B.map(F=>o.createElement("tr",{key:F.id,className:"hover:bg-gray-50 dark:hover:bg-gray-700"},o.createElement("td",{className:"px-6 py-4"},o.createElement("div",{className:"text-sm font-medium"},F.name),F.email&&o.createElement("div",{className:"text-sm text-gray-500"},F.email)),o.createElement("td",{className:"px-6 py-4"},o.createElement("div",{className:"text-sm"},F.phone||F.whatsapp||"N/A")),o.createElement("td",{className:"px-6 py-4"},o.createElement("div",{className:"flex flex-wrap gap-1"},(F.tags||[]).slice(0,3).map(le=>o.createElement("span",{key:le,className:"px-2 py-1 text-xs font-semibold text-pink-800 bg-pink-100 rounded-full"},le)))),o.createElement("td",{className:"px-6 py-4 text-right text-sm font-medium"},o.createElement("button",{onClick:()=>M(F),className:"text-indigo-600 mr-4"},"Editar"),o.createElement("button",{onClick:()=>{u(F),a("profile")},className:"text-indigo-600 mr-4"},"Ver Perfil"),o.createElement("button",{onClick:()=>A(F),className:"text-red-600"},"Excluir"))))))),o.createElement(_t,{isOpen:c,onClose:()=>d(!1),title:h?"Editar Cliente":"Adicionar Cliente",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),o.createElement("button",{onClick:X,className:"px-4 py-2 text-white rounded-full bg-pink-500"},h?"Salvar":"Adicionar"))},o.createElement("form",{className:"space-y-4"},o.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},o.createElement("div",null,o.createElement("label",null,"Nome*"),o.createElement("input",{type:"text",name:"name",value:C.name,onChange:F=>P({...C,name:F.target.value}),className:nr})),o.createElement("div",null,o.createElement("label",null,"Telefone"),o.createElement("input",{type:"tel",name:"phone",value:C.phone,onChange:F=>P({...C,phone:F.target.value}),className:nr}))),o.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},o.createElement("div",null,o.createElement("label",null,"Email"),o.createElement("input",{type:"email",name:"email",value:C.email,onChange:F=>P({...C,email:F.target.value}),className:nr})),o.createElement("div",null,o.createElement("label",null,"Aniversrio"),o.createElement("input",{type:"date",name:"birthday",value:C.birthday,onChange:F=>P({...C,birthday:F.target.value}),className:nr}))),o.createElement("div",null,o.createElement("label",null,"Preferncias"),o.createElement("textarea",{name:"preferences",rows:"3",value:C.preferences,onChange:F=>P({...C,preferences:F.target.value}),className:nr})),o.createElement("div",null,o.createElement("label",null,"Tags (separadas por vrgula)"),o.createElement("input",{type:"text",name:"tags",value:C.tags,onChange:F=>P({...C,tags:F.target.value}),className:nr})))),o.createElement(_t,{isOpen:y,onClose:()=>E(!1),title:"Confirmar Excluso",size:"max-w-md",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:()=>E(!1),disabled:f,className:`px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full ${f?"opacity-60 cursor-not-allowed":""}`},"Cancelar"),o.createElement("button",{onClick:T,disabled:f,className:`px-4 py-2 text-white rounded-full ${f?"bg-red-300 cursor-not-allowed":"bg-red-500"}`},f?"Excluindo...":"Excluir"))},o.createElement("p",null,"Tem certeza que deseja excluir a cliente ",o.createElement("strong",null,v==null?void 0:v.name),"?")))},CA=(t=0)=>{try{return Number(t).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}catch{return`R$ ${t}`}},zh="bg-pink-500 hover:bg-pink-600",IA="bg-red-500 hover:bg-red-600",dr="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",cx="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",TA=({expenses:t})=>{const e=o.useMemo(()=>{const r=new Date,s=new Date(r.getFullYear(),r.getMonth(),1),a=(t||[]).filter(u=>{const c=te(u.date);return c?c>=s:!1}).reduce((u,c)=>(u[c.category]=(u[c.category]||0)+c.amount,u),{}),l=Object.values(a).reduce((u,c)=>u+c,0);return Object.entries(a).map(([u,c])=>({category:u,amount:c,percentage:l>0?c/l*100:0})).sort((u,c)=>c.amount-u.amount)},[t]);if(!e||e.length===0)return null;const n=["bg-pink-500","bg-teal-500","bg-yellow-500","bg-purple-500","bg-orange-500","bg-indigo-500"];return o.createElement("div",{className:cx},o.createElement("h3",{className:"text-xl font-semibold mb-4"},"Despesas do Ms por Categoria"),o.createElement("div",{className:"space-y-4"},o.createElement("div",{className:"flex h-6 rounded-full overflow-hidden shadow-inner"},e.map((r,s)=>o.createElement("div",{key:r.category,style:{width:`${r.percentage}%`},className:n[s%n.length],title:`${r.category}: ${r.percentage.toFixed(1)}%`}))),o.createElement("ul",{className:"grid grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-2 text-sm"},e.map((r,s)=>o.createElement("li",{key:r.category,className:"flex items-center space-x-2"},o.createElement("span",{className:`w-3 h-3 rounded-full ${n[s%n.length]}`}),o.createElement("span",{className:"text-gray-700 dark:text-gray-300"},r.category,":"),o.createElement("span",{className:"font-semibold text-gray-800 dark:text-gray-100"},Se(r.amount)))))))},bA=({isOpen:t,onClose:e,db:n,userId:r,showToast:s,recurringExpenses:i=[],onLaunch:a,expenseCategories:l=[]})=>{const[u,c]=S.useState({description:"",amount:"",category:l[0]||"Matria Prima"});S.useEffect(()=>{c({description:"",amount:"",category:l[0]||"Matria Prima"})},[t,l]);const d=E=>c(v=>({...v,[E.target.name]:E.target.value})),h=async()=>{if(!u.description.trim()||parseFloat(u.amount)<=0){s("Descrio e valor so obrigatrios","error");return}if(!n||!r){s("Firestore no configurado. Faa login com uma conta vlida.","error");return}await Pr(Ye(n,ke(r,"recurringExpenses")),{...u,amount:parseFloat(u.amount)}),c({description:"",amount:"",category:l[0]||"Matria Prima"}),s("Despesa recorrente adicionada!","success")},m=async E=>{if(!n||!r){s("Firestore no configurado. Faa login com uma conta vlida.","error");return}await rs(Ae(n,ke(r,"recurringExpenses"),E)),s("Despesa recorrente excluda","success")},y=E=>{a&&a({description:E.description,amount:E.amount,category:E.category,status:"a_pagar",date:new Date().toISOString().split("T")[0],dueDate:new Date().toISOString().split("T")[0]})};return o.createElement(_t,{isOpen:t,onClose:e,title:"Gerenciar Despesas Recorrentes",size:"max-w-2xl"},o.createElement("div",{className:"space-y-4"},o.createElement("div",{className:"p-4 border rounded-lg bg-gray-50 dark:bg-gray-700/50 space-y-3"},o.createElement("h4",{className:"font-semibold"},"Adicionar Nova Despesa Recorrente"),o.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3"},o.createElement("input",{name:"description",value:u.description,onChange:d,className:dr,placeholder:"Descrio (Ex: Aluguel)"}),o.createElement("input",{name:"amount",value:u.amount,onChange:d,className:dr,placeholder:"Valor (R$)"}),o.createElement("select",{name:"category",value:u.category,onChange:d,className:dr},l.map(E=>o.createElement("option",{key:E,value:E},E)))),o.createElement("button",{onClick:h,className:`w-full py-2 text-white font-semibold rounded-lg ${zh}`},"Adicionar")),o.createElement("div",{className:"max-h-64 overflow-y-auto"},o.createElement("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700"},(i||[]).map(E=>o.createElement("li",{key:E.id,className:"py-3 flex justify-between items-center"},o.createElement("div",null,o.createElement("p",{className:"font-medium dark:text-gray-200"},E.description," - ",Se(E.amount)),o.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},E.category)),o.createElement("div",{className:"space-x-2"},o.createElement("button",{onClick:()=>y(E),className:"px-3 py-1 text-sm text-white bg-blue-500 rounded-full"},"Lanar no Ms"),o.createElement("button",{onClick:()=>m(E.id),className:"text-red-500"},"Excluir"))))))))},DA=({db:t,userId:e,expenses:n=[],showToast:r=()=>{},recurringExpenses:s=[],onLaunchRecurring:i=null})=>{const[a,l]=S.useState(!1),[u,c]=S.useState(null),[d,h]=S.useState(!1),[m,y]=S.useState(null),[E,v]=S.useState(!1),w={description:"",amount:"",category:"Matria Prima",date:new Date().toISOString().split("T")[0],status:"pago",dueDate:""},[f,p]=S.useState(w),g=["Matria Prima","Marketing","Aluguel","Salrios","Impostos","Outros"];S.useEffect(()=>{if(u){const A=te(u.date)&&te(u.date).toISOString().split("T")[0]||u.date||new Date().toISOString().split("T")[0],T=te(u.dueDate)&&te(u.dueDate).toISOString().split("T")[0]||u.dueDate||"";p({...u,date:A,dueDate:T})}},[u]);const k=(A=null)=>{c(null),p(A?{...w,...A}:w),l(!0)};S.useEffect(()=>{i&&k(i)},[i]);const _=A=>{const{name:T,value:B}=A.target;p(ue=>({...ue,[T]:B}))},C=async A=>{if(A&&A.preventDefault(),!f.description||parseFloat(f.amount)<=0)return r("Preencha a descrio e um valor vlido.","error");if(!t||!e){r("Firestore no configurado. Faa login com uma conta vlida.","error"),l(!1),c(null);return}try{const T={...f,amount:parseFloat(f.amount),date:me.fromDate(new Date(f.date.replace(/-/g,"/"))),dueDate:f.status==="a_pagar"&&f.dueDate?me.fromDate(new Date(f.dueDate.replace(/-/g,"/"))):null},B=Ye(t,ke(e,"expenses"));u?(await ps(Ae(B,u.id),T),r("Despesa atualizada!","success")):(await Pr(B,T),r("Despesa adicionada!","success")),l(!1),c(null)}catch(T){console.error("Erro ao salvar despesa:",T),r("Erro ao salvar despesa.","error")}},P=A=>{y(A),h(!0)},M=async()=>{if(m){if(!t||!e){r("Firestore no configurado. Faa login com uma conta vlida.","error"),h(!1),y(null);return}try{await rs(Ae(t,ke(e,"expenses"),m.id)),r("Despesa excluda.","success")}catch{r("Erro ao excluir.","error")}finally{h(!1),y(null)}}},X=async A=>{if(!t||!e){r("Firestore no configurado. Faa login com uma conta vlida.","error");return}const T=Ae(t,ke(e,"expenses"),A.id);try{await ps(T,{status:"pago"}),r("Despesa marcada como paga!","success")}catch{r("Erro ao atualizar despesa.","error")}};return o.createElement("div",{className:"space-y-6"},o.createElement("div",{className:"flex justify-between items-center"},o.createElement("h2",{className:"text-2xl font-bold"},"Controle de Despesas"),o.createElement("div",{className:"flex space-x-2"},o.createElement("button",{onClick:()=>v(!0),className:"px-4 py-2 text-teal-600 font-semibold bg-teal-100 rounded-lg"},"Gerenciar Recorrentes"),o.createElement("button",{onClick:()=>k(),className:`px-4 py-2 text-white font-semibold rounded-lg ${zh}`},"+ Nova Despesa"))),o.createElement(TA,{expenses:n}),o.createElement("div",{className:cx},o.createElement("h3",{className:"text-xl font-semibold mb-4"},"Despesas Registradas (",(n||[]).length,")"),o.createElement("div",{className:"overflow-x-auto"},o.createElement("table",{className:"min-w-full divide-y divide-gray-200"},o.createElement("thead",{className:"bg-gray-50"},o.createElement("tr",null,o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Data"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Descrio"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Categoria"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Valor"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Status"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Aes"))),o.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},(n||[]).map(A=>{const T=A.status==="a_pagar"&&te(A.dueDate)?te(A.dueDate)<Pn(new Date):!1;return o.createElement("tr",{key:A.id,className:T?"bg-red-50":""},o.createElement("td",{className:"px-3 py-4 text-sm"},te(A.date)&&te(A.date).toLocaleDateString("pt-BR")||A.date),o.createElement("td",{className:"px-3 py-4 text-sm font-medium"},A.description),o.createElement("td",{className:"px-3 py-4 text-sm"},o.createElement("span",{className:"px-2 inline-flex text-xs font-semibold rounded-full bg-pink-100 text-pink-800"},A.category)),o.createElement("td",{className:"px-3 py-4 text-sm font-semibold text-red-600"},Se(A.amount)),o.createElement("td",{className:"px-3 py-4 text-sm"},A.status==="pago"?o.createElement("span",{className:"text-green-600 font-semibold"},"Pago"):o.createElement("span",{className:"text-yellow-600 font-semibold"},"A Pagar ",te(A.dueDate)?`em ${te(A.dueDate).toLocaleDateString("pt-BR")}`:"")),o.createElement("td",{className:"px-3 py-4 text-right text-sm space-x-2"},A.status==="a_pagar"&&o.createElement("button",{onClick:()=>X(A),className:"text-green-600"},"Pagar"),o.createElement("button",{onClick:()=>{c(A),l(!0)},className:"text-indigo-600"},"Editar"),o.createElement("button",{onClick:()=>P(A),className:"text-red-600"},"Deletar")))}))))),o.createElement(_t,{isOpen:a,onClose:()=>l(!1),title:u?"Editar Despesa":"Adicionar Despesa",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:()=>l(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),o.createElement("button",{onClick:C,className:`px-4 py-2 text-white rounded-full ${zh}`},u?"Salvar":"Adicionar"))},o.createElement("form",{className:"space-y-4"},o.createElement("div",null,o.createElement("label",null,"Nome / Descrio"),o.createElement("input",{type:"text",name:"description",value:f.description,onChange:_,className:dr})),o.createElement("div",{className:"grid grid-cols-2 gap-4"},o.createElement("div",null,o.createElement("label",null,"Valor (R$)"),o.createElement("input",{type:"number",name:"amount",value:f.amount,onChange:_,className:dr})),o.createElement("div",null,o.createElement("label",null,"Data"),o.createElement("input",{type:"date",name:"date",value:f.date,onChange:_,className:dr}))),o.createElement("div",null,o.createElement("label",null,"Categoria"),o.createElement("select",{name:"category",value:f.category,onChange:_,className:dr},g.map(A=>o.createElement("option",{key:A,value:A},A)))),o.createElement("div",{className:"grid grid-cols-2 gap-4"},o.createElement("div",null,o.createElement("label",null,"Status"),o.createElement("div",{className:"flex"},o.createElement("button",{type:"button",onClick:()=>p({...f,status:"pago"}),className:`w-full py-2 ${f.status==="pago"?"bg-teal-500 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`},"Pago"),o.createElement("button",{type:"button",onClick:()=>p({...f,status:"a_pagar"}),className:`w-full py-2 ${f.status==="a_pagar"?"bg-yellow-500 text-white":"bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`},"A Pagar"))),f.status==="a_pagar"&&o.createElement("div",null,o.createElement("label",null,"Vencimento"),o.createElement("input",{type:"date",name:"dueDate",value:f.dueDate,onChange:_,className:dr}))))),o.createElement(_t,{isOpen:d,onClose:()=>h(!1),title:"Confirmar Excluso",size:"max-w-md",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 dark:bg-gray-600 dark:text-gray-200 rounded-full"},"Cancelar"),o.createElement("button",{onClick:M,className:`px-4 py-2 text-white rounded-full ${IA}`},"Excluir"))},o.createElement("p",null,"Tem certeza que deseja excluir a despesa ",o.createElement("strong",null,m==null?void 0:m.description),"?")),E&&o.createElement(bA,{isOpen:E,onClose:()=>v(!1),db:t,userId:e,showToast:r,recurringExpenses:s,onLaunch:A=>{v(!1),k(A)},expenseCategories:g}))},hd="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",AA="bg-pink-500 hover:bg-pink-600",Uy="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",RA=({goal:t,sales:e,expenses:n,goalTypes:r})=>{const s=S.useMemo(()=>{if(!t)return{idealPath:[],actualPath:[],daysInMonth:0,today:0};const v=new Date,w=v.getFullYear(),f=v.getMonth(),p=new Date(w,f+1,0).getDate(),g=v.getDate(),k=t.amount/p,_=Array.from({length:p},(T,B)=>k*(B+1)),C=(e||[]).filter(T=>{const B=te(T.date);return B?B.getMonth()===f&&B.getFullYear()===w&&T.status!=="estornada":!1}),P=(n||[]).filter(T=>{const B=te(T.date);return B?B.getMonth()===f&&B.getFullYear()===w&&T.status==="pago":!1}),M=Array(p).fill(0);switch(t.type){case"revenue":case"averageTicket":C.forEach(T=>{const B=te(T.date);B&&(M[B.getDate()-1]+=T.totalAmount||T.finalTotal||0)});break;case"netProfit":C.forEach(T=>{const B=te(T.date);B&&(M[B.getDate()-1]+=T.profit||0)}),P.forEach(T=>{const B=te(T.date);B&&(M[B.getDate()-1]-=T.amount)});break;case"salesCount":C.forEach(T=>{const B=te(T.date);B&&(M[B.getDate()-1]+=1)});break;case"itemsSold":C.forEach(T=>{const B=te(T.date);if(!B)return;const ue=B.getDate()-1;M[ue]+=T.items.reduce((F,le)=>F+le.quantity,0)});break}let X=0;const A=M.map((T,B)=>{if(X+=T,t.type==="averageTicket"){const ue=C.filter(F=>{const le=te(F.date);return le?le.getDate()<=B+1:!1});return ue.length>0?X/ue.length:0}return X});return{idealPath:_,actualPath:A,daysInMonth:p,today:g}},[t,e,n]),{idealPath:i,actualPath:a,daysInMonth:l,today:u}=s,c=Math.max(...i,...a,t.amount||0);if(c===0)return o.createElement("p",null,"Sem dados para exibir.");const d=500,h=200,m=v=>v.map((w,f)=>`${f/(l-1)*d},${h-w/c*h}`).join(" "),y=m(i),E=m(a.slice(0,u));return o.createElement("div",{className:"text-center"},o.createElement("svg",{viewBox:`0 0 ${d} ${h}`,className:"w-full h-auto"},o.createElement("polyline",{fill:"none",stroke:"#cbd5e1",strokeWidth:"2",strokeDasharray:"4 4",points:y}),o.createElement("polyline",{fill:"none",stroke:"#ec4899",strokeWidth:"3",points:E})),o.createElement("div",{className:"flex justify-center items-center space-x-4 text-sm mt-2"},o.createElement("div",{className:"flex items-center"},o.createElement("span",{className:"w-4 h-0.5 bg-pink-500 mr-2"})," Realizado"),o.createElement("div",{className:"flex items-center"},o.createElement("span",{className:"w-4 h-0.5 bg-gray-300 border-t-2 border-dashed border-gray-300 mr-2"})," Ideal")),o.createElement("p",{className:"text-sm mt-2"},"Valor atual: ",o.createElement("strong",{className:"text-pink-600"},Se(a[u-1]||0))))},PA=({db:t,userId:e,sales:n=[],expenses:r=[],allGoals:s=[],showToast:i=()=>{}})=>{const a=new Date,l=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,u=s.find(f=>f.id===l),[c,d]=S.useState("revenue"),[h,m]=S.useState(""),y=[{value:"revenue",label:"Faturamento (Receita Total)",format:Se},{value:"netProfit",label:"Lucro Lquido",format:Se},{value:"salesCount",label:"Nmero de Vendas",format:dd},{value:"itemsSold",label:"Itens Vendidos",format:dd},{value:"averageTicket",label:"Ticket Mdio (R$)",format:Se}];S.useEffect(()=>{u?(d(u.type),m(u.amount)):(d("revenue"),m(""))},[u]);const E=async()=>{const f=parseFloat(h);if(!t||!e||isNaN(f)||f<=0){i("Por favor, insira um valor de meta vlido.","error");return}const p=Ae(t,ke(e,"goals"),l);try{await lx(p,{type:c,amount:f}),i("Meta salva com sucesso!","success")}catch(g){console.error("Erro ao salvar meta:",g),i("Erro ao salvar a meta.","error")}},v=(f,p,g)=>{if(!f)return{achieved:0,percentage:0};const[k,_]=f.id.split("-").map(Number),C=new Date(k,_-1,1),P=new Date(k,_,0,23,59,59),M=(p||[]).filter(ue=>{const F=te(ue.date);return F?F>=C&&F<=P&&ue.status!=="estornada":!1}),X=(g||[]).filter(ue=>{const F=te(ue.date);return F?F>=C&&F<=P&&ue.status==="pago":!1});let A=0;const T=M.reduce((ue,F)=>ue+F.totalAmount,0);switch(f.type){case"revenue":A=T;break;case"netProfit":const ue=M.reduce((le,ce)=>le+(ce.profit||0),0),F=X.reduce((le,ce)=>le+ce.amount,0);A=ue-F;break;case"salesCount":A=M.length;break;case"itemsSold":A=M.reduce((le,ce)=>le+ce.items.reduce((W,b)=>W+b.quantity,0),0);break;case"averageTicket":A=M.length>0?T/M.length:0;break;default:A=0}const B=f.amount>0?A/f.amount*100:0;return{achieved:A,percentage:B}},w=S.useMemo(()=>(s||[]).filter(f=>f.id!==l).sort((f,p)=>p.id.localeCompare(f.id)),[s,l]);return o.createElement("div",{className:"space-y-8"},o.createElement("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100"},"Metas e Objetivos"),o.createElement("div",{className:"grid lg:grid-cols-2 gap-6"},o.createElement("div",{className:hd},o.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Definir Meta para ",new Date().toLocaleDateString("pt-BR",{month:"long"})),o.createElement("div",{className:"space-y-4"},o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Tipo de Meta"),o.createElement("select",{value:c,onChange:f=>d(f.target.value),className:Uy},y.map(f=>o.createElement("option",{key:f.value,value:f.value},f.label)))),o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Valor da Meta"),o.createElement("input",{type:"number",value:h,onChange:f=>m(f.target.value),className:Uy,placeholder:"Ex: 5000"})),o.createElement("button",{onClick:E,className:`w-full p-3 rounded-full text-white font-bold ${AA}`},u?"Atualizar Meta":"Salvar Meta"))),o.createElement("div",{className:hd},o.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Ritmo para Atingir a Meta"),u?o.createElement(RA,{goal:u,sales:n,expenses:r,goalTypes:y}):o.createElement("p",{className:"text-center text-gray-500 dark:text-gray-400 py-10"},"Defina uma meta para ver o ritmo de progresso."))),o.createElement("div",{className:hd},o.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Histrico de Metas"),o.createElement("div",{className:"max-h-96 overflow-y-auto"},o.createElement("ul",{className:"space-y-3"},w.map(f=>{const p=v(f,n,r),g=y.find(M=>M.value===f.type)||{format:dd},k=p.percentage>=100,[_,C]=f.id.split("-"),P=new Date(_,C-1,1).toLocaleDateString("pt-BR",{month:"long"});return o.createElement("li",{key:f.id,className:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border dark:border-gray-600"},o.createElement("p",{className:"font-bold text-gray-800 dark:text-gray-200 capitalize"},P," de ",_),o.createElement("div",{className:"flex justify-between items-center mt-1"},o.createElement("div",null,o.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Meta (",g.label,"): ",g.format(f.amount)),o.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Atingido: ",o.createElement("span",{className:"font-semibold"},g.format(p.achieved)))),o.createElement("div",{className:`px-3 py-1 rounded-full text-sm font-bold ${k?"bg-green-100 text-green-700 dark:bg-green-900/50 dark:text-green-300":"bg-red-100 text-red-700 dark:bg-red-900/50 dark:text-red-300"}`},p.percentage.toFixed(1),"% ",k?"":"")))})))))},Qt="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",fd="w-full p-3 border border-gray-300 rounded-lg bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",MA=({sales:t=[],expenses:e=[]})=>{const n=S.useMemo(()=>{const s=(t||[]).filter(a=>a.paymentStatus==="recebido"&&a.status!=="estornada").reduce((a,l)=>a+l.totalAmount,0),i=(e||[]).filter(a=>a.status==="pago").reduce((a,l)=>a+l.amount,0);return{inflow:s,outflow:i,balance:s-i}},[t,e]),r=Math.max(n.inflow,n.outflow,1);return o.createElement("div",{className:"space-y-4"},o.createElement("div",{className:"flex justify-around items-end h-48"},o.createElement("div",{className:"flex flex-col items-center"},o.createElement("p",{className:"font-bold text-green-600"},Se(n.inflow)),o.createElement("div",{className:"w-16 bg-green-400 rounded-t-lg",style:{height:`${n.inflow/r*150}px`}}),o.createElement("p",{className:"text-sm"},"Entradas")),o.createElement("div",{className:"flex flex-col items-center"},o.createElement("p",{className:"font-bold text-red-600"},Se(n.outflow)),o.createElement("div",{className:"w-16 bg-red-400 rounded-t-lg",style:{height:`${n.outflow/r*150}px`}}),o.createElement("p",{className:"text-sm"},"Sadas"))),o.createElement("div",{className:"text-center border-t pt-3"},o.createElement("p",{className:"text-sm"},"Saldo do Perodo"),o.createElement("p",{className:`text-2xl font-bold ${n.balance>=0?"text-blue-600":"text-orange-600"}`},Se(n.balance))))},OA=({sales:t=[],expenses:e=[],dateRange:n={}})=>{const r=S.useMemo(()=>{if(!n.start||!n.end)return[];const m=new Map,y=new Date(n.start);for(;y<=n.end;)m.set(y.toISOString().split("T")[0],0),y.setDate(y.getDate()+1);(t||[]).filter(v=>v.status!=="estornada").forEach(v=>{const w=te(v.date);if(!w)return;const f=w.toISOString().split("T")[0];m.has(f)&&m.set(f,m.get(f)+(v.profit||0))}),(e||[]).forEach(v=>{if(v.status!=="pago")return;const w=te(v.date);if(!w)return;const f=w.toISOString().split("T")[0];m.has(f)&&m.set(f,m.get(f)-v.amount)});let E=0;return Array.from(m.values()).map(v=>(E+=v,E))},[t,e,n]);if(r.length===0)return o.createElement("p",{className:"text-center"},"Selecione um perodo para ver a tendncia.");const s=Math.max(...r,0),i=Math.min(...r,0),a=s-i,l=500,u=200,c=m=>a===0?u/2:u-(m-i)/a*u,d=m=>m.length===1?`0,${c(m[0])} ${l},${c(m[0])}`:m.map((y,E)=>`${E/(m.length-1)*l},${c(y)}`).join(" "),h=c(0);return o.createElement("div",{className:"text-center"},o.createElement("svg",{viewBox:`0 0 ${l} ${u}`,className:"w-full h-auto"},h>=0&&h<=u&&o.createElement("line",{x1:"0",y1:h,x2:l,y2:h,stroke:"#9ca3af",strokeWidth:"1",strokeDasharray:"4 4"}),o.createElement("polyline",{fill:"none",stroke:"#10b981",strokeWidth:"3",points:d(r)})),o.createElement("p",{className:"text-sm mt-2"},"Lucro lquido acumulado no perodo."))},$A=({sales:t=[],products:e=[],expenses:n=[],db:r,userId:s,showToast:i=()=>{}})=>{const[a,l]=S.useState("month"),[u,c]=S.useState(""),[d,h]=S.useState(""),[m,y]=S.useState(!1),[E,v]=S.useState({sales:!0,stockMovements:!0,expenses:!0,goals:!1,defectiveItems:!1}),[w,f]=S.useState(!1),{filteredSales:p,filteredExpenses:g,dateRange:k}=S.useMemo(()=>{const N=new Date;let D,O=new Date;O.setHours(23,59,59,999),a==="custom"&&u&&d?(D=Pn(new Date(u.replace(/-/g,"/"))),O=new Date(d.replace(/-/g,"/")),O.setHours(23,59,59,999)):a==="30days"?(D=new Date,D.setDate(N.getDate()-30),D=Pn(D)):a==="month"?D=Pn(new Date(N.getFullYear(),N.getMonth(),1)):a==="year"?D=Pn(new Date(N.getFullYear(),0,1)):D=null;const H=(J,ae=!1)=>D?J.filter(x=>{const U=te(x.date);return U?U>=D&&U<=O:!1}):J;return{filteredSales:H(t,!0),filteredExpenses:H(n),dateRange:{start:D,end:O}}},[t,n,a,u,d]),_=N=>{const D=new Date;let O,H;if(N==="month")O=new Date(D.getFullYear(),D.getMonth()-1,1),H=new Date(D.getFullYear(),D.getMonth(),0);else if(N==="30days")O=new Date,O.setDate(D.getDate()-60),H=new Date,H.setDate(D.getDate()-30);else if(N==="year")O=new Date(D.getFullYear()-1,0,1),H=new Date(D.getFullYear()-1,11,31);else return null;return{start:Pn(O),end:H}},C=(N,D)=>{const O=(N||[]).reduce((x,U)=>(x.totalRevenue+=U.totalAmount,x.totalSalesCount+=1,x.grossProfit+=U.profit||0,x),{totalRevenue:0,grossProfit:0,totalSalesCount:0}),J=(D||[]).filter(x=>x.status==="pago").reduce((x,U)=>x+U.amount,0),ae=O.grossProfit-J;return{...O,totalExpenses:J,netProfit:ae}},P=S.useMemo(()=>{const N=C(p,g),D=_(a);if(!D)return{current:N,changes:null};const O=(t||[]).filter(U=>U.status!=="estornada"&&(()=>{const ee=te(U.date);return ee?ee>=D.start&&ee<=D.end:!1})()),H=(n||[]).filter(U=>(()=>{const ee=te(U.date);return ee?ee>=D.start&&ee<=D.end:!1})()),J=C(O,H),ae=(U,ee)=>ee===0?U>0?100:0:(U-ee)/ee*100,x={revenue:ae(N.totalRevenue,J.totalRevenue),netProfit:ae(N.netProfit,J.netProfit),salesCount:ae(N.totalSalesCount,J.totalSalesCount)};return{current:N,changes:x}},[p,g,t,n,a]),{totalRevenue:M,grossProfit:X,totalSalesCount:A,totalExpenses:T,netProfit:B}=P.current||{totalRevenue:0,grossProfit:0,totalSalesCount:0,totalExpenses:0,netProfit:0},ue=S.useMemo(()=>{if(!p||p.length===0)return{A:[],B:[],C:[]};const N=new Map;let D=0;if(p.forEach(x=>x.items.forEach(U=>{const ee=U.salePrice*U.quantity;N.set(U.productId,(N.get(U.productId)||0)+ee),D+=ee})),D===0)return{A:[],B:[],C:[]};const O=new Map((e||[]).map(x=>[x.id,x.name])),H=Array.from(N.entries()).map(([x,U])=>({id:x,name:O.get(x)||"Produto",revenue:U,percentage:U/D*100})).sort((x,U)=>U.revenue-x.revenue),J={A:[],B:[],C:[]};let ae=0;return H.forEach(x=>{ae+=x.percentage,ae<=80?J.A.push(x):ae<=95?J.B.push(x):J.C.push(x)}),J},[p,e]),F=S.useMemo(()=>{const N=new Map;(p||[]).forEach(O=>O.items.forEach(H=>{const J=N.get(H.sku)||{quantity:0,revenue:0};N.set(H.sku,{quantity:J.quantity+H.quantity,revenue:J.revenue+H.salePrice*H.quantity})}));const D=new Map((e||[]).flatMap(O=>(O.variants||[]).map(H=>[H.sku,{...H,productName:O.name}])));return Array.from(N.entries()).map(([O,H])=>({sku:O,...D.get(O),...H})).sort((O,H)=>H.quantity-O.quantity).slice(0,10)},[p,e]),le=S.useMemo(()=>{const N=new Map;(t||[]).forEach(J=>{const ae=te(J.date)||new Date;J.items.forEach(x=>{(!N.has(x.sku)||ae>N.get(x.sku))&&N.set(x.sku,ae)})});const D=120,O=new Date;return O.setDate(O.getDate()-D),(e||[]).flatMap(J=>(J.variants||[]).filter(ae=>ae.quantity>0).map(ae=>({...ae,productName:J.name,createdAt:te(J.createdAt)}))).map(J=>{const ae=N.get(J.sku),x=ae||J.createdAt,U=x?Math.floor((new Date-x)/(1e3*60*60*24)):null;return{...J,lastSale:ae,daysSinceLastActivity:U,referenceDate:x}}).filter(J=>J.referenceDate?J.referenceDate<O:!1).sort((J,ae)=>J.referenceDate-ae.referenceDate)},[t,e]),ce=S.useMemo(()=>{const N=[];return(t||[]).filter(D=>D.paymentStatus==="a_receber"&&D.status!=="estornada").forEach(D=>{const O=te(D.dueDate)||te(D.date);O&&N.push({id:`${D.id}-0`,saleId:D.id,installmentNumber:null,dueDate:O,customerName:D.customerName||"N/A",amount:D.totalAmount||D.finalTotal||0})}),(t||[]).filter(D=>D.paymentStatus==="parcelado"&&D.status!=="estornada"&&D.installmentsData).forEach(D=>D.installmentsData.forEach(O=>{if(O.status==="a_receber"){const H=te(O.dueDate);if(!H)return;N.push({id:`${D.id}-${O.number}`,saleId:D.id,installmentNumber:O.number,dueDate:H,customerName:D.customerName||"N/A",amount:O.amount,totalInstallments:D.installments})}})),N.sort((D,O)=>D.dueDate-O.dueDate)},[t]),W=async(N,D)=>{if(!r||!s)return i("Firebase no configurado para marcar como pago.","error");const O=Ae(r,ke(s,"sales"),N);if(D===null)await ps(O,{paymentStatus:"recebido"}),i("Venda marcada como recebida!","success");else{const H=await gu(O);if(H.exists()){const ae=H.data().installmentsData.map(U=>U.number===D?{...U,status:"recebido"}:U),x=ae.every(U=>U.status==="recebido");await ps(O,{installmentsData:ae,...x&&{paymentStatus:"recebido"}}),i(`Parcela ${D} marcada como recebida!`,"success")}}},b=[{value:"month",label:"Este Ms"},{value:"30days",label:"ltimos 30 Dias"},{value:"year",label:"Este Ano"},{value:"all",label:"Todo o Perodo"},{value:"custom",label:"Personalizado"}],V=()=>{const N=["Data","Tipo","Descrio","Valor","Status"],D=(p||[]).map(U=>{const ee=te(U.date);return[ee&&ee.toISOString()||"","Venda",`Venda para ${U.customerName||"N/A"}`,U.totalAmount||U.finalTotal||0,U.paymentStatus]}),O=(g||[]).map(U=>{const ee=te(U.date);return[ee&&ee.toISOString()||"","Despesa",U.description,-U.amount,U.status]}),H=[...D,...O].sort((U,ee)=>new Date(U[0])-new Date(ee[0])),J=[N.join(","),...H.map(U=>U.join(","))].join(`
`),ae=new Blob([`\uFEFF${J}`],{type:"text/csv;charset=utf-8;"}),x=document.createElement("a");x.href=URL.createObjectURL(ae),x.setAttribute("download","relatorio_mia_move.csv"),document.body.appendChild(x),x.click(),document.body.removeChild(x),i("Exportao concluda!","success")},K=N=>v(D=>({...D,[N]:!D[N]})),de=async N=>{if(!r||!s)throw new Error("Firestore no configurado");const D=Ye(r,ke(s,N)),H=(await ms(D)).docs;if(!H||H.length===0)return 0;let J=0;const ae=400;for(let x=0;x<H.length;x+=ae){const U=gc(r),ee=H.slice(x,x+ae);ee.forEach(je=>U.delete(Ae(D,je.id))),await U.commit(),J+=ee.length}return J},he=async()=>{f(!0);try{const N=Object.keys(E).filter(O=>E[O]);let D=0;for(const O of N){i(`Limpando ${O}...`,"info");try{const H=await de(O);D+=H,i(`${H} documentos removidos de ${O}`,"success")}catch(H){console.error("Erro limpando",O,H),i(`Erro ao limpar ${O}`,"error")}}i(`Limpeza concluda. Total removido: ${D}`,"success");try{window.dispatchEvent(new CustomEvent("mia:reports-cleared",{detail:{userId:s}}))}catch{}y(!1)}catch(N){console.error("Erro na limpeza:",N),i("Erro ao limpar relatrios.","error")}finally{f(!1)}},G=N=>{if(N===null||isNaN(N))return o.createElement("span",{className:"text-xs text-gray-400"},"s/ comp.");const D=N>=0,O=D?"text-green-500":"text-red-500";return o.createElement("span",{className:`text-sm font-bold ${O}`},D?"":""," ",Math.abs(N).toFixed(1),"%")};return o.createElement("div",{className:"space-y-8"},o.createElement("div",{className:"flex justify-between items-center"},o.createElement("h2",{className:"text-2xl font-bold"},"Relatrios e Anlises"),o.createElement("div",{className:"flex items-center gap-2"},o.createElement("select",{value:a,onChange:N=>l(N.target.value),className:fd},b.map(N=>o.createElement("option",{key:N.value,value:N.value},N.label))),a==="custom"&&o.createElement(o.Fragment,null,o.createElement("input",{type:"date",value:u,onChange:N=>c(N.target.value),className:fd}),o.createElement("input",{type:"date",value:d,onChange:N=>h(N.target.value),className:fd})),o.createElement("button",{onClick:V,className:"px-4 py-3 bg-gray-200 rounded-lg"},"Exportar CSV"),o.createElement("button",{onClick:()=>y(!0),className:"px-4 py-3 bg-red-200 text-red-800 rounded-lg"},"Limpar Relatrios"))),o.createElement("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4"},o.createElement("div",{className:`${Qt} border-l-4 border-pink-500`},o.createElement("p",{className:"text-sm text-gray-500"},"Receita Total"),o.createElement("p",{className:"text-2xl font-bold text-pink-600 mt-1"},Se(M)),P.changes&&o.createElement("div",{className:"mt-1"},G(P.changes.revenue))),o.createElement("div",{className:`${Qt} border-l-4 border-teal-500`},o.createElement("p",{className:"text-sm text-gray-500"},"Lucro Bruto (Vendas)"),o.createElement("p",{className:"text-2xl font-bold text-teal-600 mt-1"},Se(X))),o.createElement("div",{className:`${Qt} border-l-4 border-red-500`},o.createElement("p",{className:"text-sm text-gray-500"},"Total Despesas (Pagas)"),o.createElement("p",{className:"text-2xl font-bold text-red-600 mt-1"},Se(T))),o.createElement("div",{className:`${Qt} border-l-4 border-green-500 col-span-2 lg:col-span-1`},o.createElement("p",{className:"text-sm text-gray-500"},"Lucro Lquido"),o.createElement("p",{className:"text-3xl font-bold text-green-600 mt-1"},Se(B)),P.changes&&o.createElement("div",{className:"mt-1"},G(P.changes.netProfit)))),o.createElement("div",{className:"grid lg:grid-cols-2 gap-6"},o.createElement("div",{className:Qt},o.createElement("h3",{className:"text-xl font-semibold mb-4"},"Fluxo de Caixa (Recebido vs. Pago)"),o.createElement(MA,{sales:p,expenses:g})),o.createElement("div",{className:Qt},o.createElement("h3",{className:"text-xl font-semibold mb-4"},"Tendncia de Lucro no Perodo"),o.createElement(OA,{sales:p,expenses:g,dateRange:k}))),o.createElement("div",{className:"grid lg:grid-cols-2 gap-6"},o.createElement("div",{className:`${Qt}`},o.createElement("h3",{className:"text-xl font-semibold mb-4"},"Desempenho por Dia da Semana")),o.createElement("div",{className:`${Qt}`},o.createElement("h3",{className:"text-xl font-semibold mb-4"},"Distribuio de Pagamentos"))),o.createElement("div",{className:Qt},o.createElement("h3",{className:"text-xl font-semibold mb-4"},"Contas a Receber (Geral) (",ce.length,")"),o.createElement("div",{className:"overflow-x-auto max-h-80"},o.createElement("table",{className:"min-w-full"},o.createElement("thead",{className:"bg-gray-50"},o.createElement("tr",null,o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Vencimento"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Cliente / Parcela"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Valor"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Ao"))),o.createElement("tbody",{className:"bg-white divide-y"},ce.map(N=>{const D=N.dueDate<Pn(new Date);return o.createElement("tr",{key:N.id,className:D?"bg-red-50":""},o.createElement("td",{className:"px-3 py-4"},N.dueDate.toLocaleDateString("pt-BR")),o.createElement("td",{className:"px-3 py-4"},N.customerName,N.installmentNumber&&o.createElement("span",{className:"block text-xs"},"Parcela ",N.installmentNumber,"/",N.totalInstallments)),o.createElement("td",{className:"px-3 py-4 font-bold text-yellow-600"},Se(N.amount)),o.createElement("td",{className:"px-3 py-4"},o.createElement("button",{onClick:()=>W(N.saleId,N.installmentNumber),className:"px-3 py-1 text-xs text-white rounded-full bg-green-500"},"Recebido")))}))))),o.createElement(_t,{isOpen:m,onClose:()=>y(!1),title:"Limpar Relatrios (permanente)",size:"max-w-md",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:()=>y(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-full"},"Cancelar"),o.createElement("button",{onClick:he,disabled:w,className:`px-4 py-2 text-white rounded-full ${w?"bg-gray-400":"bg-red-600"}`},w?"Limpando...":"Confirmar Limpeza"))},o.createElement("div",{className:"space-y-4"},o.createElement("p",{className:"text-sm text-gray-600"},"Selecione quais colees deseja apagar permanentemente. Isso remover documentos do Firestore e NO pode ser desfeito."),o.createElement("div",{className:"space-y-2"},o.createElement("label",{className:"flex items-center"},o.createElement("input",{type:"checkbox",checked:E.sales,onChange:()=>K("sales"),className:"mr-2"})," Vendas (sales)"),o.createElement("label",{className:"flex items-center"},o.createElement("input",{type:"checkbox",checked:E.stockMovements,onChange:()=>K("stockMovements"),className:"mr-2"})," Movimentos de Estoque (stockMovements)"),o.createElement("label",{className:"flex items-center"},o.createElement("input",{type:"checkbox",checked:E.expenses,onChange:()=>K("expenses"),className:"mr-2"})," Despesas (expenses)"),o.createElement("label",{className:"flex items-center"},o.createElement("input",{type:"checkbox",checked:E.goals,onChange:()=>K("goals"),className:"mr-2"})," Metas (goals)"),o.createElement("label",{className:"flex items-center"},o.createElement("input",{type:"checkbox",checked:E.defectiveItems,onChange:()=>K("defectiveItems"),className:"mr-2"})," Itens Defeituosos (defectiveItems)")),o.createElement("div",null,o.createElement("p",{className:"text-sm text-red-600 font-semibold"},"Quer realmente apagar todo o relatrio? Esta ao  permanente e ir remover vendas, movimentos de estoque, despesas, metas e itens defeituosos selecionados.")))),o.createElement("div",{className:"grid lg:grid-cols-3 gap-6 mt-6"},o.createElement("div",{className:`${Qt} lg:col-span-1`},o.createElement("h3",{className:"text-xl font-semibold mb-4"},"Curva ABC de Produtos"),o.createElement("div",{className:"space-y-4"},ue.A.length>0?ue.A.map(N=>o.createElement("div",{key:N.id,className:"flex justify-between"},o.createElement("span",null,N.name),o.createElement("span",{className:"font-semibold"},Se(N.revenue)))):o.createElement("p",null,"Nenhum dado"))),o.createElement("div",{className:"lg:col-span-2 space-y-6"},o.createElement("div",{className:Qt},o.createElement("h3",{className:"text-xl font-semibold mb-4"},"Top 10 Variaes Mais Vendidas"),o.createElement("div",{className:"overflow-x-auto max-h-80"},o.createElement("table",{className:"min-w-full text-sm"},o.createElement("thead",{className:"bg-gray-50"},o.createElement("tr",null,o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Produto"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Qtd."),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Receita"))),o.createElement("tbody",null,F.map(N=>o.createElement("tr",{key:N.sku},o.createElement("td",{className:"py-2 px-2"},N.productName," (",N.size," - ",N.color,")"),o.createElement("td",{className:"py-2 px-2 font-bold"},N.quantity),o.createElement("td",{className:"py-2 px-2 font-semibold text-teal-600"},Se(N.revenue)))))))),o.createElement("div",{className:Qt},o.createElement("h3",{className:"text-xl font-semibold mb-4"},"Estoque Encalhado (+120 dias)"),o.createElement("div",{className:"overflow-x-auto max-h-80"},o.createElement("table",{className:"min-w-full text-sm"},o.createElement("thead",{className:"bg-gray-50"},o.createElement("tr",null,o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Produto"),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"Qtd."),o.createElement("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-800 dark:text-gray-200 uppercase"},"ltima Atividade"))),o.createElement("tbody",null,le.map(N=>o.createElement("tr",{key:N.sku},o.createElement("td",{className:"py-2 px-2"},N.productName," (",N.size," - ",N.color,")"),o.createElement("td",{className:"py-2 px-2 font-bold"},N.quantity),o.createElement("td",{className:"py-2 px-2 text-red-600"},N.daysSinceLastActivity," dias atrs"))))))))))},Vy="bg-pink-500 hover:bg-pink-600",zy="bg-red-500 hover:bg-red-600",LA="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",md="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 transition duration-150 bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-50",FA=({db:t,userId:e,products:n=null,defectiveItems:r=null,showToast:s=()=>{}})=>{const[i,a]=S.useState(!1),[l,u]=S.useState(""),[c,d]=S.useState(null),[h,m]=S.useState(""),[y,E]=S.useState(""),[v,w]=S.useState(null),[f,p]=S.useState(!1),g=!!t&&!!e,k=Array.isArray(n)?n:[],_=r&&Array.isArray(r)?r:[],C=S.useMemo(()=>(k||[]).flatMap(T=>(T.variants||[]).map(B=>({...B,productId:T.id,productName:T.name}))).filter(T=>T.quantity>0&&(T.productName.toLowerCase().includes(l.toLowerCase())||T.sku.toLowerCase().includes(l.toLowerCase()))),[k,l]),P=()=>{a(!0),d(null),m(""),E(""),u("")},M=async()=>{if(!c||!h.trim()){s("Selecione um produto e descreva o defeito.","error");return}if(!g){s("Firestore no configurado. Faa login com uma conta vlida.","error");return}if(g){try{const T=gc(t),B=n.find(K=>K.id===c.productId);if(!B){s("Produto original no encontrado.","error");return}const ue=Ae(t,ke(e,"products"),c.productId),F=B.variants.findIndex(K=>K.sku===c.sku),le=B.variants[F].quantity,ce=le-1;if(ce<0){s("Estoque insuficiente para registrar o defeito.","error");return}const W=[...B.variants];W[F].quantity=ce,T.update(ue,{variants:W});const b={date:me.now(),productId:c.productId,productName:c.productName,variantSku:c.sku,type:"saida_defeito",quantityChange:1,reason:`Defeito: ${h.substring(0,30)}...`,oldQuantity:le,newQuantity:ce};T.set(Ae(Ye(t,ke(e,"stockMovements"))),b);const V={...c,defectDescription:h,suggestedAction:y,registeredAt:me.now(),status:"pendente"};T.set(Ae(Ye(t,ke(e,"defectiveItems"))),V),await T.commit(),s("Item defeituoso registrado com sucesso!","success"),a(!1)}catch(T){console.error("Erro ao registrar item defeituoso:",T),s("Erro ao registrar item defeituoso.","error")}return}},X=async()=>{if(v){if(p(!0),g){try{await rs(Ae(t,ke(e,"defectiveItems"),v.id)),s("Item defeituoso resolvido e removido da lista.","success")}catch(T){console.error(T),s("Erro ao resolver o item.","error")}finally{w(null),p(!1)}return}s("Firestore no configurado. Faa login com uma conta vlida.","error"),w(null),p(!1)}},A=T=>{const B=`*Relatrio de Defeito - Mia Move*

*Produto:* ${T.productName}
*Variao:* ${T.size} - ${T.color}
*SKU:* ${T.sku}

*Defeito Descrito:*
${T.defectDescription}

*Ao Sugerida:*
${T.suggestedAction||"Nenhuma"}`,ue=`https://wa.me/?text=${encodeURIComponent(B)}`;window.open(ue,"_blank")};return o.createElement("div",{className:"space-y-6"},o.createElement("div",{className:"flex flex-col md:flex-row justify-between md:items-center"},o.createElement("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100"},"Controle de Defeitos"),o.createElement("button",{onClick:P,className:`px-4 py-3 text-white font-semibold rounded-lg ${Vy} shadow-md`},"+ Registrar Defeito")),o.createElement("div",{className:LA},o.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"},"Itens com Defeito (",(_||[]).length,")"),o.createElement("div",{className:"space-y-4"},(_||[]).map(T=>o.createElement("div",{key:T.id,className:"p-4 border dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-700/50"},o.createElement("div",{className:"flex flex-col sm:flex-row justify-between sm:items-start"},o.createElement("div",null,o.createElement("p",{className:"font-bold text-lg dark:text-gray-100"},T.productName," (",T.size," - ",T.color,")"),o.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"SKU: ",T.sku," | Registrado em: ",T.registeredAt?new Date(T.registeredAt).toLocaleDateString("pt-BR"):"N/A")),o.createElement("div",{className:"flex items-center space-x-2 mt-3 sm:mt-0"},o.createElement("button",{onClick:()=>A(T),className:"px-3 py-1 text-sm text-white font-semibold rounded-full bg-green-500 hover:bg-green-600 flex items-center space-x-1"},o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},o.createElement("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.428A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})),o.createElement("span",null,"WhatsApp")),o.createElement("button",{onClick:()=>w(T),className:`px-3 py-1 text-sm text-white font-semibold rounded-full ${zy}`},"Resolver"))),o.createElement("div",{className:"mt-3 pt-3 border-t dark:border-gray-600 text-sm space-y-2"},o.createElement("p",null,o.createElement("strong",null,"Defeito:")," ",T.defectDescription),o.createElement("p",null,o.createElement("strong",null,"Ao Sugerida:")," ",T.suggestedAction||"N/A")))))),o.createElement(_t,{isOpen:i,onClose:()=>a(!1),title:"Registrar Item com Defeito",size:"max-w-2xl",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:()=>a(!1),className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 rounded-full"},"Cancelar"),o.createElement("button",{onClick:M,className:`px-4 py-2 text-white rounded-full ${Vy}`},"Registrar e Dar Baixa"))},o.createElement("div",{className:"space-y-4"},o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"1. Encontre o Produto em Estoque"),o.createElement("input",{type:"text",placeholder:"Buscar por nome ou SKU...",value:l,onChange:T=>u(T.target.value),className:md}),o.createElement("div",{className:"max-h-40 overflow-y-auto mt-2 space-y-1 pr-2"},l&&C.map(T=>o.createElement("button",{key:T.sku,onClick:()=>{d(T),u("")},className:"w-full text-left p-2 rounded-lg hover:bg-pink-100 dark:hover:bg-pink-900/40"},T.productName," (",T.size," - ",T.color,") - Estoque: ",T.quantity)))),c&&o.createElement("div",{className:"p-3 bg-teal-50 dark:bg-teal-900/40 rounded-lg"},o.createElement("p",{className:"font-semibold text-teal-800 dark:text-teal-200"},"Selecionado: ",c.productName," (",c.size," - ",c.color,")")),o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"2. Descreva o Defeito"),o.createElement("textarea",{value:h,onChange:T=>m(T.target.value),rows:"3",className:md,placeholder:"Ex: Costura solta na manga direita."})),o.createElement("div",null,o.createElement("label",{className:"block text-sm font-medium"},"3. Ao Sugerida (Opcional)"),o.createElement("input",{type:"text",value:y,onChange:T=>E(T.target.value),className:md,placeholder:"Ex: Trocar com fornecedor."})))),o.createElement(_t,{isOpen:!!v,onClose:()=>w(null),title:"Confirmar Resoluo",size:"max-w-md",actions:o.createElement(o.Fragment,null,o.createElement("button",{onClick:()=>w(null),className:"px-4 py-2 bg-gray-200 dark:bg-gray-600 rounded-full"},"Cancelar"),o.createElement("button",{onClick:X,disabled:f,className:`px-4 py-2 text-white rounded-full ${zy} disabled:opacity-50`},f?"Resolvendo...":"Confirmar e Remover"))},o.createElement("p",null,"Tem certeza que deseja marcar o item ",o.createElement("strong",null,v==null?void 0:v.productName," (",v==null?void 0:v.size," - ",v==null?void 0:v.color,")")," como resolvido?"),o.createElement("p",{className:"text-sm text-gray-500 mt-2"},"Esta ao ir remover o item permanentemente da lista de defeitos.")))},UA={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1},VA=({db:t,userId:e,showToast:n=()=>{}})=>{const[r,s]=S.useState(""),[i,a]=S.useState(null),[l,u]=S.useState(!1),c=async()=>{if(!r.trim())return n("Digite sua pergunta.","error");u(!0),a(null);try{const h=await fetch((typeof import.meta<"u","http://localhost:4321/api/ai"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:r})}),m=await h.json();h.ok?(a({text:m.text}),n("Resposta recebida (via proxy).","success")):(console.error("AI error",m),n(m.error||"Erro do modelo","error"),a({text:m.detail||JSON.stringify(m)}))}catch(d){console.error("Fetch error",d),n("Falha ao contactar o servidor de IA.","error"),a({text:"Erro ao buscar resposta. Verifique se o servidor proxy est rodando e se a varivel HF_API_KEY foi configurada."})}finally{u(!1)}};return o.createElement("div",{className:"space-y-6"},o.createElement("h2",{className:"text-2xl font-bold"},"Consultor - IA"),o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 rounded shadow"},o.createElement("textarea",{value:r,onChange:d=>s(d.target.value),rows:4,className:"w-full p-3 border rounded",placeholder:"Descreva seu problema ou pea uma sugesto..."}),o.createElement("div",{className:"flex items-center space-x-2 mt-3"},o.createElement("button",{onClick:c,className:"px-4 py-2 bg-pink-500 text-white rounded"},"Perguntar"),l&&o.createElement("span",null,"Carregando...")),i&&o.createElement("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded"},o.createElement("strong",null,"Resposta:"),o.createElement("p",{className:"mt-2"},i.text))))},zA=({sales:t})=>{const e=S.useMemo(()=>{const r=[],s=["Dom","Seg","Ter","Qua","Qui","Sex","Sb"];for(let i=6;i>=0;i--){const a=new Date;a.setDate(a.getDate()-i);const l=Pn(a);r.push({day:s[a.getDay()],revenue:0,date:l})}return(t||[]).filter(i=>i.status!=="estornada").forEach(i=>{const a=te(i.date);if(!a)return;const l=Pn(a),u=r.find(c=>c.date.getTime()===l.getTime());u&&(u.revenue+=i.totalAmount||i.finalTotal||0)}),r},[t]),n=Math.max(...e.map(r=>r.revenue),0);return o.createElement("div",{className:"flex justify-around items-end h-[200px] p-2 bg-gray-50 dark:bg-gray-700/50 rounded-xl border border-gray-200 dark:border-gray-700"},e.map((r,s)=>o.createElement("div",{key:s,className:"flex flex-col items-center flex-shrink-0 w-12 text-center"},o.createElement("div",{className:"text-xs font-semibold text-pink-600 dark:text-pink-400 mb-1"},Se(r.revenue)),o.createElement("div",{style:{height:`${n>0?r.revenue/n*120:0}px`,minHeight:"2px"},className:"w-8 bg-pink-400 rounded-t-md transition-all duration-500 shadow-md"}),o.createElement("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mt-1"},r.day))))},jA=({sales:t,expenses:e,monthlyGoal:n,showTitle:r=!1})=>{const{currentValue:s,progressPercentage:i,goalType:a,goalAmount:l}=S.useMemo(()=>{if(!n)return{currentValue:0,progressPercentage:0};const u=new Date,c=new Date(u.getFullYear(),u.getMonth(),1),d=(t||[]).filter(E=>{const v=te(E.date);return v?v>=c&&E.status!=="estornada":!1}),h=(e||[]).filter(E=>{const v=te(E.date);return v?v>=c&&E.status==="pago":!1});let m=0;if(n.type==="revenue")m=d.reduce((E,v)=>E+v.totalAmount,0);else{const E=d.reduce((w,f)=>w+(f.profit||0),0),v=h.reduce((w,f)=>w+f.amount,0);m=E-v}const y=n.amount>0?m/n.amount*100:0;return{currentValue:m,progressPercentage:Math.min(y,100),goalType:n.type==="revenue"?"Faturamento":"Lucro Lquido",goalAmount:n.amount}},[t,e,n]);return n?o.createElement("div",null,r&&o.createElement("h3",{className:"text-xl font-semibold mb-2 text-gray-700 dark:text-gray-200"}," Meta do Ms (",a,")"),o.createElement("div",{className:"flex justify-between items-end mb-1"},o.createElement("span",{className:"text-lg font-bold text-purple-600 dark:text-purple-400"},Se(s)),o.createElement("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400"},"de ",Se(l))),o.createElement("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 shadow-inner"},o.createElement("div",{className:"bg-purple-500 h-4 rounded-full transition-all duration-500",style:{width:`${i}%`}})),o.createElement("p",{className:"text-right text-sm text-gray-600 dark:text-gray-300 mt-1"},i.toFixed(1),"% alcanado")):o.createElement("div",null,r&&o.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"}," Meta do Ms"),o.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"Nenhuma meta definida para este ms. V para a aba 'Metas' para criar uma."))},BA="bg-pink-500 hover:bg-pink-600",qA="bg-teal-500 hover:bg-teal-600",jy="bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700",HA=({sales:t=[],expenses:e=[],products:n=[],monthlyGoal:r=null,setActiveTab:s=()=>{}})=>{const i=new Date;i.setHours(0,0,0,0);const{todayRevenue:a,todayNetProfit:l}=S.useMemo(()=>{const h=(t||[]).filter(f=>{const p=te(f.date);return p?p>=i&&f.status!=="estornada":!1}),m=(e||[]).filter(f=>{const p=te(f.date);return p?p>=i&&f.status==="pago":!1}),y=h.reduce((f,p)=>f+p.totalAmount,0),E=h.reduce((f,p)=>f+(p.profit||0),0),v=m.reduce((f,p)=>f+p.amount,0),w=E-v;return{todayRevenue:y,todayNetProfit:w}},[t,e]),u=S.useMemo(()=>n.flatMap(h=>(h.variants||[]).map(m=>({...m,productName:h.name}))),[n]),c=S.useMemo(()=>{const h=new Date;h.setDate(h.getDate()-7);const m=new Date(h);m.setHours(0,0,0,0);const y=(t||[]).filter(w=>{const f=te(w.date);return f?f>=m&&w.status!=="estornada":!1}),E={};y.forEach(w=>w.items.forEach(f=>{E[f.sku]=(E[f.sku]||0)+f.quantity}));const v=new Map(u.map(w=>[w.sku,w]));return Object.entries(E).map(([w,f])=>({...v.get(w),quantitySold:f})).filter(w=>w&&w.productName).sort((w,f)=>f.quantitySold-w.quantitySold).slice(0,3)},[t,u]),d=S.useMemo(()=>u.filter(h=>h.quantity<5),[u]);return o.createElement("div",{className:"space-y-8"},o.createElement("div",null,o.createElement("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100"},"Painel de Controle"),o.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"Resumo do seu negcio hoje, ",new Date().toLocaleDateString("pt-BR",{weekday:"long",day:"numeric",month:"long"}),".")),o.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},o.createElement("div",{className:`${jy} border-l-4 border-pink-500 col-span-1 md:col-span-2`},o.createElement("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Viso Geral do Dia"),o.createElement("div",{className:"mt-2 grid grid-cols-2 gap-4"},o.createElement("div",null,o.createElement("p",{className:"text-3xl font-bold text-pink-600"},Se(a)),o.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-300"},"Vendas Hoje")),o.createElement("div",null,o.createElement("p",{className:`text-3xl font-bold ${l>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`},Se(l)),o.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-300"},"Lucro Lquido Hoje")))),o.createElement("div",{className:`${jy} border-l-4 border-purple-500 col-span-1 md:col-span-2`},o.createElement(jA,{sales:t,expenses:e,monthlyGoal:r,showTitle:!0}))),o.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6"},o.createElement("div",{className:"lg:col-span-2 space-y-6"},o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700"},o.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"}," Desempenho da Semana"),o.createElement(zA,{sales:t})),o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700"},o.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"}," Produtos Quentes (ltimos 7 dias)"),c.length>0?o.createElement("ul",{className:"space-y-3"},c.map(h=>o.createElement("li",{key:h.sku,className:"flex justify-between items-center p-2 bg-gray-50 dark:bg-gray-700/50 rounded-xl border-l-4 border-pink-300 dark:border-pink-500"},o.createElement("span",{className:"font-medium text-gray-800 dark:text-gray-200"},h.productName," (",h.size," - ",h.color,")"),o.createElement("span",{className:"font-bold text-pink-600 dark:text-pink-400"},h.quantitySold," uni.")))):o.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"Nenhuma venda nos ltimos 7 dias."))),o.createElement("div",{className:"space-y-6"},o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700"},o.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"}," Avisos Importantes"),o.createElement("div",{className:"space-y-3"},d.length>0&&o.createElement("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/40 rounded-lg flex justify-between items-center"},o.createElement("p",{className:"text-orange-700 dark:text-orange-300 text-sm"},d.length," variae(s) com estoque baixo."),o.createElement("button",{onClick:()=>s("Estoque"),className:"text-sm font-semibold text-orange-800 dark:text-orange-200 hover:underline"},"Ver")),d.length===0&&o.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"Tudo em ordem por aqui!"))),o.createElement("div",{className:"bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-xl shadow-lg dark:border dark:border-gray-700"},o.createElement("h3",{className:"text-xl font-semibold mb-4 text-gray-700 dark:text-gray-200"}," Acesso Rpido"),o.createElement("div",{className:"space-y-3"},o.createElement("button",{onClick:()=>s("Vendas"),className:`w-full text-center p-4 rounded-lg text-white font-bold ${BA}`},"+ Nova Venda"),o.createElement("button",{onClick:()=>s("Clientes"),className:"w-full text-center p-4 rounded-lg text-white font-bold bg-purple-500 hover:bg-purple-600"},"+ Nova Cliente"),o.createElement("button",{onClick:()=>s("Despesas"),className:`w-full text-center p-4 rounded-lg text-white font-bold ${qA}`},"+ Nova Despesa"))))))},WA=()=>{const t=()=>{try{const W=localStorage.getItem("mia-move-theme");if(W==="light"||W==="dark")return W;if(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches)return"dark"}catch{}return"light"},[e,n]=S.useState(t),[r,s]=S.useState(!1),[i,a]=S.useState(null),[l,u]=S.useState(!1),[c,d]=S.useState(null),[h,m]=S.useState("Incio");S.useLayoutEffect(()=>{const W=window.document.documentElement;e==="dark"?W.classList.add("dark"):W.classList.remove("dark");try{localStorage.setItem("mia-move-theme",e)}catch{}},[e]);const y=S.useCallback((W,b="info")=>{d({message:W,type:b}),setTimeout(()=>d(null),3e3)},[]),E=W=>{try{localStorage.setItem("mia-user",JSON.stringify(W))}catch{}s(!0),a(W),y("Bem-vindo "+(W.email||""),"success")},v=()=>{try{localStorage.removeItem("mia-user")}catch{}s(!1),a(null),y("Sesso encerrada","info");try{Jt&&yl(Jt)}catch{}},w=o.useRef(!1);o.useEffect(()=>{try{const b=window.location.hash&&decodeURIComponent(window.location.hash.slice(1)),V=window.history.state&&window.history.state.tab;b?m(b):V?m(V):window.history.replaceState({tab:h},"")}catch{}const W=b=>{try{const V=b.state&&b.state.tab||(window.location.hash?decodeURIComponent(window.location.hash.slice(1)):"Incio");w.current=!0,m(V)}catch{}};return window.addEventListener("popstate",W),()=>window.removeEventListener("popstate",W)},[]),o.useEffect(()=>{try{w.current?w.current=!1:window.history.pushState({tab:h},"",`#${encodeURIComponent(h)}`)}catch{}},[h]);const f=!!Xa&&!!Rt,p=i?i.uid:null;if(!f)return o.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900"},o.createElement("div",{className:"max-w-xl p-8 bg-white dark:bg-gray-800 rounded-lg shadow"},o.createElement("h2",{className:"text-2xl font-bold mb-2"},"Firebase no configurado"),o.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-300"},"Esta verso da aplicao requer conexo com Firestore. Por favor verifique o `firebaseConfig` e assegure que o Firestore esteja habilitado no projeto.")));S.useEffect(()=>{if(!f||!Jt)return;const W=eC(Jt,async b=>{b?(s(!0),a({uid:b.uid,email:b.email,displayName:b.displayName})):(s(!1),a(null))});return()=>W()},[f]),S.useEffect(()=>{if(!(!f||!Jt)){try{OE(Jt,Mu).catch(W=>{console.warn("setPersistence failed",W)})}catch{}return()=>{}}},[f]);const[g,k]=S.useState([]),[_,C]=S.useState([]),[P,M]=S.useState([]),[X,A]=S.useState([]),[T,B]=S.useState([]),[ue,F]=S.useState([]),[le,ce]=S.useState([]);return S.useEffect(()=>{if(!f||!i)return;const W=i.uid,b=[],V=(he,G,N=!0)=>{try{const D=Ye(Rt,ke(W,he)),O=N?Vh(D,aA("createdAt","desc")):Vh(D),H=uA(O,J=>{const ae=J.docs.map(x=>({id:x.id,...x.data()}));G(ae)},J=>{console.error("Firestore listen error",he,J),y("Erro ao escutar "+he,"error")});b.push(H)}catch(D){console.error("listen setup error",D)}};V("products",k);let K=null;const de=async he=>{try{const G=Ye(Rt,ke(W,"products")),D=(await ms(G)).docs.map(O=>({id:O.id,...O.data()}));k(D)}catch(G){console.error("products refresh failed",G)}try{K&&clearTimeout(K)}catch{}K=setTimeout(async()=>{try{const G=Ye(Rt,ke(W,"products")),D=(await ms(G)).docs.map(O=>({id:O.id,...O.data()}));k(D)}catch(G){console.error("products retry refresh failed",G)}},1500)};return window.addEventListener("mia:products-updated",de),V("sales",C),V("defectiveItems",M),V("expenses",A),V("customers",B),V("categories",F),V("goals",ce,!1),()=>{b.forEach(he=>he()),window.removeEventListener("mia:products-updated",de);try{K&&clearTimeout(K)}catch{}}},[f,i]),r?o.createElement("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 font-sans text-gray-800 dark:text-gray-200"},o.createElement("header",{className:"bg-white dark:bg-gray-800 shadow-md"},o.createElement("div",{className:"p-4 flex justify-between items-center"},o.createElement("div",{className:"flex items-center space-x-4"},o.createElement("h1",{onClick:()=>m("Incio"),className:"text-3xl cursor-pointer font-extrabold text-pink-600 tracking-wider"},"Mia Move ",o.createElement("span",{className:"text-teal-500 text-sm font-medium"},"Gesto"))),o.createElement("div",{className:"flex items-center space-x-3 sm:space-x-4"},o.createElement("button",{onClick:()=>n(W=>W==="light"?"dark":"light"),title:"Alternar tema",className:"p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"},e==="dark"?o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},o.createElement("path",{d:"M17.293 13.293A8 8 0 116.707 2.707 8 8 0 0017.293 13.293z"})):o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},o.createElement("path",{d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4.22 2.03a1 1 0 011.4 1.42l-.7.7a1 1 0 11-1.4-1.42l.7-.7zM18 9a1 1 0 110 2h-1a1 1 0 110-2h1zM5.46 4.05a1 1 0 011.4 1.42l-.7.7A1 1 0 114.76 5.77l.7-.72zM4 9a1 1 0 100 2H3a1 1 0 100-2h1zM10 16a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM3.05 14.54a1 1 0 011.42 1.4l-.7.7a1 1 0 11-1.42-1.4l.7-.7zM16.95 14.54a1 1 0 011.42 1.4l-.7.7a1 1 0 11-1.42-1.4l.7-.7z"}))),o.createElement("div",{className:"w-9 h-9 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center"},o.createElement("span",{className:"font-semibold text-sm text-gray-700 dark:text-gray-200"},"PR")),o.createElement("button",{onClick:v,title:"Sair",className:"ml-2 px-3 py-1 text-sm rounded bg-gray-100 dark:bg-gray-700"},"Sair")))),o.createElement("main",{className:"p-4 sm:p-6 lg:p-8"},o.createElement("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6 sticky top-0 bg-gray-50 dark:bg-gray-900 z-20"},o.createElement("nav",{className:"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto"},["Incio","Estoque","Vendas","Clientes","Despesas","Metas","Relatrios","Defeitos","Consultor - IA"].map(W=>o.createElement("button",{key:W,onClick:()=>m(W),className:`flex-shrink-0 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-base sm:text-lg transition ${h===W?"border-pink-500 text-pink-600 dark:border-pink-400 dark:text-pink-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:border-gray-600"}`},W)))),h==="Incio"?o.createElement(HA,{sales:_,expenses:X,products:g,monthlyGoal:null,setActiveTab:m}):h==="Estoque"?o.createElement(xA,{db:Rt,userId:p,products:g,showToast:y,categories:ue}):h==="Vendas"?o.createElement(NA,{db:Rt,userId:p,products:g,sales:_,customers:T,showToast:y}):h==="Clientes"?o.createElement(_A,{db:Rt,userId:p,customers:T,sales:_,showToast:y}):h==="Despesas"?o.createElement(DA,{db:Rt,userId:p,showToast:y}):h==="Metas"?o.createElement(PA,{db:Rt,userId:p,sales:_,expenses:X,allGoals:le,showToast:y}):h==="Relatrios"?o.createElement($A,{db:Rt,userId:p,sales:_,products:g,expenses:X,showToast:y}):h==="Defeitos"?o.createElement(FA,{db:Rt,userId:p,products:g,defectiveItems:P,showToast:y}):h==="Consultor - IA"?o.createElement(VA,{db:Rt,userId:p,showToast:y}):o.createElement("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-lg shadow"},"Pgina: ",h," (ainda em desenvolvimento)")),l&&o.createElement(fA,{isOpen:l,onClose:()=>u(!1),showToast:y,onSync:W=>{y("Sincronizado com "+W,"success")},onUnsync:()=>{y("Sincronizao desfeita","info")},currentUid:p,isSynced:!1}),c&&o.createElement(mA,{message:c.message,type:c.type,onClose:()=>d(null)})):o.createElement(pA,{onLogin:E})},KA=Zv(document.getElementById("root"));KA.render(o.createElement(o.StrictMode,null,o.createElement(WA,null)));
